LavaPack.loadBundle([[10,{"@metamask/account-tree-controller":1027},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AccountTreeControllerInit=void 0;var s=e("@metamask/account-tree-controller");n.AccountTreeControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.AccountTreeController({messenger:e,state:t.AccountTreeController})})}}},{package:"$root$",file:"app/scripts/controller-init/accounts/account-tree-controller-init.ts"}],[100,{"../lib/util":237,"@metamask/assets-controllers":1076},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TokenListControllerInit=void 0;var s=e("@metamask/assets-controllers"),r=e("../lib/util");n.TokenListControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:n})=>{const a=t.call("NetworkController:getState").selectedNetworkClientId,{chainId:i}=t.call("NetworkController:getNetworkClientById",a).configuration,o=t.call("PreferencesController:getState"),c=e=>{const{useTokenDetection:t,useTransactionSimulations:n,preferences:s}=e??{},{petnamesEnabled:r}=s??{};return t||r||n},l=new s.TokenListController({messenger:e,state:n.TokenListController,preventPollingOnNetworkRestart:!c(o),chainId:i});return t.subscribe("PreferencesController:stateChange",(0,r.previousValueComparator)((e,t)=>(((e,t)=>{const n=c(t),s=c(e);n!==s&&l.updatePreventPollingOnNetworkRestart(!s)})(t,e),!0),o)),{controller:l}}}}},{package:"$root$",file:"app/scripts/controller-init/token-list-controller-init.ts"}],[101,{"@metamask/assets-controllers":1076,"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TokensControllerInit=void 0;var s=e("@metamask/assets-controllers"),r=e("@metamask/utils");n.TokensControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:n})=>{const a=t.call("NetworkController:getState").selectedNetworkClientId,{chainId:i}=t.call("NetworkController:getNetworkClientById",a).configuration,{provider:o}=t.call("NetworkController:getSelectedNetworkClient")??{};(0,r.assert)(o,"Provider is required to initialize TokensController.");return{controller:new s.TokensController({messenger:e,state:n.TokensController,provider:o,chainId:i})}}}}},{package:"$root$",file:"app/scripts/controller-init/tokens-controller-init.ts"}],[102,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){}}},{package:"$root$",file:"app/scripts/controller-init/types.ts"}],[1025,{"./group.cjs":1026,"./rules/entropy.cjs":1029,"./rules/keyring.cjs":1030,"./rules/snap.cjs":1031,"@metamask/account-api":1024,"@metamask/base-controller":1140,"@metamask/keyring-api":1914},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,l,u,d,p,h,m,f,g,y,w,b,E,v,T,S,A,k,_,M=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},C=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.AccountTreeController=n.getDefaultAccountTreeControllerState=n.controllerName=void 0;const P=e("@metamask/account-api"),I=e("@metamask/base-controller"),N=e("@metamask/keyring-api"),O=e("./group.cjs"),D=e("./rules/entropy.cjs"),j=e("./rules/keyring.cjs"),R=e("./rules/snap.cjs");n.controllerName="AccountTreeController";const L={accountTree:{persist:!1,anonymous:!1},accountGroupsMetadata:{persist:!0,anonymous:!1},accountWalletsMetadata:{persist:!0,anonymous:!1}};function B(){return{accountTree:{wallets:{},selectedAccountGroup:""},accountGroupsMetadata:{},accountWalletsMetadata:{}}}n.getDefaultAccountTreeControllerState=B;class x extends I.BaseController{constructor({messenger:e,state:t}){super({messenger:e,name:n.controllerName,metadata:L,state:{accountTree:{wallets:{},selectedAccountGroup:""},accountGroupsMetadata:{},accountWalletsMetadata:{},...t}}),s.add(this),r.set(this,void 0),a.set(this,void 0),i.set(this,void 0),M(this,r,new Map,"f"),M(this,a,new Map,"f"),M(this,i,[new D.EntropyRule(this.messagingSystem),new R.SnapRule(this.messagingSystem),new j.KeyringRule(this.messagingSystem)],"f"),this.messagingSystem.subscribe("AccountsController:accountAdded",e=>{C(this,s,"m",h).call(this,e)}),this.messagingSystem.subscribe("AccountsController:accountRemoved",e=>{C(this,s,"m",m).call(this,e)}),this.messagingSystem.subscribe("AccountsController:selectedAccountChange",e=>{C(this,s,"m",T).call(this,e)}),C(this,s,"m",_).call(this)}init(){const e={};C(this,r,"f").clear(),C(this,a,"f").clear();const t=this.state.accountTree.selectedAccountGroup;for(const t of C(this,s,"m",y).call(this))C(this,s,"m",g).call(this,e,t);let i=!1;for(const n of Object.values(e)){C(this,s,"m",u).call(this,n);for(const e of Object.values(n.groups))C(this,s,"m",p).call(this,n,e),e.id===t&&(i=!0)}this.update(n=>{n.accountTree.wallets=e,i&&""!==t||(n.accountTree.selectedAccountGroup=C(this,s,"m",v).call(this,e))}),t!==this.state.accountTree.selectedAccountGroup&&this.messagingSystem.publish(`${n.controllerName}:selectedAccountGroupChange`,this.state.accountTree.selectedAccountGroup,t)}getAccountWalletObject(e){const t=this.state.accountTree.wallets[e];return t||undefined}getAccountWalletObjects(){return Object.values(this.state.accountTree.wallets)}getAccountsFromSelectedAccountGroup(e){const t=this.getSelectedAccountGroup();if(!t)return[];const n=this.getAccountGroupObject(t);if(!n)return[];const s=[];for(const e of n.accounts){const t=this.messagingSystem.call("AccountsController:getAccount",e);t&&s.push(t)}return e?(0,P.select)(s,e):s}getAccountGroupObject(e){const t=C(this,a,"f").get(e);if(!t)return undefined;const n=this.getAccountWalletObject(t);return n?.groups[e]}getSelectedAccountGroup(){return this.state.accountTree.selectedAccountGroup}setSelectedAccountGroup(e){const t=this.state.accountTree.selectedAccountGroup;if(t===e)return;const r=C(this,s,"m",A).call(this,e);if(!r)throw new Error(`No accounts found in group: ${e}`);this.update(t=>{t.accountTree.selectedAccountGroup=e}),this.messagingSystem.publish(`${n.controllerName}:selectedAccountGroupChange`,e,t),this.messagingSystem.call("AccountsController:setSelectedAccount",r)}setAccountGroupName(e,t){C(this,s,"m",w).call(this,e),C(this,s,"m",E).call(this,e,t),this.update(n=>{var s;(s=n.accountGroupsMetadata)[e]??(s[e]={}),n.accountGroupsMetadata[e].name={value:t,lastUpdatedAt:Date.now()};const r=C(this,a,"f").get(e);r&&(n.accountTree.wallets[r].groups[e].metadata.name=t)})}setAccountWalletName(e,t){C(this,s,"m",b).call(this,e),this.update(n=>{var s;(s=n.accountWalletsMetadata)[e]??(s[e]={}),n.accountWalletsMetadata[e].name={value:t,lastUpdatedAt:Date.now()},n.accountTree.wallets[e].metadata.name=t})}setAccountGroupPinned(e,t){C(this,s,"m",w).call(this,e),this.update(n=>{var s;(s=n.accountGroupsMetadata)[e]??(s[e]={}),n.accountGroupsMetadata[e].pinned={value:t,lastUpdatedAt:Date.now()};const r=C(this,a,"f").get(e);r&&(n.accountTree.wallets[r].groups[e].metadata.pinned=t)})}setAccountGroupHidden(e,t){C(this,s,"m",w).call(this,e),this.update(n=>{var s;(s=n.accountGroupsMetadata)[e]??(s[e]={}),n.accountGroupsMetadata[e].hidden={value:t,lastUpdatedAt:Date.now()};const r=C(this,a,"f").get(e);r&&(n.accountTree.wallets[r].groups[e].metadata.hidden=t)})}}n.AccountTreeController=x,r=new WeakMap,a=new WeakMap,i=new WeakMap,s=new WeakSet,o=function(){return C(this,i,"f")[0]},c=function(){return C(this,i,"f")[1]},l=function(){return C(this,i,"f")[2]},u=function(e){const t=this.state.accountWalletsMetadata[e.id];t?.name!==undefined?e.metadata.name=t.name.value:e.metadata.name||(e.type===P.AccountWalletType.Entropy?e.metadata.name=C(this,s,"m",o).call(this).getDefaultAccountWalletName(e):e.type===P.AccountWalletType.Snap?e.metadata.name=C(this,s,"m",c).call(this).getDefaultAccountWalletName(e):e.metadata.name=C(this,s,"m",l).call(this).getDefaultAccountWalletName(e))},d=function(e){switch(e.type){case P.AccountWalletType.Entropy:return C(this,s,"m",o).call(this);case P.AccountWalletType.Snap:return C(this,s,"m",c).call(this);default:return C(this,s,"m",l).call(this)}},p=function(e,t){const n=this.state.accountGroupsMetadata[t.id];if(n?.name!==undefined)t.metadata.name=n.name.value;else if(!t.metadata.name){const n=C(this,s,"m",d).call(this,e),r=e.groups[t.id];let a=Object.keys(e.groups).sort().indexOf(t.id);-1===a&&(a=0),t.metadata.name=n.getComputedAccountGroupName(r)||n.getDefaultAccountGroupName(a)}n?.pinned?.value!==undefined&&(t.metadata.pinned=n.pinned.value),n?.hidden?.value!==undefined&&(t.metadata.hidden=n.hidden.value)},h=function(e){this.update(t=>{C(this,s,"m",g).call(this,t.accountTree.wallets,e);const n=C(this,r,"f").get(e.id);if(n){const{walletId:e,groupId:r}=n,a=t.accountTree.wallets[e];if(a){C(this,s,"m",u).call(this,a);const e=a.groups[r];e&&C(this,s,"m",p).call(this,a,e)}}}),this.messagingSystem.publish(`${n.controllerName}:accountTreeChange`,this.state.accountTree)},m=function(e){const t=C(this,r,"f").get(e);if(t){const{walletId:a,groupId:i}=t,o=this.state.accountTree.selectedAccountGroup;let c=!1;this.update(t=>{const n=t.accountTree.wallets[a]?.groups[i]?.accounts;if(n){const r=n.indexOf(e);if(-1!==r&&(n.splice(r,1),t.accountTree.selectedAccountGroup===i&&0===n.length)){const e=C(this,s,"m",k).call(this,t.accountTree.wallets);t.accountTree.selectedAccountGroup=e,c=e!==o}0===n.length&&C(this,s,"m",f).call(this,t,a,i)}}),this.messagingSystem.publish(`${n.controllerName}:accountTreeChange`,this.state.accountTree),c&&this.messagingSystem.publish(`${n.controllerName}:selectedAccountGroupChange`,this.state.accountTree.selectedAccountGroup,o),C(this,r,"f").delete(e)}},f=function(e,t,n){const{wallets:s}=e.accountTree;return delete s[t].groups[n],C(this,a,"f").delete(n),0===Object.keys(s[t].groups).length&&delete s[t],e},g=function(e,t){const n=C(this,s,"m",o).call(this).match(t)??C(this,s,"m",c).call(this).match(t)??C(this,s,"m",l).call(this).match(t),i=n.wallet.id;let u=e[i];u||(e[i]={...n.wallet,groups:{},metadata:{name:"",...n.wallet.metadata}},u=e[i]);const d=n.group.id;let p=u.groups[d];p?p.accounts.push(t.id):(u.groups[d]={...n.group,accounts:[t.id],metadata:{name:"",pinned:!1,hidden:!1,...n.group.metadata}},p=u.groups[d],C(this,a,"f").set(d,i)),C(this,r,"f").set(t.id,{walletId:u.id,groupId:p.id})},y=function(){return this.messagingSystem.call("AccountsController:listMultichainAccounts")},w=function(e){if(!C(this,a,"f").has(e))throw new Error(`Account group with ID "${e}" not found in tree`)},b=function(e){if(!Boolean(this.state.accountTree.wallets[e]))throw new Error(`Account wallet with ID "${e}" not found in tree`)},E=function(e,t){if(!(0,O.isAccountGroupNameUnique)(this.state,e,t))throw new Error("Account group name already exists")},v=function(e){const t=this.messagingSystem.call("AccountsController:getSelectedAccount");if(t&&t.id){const e=C(this,r,"f").get(t.id);if(e){const{groupId:t}=e;return t}}return C(this,s,"m",k).call(this,e)},T=function(e){const t=C(this,r,"f").get(e.id);if(!t)return;const{groupId:s}=t,a=this.state.accountTree.selectedAccountGroup;a!==s&&(this.update(e=>{e.accountTree.selectedAccountGroup=s}),this.messagingSystem.publish(`${n.controllerName}:selectedAccountGroupChange`,s,a))},S=function(e){const t=Object.values(this.state.accountTree.wallets).find(t=>t.groups[e]!==undefined);return t?.groups[e]},A=function(e){const t=C(this,s,"m",S).call(this,e);if(t){let e;for(const n of t.accounts){const t=this.messagingSystem.call("AccountsController:getAccount",n);if(e||(e=n),t&&(0,N.isEvmAccountType)(t.type))return t.id}return e}return undefined},k=function(e){let t="";for(const n of Object.values(e))for(const e of Object.values(n.groups)){""===t&&e.accounts.length>0&&(t=e.id);for(const t of e.accounts){const n=this.messagingSystem.call("AccountsController:getAccount",t);if(n&&(0,N.isEvmAccountType)(n.type))return e.id}}return t},_=function(){this.messagingSystem.registerActionHandler(`${n.controllerName}:getSelectedAccountGroup`,this.getSelectedAccountGroup.bind(this)),this.messagingSystem.registerActionHandler(`${n.controllerName}:setSelectedAccountGroup`,this.setSelectedAccountGroup.bind(this)),this.messagingSystem.registerActionHandler(`${n.controllerName}:getAccountsFromSelectedAccountGroup`,this.getAccountsFromSelectedAccountGroup.bind(this)),this.messagingSystem.registerActionHandler(`${n.controllerName}:setAccountWalletName`,this.setAccountWalletName.bind(this)),this.messagingSystem.registerActionHandler(`${n.controllerName}:setAccountGroupName`,this.setAccountGroupName.bind(this)),this.messagingSystem.registerActionHandler(`${n.controllerName}:setAccountGroupPinned`,this.setAccountGroupPinned.bind(this)),this.messagingSystem.registerActionHandler(`${n.controllerName}:setAccountGroupHidden`,this.setAccountGroupHidden.bind(this))}}}},{package:"@metamask/account-tree-controller",file:"node_modules/@metamask/account-tree-controller/dist/AccountTreeController.cjs"}],[1026,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isAccountGroupNameUnique=void 0,n.isAccountGroupNameUnique=function(e,t,n){const s=n.trim();for(const n of Object.values(e.accountTree.wallets))for(const e of Object.values(n.groups))if(e.id!==t&&e.metadata.name.trim()===s)return!1;return!0}}}},{package:"@metamask/account-tree-controller",file:"node_modules/@metamask/account-tree-controller/dist/group.cjs"}],[1027,{"./AccountTreeController.cjs":1025,"./group.cjs":1026},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultAccountTreeControllerState=n.AccountTreeController=n.isAccountGroupNameUnique=void 0;var s=e("./group.cjs");Object.defineProperty(n,"isAccountGroupNameUnique",{enumerable:!0,get:function(){return s.isAccountGroupNameUnique}});var r=e("./AccountTreeController.cjs");Object.defineProperty(n,"AccountTreeController",{enumerable:!0,get:function(){return r.AccountTreeController}}),Object.defineProperty(n,"getDefaultAccountTreeControllerState",{enumerable:!0,get:function(){return r.getDefaultAccountTreeControllerState}})}}},{package:"@metamask/account-tree-controller",file:"node_modules/@metamask/account-tree-controller/dist/index.cjs"}],[1028,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BaseRule=void 0;n.BaseRule=class{constructor(e){this.messenger=e}getComputedAccountGroupName(e){const t=this.messenger.call("AccountsController:getAccount",e.accounts[0]);return t?.metadata.name??""}getDefaultAccountGroupName(e){return e===undefined?"":`Account ${e+1}`}}}}},{package:"@metamask/account-tree-controller",file:"node_modules/@metamask/account-tree-controller/dist/rule.cjs"}],[1029,{"../rule.cjs":1028,"@metamask/account-api":1024,"@metamask/keyring-api":1914,"@metamask/keyring-controller":1924},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.EntropyRule=void 0;const s=e("@metamask/account-api"),r=e("@metamask/keyring-api"),a=e("@metamask/keyring-controller"),i=e("../rule.cjs");class o extends i.BaseRule{constructor(){super(...arguments),this.walletType=s.AccountWalletType.Entropy,this.groupType=s.AccountGroupType.MultichainAccount}getEntropySourceIndex(e){const{keyrings:t}=this.messenger.call("KeyringController:getState");return t.filter(e=>e.type===a.KeyringTypes.hd).findIndex(t=>t.metadata.id===e)}match(e){if(!(0,s.isBip44Account)(e))return undefined;const t=e.options.entropy.id;if(-1===this.getEntropySourceIndex(t))return console.warn(`! Found an unknown entropy ID: "${t}", account "${e.id}" won't be grouped by entropy.`),undefined;const n=(0,s.toMultichainAccountWalletId)(t),r=(0,s.toMultichainAccountGroupId)(n,e.options.entropy.groupIndex);return{wallet:{type:this.walletType,id:n,metadata:{entropy:{id:t}}},group:{type:this.groupType,id:r,metadata:{entropy:{groupIndex:e.options.entropy.groupIndex},pinned:!1,hidden:!1}}}}getDefaultAccountWalletName(e){return`Wallet ${this.getEntropySourceIndex(e.metadata.entropy.id)+1}`}getComputedAccountGroupName(e){for(const t of e.accounts){const e=this.messenger.call("AccountsController:getAccount",t);if(e&&(0,r.isEvmAccountType)(e.type))return e.metadata.name}return""}getDefaultAccountGroupName(e){return`Account ${e+1}`}}n.EntropyRule=o}}},{package:"@metamask/account-tree-controller",file:"node_modules/@metamask/account-tree-controller/dist/rules/entropy.cjs"}],[103,{"./messengers":42,"./types":102,"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initControllers=function({baseControllerMessenger:e,existingControllers:t=[],initFunctions:n,initRequest:s}){a("Initializing controllers",Object.keys(n).length);const i=t.reduce((e,t)=>(e[t.name]=t,e),{}),o={},c={};let l={};const u=e=>function(e,t){const n=e[t];if(!n)throw new Error(`Controller requested before it was initialized: ${t}`);return n}(i,e);for(const[t,d]of Object.entries(n)){const n=t,p=d,h=r.CONTROLLER_MESSENGERS[n],m=null==h?void 0:h.getMessenger,f=null==h?void 0:h.getInitMessenger,g={...s,controllerMessenger:null==m?void 0:m(e),getController:u,initMessenger:null==f?void 0:f(e)},y=p({...g,controllerMessenger:g.controllerMessenger}),{controller:w,persistedStateKey:b,memStateKey:E}=y,v=y.api??{},T=null===b?undefined:b??n,S=null===E?undefined:E??n;i[n]=w,l={...l,...v},T&&(o[T]=w),S&&(c[S]=w),a("Initialized controller",n,{api:Object.keys(v),persistedStateKey:T,memStateKey:S})}return{controllerApi:l,controllerMemState:c,controllerPersistedState:o,controllersByName:i}};var s=e("@metamask/utils"),r=(e("./types"),e("./messengers"));const a=(0,s.createProjectLogger)("controller-init")}}},{package:"$root$",file:"app/scripts/controller-init/utils.ts"}],[1030,{"../rule.cjs":1028,"@metamask/account-api":1024,"@metamask/keyring-controller":1924},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.KeyringRule=n.getAccountWalletNameFromKeyringType=void 0;const s=e("@metamask/account-api"),r=e("@metamask/account-api"),a=e("@metamask/account-api"),i=e("@metamask/keyring-controller"),o=e("../rule.cjs");function c(e){switch(e){case i.KeyringTypes.simple:return"Imported accounts";case i.KeyringTypes.trezor:return"Trezor";case i.KeyringTypes.oneKey:return"OneKey";case i.KeyringTypes.ledger:return"Ledger";case i.KeyringTypes.lattice:return"Lattice";case i.KeyringTypes.qr:return"QR";case i.KeyringTypes.hd:return"HD Wallet";case i.KeyringTypes.snap:return"Snap Wallet";default:return"Unknown"}}n.getAccountWalletNameFromKeyringType=c;class l extends o.BaseRule{constructor(){super(...arguments),this.walletType=r.AccountWalletType.Keyring,this.groupType=s.AccountGroupType.SingleAccount}match(e){const t=e.metadata.keyring.type,n=(0,a.toAccountWalletId)(this.walletType,t),s=(0,a.toAccountGroupId)(n,e.address);return{wallet:{type:this.walletType,id:n,metadata:{keyring:{type:t}}},group:{type:this.groupType,id:s,metadata:{pinned:!1,hidden:!1}}}}getDefaultAccountWalletName(e){return c(e.metadata.keyring.type)}getComputedAccountGroupName(e){return super.getComputedAccountGroupName(e)}getDefaultAccountGroupName(e){return super.getDefaultAccountGroupName(e)}}n.KeyringRule=l}}},{package:"@metamask/account-tree-controller",file:"node_modules/@metamask/account-tree-controller/dist/rules/keyring.cjs"}],[1031,{"../rule.cjs":1028,"@metamask/account-api":1024,"@metamask/keyring-controller":1924,"@metamask/snaps-utils":2516},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SnapRule=void 0;const s=e("@metamask/account-api"),r=e("@metamask/account-api"),a=e("@metamask/keyring-controller"),i=e("@metamask/snaps-utils"),o=e("../rule.cjs");class c extends o.BaseRule{constructor(){super(...arguments),this.walletType=s.AccountWalletType.Snap,this.groupType=s.AccountGroupType.SingleAccount}match(e){if(!function(e){return e.metadata.keyring.type===a.KeyringTypes.snap&&e.metadata.snap!==undefined&&e.metadata.snap.enabled}(e))return undefined;const{id:t}=e.metadata.snap,n=(0,r.toAccountWalletId)(this.walletType,t),s=(0,r.toAccountGroupId)(n,e.address);return{wallet:{type:this.walletType,id:n,metadata:{snap:{id:t}}},group:{type:this.groupType,id:s,metadata:{pinned:!1,hidden:!1}}}}getDefaultAccountWalletName(e){const t=e.metadata.snap.id,n=this.messenger.call("SnapController:get",t);return n?n.manifest.proposedName:(0,i.stripSnapPrefix)(t)}getComputedAccountGroupName(e){return super.getComputedAccountGroupName(e)}getDefaultAccountGroupName(e){return super.getDefaultAccountGroupName(e)}}n.SnapRule=c}}},{package:"@metamask/account-tree-controller",file:"node_modules/@metamask/account-tree-controller/dist/rules/snap.cjs"}],[1032,{"./utils.cjs":1034,"@metamask/base-controller":1140,"@metamask/eth-snap-keyring":1788,"@metamask/keyring-api":1914,"@metamask/keyring-controller":1924,"@metamask/keyring-utils":1955,"@metamask/utils":2632,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,l,u,d,p,h,m,f,g,y,w=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.AccountsController=n.EMPTY_ACCOUNT=void 0;const b=e("@metamask/base-controller"),E=e("@metamask/eth-snap-keyring"),v=e("@metamask/keyring-api"),T=e("@metamask/keyring-controller"),S=e("@metamask/keyring-utils"),A=e("@metamask/utils"),k=e("lodash"),_=e("./utils.cjs"),M="AccountsController",C={internalAccounts:{persist:!0,anonymous:!1}},P={internalAccounts:{accounts:{},selectedAccount:""}};n.EMPTY_ACCOUNT={id:"",address:"",options:{},methods:[],type:v.EthAccountType.Eoa,scopes:[v.EthScope.Eoa],metadata:{name:"",keyring:{type:""},importTime:0}};class I extends b.BaseController{constructor({messenger:e,state:t}){super({messenger:e,name:M,metadata:C,state:{...P,...t}}),s.add(this),w(this,s,"m",g).call(this),w(this,s,"m",y).call(this)}getAccount(e){return this.state.internalAccounts.accounts[e]}listAccounts(){return Object.values(this.state.internalAccounts.accounts).filter(e=>(0,v.isEvmAccountType)(e.type))}listMultichainAccounts(e){const t=Object.values(this.state.internalAccounts.accounts);if(!e)return t;if(!(0,A.isCaipChainId)(e))throw new Error(`Invalid CAIP-2 chain ID: ${String(e)}`);return t.filter(t=>(0,S.isScopeEqualToAny)(e,t.scopes))}getAccountExpect(e){const t=this.getAccount(e);if(t===undefined)throw new Error(`Account Id "${e}" not found`);return t}getSelectedAccount(){const{internalAccounts:{selectedAccount:e}}=this.state;if(""===e)return n.EMPTY_ACCOUNT;const t=this.getAccountExpect(e);if((0,v.isEvmAccountType)(t.type))return t;const r=this.listAccounts();if(!r.length)throw new Error("No EVM accounts");return w(this,s,"m",p).call(this,r)}getSelectedMultichainAccount(e){const{internalAccounts:{selectedAccount:t}}=this.state;if(""===t)return n.EMPTY_ACCOUNT;if(!e)return this.getAccountExpect(t);const r=this.listMultichainAccounts(e);return w(this,s,"m",p).call(this,r)}getAccountByAddress(e){return this.listMultichainAccounts().find(t=>t.address.toLowerCase()===e.toLowerCase())}setSelectedAccount(e){const t=this.getAccountExpect(e);this.state.internalAccounts.selectedAccount!==t.id&&w(this,s,"m",l).call(this,e=>{const{internalAccounts:n}=e;n.accounts[t.id].metadata.lastSelected=Date.now(),n.selectedAccount=t.id})}setAccountName(e,t){this.updateAccountMetadata(e,{name:t,nameLastUpdatedAt:Date.now()})}setAccountNameAndSelectAccount(e,t){const n=this.getAccountExpect(e);w(this,s,"m",r).call(this,n,t);const a={...n,metadata:{...n.metadata,name:t,nameLastUpdatedAt:Date.now(),lastSelected:w(this,s,"m",h).call(this)}};w(this,s,"m",l).call(this,e=>{e.internalAccounts.accounts[n.id]=a,e.internalAccounts.selectedAccount=n.id}),this.messagingSystem.publish("AccountsController:accountRenamed",a)}updateAccountMetadata(e,t){const n=this.getAccountExpect(e);t.name&&w(this,s,"m",r).call(this,n,t.name);const a={...n,metadata:{...n.metadata,...t}};w(this,s,"m",l).call(this,t=>{t.internalAccounts.accounts[e]=a}),t.name&&this.messagingSystem.publish("AccountsController:accountRenamed",a)}async updateAccounts(){const e=new Map,t=this.state.internalAccounts.accounts,n={},{keyrings:r}=this.messagingSystem.call("KeyringController:getState");for(const a of r){const r=(0,_.keyringTypeToName)(a.type);for(const i of a.accounts){const o=w(this,s,"m",m).call(this,i,a);if(!o)continue;const c=e.get(r)??1,l=t[o.id];n[o.id]={...o,metadata:{...o.metadata,name:l?.metadata.name??`${r} ${c}`,importTime:l?.metadata.importTime??Date.now(),lastSelected:l?.metadata.lastSelected??0}},e.set(r,c+1)}}w(this,s,"m",l).call(this,e=>{e.internalAccounts.accounts=n})}loadBackup(e){e.internalAccounts&&this.update(t=>{t.internalAccounts=e.internalAccounts})}getNextAvailableAccountName(e=T.KeyringTypes.hd,t){const n=(0,_.keyringTypeToName)(e),r=w(this,s,"m",d).call(this,e,t),a=r.reduce((e,t)=>{const s=new RegExp(`${n} ([0-9]+)$`,"u").exec(t.metadata.name);if(s){const t=parseInt(s[1],10);return Math.max(e,t)}return e},0),i=Math.max(r.length+1,a+1);return`${n} ${i}`}}n.AccountsController=I,s=new WeakSet,r=function(e,t){if(this.listMultichainAccounts().find(n=>n.metadata.name===t&&n.id!==e.id))throw new Error("Account name already exists")},a=function(e,t){const n=(0,_.getUUIDFromAddressOfNormalAccount)(e),s=this.getAccount(n),r={name:s?.metadata.name??"",...s?.metadata.nameLastUpdatedAt?{nameLastUpdatedAt:s?.metadata.nameLastUpdatedAt}:{},importTime:s?.metadata.importTime??Date.now(),lastSelected:s?.metadata.lastSelected??0,keyring:{type:t.type}};let a={};if((0,_.isHdKeyringType)(t.type)){const n=(0,_.getEvmGroupIndexFromAddressIndex)(t,e);if(n!==undefined){const e=(0,_.getEvmDerivationPathForIndex)(n);a={...{entropySource:t.metadata.id,derivationPath:e,groupIndex:n},...{entropy:{type:v.KeyringAccountEntropyTypeOption.Mnemonic,id:t.metadata.id,derivationPath:e,groupIndex:n}}}}}return{id:n,address:e,options:a,methods:[v.EthMethod.PersonalSign,v.EthMethod.Sign,v.EthMethod.SignTransaction,v.EthMethod.SignTypedDataV1,v.EthMethod.SignTypedDataV3,v.EthMethod.SignTypedDataV4],scopes:[v.EthScope.Eoa],type:v.EthAccountType.Eoa,metadata:r}},i=function(){const[e]=this.messagingSystem.call("KeyringController:getKeyringsByType",E.SnapKeyring.type);return e},o=function(e,...t){this.messagingSystem.publish(e,...t)},c=function({isUnlocked:e,keyrings:t}){if(!e||0===t.length)return;const n={snap:{previous:{},added:[],updated:[],removed:[]},normal:{previous:{},added:[],updated:[],removed:[]}},r=e=>(0,_.isSnapKeyringType)(e)?n.snap:n.normal;for(const e of this.listMultichainAccounts()){const t=e.address.toLowerCase();r(e.metadata.keyring.type).previous[t]=e}const a=new Set;for(const e of t){const t=r(e.type);for(const n of e.accounts){const s=n.toLowerCase(),r=t.previous[s];r?t.updated.push(r):t.added.push({address:s,keyring:e}),a.add(s)}}for(const e of[n.snap,n.normal])for(const[t,n]of Object.entries(e.previous))a.has(t)||e.removed.push(n);const i={removed:[],added:[]};w(this,s,"m",l).call(this,e=>{const{internalAccounts:t}=e;for(const e of[n.snap,n.normal]){for(const n of e.removed)delete t.accounts[n.id],i.removed.push(n.id);for(const n of e.added){const e=w(this,s,"m",m).call(this,n.address,n.keyring);if(e){const n=Object.values(t.accounts),r=this.getNextAvailableAccountName(e.metadata.keyring.type,n),a=0===n.length?w(this,s,"m",h).call(this):0;t.accounts[e.id]={...e,metadata:{...e.metadata,name:r,importTime:Date.now(),lastSelected:a}},i.added.push(t.accounts[e.id])}}}});for(const e of i.removed)this.messagingSystem.publish("AccountsController:accountRemoved",e);for(const e of i.added)this.messagingSystem.publish("AccountsController:accountAdded",e)},l=function(e){const t=this.state.internalAccounts.selectedAccount;this.update(n=>{e(n);const{internalAccounts:r}=n;if(!r.accounts[t]){const e=Object.values(r.accounts),t=w(this,s,"m",p).call(this,e);t?(r.selectedAccount=t.id,r.accounts[t.id].metadata.lastSelected=w(this,s,"m",h).call(this)):r.selectedAccount=""}});const{selectedAccount:n}=this.state.internalAccounts;if(n&&n!==t){const e=this.getSelectedMultichainAccount();e&&((0,v.isEvmAccountType)(e.type)&&this.messagingSystem.publish("AccountsController:selectedEvmAccountChange",e),this.messagingSystem.publish("AccountsController:selectedAccountChange",e))}},u=function(e){const{snaps:t}=e,n=[];for(const e of this.listMultichainAccounts())if(e.metadata.snap){const s=t[e.metadata.snap.id];if(s){const t=s.enabled&&!s.blocked;e.metadata.snap.enabled!==t&&n.push({id:e.id,enabled:t})}else n.push({id:e.id,enabled:!1})}n.length>0&&this.update(e=>{for(const{id:t,enabled:s}of n){const n=e.internalAccounts.accounts[t];n.metadata.snap&&(n.metadata.snap.enabled=s)}})},d=function(e,t){return(t??this.listMultichainAccounts()).filter(t=>(0,_.isHdKeyringType)(e)||(0,_.isSimpleKeyringType)(e)?(0,_.isHdKeyringType)(t.metadata.keyring.type)||(0,_.isSimpleKeyringType)(t.metadata.keyring.type):t.metadata.keyring.type===e)},p=function(e){const[t]=e.sort((e,t)=>(t.metadata.lastSelected??0)-(e.metadata.lastSelected??0));return t},h=function(){return Date.now()},m=function(e,t){if((0,_.isSnapKeyringType)(t.type)){const t=w(this,s,"m",i).call(this);if(!t)return undefined;let n=t.getAccountByAddress(e);if(n&&(n=(0,k.cloneDeep)(n),(0,_.isHdSnapKeyringAccount)(n))){const e={...n.options,entropy:{type:v.KeyringAccountEntropyTypeOption.Mnemonic,id:n.options.entropySource,groupIndex:n.options.index,derivationPath:n.options.derivationPath}};n.options=e}return n}return w(this,s,"m",a).call(this,e,t)},f=function(e){let t;if((0,A.isCaipChainId)(e)){const n=this.getSelectedMultichainAccount(e);t=n.id}else{const e=this.getSelectedAccount();t=e.id}this.state.internalAccounts.selectedAccount!==t&&this.update(e=>{e.internalAccounts.accounts[t].metadata.lastSelected=Date.now(),e.internalAccounts.selectedAccount=t})},g=function(){this.messagingSystem.subscribe("SnapController:stateChange",e=>w(this,s,"m",u).call(this,e)),this.messagingSystem.subscribe("KeyringController:stateChange",e=>w(this,s,"m",c).call(this,e)),this.messagingSystem.subscribe("SnapKeyring:accountAssetListUpdated",e=>w(this,s,"m",o).call(this,"AccountsController:accountAssetListUpdated",e)),this.messagingSystem.subscribe("SnapKeyring:accountBalancesUpdated",e=>w(this,s,"m",o).call(this,"AccountsController:accountBalancesUpdated",e)),this.messagingSystem.subscribe("SnapKeyring:accountTransactionsUpdated",e=>w(this,s,"m",o).call(this,"AccountsController:accountTransactionsUpdated",e)),this.messagingSystem.subscribe("MultichainNetworkController:networkDidChange",e=>w(this,s,"m",f).call(this,e))},y=function(){this.messagingSystem.registerActionHandler(`${M}:setSelectedAccount`,this.setSelectedAccount.bind(this)),this.messagingSystem.registerActionHandler(`${M}:listAccounts`,this.listAccounts.bind(this)),this.messagingSystem.registerActionHandler(`${M}:listMultichainAccounts`,this.listMultichainAccounts.bind(this)),this.messagingSystem.registerActionHandler(`${M}:setAccountName`,this.setAccountName.bind(this)),this.messagingSystem.registerActionHandler(`${M}:setAccountNameAndSelectAccount`,this.setAccountNameAndSelectAccount.bind(this)),this.messagingSystem.registerActionHandler(`${M}:updateAccounts`,this.updateAccounts.bind(this)),this.messagingSystem.registerActionHandler(`${M}:getSelectedAccount`,this.getSelectedAccount.bind(this)),this.messagingSystem.registerActionHandler(`${M}:getSelectedMultichainAccount`,this.getSelectedMultichainAccount.bind(this)),this.messagingSystem.registerActionHandler(`${M}:getAccountByAddress`,this.getAccountByAddress.bind(this)),this.messagingSystem.registerActionHandler(`${M}:getNextAvailableAccountName`,this.getNextAvailableAccountName.bind(this)),this.messagingSystem.registerActionHandler("AccountsController:getAccount",this.getAccount.bind(this)),this.messagingSystem.registerActionHandler("AccountsController:updateAccountMetadata",this.updateAccountMetadata.bind(this))}}}},{package:"@metamask/accounts-controller",file:"node_modules/@metamask/accounts-controller/dist/AccountsController.cjs"}],[1033,{"./AccountsController.cjs":1032,"./utils.cjs":1034},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isNormalKeyringType=n.getUUIDFromAddressOfNormalAccount=n.getUUIDOptionsFromAddressOfNormalAccount=n.keyringTypeToName=n.AccountsController=n.EMPTY_ACCOUNT=void 0;var s=e("./AccountsController.cjs");Object.defineProperty(n,"EMPTY_ACCOUNT",{enumerable:!0,get:function(){return s.EMPTY_ACCOUNT}}),Object.defineProperty(n,"AccountsController",{enumerable:!0,get:function(){return s.AccountsController}});var r=e("./utils.cjs");Object.defineProperty(n,"keyringTypeToName",{enumerable:!0,get:function(){return r.keyringTypeToName}}),Object.defineProperty(n,"getUUIDOptionsFromAddressOfNormalAccount",{enumerable:!0,get:function(){return r.getUUIDOptionsFromAddressOfNormalAccount}}),Object.defineProperty(n,"getUUIDFromAddressOfNormalAccount",{enumerable:!0,get:function(){return r.getUUIDFromAddressOfNormalAccount}}),Object.defineProperty(n,"isNormalKeyringType",{enumerable:!0,get:function(){return r.isNormalKeyringType}})}}},{package:"@metamask/accounts-controller",file:"node_modules/@metamask/accounts-controller/dist/index.cjs"}],[1034,{"@metamask/keyring-controller":1924,"@metamask/superstruct":2538,"@metamask/utils":2632,"ethereum-cryptography/sha256":3840,uuid:5195},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isHdSnapKeyringAccount=n.HdSnapKeyringAccountOptionsStruct=n.getEvmGroupIndexFromAddressIndex=n.getEvmDerivationPathForIndex=n.isHdKeyringType=n.isSimpleKeyringType=n.isSnapKeyringType=n.isNormalKeyringType=n.getUUIDFromAddressOfNormalAccount=n.getUUIDOptionsFromAddressOfNormalAccount=n.keyringTypeToName=void 0;const s=e("@metamask/keyring-controller"),r=e("@metamask/superstruct"),a=e("@metamask/utils"),i=e("ethereum-cryptography/sha256"),o=e("uuid");function c(e){return{random:(0,i.sha256)((0,a.hexToBytes)(e)).slice(0,16)}}function l(e){return e===s.KeyringTypes.hd}n.keyringTypeToName=function(e){switch(e){case s.KeyringTypes.simple:case s.KeyringTypes.hd:return"Account";case s.KeyringTypes.trezor:return"Trezor";case s.KeyringTypes.oneKey:return"OneKey";case s.KeyringTypes.ledger:return"Ledger";case s.KeyringTypes.lattice:return"Lattice";case s.KeyringTypes.qr:return"QR";case s.KeyringTypes.snap:return"Snap Account";default:throw new Error(`Unknown keyring ${e}`)}},n.getUUIDOptionsFromAddressOfNormalAccount=c,n.getUUIDFromAddressOfNormalAccount=function(e){return(0,o.v4)(c(e))},n.isNormalKeyringType=function(e){return e!==s.KeyringTypes.snap},n.isSnapKeyringType=function(e){return e===s.KeyringTypes.snap},n.isSimpleKeyringType=function(e){return e===s.KeyringTypes.simple},n.isHdKeyringType=l,n.getEvmDerivationPathForIndex=function(e){return`m/44'/60'/0'/0/${e}`},n.getEvmGroupIndexFromAddressIndex=function(e,t){if(!l(e.type))return undefined;const n=e.accounts.findIndex(e=>e.toLowerCase()===t.toLowerCase());return-1===n?(console.warn(`! Unable to get group index for HD account: "${t}"`),undefined):n},n.HdSnapKeyringAccountOptionsStruct=(0,r.type)({entropySource:(0,r.string)(),index:(0,r.number)(),derivationPath:(0,r.string)()}),n.isHdSnapKeyringAccount=function(e){return(0,r.is)(e.options,n.HdSnapKeyringAccountOptionsStruct)}}}},{package:"@metamask/accounts-controller",file:"node_modules/@metamask/accounts-controller/dist/utils.cjs"}],[1035,{"@metamask/base-controller":1140,"@metamask/controller-utils":1224},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.AddressBookController=n.getDefaultAddressBookControllerState=n.controllerName=n.AddressType=void 0;const i=e("@metamask/base-controller"),o=e("@metamask/controller-utils");var c;!function(e){e.externallyOwnedAccounts="EXTERNALLY_OWNED_ACCOUNTS",e.contractAccounts="CONTRACT_ACCOUNTS",e.nonAccounts="NON_ACCOUNTS"}(c||(n.AddressType=c={})),n.controllerName="AddressBookController";const l={addressBook:{persist:!0,anonymous:!1}};n.getDefaultAddressBookControllerState=()=>({addressBook:{}});class u extends i.BaseController{constructor({messenger:e,state:t}){const i={...(0,n.getDefaultAddressBookControllerState)(),...t};super({messenger:e,metadata:l,name:n.controllerName,state:i}),s.add(this),a(this,s,"m",r).call(this)}list(){const{addressBook:e}=this.state;return Object.keys(e).reduce((t,n)=>{const s=n;return[...t,...Object.values(e[s])]},[])}clear(){this.update(e=>{e.addressBook={}})}delete(e,t){if(t=(0,o.toChecksumHexAddress)(t),!([e,t].every(e=>(0,o.isSafeDynamicKey)(e))&&(0,o.isValidHexAddress)(t)&&this.state.addressBook[e]&&this.state.addressBook[e][t]))return!1;const n={...this.state.addressBook[e][t]};return this.update(n=>{const s=n.addressBook[e];s?.[t]&&(delete s[t],0===Object.keys(s).length&&delete n.addressBook[e])}),"*"!==String(e)&&this.messagingSystem.publish("AddressBookController:contactDeleted",n),!0}set(e,t,n=(0,o.toHex)(1),s="",r){if(e=(0,o.toChecksumHexAddress)(e),!(0,o.isValidHexAddress)(e))return!1;const a={address:e,chainId:n,isEns:!1,memo:s,name:t,addressType:r,lastUpdatedAt:Date.now()},i=(0,o.normalizeEnsName)(t);return i&&(a.name=i,a.isEns=!0),this.update(t=>{t.addressBook={...this.state.addressBook,[n]:{...this.state.addressBook[n],[e]:a}}}),"*"!==String(n)&&this.messagingSystem.publish("AddressBookController:contactUpdated",a),!0}}n.AddressBookController=u,s=new WeakSet,r=function(){this.messagingSystem.registerActionHandler(`${n.controllerName}:list`,this.list.bind(this)),this.messagingSystem.registerActionHandler(`${n.controllerName}:set`,this.set.bind(this)),this.messagingSystem.registerActionHandler(`${n.controllerName}:delete`,this.delete.bind(this))},n.default=u}}},{package:"@metamask/address-book-controller",file:"node_modules/@metamask/address-book-controller/dist/AddressBookController.cjs"}],[1036,{"./AddressBookController.cjs":1035},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AddressBookController=n.getDefaultAddressBookControllerState=void 0;var s=e("./AddressBookController.cjs");Object.defineProperty(n,"getDefaultAddressBookControllerState",{enumerable:!0,get:function(){return s.getDefaultAddressBookControllerState}}),Object.defineProperty(n,"AddressBookController",{enumerable:!0,get:function(){return s.AddressBookController}})}}},{package:"@metamask/address-book-controller",file:"node_modules/@metamask/address-book-controller/dist/index.cjs"}],[1037,{"@metamask/base-controller":1140},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.AnnouncementController=void 0;const i=e("@metamask/base-controller"),o={announcements:{}},c={announcements:{persist:!0,anonymous:!0}};class l extends i.BaseController{constructor({messenger:e,state:t,allAnnouncements:n}){const i={...o,...t};super({messenger:e,metadata:c,name:"AnnouncementController",state:i}),s.add(this),a(this,s,"m",r).call(this,n)}resetViewed(){this.update(({announcements:e})=>{for(const t of Object.values(e))t.isShown=!1})}updateViewed(e){this.update(({announcements:t})=>{for(const n of Object.keys(e).map(Number))t[n].isShown=e[n]})}}n.AnnouncementController=l,s=new WeakSet,r=function(e){this.update(t=>{Object.values(e).forEach(e=>{t.announcements[e.id]=t.announcements[e.id]??{...e,isShown:!1}})})}}}},{package:"@metamask/announcement-controller",file:"node_modules/@metamask/announcement-controller/dist/AnnouncementController.cjs"}],[1038,{"./AnnouncementController.cjs":1037},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AnnouncementController=void 0;var s=e("./AnnouncementController.cjs");Object.defineProperty(n,"AnnouncementController",{enumerable:!0,get:function(){return s.AnnouncementController}})}}},{package:"@metamask/announcement-controller",file:"node_modules/@metamask/announcement-controller/dist/index.cjs"}],[104,{"@metamask/base-controller":1140},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AccountOrderController=void 0;var s=e("@metamask/base-controller");const r={pinnedAccountList:[],hiddenAccountList:[]},a={pinnedAccountList:{persist:!0,anonymous:!0},hiddenAccountList:{persist:!0,anonymous:!0}};class i extends s.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:a,name:"AccountOrderController",state:{...r,...t}})}updateAccountsList(e){this.update(t=>(t.pinnedAccountList=e,t))}updateHiddenAccountsList(e){this.update(t=>(t.hiddenAccountList=e,t))}}n.AccountOrderController=i}}},{package:"$root$",file:"app/scripts/controllers/account-order.ts"}],[105,{"../../../shared/constants/network":5262,"../constants/contracts":5,"../lib/util":237,"@ethersproject/contracts":595,"@ethersproject/providers":633,"@metamask/base-controller":1140,"@metamask/controller-utils":1224,"@metamask/utils":2632,lodash:4362,loglevel:4370,"single-call-balance-checker-abi":5113,uuid:5195},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultAccountTrackerControllerState=n.default=void 0;var s=e("uuid"),r=f(e("loglevel")),a=e("@ethersproject/providers"),i=e("@ethersproject/contracts"),o=f(e("single-call-balance-checker-abi")),c=e("lodash"),l=e("@metamask/utils"),u=e("@metamask/base-controller"),d=e("@metamask/controller-utils"),p=e("../../../shared/constants/network"),h=e("../constants/contracts"),m=e("../lib/util");function f(e){return e&&e.__esModule?e:{default:e}}function g(e,t,n){y(e,t),t.set(e,n)}function y(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w(e,t){return e.get(E(e,t))}function b(e,t,n){return e.set(E(e,t),n),n}function E(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const v="AccountTrackerController",T={accounts:{persist:!0,anonymous:!1},currentBlockGasLimit:{persist:!0,anonymous:!0},accountsByChainId:{persist:!0,anonymous:!1},currentBlockGasLimitByChainId:{persist:!0,anonymous:!0}},S=()=>({accounts:{},currentBlockGasLimit:"",accountsByChainId:{},currentBlockGasLimitByChainId:{}});n.getDefaultAccountTrackerControllerState=S;var A=new WeakMap,k=new WeakMap,_=new WeakMap,M=new WeakMap,C=new WeakMap,P=new WeakMap,I=new WeakMap,N=new WeakSet,O=new WeakMap;class D extends u.BaseController{constructor(e){var t,n;super({name:v,metadata:T,state:{accounts:{},currentBlockGasLimit:"",accountsByChainId:{},currentBlockGasLimitByChainId:{},...e.state},messenger:e.messenger}),y(t=this,n=N),n.add(t),g(this,A,new Map),g(this,k,{}),g(this,_,void 0),g(this,M,void 0),g(this,C,{}),g(this,P,void 0),g(this,I,void 0),g(this,O,async e=>{await E(N,this,U).call(this,undefined,e)}),b(_,this,e.provider),b(M,this,e.blockTracker),b(P,this,e.getNetworkIdentifier),this.messagingSystem.subscribe("KeyringController:accountRemoved",e=>this.removeAccounts([e]));const s=this.messagingSystem.call("OnboardingController:getState");this.messagingSystem.subscribe("OnboardingController:stateChange",(0,m.previousValueComparator)((e,t)=>{const{completedOnboarding:n}=e,{completedOnboarding:s}=t;return!n&&s&&this.updateAccountsAllActiveNetworks(),!0},s)),b(I,this,this.messagingSystem.call("AccountsController:getSelectedAccount")),this.messagingSystem.subscribe("AccountsController:selectedEvmAccountChange",e=>{const{useMultiAccountBalanceChecker:t}=this.messagingSystem.call("PreferencesController:getState");w(I,this).id===e.id||t||(b(I,this,e),this.updateAccountsAllActiveNetworks())}),this._registerMessageHandlers()}resetState(){const{accounts:e,accountsByChainId:t,currentBlockGasLimit:n,currentBlockGasLimitByChainId:s}={accounts:{},currentBlockGasLimit:"",accountsByChainId:{},currentBlockGasLimitByChainId:{}};this.update(r=>{r.accounts=e,r.accountsByChainId=t,r.currentBlockGasLimit=n,r.currentBlockGasLimitByChainId=s})}start(){b(C,this,{[E(N,this,j).call(this)]:w(M,this).getCurrentBlock()}),w(M,this).once("latest",e=>{w(C,this)[E(N,this,j).call(this)]=e}),w(M,this).removeListener("latest",w(O,this)),w(M,this).addListener("latest",w(O,this)),this.updateAccounts()}stop(){w(M,this).removeListener("latest",w(O,this))}startPollingByNetworkClientId(e){const t=(0,s.v4)(),n=w(A,this).get(e);if(n)n.add(t);else{const n=new Set;n.add(t),w(A,this).set(e,n),E(N,this,L).call(this,e)}return t}stopAllPolling(){this.stop(),w(A,this).forEach((e,t)=>{e.forEach(e=>{this.stopPollingByPollingToken(e)})})}stopPollingByPollingToken(e){if(!e)throw new Error("pollingToken required");w(A,this).forEach((t,n)=>{t.has(e)&&(t.delete(e),0===t.size&&(w(A,this).delete(n),E(N,this,B).call(this,n)))})}syncWithAddresses(e){const{accounts:t}=this.state,n=Object.keys(t),s=[];e.forEach(e=>{n.includes(e)||s.push(e)});const r=[];n.forEach(t=>{e.includes(t)||r.push(t)}),this.addAccounts(s),this.removeAccounts(r)}addAccounts(e){const{accounts:t,accountsByChainId:n}=this.state,s=(0,c.cloneDeep)(t),r=(0,c.cloneDeep)(n);e.forEach(e=>{s[e]={}}),Object.keys(r).forEach(t=>{e.forEach(e=>{r[t][e]={}})}),this.update(e=>{e.accounts=s,e.accountsByChainId=r}),w(C,this)[E(N,this,j).call(this)]&&this.updateAccounts(),w(A,this).forEach((e,t)=>{const{chainId:n}=E(N,this,R).call(this,t);w(C,this)[n]&&this.updateAccounts(t)})}removeAccounts(e){const{accounts:t,accountsByChainId:n}=this.state,s=(0,c.cloneDeep)(t),r=(0,c.cloneDeep)(n);e.forEach(e=>{delete s[e]}),Object.keys(r).forEach(t=>{e.forEach(e=>{delete r[t][e]})}),this.update(e=>{e.accounts=s,e.accountsByChainId=r})}clearAccounts(){this.update(e=>{e.accounts={},e.accountsByChainId={[E(N,this,j).call(this)]:{}}})}async updateAccountsAllActiveNetworks(){await this.updateAccounts(),await Promise.all(Array.from(w(A,this)).map(([e])=>this.updateAccounts(e)))}async updateAccounts(e){const{completedOnboarding:t}=this.messagingSystem.call("OnboardingController:getState");if(!t)return;const{chainId:n,provider:s,identifier:r}=E(N,this,R).call(this,e),{useMultiAccountBalanceChecker:a}=this.messagingSystem.call("PreferencesController:getState");let i=[];if(a){const{accounts:e}=this.state;i=Object.keys(e)}else{i=[this.messagingSystem.call("AccountsController:getSelectedAccount").address]}r!==p.LOCALHOST_RPC_URL&&"http://127.0.0.1:8545"!==r&&n in h.SINGLE_CALL_BALANCES_ADDRESSES?await E(N,this,G).call(this,i,h.SINGLE_CALL_BALANCES_ADDRESSES[n],s,n):await Promise.all(i.map(e=>E(N,this,F).call(this,e,s,n)))}async updateAccountByAddress({address:e,networkClientId:t}={}){const{completedOnboarding:n}=this.messagingSystem.call("OnboardingController:getState");if(!n)return;const s=e||this.messagingSystem.call("AccountsController:getSelectedAccount").address;if(!s)return;const{chainId:r,provider:a}=E(N,this,R).call(this,t);await E(N,this,F).call(this,s,a,r)}updateNativeBalances(e){this.update(t=>{e.forEach(({address:e,chainId:n,balance:s})=>{t.accountsByChainId[n]||(t.accountsByChainId[n]={}),t.accountsByChainId[n][e]||(t.accountsByChainId[n][e]={address:e,balance:"0x0"}),s&&(t.accountsByChainId[n][e].balance=(0,d.toHex)(s))})})}updateStakedBalances(e){this.update(t=>{e.forEach(({address:e,chainId:n,stakedBalance:s})=>{t.accountsByChainId[n]||(t.accountsByChainId[n]={}),t.accountsByChainId[n][e]||(t.accountsByChainId[n][e]={address:e,balance:"0x0"}),s&&(t.accountsByChainId[n][e].stakedBalance=(0,d.toHex)(s))})})}_registerMessageHandlers(){this.messagingSystem.registerActionHandler(`${v}:updateNativeBalances`,this.updateNativeBalances.bind(this)),this.messagingSystem.registerActionHandler(`${v}:updateStakedBalances`,this.updateStakedBalances.bind(this))}}function j(){const{selectedNetworkClientId:e}=this.messagingSystem.call("NetworkController:getState"),{configuration:{chainId:t}}=this.messagingSystem.call("NetworkController:getNetworkClientById",e);return t}function R(e){if(e){const{configuration:t,provider:n,blockTracker:s}=this.messagingSystem.call("NetworkController:getNetworkClientById",e);return{chainId:t.chainId,provider:n,blockTracker:s,identifier:w(P,this).call(this,t)}}return{chainId:E(N,this,j).call(this),provider:w(_,this),blockTracker:w(M,this),identifier:w(P,this).call(this)}}function L(e){if(w(k,this)[e])return;const{blockTracker:t}=E(N,this,R).call(this,e),n=t=>E(N,this,U).call(this,e,t);t.addListener("latest",n),w(k,this)[e]=n,this.updateAccounts(e)}function B(e){if(!w(k,this)[e])return;const{blockTracker:t}=E(N,this,R).call(this,e);t.removeListener("latest",w(k,this)[e]),delete w(k,this)[e]}function x(e){const{accounts:t,accountsByChainId:n}=this.state;if(n[e])return(0,c.cloneDeep)(n[e]);const s={};return Object.keys(t).forEach(e=>{s[e]={}}),s}async function U(e,t){const{chainId:n,provider:s}=E(N,this,R).call(this,e);w(C,this)[n]=t;const a=await s.request({method:"eth_getBlockByNumber",params:[t,!1]});if(!a)return;const i=a.gasLimit;this.update(e=>{n===E(N,this,j).call(this)&&(e.currentBlockGasLimit=i),e.currentBlockGasLimitByChainId[n]=i});try{await this.updateAccounts(e)}catch(e){r.default.error(e)}}async function F(e,t,n){const{useMultiAccountBalanceChecker:s}=this.messagingSystem.call("PreferencesController:getState");let r="0x0";try{r=await t.request({method:"eth_getBalance",params:[e,"latest"]})}catch(e){if(e&&"object"==typeof e&&(0,l.hasProperty)(e,"data")&&e.data&&(0,l.hasProperty)(e.data,"request")&&e.data.request&&(0,l.hasProperty)(e.data.request,"method")&&"eth_getBalance"!==e.data.request.method)throw e}const a={address:e,balance:r},i=E(N,this,x).call(this,n);if(!i[e])return;let o=i;s||(o={},Object.keys(i).forEach(t=>{e!==t&&(o[t]={address:t,balance:null})})),o[e]=a,this.update(e=>{n===E(N,this,j).call(this)&&(e.accounts=o),e.accountsByChainId[n]=o})}async function G(e,t,n,s){const c=await new i.Contract(t,o.default,new a.Web3Provider(n)),l=["0x0000000000000000000000000000000000000000"];try{const t=await c.balances(e,l),n=E(N,this,x).call(this,s),r={};Object.keys(n).forEach(t=>{e.includes(t)||(r[t]={address:t,balance:null})}),e.forEach((e,n)=>{const s=t[n]?t[n].toHexString():"0x0";r[e]={address:e,balance:s}}),this.update(e=>{s===E(N,this,j).call(this)&&(e.accounts=r),e.accountsByChainId[s]=r})}catch(t){r.default.warn("MetaMask - Account Tracker single call balance fetch failed",t),Promise.allSettled(e.map(e=>E(N,this,F).call(this,e,n,s)))}}n.default=D}}},{package:"$root$",file:"app/scripts/controllers/account-tracker-controller.ts"}],[106,{"../../../shared/constants/alerts":5242,"@metamask/base-controller":1140},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultAlertControllerState=n.AlertController=void 0;var s=e("@metamask/base-controller"),r=e("../../../shared/constants/alerts");function a(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i(e,t,n){return e.set(o(e,t),n),n}function o(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const c=()=>({alertEnabledness:r.TOGGLEABLE_ALERT_TYPES.reduce((e,t)=>(e[t]=!0,e),{}),unconnectedAccountAlertShownOrigins:{},web3ShimUsageOrigins:{}});n.getDefaultAlertControllerState=c;const l={alertEnabledness:{persist:!0,anonymous:!0},unconnectedAccountAlertShownOrigins:{persist:!0,anonymous:!1},web3ShimUsageOrigins:{persist:!0,anonymous:!1}};var u=new WeakMap,d=new WeakSet;class p extends s.BaseController{constructor(e){var t,n;super({messenger:e.messenger,metadata:l,name:"AlertController",state:{...c(),...e.state}}),a(t=this,n=d),n.add(t),function(e,t,n){a(e,t),t.set(e,n)}(this,u,void 0),i(u,this,this.messagingSystem.call("AccountsController:getSelectedAccount").address),this.messagingSystem.subscribe("AccountsController:selectedAccountChange",e=>{this.state.unconnectedAccountAlertShownOrigins&&function(e,t){return e.get(o(e,t))}(u,this)!==e.address&&(i(u,this,e.address),this.update(e=>{e.unconnectedAccountAlertShownOrigins={}}))})}setAlertEnabledness(e,t){this.update(n=>{n.alertEnabledness[e]=t})}setUnconnectedAccountAlertShown(e){this.update(t=>{t.unconnectedAccountAlertShownOrigins[e]=!0})}getWeb3ShimUsageState(e){var t;return null===(t=this.state.web3ShimUsageOrigins)||void 0===t?void 0:t[e]}setWeb3ShimUsageRecorded(e){o(d,this,h).call(this,e,r.Web3ShimUsageAlertStates.recorded)}setWeb3ShimUsageAlertDismissed(e){o(d,this,h).call(this,e,r.Web3ShimUsageAlertStates.dismissed)}}function h(e,t){this.update(n=>{n.web3ShimUsageOrigins&&(n.web3ShimUsageOrigins[e]=t)})}n.AlertController=p}}},{package:"$root$",file:"app/scripts/controllers/alert-controller.ts"}],[107,{"@metamask/base-controller":1140},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultAppMetadataControllerState=n.default=void 0;var s=e("@metamask/base-controller");function r(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function a(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const i=()=>({currentAppVersion:"",previousAppVersion:"",previousMigrationVersion:0,currentMigrationVersion:0});n.getDefaultAppMetadataControllerState=i;const o={currentAppVersion:{persist:!0,anonymous:!0},previousAppVersion:{persist:!0,anonymous:!0},previousMigrationVersion:{persist:!0,anonymous:!0},currentMigrationVersion:{persist:!0,anonymous:!0}};var c=new WeakSet;class l extends s.BaseController{constructor({state:e={},messenger:t,currentAppVersion:n="",currentMigrationVersion:s=0}){super({name:"AppMetadataController",metadata:o,state:{currentAppVersion:"",previousAppVersion:"",previousMigrationVersion:0,currentMigrationVersion:0,...e},messenger:t}),r(this,c),a(c,this,u).call(this,n),a(c,this,d).call(this,s)}}function u(e){const t=this.state.currentAppVersion;e!==t&&this.update(n=>{n.currentAppVersion=e,n.previousAppVersion=t})}function d(e){const t=this.state.currentMigrationVersion;e!==t&&this.update(n=>{n.previousMigrationVersion=t,n.currentMigrationVersion=e})}n.default=l}}},{package:"$root$",file:"app/scripts/controllers/app-metadata.ts"}],[108,{"../../../shared/constants/alarms":5241,"../../../shared/constants/app":5244,"../../../shared/constants/preferences":5267,"../../../shared/constants/time":5277,"../../../shared/modules/mv3.utils":5363,"../../../ui/helpers/utils/build-types":6484,"@metamask/base-controller":1140,"@metamask/controller-utils":1224,"@metamask/utils":2632,loglevel:4370,uuid:5195},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AppStateController=void 0;var s,r=e("uuid"),a=(s=e("loglevel"))&&s.__esModule?s:{default:s},i=e("@metamask/controller-utils"),o=e("@metamask/base-controller"),c=e("@metamask/utils"),l=e("../../../shared/constants/time"),u=e("../../../shared/constants/alarms"),d=e("../../../shared/modules/mv3.utils"),p=e("../../../ui/helpers/utils/build-types"),h=e("../../../shared/constants/app"),m=e("../../../shared/constants/preferences");function f(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t,n){y(e,t),t.set(e,n)}function y(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w(e,t){return e.get(E(e,t))}function b(e,t,n){return e.set(E(e,t),n),n}function E(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const v={timeoutMinutes:{persist:!0,anonymous:!0},connectedStatusPopoverHasBeenShown:{persist:!0,anonymous:!0},defaultHomeActiveTabName:{persist:!0,anonymous:!0},browserEnvironment:{persist:!0,anonymous:!0},popupGasPollTokens:{persist:!1,anonymous:!0},notificationGasPollTokens:{persist:!1,anonymous:!0},fullScreenGasPollTokens:{persist:!1,anonymous:!0},recoveryPhraseReminderHasBeenShown:{persist:!0,anonymous:!0},recoveryPhraseReminderLastShown:{persist:!0,anonymous:!0},outdatedBrowserWarningLastShown:{persist:!0,anonymous:!0},nftsDetectionNoticeDismissed:{persist:!0,anonymous:!0},showTestnetMessageInDropdown:{persist:!0,anonymous:!0},showBetaHeader:{persist:!0,anonymous:!0},showPermissionsTour:{persist:!0,anonymous:!0},showNetworkBanner:{persist:!0,anonymous:!0},showAccountBanner:{persist:!0,anonymous:!0},productTour:{persist:!0,anonymous:!0},trezorModel:{persist:!0,anonymous:!0},currentPopupId:{persist:!1,anonymous:!0},onboardingDate:{persist:!0,anonymous:!0},lastViewedUserSurvey:{persist:!0,anonymous:!0},isRampCardClosed:{persist:!0,anonymous:!0},newPrivacyPolicyToastClickedOrClosed:{persist:!0,anonymous:!0},newPrivacyPolicyToastShownDate:{persist:!0,anonymous:!0},hadAdvancedGasFeesSetPriorToMigration92_3:{persist:!0,anonymous:!0},activeQrCodeScanRequest:{persist:!1,anonymous:!0},nftsDropdownState:{persist:!1,anonymous:!0},surveyLinkLastClickedOrClosed:{persist:!0,anonymous:!0},signatureSecurityAlertResponses:{persist:!1,anonymous:!0},addressSecurityAlertResponses:{persist:!1,anonymous:!0},currentExtensionPopupId:{persist:!1,anonymous:!0},lastInteractedConfirmationInfo:{persist:!0,anonymous:!0},termsOfUseLastAgreed:{persist:!0,anonymous:!0},snapsInstallPrivacyWarningShown:{persist:!0,anonymous:!0},showDownloadMobileAppSlide:{persist:!0,anonymous:!0},slides:{persist:!0,anonymous:!0},throttledOrigins:{persist:!1,anonymous:!0},isUpdateAvailable:{persist:!1,anonymous:!0},updateModalLastDismissedAt:{persist:!0,anonymous:!0},lastUpdatedAt:{persist:!0,anonymous:!0},enableEnforcedSimulations:{persist:!0,anonymous:!0},enableEnforcedSimulationsForTransactions:{persist:!1,anonymous:!0},enforcedSimulationsSlippage:{persist:!0,anonymous:!0},enforcedSimulationsSlippageForTransactions:{persist:!1,anonymous:!0}};var T=new WeakMap,S=new WeakMap,A=new WeakMap,k=new WeakMap,_=new WeakMap,M=new WeakSet;class C extends o.BaseController{constructor({state:e={},messenger:t,addUnlockListener:n,isUnlocked:s,onInactiveTimeout:r,extension:a}){super({name:"AppStateController",metadata:v,state:{timeoutMinutes:m.DEFAULT_AUTO_LOCK_TIME_LIMIT,connectedStatusPopoverHasBeenShown:!0,defaultHomeActiveTabName:null,browserEnvironment:{},popupGasPollTokens:[],notificationGasPollTokens:[],fullScreenGasPollTokens:[],recoveryPhraseReminderHasBeenShown:!1,recoveryPhraseReminderLastShown:(new Date).getTime(),outdatedBrowserWarningLastShown:null,nftsDetectionNoticeDismissed:!1,showTestnetMessageInDropdown:!0,showBetaHeader:(0,p.isBeta)(),showPermissionsTour:!0,showNetworkBanner:!0,showAccountBanner:!0,productTour:"accountIcon",trezorModel:null,onboardingDate:null,lastViewedUserSurvey:null,isRampCardClosed:!1,newPrivacyPolicyToastClickedOrClosed:null,newPrivacyPolicyToastShownDate:null,hadAdvancedGasFeesSetPriorToMigration92_3:!1,surveyLinkLastClickedOrClosed:null,showDownloadMobileAppSlide:!0,slides:[],throttledOrigins:{},isUpdateAvailable:!1,updateModalLastDismissedAt:null,lastUpdatedAt:null,enableEnforcedSimulations:!0,enableEnforcedSimulationsForTransactions:{},enforcedSimulationsSlippage:10,enforcedSimulationsSlippageForTransactions:{},activeQrCodeScanRequest:null,nftsDropdownState:{},signatureSecurityAlertResponses:{},addressSecurityAlertResponses:{},currentExtensionPopupId:0,...e,nftsDropdownState:{},signatureSecurityAlertResponses:{},addressSecurityAlertResponses:{},currentExtensionPopupId:0},messenger:t}),function(e,t){y(e,t),t.add(e)}(this,M),g(this,T,void 0),g(this,S,void 0),g(this,A,void 0),f(this,"isUnlocked",void 0),f(this,"waitingForUnlock",void 0),g(this,k,void 0),g(this,_,null),f(this,"getAddressSecurityAlertResponse",e=>{const t=this.state.addressSecurityAlertResponses[e.toLowerCase()];if(!t)return undefined;const n=Date.now(),s=15*l.MINUTE;if(n-t.timestamp>s)return this.update(t=>{delete t.addressSecurityAlertResponses[e.toLowerCase()]}),undefined;const{timestamp:r,...a}=t;return a}),f(this,"addAddressSecurityAlertResponse",(e,t)=>{this.update(n=>{n.addressSecurityAlertResponses[e.toLowerCase()]={...t,timestamp:Date.now()}})}),b(T,this,a),b(S,this,r||(()=>undefined)),b(A,this,null),this.isUnlocked=s,this.waitingForUnlock=[],n(E(M,this,I).bind(this)),t.subscribe("PreferencesController:stateChange",({preferences:e})=>{const t=this.state;"number"==typeof(null==e?void 0:e.autoLockTimeLimit)&&t.timeoutMinutes!==e.autoLockTimeLimit&&E(M,this,N).call(this,e.autoLockTimeLimit)});const{preferences:i}=t.call("PreferencesController:getState");"number"==typeof i.autoLockTimeLimit&&E(M,this,N).call(this,i.autoLockTimeLimit),this.messagingSystem.registerActionHandler("AppStateController:requestQrCodeScan",E(M,this,B).bind(this)),b(k,this,null)}getUnlockPromise(e){return new Promise(t=>{this.isUnlocked()?t():E(M,this,P).call(this,t,e)})}setDefaultHomeActiveTabName(e){this.update(t=>{t.defaultHomeActiveTabName=e})}setConnectedStatusPopoverHasBeenShown(){this.update(e=>{e.connectedStatusPopoverHasBeenShown=!0})}setRecoveryPhraseReminderHasBeenShown(){this.update(e=>{e.recoveryPhraseReminderHasBeenShown=!0})}setSurveyLinkLastClickedOrClosed(e){this.update(t=>{t.surveyLinkLastClickedOrClosed=e})}setOnboardingDate(){this.update(e=>{e.onboardingDate=Date.now()})}setLastViewedUserSurvey(e){this.update(t=>{t.lastViewedUserSurvey=e})}setRampCardClosed(){this.update(e=>{e.isRampCardClosed=!0})}setNewPrivacyPolicyToastClickedOrClosed(){this.update(e=>{e.newPrivacyPolicyToastClickedOrClosed=!0})}setNewPrivacyPolicyToastShownDate(e){this.update(t=>{t.newPrivacyPolicyToastShownDate=e})}updateSlides(e){this.update(t=>{const n=t.slides||[],s=e.map(e=>{const t=n.find(t=>t.id===e.id);return t?{...t,...e}:e});t.slides=[...s]})}removeSlide(e){this.update(t=>{const n=t.slides||[];t.slides=n.map(t=>t.id===e?{...t,dismissed:!0}:t),e===h.DOWNLOAD_MOBILE_APP_SLIDE_ID&&(t.showDownloadMobileAppSlide=!1)})}setRecoveryPhraseReminderLastShown(e){this.update(t=>{t.recoveryPhraseReminderLastShown=e})}setTermsOfUseLastAgreed(e){this.update(t=>{t.termsOfUseLastAgreed=e})}setSnapsInstallPrivacyWarningShownStatus(e){this.update(t=>{t.snapsInstallPrivacyWarningShown=e})}setOutdatedBrowserWarningLastShown(e){this.update(t=>{t.outdatedBrowserWarningLastShown=e})}setLastActiveTime(){E(M,this,O).call(this)}setIsUpdateAvailable(e){this.update(t=>{t.isUpdateAvailable=e})}setUpdateModalLastDismissedAt(e){this.update(t=>{t.updateModalLastDismissedAt=e})}setLastUpdatedAt(e){this.update(t=>{t.lastUpdatedAt=e})}setBrowserEnvironment(e,t){this.update(n=>{n.browserEnvironment={os:e,browser:t}})}addPollingToken(e,t){t.toString()!==h.POLLING_TOKEN_ENVIRONMENT_TYPES[h.ENVIRONMENT_TYPE_BACKGROUND]&&E(M,this,j).call(this,t)&&E(M,this,D).call(this,e,t)}removePollingToken(e,t){if(t.toString()!==h.POLLING_TOKEN_ENVIRONMENT_TYPES[h.ENVIRONMENT_TYPE_BACKGROUND]){const n=this.state[t];E(M,this,j).call(this,t)&&this.update(s=>{s[t]=n.filter(t=>t!==e)})}}clearPollingTokens(){this.update(e=>{e.popupGasPollTokens=[],e.notificationGasPollTokens=[],e.fullScreenGasPollTokens=[]})}setShowTestnetMessageInDropdown(e){this.update(t=>{t.showTestnetMessageInDropdown=e})}setShowBetaHeader(e){this.update(t=>{t.showBetaHeader=e})}setShowPermissionsTour(e){this.update(t=>{t.showPermissionsTour=e})}setProductTour(e){this.update(t=>{t.productTour=e})}setShowNetworkBanner(e){this.update(t=>{t.showNetworkBanner=e})}setShowAccountBanner(e){this.update(t=>{t.showAccountBanner=e})}setCurrentExtensionPopupId(e){this.update(t=>{t.currentExtensionPopupId=e})}setTrezorModel(e){this.update(t=>{t.trezorModel=e})}updateNftDropDownState(e){this.update(t=>{t.nftsDropdownState=e})}getSignatureSecurityAlertResponse(e){return this.state.signatureSecurityAlertResponses[e]}addSignatureSecurityAlertResponse(e){e.securityAlertId&&this.update(t=>{t.signatureSecurityAlertResponses[String(e.securityAlertId)]=e})}setCurrentPopupId(e){this.update(t=>{t.currentPopupId=e})}getLastInteractedConfirmationInfo(){return this.state.lastInteractedConfirmationInfo}setLastInteractedConfirmationInfo(e){this.update(t=>{t.lastInteractedConfirmationInfo=e})}getCurrentPopupId(){return this.state.currentPopupId}getThrottledOriginState(e){return this.state.throttledOrigins[e]}updateThrottledOriginState(e,t){this.update(n=>{n.throttledOrigins[e]=t})}completeQrCodeScan(e){if(!w(_,this))throw new Error("No QR code scan is in progress.");this.update(e=>{e.activeQrCodeScanRequest=null}),w(_,this).resolve(e),b(_,this,null)}cancelQrCodeScan(e){if(!w(_,this))throw new Error("No QR code scan is in progress.");this.update(e=>{e.activeQrCodeScanRequest=null}),w(_,this).reject(e||new Error("Scan cancelled")),b(_,this,null)}setEnableEnforcedSimulations(e){this.update(t=>{t.enableEnforcedSimulations=e})}setEnableEnforcedSimulationsForTransaction(e,t){this.update(n=>{n.enableEnforcedSimulationsForTransactions[e]=t})}setEnforcedSimulationsSlippage(e){this.update(t=>{t.enforcedSimulationsSlippage=e})}setEnforcedSimulationsSlippageForTransaction(e,t){this.update(n=>{n.enforcedSimulationsSlippageForTransactions[e]=t})}}function P(e,t){this.waitingForUnlock.push({resolve:e}),this.messagingSystem.publish("AppStateController:unlockChange"),t&&E(M,this,R).call(this)}function I(){if(this.waitingForUnlock.length>0){for(;this.waitingForUnlock.length>0;){var e;null===(e=this.waitingForUnlock.shift())||void 0===e||e.resolve()}this.messagingSystem.publish("AppStateController:unlockChange")}E(M,this,L).call(this)}function N(e){this.update(t=>{t.timeoutMinutes=e}),E(M,this,O).call(this)}function O(){const{timeoutMinutes:e}=this.state;if(w(A,this)?clearTimeout(w(A,this)):d.isManifestV3&&w(T,this).alarms.clear(u.AUTO_LOCK_TIMEOUT_ALARM),!e)return;const t=Number(e);d.isManifestV3?(w(T,this).alarms.create(u.AUTO_LOCK_TIMEOUT_ALARM,{delayInMinutes:t,periodInMinutes:t}),w(T,this).alarms.onAlarm.addListener(e=>{e.name===u.AUTO_LOCK_TIMEOUT_ALARM&&(w(S,this).call(this),w(T,this).alarms.clear(u.AUTO_LOCK_TIMEOUT_ALARM))})):b(A,this,setTimeout(()=>w(S,this).call(this),t*l.MINUTE))}function D(e,t){this.update(n=>{n[t].push(e)})}function j(e){return["popupGasPollTokens","notificationGasPollTokens","fullScreenGasPollTokens"].includes(e)}function R(){w(k,this)||(b(k,this,(0,r.v4)()),this.messagingSystem.call("ApprovalController:addRequest",{id:w(k,this),origin:h.ORIGIN_METAMASK,type:i.ApprovalType.Unlock},!0).catch(()=>{b(k,this,null)}))}function L(){if(w(k,this)){try{this.messagingSystem.call("ApprovalController:acceptRequest",w(k,this))}catch(e){a.default.error("Failed to unlock approval request",e)}b(k,this,null)}}function B(e){if(w(_,this))return w(_,this).promise;const t=(0,c.createDeferredPromise)();return b(_,this,t),this.update(t=>{t.activeQrCodeScanRequest=e}),t.promise}n.AppStateController=C}}},{package:"$root$",file:"app/scripts/controllers/app-state-controller.ts"}],[109,{"../../../shared/constants/metametrics":5259,"../../../shared/modules/hexstring-utils":5360,"@metamask/base-controller":1140,"@metamask/controller-utils":1224,"@metamask/message-manager":1972,"@metamask/utils":2632,buffer:3590,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.managerName=n.isEIP1024EncryptedMessage=n.getDefaultState=n.default=void 0;var s,r=(s=e("loglevel"))&&s.__esModule?s:{default:s},a=e("@metamask/message-manager"),i=e("@metamask/base-controller"),o=e("@metamask/controller-utils"),c=e("@metamask/utils"),l=e("../../../shared/constants/metametrics"),u=e("../../../shared/modules/hexstring-utils");function d(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const p={unapprovedDecryptMsgs:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0},unapprovedDecryptMsgCount:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0}},h=n.managerName="DecryptMessageManager",m=e=>!!((0,c.isObject)(e.data)&&(0,c.hasProperty)(e.data,"version")&&(0,c.hasProperty)(e.data,"nonce")&&(0,c.hasProperty)(e.data,"ephemPublicKey")&&(0,c.hasProperty)(e.data,"ciphertext"));n.isEIP1024EncryptedMessage=m;const f=()=>({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0});n.getDefaultState=f;class g extends i.BaseController{constructor({getState:e,metricsEvent:t,messenger:n,managerMessenger:s}){super({metadata:p,messenger:n,name:"DecryptMessageController",state:{unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0}}),d(this,"_getState",void 0),d(this,"_metricsEvent",void 0),d(this,"_decryptMessageManager",void 0),this._getState=e,this._metricsEvent=t,this._decryptMessageManager=new a.DecryptMessageManager({additionalFinishStatuses:["decrypted"],messenger:s}),n.subscribe(`${h}:unapprovedMessage`,this._requestApproval.bind(this)),this._subscribeToMessageState(n,(e,t,n)=>{e.unapprovedDecryptMsgs=t,e.unapprovedDecryptMsgCount=n})}get unapprovedDecryptMsgCount(){return this._decryptMessageManager.getUnapprovedMessagesCount()}resetState(){this.update(()=>({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0}))}clearUnapproved(){this._decryptMessageManager.clearUnapprovedMessages()}async newRequestDecryptMessage(e,t){return this._decryptMessageManager.addUnapprovedMessageAsync(e,t)}async decryptMessage(e){const t=e.metamaskId;try{const n=await this._decryptMessageManager.approveMessage(e);if(n.data=this._parseMessageData(n.data),!m(n))throw new Error("Invalid encrypted data.");const s=await this.messagingSystem.call("KeyringController:decryptMessage",n);this._decryptMessageManager.setMessageStatusAndResult(t,s,"decrypted"),this._acceptApproval(t)}catch(e){throw r.default.info("MetaMaskController - eth_decrypt failed.",e),this._cancelAbstractMessage(this._decryptMessageManager,t),e}return this._getState()}async decryptMessageInline(e){const t=e.metamaskId;if(e.data=this._parseMessageData(e.data),!m(e))throw new Error("Invalid encrypted data.");const n=await this.messagingSystem.call("KeyringController:decryptMessage",e);return this._decryptMessageManager.setResult(t,n),this._getState()}cancelDecryptMessage(e){return this._decryptMessageManager.rejectMessage(e),this._rejectApproval(e),this._getState()}rejectUnapproved(e){Object.keys(this._decryptMessageManager.getUnapprovedMessages()).forEach(t=>{this._cancelAbstractMessage(this._decryptMessageManager,t,e)})}_acceptApproval(e){this.messagingSystem.call("ApprovalController:acceptRequest",e)}_cancelAbstractMessage(e,t,n){return n&&this._metricsEvent({event:n,category:l.MetaMetricsEventCategory.Messages,properties:{action:"Decrypt Message Request"}}),e.rejectMessage(t),this._rejectApproval(t),this._getState()}_subscribeToMessageState(e,t){e.subscribe(`${h}:stateChange`,e=>{const n=this._migrateMessages(e.unapprovedMessages);this.update(s=>{t(s,n,e.unapprovedMessagesCount)})})}_migrateMessages(e){const t={};for(const n of Object.keys(e)){const s=e[n],r=this._migrateMessage(s);t[n]=r}return t}_migrateMessage(e){const{messageParams:t,...n}=e;return{...n,rawSig:e.rawSig,msgParams:t,origin:t.origin}}_requestApproval(e){const t=e.metamaskId,n=e.origin||o.ORIGIN_METAMASK;try{this.messagingSystem.call("ApprovalController:addRequest",{id:t,origin:n,type:o.ApprovalType.EthDecrypt},!0)}catch(e){r.default.info("Error adding request to approval controller",e)}}_parseMessageData(e){const n=(0,u.stripHexPrefix)(e),s=t.from(n,"hex");return JSON.parse(s.toString("utf8"))}_rejectApproval(e){try{this.messagingSystem.call("ApprovalController:rejectRequest",e,"Cancel")}catch(e){r.default.info("Error rejecting request to approval controller",e)}}}n.default=g}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/controllers/decrypt-message.ts"}],[11,{"@metamask/assets-controllers":1076},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AssetsContractControllerInit=void 0;var s=e("@metamask/assets-controllers");n.AssetsContractControllerInit=({controllerMessenger:e,getGlobalChainId:t})=>({controller:new s.AssetsContractController({messenger:e,chainId:t()}),memStateKey:null})}}},{package:"$root$",file:"app/scripts/controller-init/assets/assets-contract-controller-init.ts"}],[110,{"../../../shared/constants/app":5244,"../../../shared/constants/keyring":5255,"../../../shared/constants/metametrics":5259,"@metamask/base-controller":1140,"@metamask/message-manager":1972,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s,r=(s=e("loglevel"))&&s.__esModule?s:{default:s},a=e("@metamask/message-manager"),i=e("@metamask/base-controller"),o=e("../../../shared/constants/metametrics"),c=e("../../../shared/constants/keyring"),l=e("../../../shared/constants/app");function u(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const d="EncryptionPublicKeyManager",p={unapprovedEncryptionPublicKeyMsgs:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0},unapprovedEncryptionPublicKeyMsgCount:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0}};class h extends i.BaseController{constructor({messenger:e,managerMessenger:t,getEncryptionPublicKey:n,getAccountKeyringType:s,getState:r,metricsEvent:i}){super({name:"EncryptionPublicKeyController",metadata:p,messenger:e,state:{unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0}}),u(this,"_getEncryptionPublicKey",void 0),u(this,"_getAccountKeyringType",void 0),u(this,"_getState",void 0),u(this,"_encryptionPublicKeyManager",void 0),u(this,"_metricsEvent",void 0),this._getEncryptionPublicKey=n,this._getAccountKeyringType=s,this._getState=r,this._metricsEvent=i,this._encryptionPublicKeyManager=new a.EncryptionPublicKeyManager({additionalFinishStatuses:["received"],messenger:t}),this.messagingSystem.subscribe(`${d}:unapprovedMessage`,this._requestApproval.bind(this)),this._subscribeToMessageState(e,(e,t,n)=>{e.unapprovedEncryptionPublicKeyMsgs=t,e.unapprovedEncryptionPublicKeyMsgCount=n})}get unapprovedMsgCount(){return this._encryptionPublicKeyManager.getUnapprovedMessagesCount()}resetState(){this.update(()=>({unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0}))}async newRequestEncryptionPublicKey(e,t){switch(await this._getAccountKeyringType(e)){case c.KeyringType.ledger:return new Promise((e,t)=>{t(new Error("Ledger does not support eth_getEncryptionPublicKey."))});case c.KeyringType.trezor:return new Promise((e,t)=>{t(new Error("Trezor does not support eth_getEncryptionPublicKey."))});case c.KeyringType.lattice:return new Promise((e,t)=>{t(new Error("Lattice does not support eth_getEncryptionPublicKey."))});case c.KeyringType.qr:return Promise.reject(new Error("QR hardware does not support eth_getEncryptionPublicKey."));default:return this._encryptionPublicKeyManager.addUnapprovedMessageAsync({from:e},t)}}async encryptionPublicKey(e){r.default.info("MetaMaskController - encryptionPublicKey");const t=e.metamaskId;try{const n=await this._encryptionPublicKeyManager.approveMessage(e),s=await this._getEncryptionPublicKey(n.from);return this._encryptionPublicKeyManager.setMessageStatusAndResult(t,s,"received"),this._acceptApproval(t),this._getState()}catch(e){throw r.default.info("MetaMaskController - eth_getEncryptionPublicKey failed.",e),this._cancelAbstractMessage(this._encryptionPublicKeyManager,t),e}}cancelEncryptionPublicKey(e){return this._cancelAbstractMessage(this._encryptionPublicKeyManager,e)}rejectUnapproved(e){Object.keys(this._encryptionPublicKeyManager.getUnapprovedMessages()).forEach(t=>{this._cancelAbstractMessage(this._encryptionPublicKeyManager,t,e)})}clearUnapproved(){this._encryptionPublicKeyManager.clearUnapprovedMessages()}_cancelAbstractMessage(e,t,n){return n&&this._metricsEvent({event:n,category:o.MetaMetricsEventCategory.Messages,properties:{action:"Encryption public key Request"}}),e.rejectMessage(t),this._rejectApproval(t),this._getState()}_subscribeToMessageState(e,t){e.subscribe(`${d}:stateChange`,e=>{const n=this._migrateMessages(e.unapprovedMessages);this.update(s=>{t(s,n,e.unapprovedMessagesCount)})})}_migrateMessages(e){const t={};for(const n of Object.keys(e)){const s=e[n],r=this._migrateMessage(s);t[n]=r}return t}_migrateMessage(e){const{messageParams:t,...n}=e;return{...n,rawSig:e.rawSig,msgParams:t.from,origin:t.origin}}_requestApproval(e){const t=e.metamaskId,n=e.origin||l.ORIGIN_METAMASK;this.messagingSystem.call("ApprovalController:addRequest",{id:t,origin:n,type:"eth_getEncryptionPublicKey"},!0).catch(()=>{})}_acceptApproval(e){this.messagingSystem.call("ApprovalController:acceptRequest",e)}_rejectApproval(e){this.messagingSystem.call("ApprovalController:rejectRequest",e,"Cancel")}}n.default=h}}},{package:"$root$",file:"app/scripts/controllers/encryption-public-key.ts"}],[111,{"../../../../shared/lib/accounts/institutional-wallet-snap":5285,"@metamask/base-controller":1140,"@metamask/controller-utils":1224,"@metamask/snaps-utils":2516,"@metamask/transaction-controller":2587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.InstitutionalSnapController=void 0;var s=e("@metamask/transaction-controller"),r=e("@metamask/snaps-utils"),a=e("@metamask/base-controller"),i=e("@metamask/controller-utils");function o(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function c(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const l=e("../../../../shared/lib/accounts/institutional-wallet-snap").INSTITUTIONAL_WALLET_SNAP_ID,u="InstitutionalSnapController",d={};var p=new WeakSet;class h extends a.BaseController{constructor({messenger:e}){super({messenger:e,name:u,state:{},metadata:d}),o(this,p),c(p,this,m).call(this)}async deferPublicationHook(e){if(await c(p,this,w).call(this,e)){const t=await c(p,this,g).call(this,e);return await c(p,this,y).call(this,e.id,t),!1}return!0}async beforeCheckPendingTransactionHook(e){return!await c(p,this,w).call(this,e)}}function m(){this.messagingSystem.registerActionHandler(`${u}:publishHook`,this.deferPublicationHook.bind(this)),this.messagingSystem.registerActionHandler(`${u}:beforeCheckPendingTransactionHook`,this.beforeCheckPendingTransactionHook.bind(this))}async function f(e){return await this.messagingSystem.call("SnapController:handleRequest",e)}async function g(e){const t={from:e.txParams.from,to:e.txParams.to,value:e.txParams.value,data:e.txParams.data,chainId:e.chainId},n={snapId:l,origin:i.ORIGIN_METAMASK,handler:r.HandlerType.OnRpcRequest,request:{method:"transactions.getMutableTransactionParameters",params:t}},a=await c(p,this,f).call(this,n);return{hash:a.transaction.transactionHash,nonce:a.transaction.nonce,gasLimit:a.transaction.gasLimit,maxFeePerGas:a.transaction.maxFeePerGas,maxPriorityFeePerGas:a.transaction.maxPriorityFeePerGas,type:a.transaction.type,status:s.TransactionStatus.submitted}}async function y(e,{status:t,hash:n,nonce:s,gasLimit:r,maxFeePerGas:a,maxPriorityFeePerGas:i,type:o}){return await this.messagingSystem.call("TransactionController:updateCustodialTransaction",{transactionId:e,status:t,hash:n,nonce:s,gasLimit:r,maxFeePerGas:a,maxPriorityFeePerGas:i,type:o})}async function w(e){var t;const n=await this.messagingSystem.call("AccountsController:getAccountByAddress",e.txParams.from);return null==n||null===(t=n.options.custodian)||void 0===t?void 0:t.deferPublication}n.InstitutionalSnapController=h}}},{package:"$root$",file:"app/scripts/controllers/institutional-snap/InstitutionalSnapController.ts"}],[112,{"../../../development/build/constants":460,"../../../shared/constants/alarms":5241,"../../../shared/constants/app":5244,"../../../shared/constants/keyring":5255,"../../../shared/constants/metametrics":5259,"../../../shared/constants/time":5277,"../../../shared/constants/transaction":5279,"../../../shared/lib/trace":5342,"../../../shared/modules/mv3.utils":5363,"../lib/util":237,"@metamask/base-controller":1140,"@metamask/name-controller":2014,"@metamask/utils":2632,buffer:3590,"ethereumjs-util":3849,lodash:4362,uuid:5195},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.overrideAnonymousEventNames=n.getDefaultMetaMetricsControllerState=n.default=void 0;var s=e("lodash"),r=e("ethereumjs-util"),a=e("uuid"),i=e("@metamask/name-controller"),o=e("@metamask/utils"),c=e("@metamask/base-controller"),l=e("../../../shared/constants/app"),u=e("../../../shared/constants/metametrics"),d=e("../../../shared/constants/time"),p=e("../../../shared/modules/mv3.utils"),h=e("../../../shared/constants/alarms"),m=e("../lib/util"),f=e("../../../shared/constants/transaction"),g=e("../../../shared/lib/trace"),y=e("../../../development/build/constants"),w=e("../../../shared/constants/keyring");function b(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t,n){v(e,t),t.set(e,n)}function v(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function T(e,t){return e.get(A(e,t))}function S(e,t,n){return e.set(A(e,t),n),n}function A(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const k=n.overrideAnonymousEventNames={[f.TransactionMetaMetricsEvent.added]:f.AnonymousTransactionMetaMetricsEvent.added,[f.TransactionMetaMetricsEvent.approved]:f.AnonymousTransactionMetaMetricsEvent.approved,[f.TransactionMetaMetricsEvent.finalized]:f.AnonymousTransactionMetaMetricsEvent.finalized,[f.TransactionMetaMetricsEvent.rejected]:f.AnonymousTransactionMetaMetricsEvent.rejected,[f.TransactionMetaMetricsEvent.submitted]:f.AnonymousTransactionMetaMetricsEvent.submitted,[u.MetaMetricsEventName.SignatureRequested]:u.MetaMetricsEventName.SignatureRequestedAnon,[u.MetaMetricsEventName.SignatureApproved]:u.MetaMetricsEventName.SignatureApprovedAnon,[u.MetaMetricsEventName.SignatureRejected]:u.MetaMetricsEventName.SignatureRejectedAnon},_=e=>{setTimeout(()=>{throw e})},M=e=>{const t=[];return e.uniqueIdentifier&&t.push(e.uniqueIdentifier),e.actionId&&t.push(e.actionId),t.length&&e.isDuplicateAnonymizedEvent&&t.push("0x000"),t.length?t.join("-"):(0,m.generateRandomId)()},C={'You must pass either an "anonymousId" or a "userId".':!0},P={metaMetricsId:{persist:!0,anonymous:!0},participateInMetaMetrics:{persist:!0,anonymous:!0},latestNonAnonymousEventTimestamp:{persist:!0,anonymous:!0},fragments:{persist:!0,anonymous:!1},eventsBeforeMetricsOptIn:{persist:!0,anonymous:!1},tracesBeforeMetricsOptIn:{persist:!0,anonymous:!1},traits:{persist:!0,anonymous:!1},dataCollectionForMarketing:{persist:!0,anonymous:!1},marketingCampaignCookieId:{persist:!0,anonymous:!0},segmentApiCalls:{persist:!0,anonymous:!1}},I=()=>({participateInMetaMetrics:null,metaMetricsId:null,dataCollectionForMarketing:null,marketingCampaignCookieId:null,latestNonAnonymousEventTimestamp:0,eventsBeforeMetricsOptIn:[],tracesBeforeMetricsOptIn:[],traits:{},fragments:{},segmentApiCalls:{}});n.getDefaultMetaMetricsControllerState=I;var N=new WeakMap,O=new WeakMap,D=new WeakMap,j=new WeakMap,R=new WeakSet,L=new WeakMap;class B extends c.BaseController{constructor({state:e={},messenger:t,segment:n,version:r,environment:a,extension:i,captureException:c=_}){var l,u;super({name:"MetaMetricsController",metadata:P,state:{participateInMetaMetrics:null,metaMetricsId:null,dataCollectionForMarketing:null,marketingCampaignCookieId:null,latestNonAnonymousEventTimestamp:0,eventsBeforeMetricsOptIn:[],tracesBeforeMetricsOptIn:[],traits:{},fragments:{},segmentApiCalls:{},...e},messenger:t}),v(l=this,u=R),u.add(l),E(this,N,void 0),b(this,"chainId",void 0),b(this,"locale",void 0),b(this,"previousUserTraits",void 0),b(this,"version",void 0),E(this,O,void 0),E(this,D,void 0),E(this,j,void 0),E(this,L,(0,s.memoize)((e={})=>Object.values(e).reduce((e,t)=>e.concat(...Object.values(t)),[]))),S(N,this,e=>{const t=(0,o.getErrorMessage)(e);C[t]||c(e)}),this.chainId=A(R,this,x).call(this);const f=this.messagingSystem.call("PreferencesController:getState");this.locale=f.currentLocale.replace("_","-"),this.version="production"===a?r:`${r}-${a}`,S(O,this,i),S(D,this,a),this.messagingSystem.registerActionHandler("MetaMetricsController:trackEvent",this.trackEvent.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:getMetaMetricsId",this.getMetaMetricsId.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:createEventFragment",this.createEventFragment.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:getEventFragmentById",this.getEventFragmentById.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:updateEventFragment",this.updateEventFragment.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:deleteEventFragment",this.deleteEventFragment.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:finalizeEventFragment",this.finalizeEventFragment.bind(this));const g=(0,s.omitBy)(e.fragments,"persist");this.messagingSystem.subscribe("PreferencesController:stateChange",({currentLocale:e})=>{this.locale=null==e?void 0:e.replace("_","-")}),this.messagingSystem.subscribe("NetworkController:networkDidChange",({selectedNetworkClientId:e})=>{this.chainId=A(R,this,x).call(this,e)}),S(j,this,n),Object.values(g).forEach(e=>{this.processAbandonedFragment(e)}),p.isManifestV3&&Object.values(e.segmentApiCalls||{}).forEach(({eventType:e,payload:t})=>{try{A(R,this,X).call(this,e,t)}catch(e){T(N,this).call(this,e)}}),p.isManifestV3?(T(O,this).alarms.getAll().then(e=>{(0,m.checkAlarmExists)(e,h.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM)||T(O,this).alarms.create(h.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM,{delayInMinutes:1,periodInMinutes:1})}),T(O,this).alarms.onAlarm.addListener(e=>{e.name===h.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM&&this.finalizeAbandonedFragments()})):setInterval(()=>{this.finalizeAbandonedFragments()},30*d.SECOND)}finalizeAbandonedFragments(){Object.values(this.state.fragments).forEach(e=>{e.timeout&&e.lastUpdated&&Date.now()-e.lastUpdated/1e3>e.timeout&&this.processAbandonedFragment(e)})}generateMetaMetricsId(){return(0,r.bufferToHex)((0,r.keccak)(t.from(String(Date.now())+String(Math.round(Math.random()*Number.MAX_SAFE_INTEGER)))))}createEventFragment(e){if(!e.successEvent)throw new Error(`Must specify success event. Success event was: ${e.event}. Payload keys were: ${Object.keys(e)}. ${"object"==typeof e.properties?`Payload property keys were: ${Object.keys(e.properties)}`:""}`);const{fragments:t}=this.state,n=e.uniqueIdentifier??(0,a.v4)(),r={id:n,...e,lastUpdated:Date.now()},i=e.initialEvent===f.TransactionMetaMetricsEvent.submitted&&t[n]?{...t[n],canDeleteIfAbandoned:!1}:{};return this.update(e=>{e.fragments[n]=(0,s.merge)({},i,r)}),r.initialEvent&&this.trackEvent({event:r.initialEvent,category:r.category,properties:r.properties,sensitiveProperties:r.sensitiveProperties,page:r.page,referrer:r.referrer,revenue:r.revenue,value:r.value,currency:r.currency,environmentType:r.environmentType,actionId:e.actionId,uniqueIdentifier:e.uniqueIdentifier}),r}getEventFragmentById(e){return this.state.fragments[e]}processAbandonedFragment(e){e.canDeleteIfAbandoned?this.deleteEventFragment(e.id):this.finalizeEventFragment(e.id,{abandoned:!0})}updateEventFragment(e,t){const{fragments:n}=this.state,r=n[e];if(!r&&e.includes("transaction-submitted-"))this.update(n=>{n.fragments[e]={canDeleteIfAbandoned:!0,category:u.MetaMetricsEventCategory.Transactions,successEvent:f.TransactionMetaMetricsEvent.finalized,id:e,...t,lastUpdated:Date.now()}});else{if(!r)throw new Error(`Event fragment with id ${e} does not exist.`);this.update(n=>{n.fragments[e]=(0,s.merge)(n.fragments[e],{...t,lastUpdated:Date.now()})})}}deleteEventFragment(e){this.state.fragments[e]&&this.update(t=>{delete t.fragments[e]})}finalizeEventFragment(e,{abandoned:t=!1,page:n,referrer:s}={}){const r=this.state.fragments[e];if(!r)throw new Error(`Funnel with id ${e} does not exist.`);const a=t?r.failureEvent:r.successEvent;this.trackEvent({event:a??"",category:r.category,properties:r.properties,sensitiveProperties:r.sensitiveProperties,page:n??r.page,referrer:r.referrer??s,revenue:r.revenue,value:r.value,currency:r.currency,environmentType:r.environmentType,actionId:r.actionId,uniqueIdentifier:r.uniqueIdentifier?`${r.uniqueIdentifier}-${t?"failure":"success"}`:undefined}),this.update(t=>{delete t.fragments[e]})}identify(e){const{metaMetricsId:t,participateInMetaMetrics:n}=this.state;if(!n||!t||!e)return;if("object"!=typeof e)return void console.warn("MetaMetricsController#identify: userTraits parameter must be an object. Received type: "+typeof e);const s=A(R,this,H).call(this,e);A(R,this,V).call(this,s)}updateExtensionUninstallUrl(e,n){const s={av:this.version};e&&(s.mmi=t.from(n).toString("base64"),s.env=T(D,this));const r=new URLSearchParams(s);T(O,this)&&T(O,this).runtime&&T(O,this).runtime.setUninstallURL(`https://metamask.io/uninstalled?${r}`)}async setParticipateInMetaMetrics(e){const{metaMetricsId:t}=this.state,n=e&&!t?this.generateMetaMetricsId():t;return this.update(t=>{t.participateInMetaMetrics=e,t.metaMetricsId=n}),e?(this.trackEventsAfterMetricsOptIn(),this.clearEventsAfterMetricsOptIn(),this.trackTracesAfterMetricsOptIn(),this.clearTracesAfterMetricsOptIn()):this.state.marketingCampaignCookieId&&this.setMarketingCampaignCookieId(null),T(D,this)!==y.ENVIRONMENT.DEVELOPMENT&&null!==n&&this.updateExtensionUninstallUrl(e,n),n}setDataCollectionForMarketing(e){const{metaMetricsId:t}=this.state;return this.update(t=>{t.dataCollectionForMarketing=e}),!e&&this.state.marketingCampaignCookieId&&this.setMarketingCampaignCookieId(null),t}setMarketingCampaignCookieId(e){this.update(t=>{t.marketingCampaignCookieId=e})}trackPage(e,t){try{if(!1===this.state.participateInMetaMetrics)return;if(null===this.state.participateInMetaMetrics&&(null==t||!t.isOptInPath))return;const{name:n,params:s,environmentType:r,page:a,referrer:i,actionId:o}=e,{metaMetricsId:c}=this.state,l=c?"userId":"anonymousId",d=c??u.METAMETRICS_ANONYMOUS_ID;A(R,this,X).call(this,"page",{messageId:M({actionId:o}),[l]:d,name:n,properties:{params:s,locale:this.locale,chain_id:this.chainId,environment_type:r},context:A(R,this,G).call(this,i,a)})}catch(e){T(N,this).call(this,e)}}trackEvent(e,t){A(R,this,F).call(this,e),A(R,this,U).call(this,e,t).catch(e=>{T(N,this).call(this,e)})}handleMetaMaskStateUpdate(e){const t=this._buildUserTraitsObject(e);t&&this.identify(t)}trackEventsAfterMetricsOptIn(){const{eventsBeforeMetricsOptIn:e}=this.state;e.forEach(e=>{this.trackEvent(e)})}clearEventsAfterMetricsOptIn(){this.update(e=>{e.eventsBeforeMetricsOptIn=[]})}addEventBeforeMetricsOptIn(e){this.update(t=>{t.eventsBeforeMetricsOptIn.push(e)})}trackTracesAfterMetricsOptIn(){const{tracesBeforeMetricsOptIn:e}=this.state;e.forEach(e=>{"start"===e.type?(0,g.trace)(e.request):"end"===e.type&&(0,g.endTrace)(e.request)})}clearTracesAfterMetricsOptIn(){this.update(e=>{e.tracesBeforeMetricsOptIn=[]})}addTraceBeforeMetricsOptIn(e){this.update(t=>{t.tracesBeforeMetricsOptIn.push(e)})}bufferedTrace(e,t){if(this.state.participateInMetaMetrics)return t?(0,g.trace)(e,t):(0,g.trace)(e);let n;if(e.parentContext&&"object"==typeof e.parentContext){const t=e.parentContext;n=null==t?void 0:t._name}return this.addTraceBeforeMetricsOptIn({type:"start",request:{...e,parentContext:undefined,startTime:e.startTime??Date.now()},parentTraceName:n}),undefined}bufferedEndTrace(e){this.state.participateInMetaMetrics?(0,g.endTrace)(e):this.addTraceBeforeMetricsOptIn({type:"end",request:{...e,timestamp:e.timestamp??Date.now()}})}updateTraits(e){this.update(t=>{t.traits={...t.traits,...e}})}getMetaMetricsId(){let{metaMetricsId:e}=this.state;return e||(e=this.generateMetaMetricsId(),this.update(t=>{t.metaMetricsId=e})),e}_buildUserTraitsObject(e){var t,n,r;const{traits:a}=this.state,i={[u.MetaMetricsUserTrait.AddressBookEntries]:(0,s.sum)(Object.values(e.addressBook).map(s.size)),[u.MetaMetricsUserTrait.InstallDateExt]:a[u.MetaMetricsUserTrait.InstallDateExt]||"",[u.MetaMetricsUserTrait.LedgerConnectionType]:e.ledgerTransportType,[u.MetaMetricsUserTrait.NetworksAdded]:Object.values(e.networkConfigurationsByChainId).map(e=>e.chainId),[u.MetaMetricsUserTrait.NetworksWithoutTicker]:Object.values(e.networkConfigurationsByChainId).filter(({nativeCurrency:e})=>!e).map(({chainId:e})=>e),[u.MetaMetricsUserTrait.ChainIdList]:[...Object.keys(e.networkConfigurationsByChainId).map(e=>`eip155:${parseInt(e,16)}`),...Object.keys(e.multichainNetworkConfigurationsByChainId)],[u.MetaMetricsUserTrait.NftAutodetectionEnabled]:e.useNftDetection,[u.MetaMetricsUserTrait.NumberOfAccounts]:Object.values(e.internalAccounts.accounts).length,[u.MetaMetricsUserTrait.NumberOfNftCollections]:A(R,this,K).call(this,e.allNfts),[u.MetaMetricsUserTrait.NumberOfNfts]:T(L,this).call(this,e.allNfts).length,[u.MetaMetricsUserTrait.NumberOfTokens]:A(R,this,W).call(this,e.allTokens),[u.MetaMetricsUserTrait.NumberOfHDEntropies]:A(R,this,q).call(this,e)??(null===(t=this.previousUserTraits)||void 0===t?void 0:t.number_of_hd_entropies),[u.MetaMetricsUserTrait.OpenSeaApiEnabled]:e.openSeaEnabled,[u.MetaMetricsUserTrait.ThreeBoxEnabled]:!1,[u.MetaMetricsUserTrait.Theme]:e.theme||"default",[u.MetaMetricsUserTrait.TokenDetectionEnabled]:e.useTokenDetection,[u.MetaMetricsUserTrait.ShowNativeTokenAsMainBalance]:e.ShowNativeTokenAsMainBalance,[u.MetaMetricsUserTrait.CurrentCurrency]:e.currentCurrency,[u.MetaMetricsUserTrait.SecurityProviders]:e.securityAlertsEnabled?["blockaid"]:[],[u.MetaMetricsUserTrait.PetnameAddressCount]:A(R,this,Z).call(this,e),[u.MetaMetricsUserTrait.IsMetricsOptedIn]:e.participateInMetaMetrics,[u.MetaMetricsUserTrait.HasMarketingConsent]:e.dataCollectionForMarketing,[u.MetaMetricsUserTrait.TokenSortPreference]:(null===(n=e.tokenSortConfig)||void 0===n?void 0:n.key)||"",[u.MetaMetricsUserTrait.PrivacyModeEnabled]:e.preferences.privacyMode,[u.MetaMetricsUserTrait.NetworkFilterPreference]:Object.keys(e.preferences.tokenNetworkFilter||{}),[u.MetaMetricsUserTrait.ProfileId]:null===(r=Object.entries(e.srpSessionData||{}))||void 0===r||null===(r=r[0])||void 0===r||null===(r=r[1])||void 0===r||null===(r=r.profile)||void 0===r?void 0:r.profileId};if(!this.previousUserTraits&&e.participateInMetaMetrics)return this.previousUserTraits=i,i;if(this.previousUserTraits&&!(0,s.isEqual)(this.previousUserTraits,i)){const t=(0,s.pickBy)(i,(e,t)=>{const n=this.previousUserTraits[t];return!(0,s.isEqual)(n,e)});return e.participateInMetaMetrics&&(this.previousUserTraits=i),t}return null}}function x(e){const t=e||this.messagingSystem.call("NetworkController:getState").selectedNetworkClientId,{configuration:{chainId:n}}=this.messagingSystem.call("NetworkController:getNetworkClientById",t);return n}async function U(e,t){if(!(this.state.participateInMetaMetrics||null!=t&&t.isOptIn))return;const n=[];if(e.sensitiveProperties){if(!0===(null==t?void 0:t.excludeMetaMetricsId))throw new Error("sensitiveProperties was specified in an event payload that also set the excludeMetaMetricsId flag");const r=k[`${e.event}`],a={...e,event:r??e.event},i=(0,s.merge)({...a.sensitiveProperties},{...a.properties});n.push(A(R,this,J).call(this,A(R,this,$).call(this,{...a,properties:i,isDuplicateAnonymizedEvent:!0}),{...t,excludeMetaMetricsId:!0}))}n.push(A(R,this,J).call(this,A(R,this,$).call(this,e),t)),await Promise.all(n)}function F(e){if(!e.event)throw new Error(`Must specify event. Event was: ${e.event}. Payload keys were: ${Object.keys(e)}. ${"object"==typeof e.properties?`Payload property keys were: ${Object.keys(e.properties)}`:""}`)}function G(e,t=u.METAMETRICS_BACKGROUND_PAGE_OBJECT){return{app:{name:"MetaMask Extension",version:this.version},userAgent:window.navigator.userAgent,page:t,referrer:e,marketingCampaignCookieId:this.state.marketingCampaignCookieId}}function $(e){const{event:t,properties:n,revenue:r,value:a,currency:i,category:o,page:c,referrer:u,environmentType:d=l.ENVIRONMENT_TYPE_BACKGROUND}=e;let p;return p=n&&"chain_id_caip"in n&&"string"==typeof n.chain_id_caip?null:n&&"chain_id"in n&&"string"==typeof n.chain_id?n.chain_id:this.chainId,{event:t,messageId:M(e),properties:{...(0,s.omit)(n,["revenue","locale","currency","value"]),revenue:r,value:a,currency:i,category:o,locale:this.locale,chain_id:p,environment_type:d},context:A(R,this,G).call(this,u,c)}}function H(e){return Object.entries(e).reduce((e,[t,n])=>A(R,this,Q).call(this,n)?{...e,[t]:n.toISOString()}:A(R,this,Y).call(this,n)?{...e,[t]:n}:(console.warn(`MetaMetricsController: "${t}" value is not a valid trait type`),e),{})}function K(e={}){const t=T(L,this).call(this,e).map(e=>e.address);return new Set(t).size}function W(e){return Object.values(e).reduce((e,t)=>e+(0,s.sum)(Object.values(t).map(s.size)),0)}function q(e){var t;return(null===(t=e.keyrings)||void 0===t?void 0:t.filter(e=>e.type===w.KeyringType.hdKeyTree).length)??0}function V(e){const{metaMetricsId:t}=this.state;if(e&&0!==Object.keys(e).length)try{A(R,this,X).call(this,"identify",{userId:t??undefined,traits:e})}catch(e){T(N,this).call(this,e)}else console.warn("MetaMetricsController#_identify: No userTraits found")}function Y(e){const t=typeof e;return"string"===t||"boolean"===t||"number"===t||A(R,this,z).call(this,e)||A(R,this,Q).call(this,e)}function z(e){return Array.isArray(e)&&(e.every(e=>"string"==typeof e)||e.every(e=>"boolean"==typeof e)||e.every(e=>"number"==typeof e))}function Q(e){return"[object Date]"===Object.prototype.toString.call(e)}function J(e,t){const{isOptIn:n,metaMetricsId:s,matomoEvent:r,flushImmediately:a}=t||{};let i="userId",c=this.state.metaMetricsId,l=(null==t?void 0:t.excludeMetaMetricsId)??!1;const d=Boolean(e.event.match(/^send|^confirm/iu));return!1!==(null==t?void 0:t.excludeMetaMetricsId)&&d&&(l=!0),l||n&&!s?(i="anonymousId",c=u.METAMETRICS_ANONYMOUS_ID):n&&s&&(c=s),e[i]=c??undefined,!0===r&&(e.properties.legacy_event=!0),new Promise((t,n)=>{A(R,this,X).call(this,"track",e,e=>{if(e){const t=(0,o.isErrorWithMessage)(e)?e.message:"",s=(0,o.isErrorWithStack)(e)?e.stack:undefined,r=new Error(t);return s&&(r.stack=s),n(r)}return t()}),a&&T(j,this).flush()})}function X(e,t,n){const{metaMetricsId:s,latestNonAnonymousEventTimestamp:r,participateInMetaMetrics:a}=this.state;if(!a||!s)return;const i=t.messageId||(0,m.generateRandomId)();let o=new Date;if(t.timestamp){const e=new Date(t.timestamp);(0,m.isValidDate)(e)&&(o=e)}const c={...t,messageId:i,timestamp:o};this.update(t=>{t.latestNonAnonymousEventTimestamp=c.anonymousId===u.METAMETRICS_ANONYMOUS_ID?r:o.valueOf(),t.segmentApiCalls[i]={eventType:e,payload:{...c,timestamp:c.timestamp.toString()}}});T(j,this)[e](c,e=>(this.update(e=>{delete e.segmentApiCalls[i]}),null==n?void 0:n(e)))}function Z(e){var t;const n=(null===(t=e.names)||void 0===t?void 0:t[i.NameType.ETHEREUM_ADDRESS])??{};return Object.keys(n).reduce((e,t)=>{const s=n[t];return e+Object.keys(s).reduce((e,t)=>{var n;return e+(Boolean(null===(n=s[t].name)||void 0===n?void 0:n.length)?1:0)},0)},0)}n.default=B}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/controllers/metametrics-controller.ts"}],[113,{"@metamask/base-controller":1140},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MetaMetricsDataDeletionController=void 0;var s=e("@metamask/base-controller");function r(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a(e,t){return e.get(i(e,t))}function i(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const o="MetaMetricsDataDeletionController",c={metaMetricsDataDeletionId:{persist:!0,anonymous:!0},metaMetricsDataDeletionTimestamp:{persist:!0,anonymous:!0},metaMetricsDataDeletionStatus:{persist:!0,anonymous:!0}};var l=new WeakMap,u=new WeakSet;class d extends s.BaseController{constructor({dataDeletionService:e,messenger:t,state:n}){var s,a;super({messenger:t,metadata:c,name:o,state:{metaMetricsDataDeletionId:null,metaMetricsDataDeletionTimestamp:0,...n}}),r(s=this,a=u),a.add(s),function(e,t,n){r(e,t),t.set(e,n)}(this,l,void 0),function(e,t,n){e.set(i(e,t),n)}(l,this,e),i(u,this,p).call(this)}async createMetaMetricsDataDeletionTask(){const{metaMetricsId:e}=this.messagingSystem.call("MetaMetricsController:getState");if(!e)throw new Error("MetaMetrics ID not found");const t=await a(l,this).createDataDeletionRegulationTask(e);this.update(e=>{e.metaMetricsDataDeletionId=t??null,e.metaMetricsDataDeletionTimestamp=Date.now()}),await this.updateDataDeletionTaskStatus()}async updateDataDeletionTaskStatus(){const e=this.state.metaMetricsDataDeletionId;if(!e)throw new Error("Delete Regulation id not found");const t=await a(l,this).fetchDeletionRegulationStatus(e);this.update(e=>{e.metaMetricsDataDeletionStatus=t??undefined})}}function p(){this.messagingSystem.registerActionHandler(`${o}:createMetaMetricsDataDeletionTask`,this.createMetaMetricsDataDeletionTask.bind(this)),this.messagingSystem.registerActionHandler(`${o}:updateDataDeletionTaskStatus`,this.updateDataDeletionTaskStatus.bind(this))}n.MetaMetricsDataDeletionController=d}}},{package:"$root$",file:"app/scripts/controllers/metametrics-data-deletion/metametrics-data-deletion.ts"}],[114,{"../../../shared/constants/network":5262,"@metamask/base-controller":1140,"@metamask/keyring-api":1914,"@metamask/multichain-network-controller":2006,"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NetworkOrderController=void 0;var s=e("@metamask/keyring-api"),r=e("@metamask/base-controller"),a=e("@metamask/utils"),i=e("@metamask/multichain-network-controller"),o=e("../../../shared/constants/network");const c={orderedNetworkList:[],enabledNetworkMap:{[a.KnownCaipNamespace.Eip155]:{[o.CHAIN_IDS.MAINNET]:!0,[o.CHAIN_IDS.LINEA_MAINNET]:!0,[o.CHAIN_IDS.BASE]:!0},[a.KnownCaipNamespace.Solana]:{[s.SolScope.Mainnet]:!0},[a.KnownCaipNamespace.Bip122]:{}}},l={orderedNetworkList:{persist:!0,anonymous:!0},enabledNetworkMap:{persist:!0,anonymous:!0}};class u extends r.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:l,name:"NetworkOrderController",state:{...c,...t}}),this.messagingSystem.subscribe("NetworkController:stateChange",e=>{this.onNetworkControllerStateChange(e)}),this.messagingSystem.subscribe("NetworkController:networkRemoved",e=>{this.onNetworkRemoved(e.chainId)})}onNetworkControllerStateChange({networkConfigurationsByChainId:e}){this.update(t=>{const n=Object.keys(e).filter(e=>!o.TEST_CHAINS.includes(e)).map(i.toEvmCaipChainId),r=[s.BtcScope.Mainnet,s.SolScope.Mainnet],a=n.filter(e=>!t.orderedNetworkList.some(({networkId:t})=>t===e)).map(e=>({networkId:e}));t.orderedNetworkList=t.orderedNetworkList.filter(({networkId:e})=>n.includes(e)||r.includes(e)).concat(a)})}onNetworkRemoved(e){const t=(0,a.isCaipChainId)(e)?e:(0,i.toEvmCaipChainId)(e),{namespace:n}=(0,a.parseCaipChainId)(t);n===a.KnownCaipNamespace.Eip155?this.update(t=>{delete t.enabledNetworkMap[n][e],0===Object.keys(t.enabledNetworkMap[n]).length&&(t.enabledNetworkMap[n]["0x1"]=!0)}):this.update(e=>{delete e.enabledNetworkMap[n][t]})}updateNetworksList(e){this.update(t=>{t.orderedNetworkList=e.map(e=>({networkId:e}))})}setEnabledNetworks(e,t){if(!t)throw new Error("namespace is required to set enabled networks");if(!e)throw new Error("chainIds is required to set enabled networks");const n=Array.isArray(e)?e:[e];this.update(e=>{const s=Object.fromEntries(n.map(e=>[e,!0]));e.enabledNetworkMap[t]=s})}setEnabledNetworksMultichain(e,t){if(!t)throw new Error("namespace is required to set enabled networks");if(!e)throw new Error("chainIds is required to set enabled networks");const n=Array.isArray(e)?e:[e];this.update(e=>{const s=Object.fromEntries(n.map(e=>[e,!0])),r=Object.keys(e.enabledNetworkMap).reduce((e,n)=>n!==t?{...e,[n]:{}}:{...e,[n]:s},{});e.enabledNetworkMap=r})}}n.NetworkOrderController=u}}},{package:"$root$",file:"app/scripts/controllers/network-order.ts"}],[115,{"../../../shared/constants/onboarding":5265,"../../../shared/modules/environment":5355,"@metamask/base-controller":1140,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultOnboardingControllerState=n.default=void 0;var s,r=e("@metamask/base-controller"),a=(s=e("loglevel"))&&s.__esModule?s:{default:s},i=e("../../../shared/constants/onboarding"),o=e("../../../shared/modules/environment");function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const l=()=>({seedPhraseBackedUp:null,firstTimeFlowType:null,completedOnboarding:!1});n.getDefaultOnboardingControllerState=l;const u={onboardingTabs:{}},d={seedPhraseBackedUp:{persist:!0,anonymous:!0},firstTimeFlowType:{persist:!0,anonymous:!0},completedOnboarding:{persist:!0,anonymous:!0},onboardingTabs:{persist:!1,anonymous:!1}};class p extends r.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:d,name:"OnboardingController",state:{seedPhraseBackedUp:null,firstTimeFlowType:null,completedOnboarding:!1,...t,...u}}),c(this,"registerOnboarding",async(e,t)=>{if(this.state.completedOnboarding)return void a.default.debug("Ignoring registerOnboarding; user already onboarded");const{onboardingTabs:n}={...this.state??{}};n&&(n[e]&&n[e]===t||(a.default.debug(`Registering onboarding tab at location '${e}' with tabId '${t}'`),this.update(s=>{s.onboardingTabs={...n,[e]:t}})))})}setSeedPhraseBackedUp(e){this.update(t=>{t.seedPhraseBackedUp=e})}completeOnboarding(){return this.update(e=>{e.completedOnboarding=!0}),!0}setFirstTimeFlowType(e){this.update(t=>{t.firstTimeFlowType=e})}getIsSocialLoginFlow(){if(!(0,o.getIsSeedlessOnboardingFeatureEnabled)())return!1;const{firstTimeFlowType:e}=this.state;return e===i.FirstTimeFlowType.socialCreate||e===i.FirstTimeFlowType.socialImport}}n.default=p}}},{package:"$root$",file:"app/scripts/controllers/onboarding.ts"}],[12,{"./assets-contract-controller-init":11,"./network-order-controller-init":13,"./nft-controller-init":14,"./nft-detection-controller-init":15,"./token-rates-controller-init":16},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"AssetsContractControllerInit",{enumerable:!0,get:function(){return i.AssetsContractControllerInit}}),Object.defineProperty(n,"NetworkOrderControllerInit",{enumerable:!0,get:function(){return o.NetworkOrderControllerInit}}),Object.defineProperty(n,"NftControllerInit",{enumerable:!0,get:function(){return r.NftControllerInit}}),Object.defineProperty(n,"NftDetectionControllerInit",{enumerable:!0,get:function(){return a.NftDetectionControllerInit}}),Object.defineProperty(n,"TokenRatesControllerInit",{enumerable:!0,get:function(){return s.TokenRatesControllerInit}});var s=e("./token-rates-controller-init"),r=e("./nft-controller-init"),a=e("./nft-detection-controller-init"),i=e("./assets-contract-controller-init"),o=e("./network-order-controller-init")}}},{package:"$root$",file:"app/scripts/controller-init/assets/index.ts"}],[122,{"../../../shared/constants/hardware-wallets":5253,"../../../shared/constants/network":5262,"../../../shared/constants/preferences":5267,"@metamask/base-controller":1140,"@metamask/preferences-controller":2123},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultPreferencesControllerState=n.PreferencesController=void 0;var s=e("@metamask/base-controller"),r=e("@metamask/preferences-controller"),a=e("../../../shared/constants/network"),i=e("../../../shared/constants/hardware-wallets"),o=e("../../../shared/constants/preferences");function c(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}const l=()=>({selectedAddress:"",useBlockie:!1,usePhishDetect:!0,dismissSeedBackUpReminder:!1,overrideContentSecurityPolicyHeader:!0,useMultiAccountBalanceChecker:!0,useSafeChainsListValidation:!0,useTokenDetection:!0,useNftDetection:!0,use4ByteResolution:!0,useCurrencyRateCheck:!0,openSeaEnabled:!0,securityAlertsEnabled:!0,watchEthereumAccountEnabled:!1,addSnapAccountEnabled:!1,advancedGasFee:{},featureFlags:{},knownMethodData:{},currentLocale:"",identities:{},lostIdentities:{},forgottenPassword:!1,preferences:{autoLockTimeLimit:undefined,showExtensionInFullSizeView:!1,showFiatInTestnets:!1,showTestNetworks:!1,smartTransactionsOptInStatus:!0,smartTransactionsMigrationApplied:!1,showNativeTokenAsMainBalance:!1,useNativeCurrencyAsPrimaryCurrency:!0,hideZeroBalanceTokens:!1,petnamesEnabled:!0,featureNotificationsEnabled:!1,showConfirmationAdvancedDetails:!1,showMultiRpcModal:!1,privacyMode:!1,dismissSmartAccountSuggestionEnabled:!1,smartAccountOptIn:!0,tokenSortConfig:{key:"tokenFiatAmount",order:"dsc",sortCallback:"stringNumeric"},tokenNetworkFilter:{},skipDeepLinkInterstitial:!1,avatarType:"maskicon"},ipfsGateway:a.IPFS_DEFAULT_GATEWAY_URL,isIpfsGatewayEnabled:!0,useAddressBarEnsResolution:!0,ledgerTransportType:window.navigator.hid?i.LedgerTransportTypes.webhid:i.LedgerTransportTypes.u2f,snapRegistryList:{},theme:o.ThemeType.os,snapsAddSnapAccountModalDismissed:!1,useExternalNameSources:!0,useTransactionSimulations:!0,enableMV3TimestampSave:!0,useExternalServices:!0,isMultiAccountBalancesEnabled:!0,showIncomingTransactions:{[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.MAINNET]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.GOERLI]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.BSC]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.BSC_TESTNET]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.OPTIMISM]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.OPTIMISM_SEPOLIA]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.POLYGON]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.POLYGON_TESTNET]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.AVALANCHE]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.AVALANCHE_TESTNET]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.FANTOM]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.FANTOM_TESTNET]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.SEPOLIA]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.LINEA_GOERLI]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.LINEA_SEPOLIA]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.LINEA_MAINNET]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.MOONBEAM]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.MOONBEAM_TESTNET]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.MOONRIVER]:!0,[r.ETHERSCAN_SUPPORTED_CHAIN_IDS.GNOSIS]:!0},manageInstitutionalWallets:!1});n.getDefaultPreferencesControllerState=l;const u={selectedAddress:{persist:!0,anonymous:!1},useBlockie:{persist:!0,anonymous:!0},usePhishDetect:{persist:!0,anonymous:!0},dismissSeedBackUpReminder:{persist:!0,anonymous:!0},overrideContentSecurityPolicyHeader:{persist:!0,anonymous:!0},useMultiAccountBalanceChecker:{persist:!0,anonymous:!0},useSafeChainsListValidation:{persist:!0,anonymous:!1},useTokenDetection:{persist:!0,anonymous:!0},useNftDetection:{persist:!0,anonymous:!0},use4ByteResolution:{persist:!0,anonymous:!0},useCurrencyRateCheck:{persist:!0,anonymous:!0},openSeaEnabled:{persist:!0,anonymous:!0},securityAlertsEnabled:{persist:!0,anonymous:!1},watchEthereumAccountEnabled:{persist:!0,anonymous:!1},addSnapAccountEnabled:{persist:!0,anonymous:!1},advancedGasFee:{persist:!0,anonymous:!0},featureFlags:{persist:!0,anonymous:!0},knownMethodData:{persist:!0,anonymous:!1},currentLocale:{persist:!0,anonymous:!0},identities:{persist:!0,anonymous:!1},lostIdentities:{persist:!0,anonymous:!1},forgottenPassword:{persist:!0,anonymous:!0},preferences:{persist:!0,anonymous:!0,properties:{smartTransactionsOptInStatus:{persist:!0,anonymous:!0},smartTransactionsMigrationApplied:{persist:!0,anonymous:!0},avatarType:{persist:!0,anonymous:!0}}},ipfsGateway:{persist:!0,anonymous:!1},isIpfsGatewayEnabled:{persist:!0,anonymous:!1},useAddressBarEnsResolution:{persist:!0,anonymous:!0},ledgerTransportType:{persist:!0,anonymous:!0},snapRegistryList:{persist:!0,anonymous:!1},theme:{persist:!0,anonymous:!0},snapsAddSnapAccountModalDismissed:{persist:!0,anonymous:!1},useExternalNameSources:{persist:!0,anonymous:!1},useTransactionSimulations:{persist:!0,anonymous:!0},enableMV3TimestampSave:{persist:!0,anonymous:!0},useExternalServices:{persist:!0,anonymous:!1},textDirection:{persist:!0,anonymous:!1},isMultiAccountBalancesEnabled:{persist:!0,anonymous:!0},showIncomingTransactions:{persist:!0,anonymous:!0},manageInstitutionalWallets:{persist:!0,anonymous:!1}};var d=new WeakSet;class p extends s.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:u,name:"PreferencesController",state:{...l(),...t}}),c(this,d),this.messagingSystem.subscribe("AccountsController:stateChange",function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(d,this,h).bind(this)),globalThis.setPreference=(e,t)=>this.setFeatureFlag(e,t)}setPasswordForgotten(e){this.update(t=>{t.forgottenPassword=e})}setUseBlockie(e){this.update(t=>{t.useBlockie=e})}setUsePhishDetect(e){this.update(t=>{t.usePhishDetect=e})}setUseMultiAccountBalanceChecker(e){this.update(t=>{t.useMultiAccountBalanceChecker=e})}setUseSafeChainsListValidation(e){this.update(t=>{t.useSafeChainsListValidation=e})}toggleExternalServices(e){this.update(t=>{t.useExternalServices=e}),this.setUseTokenDetection(e),this.setUseCurrencyRateCheck(e),this.setUsePhishDetect(e),this.setUseAddressBarEnsResolution(e),this.setOpenSeaEnabled(e),this.setUseNftDetection(e),this.setUseSafeChainsListValidation(e)}setUseTokenDetection(e){this.update(t=>{t.useTokenDetection=e})}setUseNftDetection(e){this.update(t=>{t.useNftDetection=e})}setUse4ByteResolution(e){this.update(t=>{t.use4ByteResolution=e})}setUseCurrencyRateCheck(e){this.update(t=>{t.useCurrencyRateCheck=e})}setOpenSeaEnabled(e){this.update(t=>{t.openSeaEnabled=e})}setSecurityAlertsEnabled(e){this.update(t=>{t.securityAlertsEnabled=e})}setAddSnapAccountEnabled(e){this.update(t=>{t.addSnapAccountEnabled=e})}setUseExternalNameSources(e){this.update(t=>{t.useExternalNameSources=e})}setUseTransactionSimulations(e){this.update(t=>{t.useTransactionSimulations=e})}setAdvancedGasFee({chainId:e,gasFeePreferences:t}){const{advancedGasFee:n}=this.state;this.update(s=>{s.advancedGasFee={...n,[e]:t}})}setTheme(e){this.update(t=>{t.theme=e})}addKnownMethodData(e,t){const{knownMethodData:n}=this.state,s={...n};s[e]=t,this.update(e=>{e.knownMethodData=s})}setCurrentLocale(e){const t=["ar","dv","fa","he","ku"].includes(e)?"rtl":"auto";return this.update(n=>{n.currentLocale=e,n.textDirection=t}),t}setSelectedAddress(e){const t=this.messagingSystem.call("AccountsController:getAccountByAddress",e);if(!t)throw new Error(`Identity for '${e} not found`);this.messagingSystem.call("AccountsController:setSelectedAccount",t.id)}getSelectedAddress(){return this.messagingSystem.call("AccountsController:getSelectedAccount").address}setAccountLabel(e,t){if(!e)throw new Error(`setAccountLabel requires a valid address, got ${String(e)}`);const n=this.messagingSystem.call("AccountsController:getAccountByAddress",e);return n?(this.messagingSystem.call("AccountsController:setAccountName",n.id,t),t):undefined}setFeatureFlag(e,t){const n={...this.state.featureFlags,[e]:t};return this.update(e=>{e.featureFlags=n}),n}setPreference(e,t){const n={...this.getPreferences(),[e]:t};return this.update(e=>{e.preferences=n}),n}getPreferences(){return this.state.preferences}getIpfsGateway(){return this.state.ipfsGateway}setIpfsGateway(e){return this.update(t=>{t.ipfsGateway=e}),e}setIsIpfsGatewayEnabled(e){this.update(t=>{t.isIpfsGatewayEnabled=e})}setUseAddressBarEnsResolution(e){this.update(t=>{t.useAddressBarEnsResolution=e})}setLedgerTransportPreference(e){return this.update(t=>{t.ledgerTransportType=e}),e}setDismissSeedBackUpReminder(e){this.update(t=>{t.dismissSeedBackUpReminder=e})}setOverrideContentSecurityPolicyHeader(e){this.update(t=>{t.overrideContentSecurityPolicyHeader=e})}setManageInstitutionalWallets(e){this.update(t=>{t.manageInstitutionalWallets=e})}setServiceWorkerKeepAlivePreference(e){this.update(t=>{t.enableMV3TimestampSave=e})}setSnapsAddSnapAccountModalDismissed(e){this.update(t=>{t.snapsAddSnapAccountModalDismissed=e})}}function h(e){const{accounts:t,selectedAccount:n}=e.internalAccounts,s=t[n],{identities:r,lostIdentities:a}=this.state,i=Object.values(t).map(e=>e.address.toLowerCase()),o=Object.keys(r).reduce((e,t)=>(i.includes(t.toLowerCase())&&(e[t]=r[t]),e),{...a??{}}),c=Object.values(t).reduce((e,t)=>(e[t.address]={address:t.address,name:t.metadata.name,lastSelected:t.metadata.lastSelected},e),{});this.update(e=>{e.identities=c,e.lostIdentities=o,e.selectedAddress=(null==s?void 0:s.address)||""})}n.PreferencesController=p}}},{package:"$root$",file:"app/scripts/controllers/preferences-controller.ts"}],[1229,{"./constants.cjs":1230,"./utils.cjs":1232,"@metamask/base-controller":1140,"@metamask/keyring-controller":1924,"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},i=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.DelegationController=n.controllerName=void 0;const o=e("@metamask/base-controller"),c=e("@metamask/keyring-controller"),l=e("@metamask/utils"),u=e("./constants.cjs"),d=e("./utils.cjs");n.controllerName="DelegationController";const p={delegations:{persist:!0,anonymous:!1}};class h extends o.BaseController{constructor({messenger:e,state:t,hashDelegation:i,getDelegationEnvironment:o}){super({messenger:e,metadata:p,name:n.controllerName,state:{delegations:{},...t}}),s.set(this,void 0),r.set(this,void 0),a(this,s,i,"f"),a(this,r,o,"f")}async signDelegation(e){const{delegation:t,chainId:n}=e,{DelegationManager:s}=i(this,r,"f").call(this,n),a=(0,d.createTypedMessageParams)({chainId:(0,l.hexToNumber)(n),from:t.delegator,delegation:{...t,signature:"0x"},verifyingContract:s});return await this.messagingSystem.call("KeyringController:signTypedMessage",a,c.SignTypedDataVersion.V4)}store(e){const{entry:t}=e,n=i(this,s,"f").call(this,t.delegation);if(!(0,d.isHexEqual)(t.delegation.authority,u.ROOT_AUTHORITY)&&!this.state.delegations[t.delegation.authority])throw new Error("Invalid authority");this.update(e=>{e.delegations[n]=t})}list(e){const t=this.messagingSystem.call("AccountsController:getSelectedAccount").address;let n=Object.values(this.state.delegations);e?.from&&(n=n.filter(t=>(0,d.isHexEqual)(t.delegation.delegator,e.from))),(!e?.from||e?.from&&!(0,d.isHexEqual)(e.from,t))&&(n=n.filter(e=>(0,d.isHexEqual)(e.delegation.delegate,t)));const s=e?.chainId;s&&(n=n.filter(e=>(0,d.isHexEqual)(e.chainId,s)));const r=e?.tags;return r&&r.length>0&&(n=n.filter(e=>r.every(t=>e.tags.includes(t)))),n}retrieve(e){return this.state.delegations[e]??null}chain(e){const t=[],n=this.retrieve(e);if(!n)return null;t.push(n);for(let e=n.delegation.authority;e!==u.ROOT_AUTHORITY;){const n=this.retrieve(e);if(!n)throw new Error("Invalid delegation chain");t.push(n),e=n.delegation.authority}return t}delete(e){if(!this.retrieve(e))return 0;const t=Object.entries(this.state.delegations),n=[e],s=[];for(;n.length>0;){const e=n.pop();t.filter(([t,n])=>n.delegation.authority===e).forEach(([e])=>{n.push(e)}),s.push(e)}return this.update(e=>{s.forEach(t=>{delete e.delegations[t]})}),s.length}}n.DelegationController=h,s=new WeakMap,r=new WeakMap}}},{package:"@metamask/delegation-controller",file:"node_modules/@metamask/delegation-controller/dist/DelegationController.cjs"}],[123,{"webextension-polyfill":5227},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getNotificationImage=async function(){return await r.default.runtime.getURL("../../images/icon-64.png")};var s,r=(s=e("webextension-polyfill"))&&s.__esModule?s:{default:s}}}},{package:"$root$",file:"app/scripts/controllers/push-notifications/get-notification-image.ts"}],[1230,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SIGNABLE_DELEGATION_TYPED_DATA=n.ROOT_AUTHORITY=void 0,n.ROOT_AUTHORITY="0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff";n.SIGNABLE_DELEGATION_TYPED_DATA={EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],Caveat:[{name:"enforcer",type:"address"},{name:"terms",type:"bytes"}],Delegation:[{name:"delegate",type:"address"},{name:"delegator",type:"address"},{name:"authority",type:"bytes32"},{name:"caveats",type:"Caveat[]"},{name:"salt",type:"uint256"}]}}}},{package:"@metamask/delegation-controller",file:"node_modules/@metamask/delegation-controller/dist/constants.cjs"}],[1231,{"./DelegationController.cjs":1229},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DelegationController=void 0;var s=e("./DelegationController.cjs");Object.defineProperty(n,"DelegationController",{enumerable:!0,get:function(){return s.DelegationController}})}}},{package:"@metamask/delegation-controller",file:"node_modules/@metamask/delegation-controller/dist/index.cjs"}],[1232,{"./constants.cjs":1230,"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createTypedMessageParams=n.toDelegationStruct=n.isHexEqual=void 0;const s=e("@metamask/utils"),r=e("./constants.cjs");n.isHexEqual=function(e,t){return e.toLowerCase()===t.toLowerCase()};n.toDelegationStruct=e=>{const t=e.caveats.map(e=>({enforcer:(0,s.getChecksumAddress)(e.enforcer),terms:e.terms,args:e.args})),n="0x"===e.salt?0n:BigInt(e.salt);return{delegate:(0,s.getChecksumAddress)(e.delegate),delegator:(0,s.getChecksumAddress)(e.delegator),authority:e.authority,caveats:t,salt:n,signature:e.signature}},n.createTypedMessageParams=function(e){const{chainId:t,from:s,delegation:a,verifyingContract:i}=e;return{data:{types:r.SIGNABLE_DELEGATION_TYPED_DATA,primaryType:"Delegation",domain:{chainId:t,name:"DelegationManager",version:"1",verifyingContract:i},message:(0,n.toDelegationStruct)(a)},from:s}}}}},{package:"@metamask/delegation-controller",file:"node_modules/@metamask/delegation-controller/dist/utils.cjs"}],[1233,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var s={DelegationManager:"0xdb9B1e94B5b69Df7e401DDbedE43491141047dB3",EntryPoint:"0x0000000071727De22E5E9d8BAf0edAc6f37da032",SimpleFactory:"0x69Aa2f9fe1572F1B640E1bbc512f5c3a734fc77c",MultiSigDeleGatorImpl:"0x56a9EdB16a0105eb5a4C54f4C062e2868844f3A7",HybridDeleGatorImpl:"0x48dBe696A4D990079e039489bA2053B36E8FFEC4",EIP7702StatelessDeleGatorImpl:"0x63c0c19a282a1B52b07dD5a65b58948A07DAE32B",AllowedCalldataEnforcer:"0xc2b0d624c1c4319760C96503BA27C347F3260f55",AllowedMethodsEnforcer:"0x2c21fD0Cb9DC8445CB3fb0DC5E7Bb0Aca01842B5",AllowedTargetsEnforcer:"0x7F20f61b1f09b08D970938F6fa563634d65c4EeB",BlockNumberEnforcer:"0x5d9818dF0AE3f66e9c3D0c5029DAF99d1823ca6c",DeployedEnforcer:"0x24ff2AA430D53a8CD6788018E902E098083dcCd2",ERC20BalanceChangeEnforcer:"0xcdF6aB796408598Cea671d79506d7D48E97a5437",ERC20TransferAmountEnforcer:"0xf100b0819427117EcF76Ed94B358B1A5b5C6D2Fc",ERC20PeriodTransferEnforcer:"0x474e3Ae7E169e940607cC624Da8A15Eb120139aB",ERC20StreamingEnforcer:"0x56c97aE02f233B29fa03502Ecc0457266d9be00e",ERC721BalanceChangeEnforcer:"0x8aFdf96eDBbe7e1eD3f5Cd89C7E084841e12A09e",ERC721TransferEnforcer:"0x3790e6B7233f779b09DA74C72b6e94813925b9aF",ERC1155BalanceChangeEnforcer:"0x63c322732695cAFbbD488Fc6937A0A7B66fC001A",ExactCalldataBatchEnforcer:"0x982FD5C86BBF425d7d1451f974192d4525113DfD",ExactCalldataEnforcer:"0x99F2e9bF15ce5eC84685604836F71aB835DBBdED",ExactExecutionBatchEnforcer:"0x1e141e455d08721Dd5BCDA1BaA6Ea5633Afd5017",ExactExecutionEnforcer:"0x146713078D39eCC1F5338309c28405ccf85Abfbb",IdEnforcer:"0xC8B5D93463c893401094cc70e66A206fb5987997",LimitedCallsEnforcer:"0x04658B29F6b82ed55274221a06Fc97D318E25416",NativeBalanceChangeEnforcer:"0xbD7B277507723490Cd50b12EaaFe87C616be6880",ArgsEqualityCheckEnforcer:"0x44B8C6ae3C304213c3e298495e12497Ed3E56E41",NativeTokenPaymentEnforcer:"0x4803a326ddED6dDBc60e659e5ed12d85c7582811",NativeTokenTransferAmountEnforcer:"0xF71af580b9c3078fbc2BBF16FbB8EEd82b330320",NativeTokenStreamingEnforcer:"0xD10b97905a320b13a0608f7E9cC506b56747df19",NativeTokenPeriodTransferEnforcer:"0x9BC0FAf4Aca5AE429F4c06aEEaC517520CB16BD9",NonceEnforcer:"0xDE4f2FAC4B3D87A1d9953Ca5FC09FCa7F366254f",OwnershipTransferEnforcer:"0x7EEf9734E7092032B5C56310Eb9BbD1f4A524681",RedeemerEnforcer:"0xE144b0b2618071B4E56f746313528a669c7E65c5",SpecificActionERC20TransferBatchEnforcer:"0x00e0251aaA263dfE3B3541B758A82D1CBA1c3B6D",TimestampEnforcer:"0x1046bb45C8d673d4ea75321280DB34899413c069",ValueLteEnforcer:"0x92Bf12322527cAA612fd31a0e810472BBB106A8F",MultiTokenPeriodEnforcer:"0xFB2f1a9BD76d3701B730E5d69C3219D42D80eBb7"},r={DelegationManager:"0x56D56e07e3d6Ee5a24e30203A37a0a460f42D7A3",EntryPoint:"0x0000000071727De22E5E9d8BAf0edAc6f37da032",SimpleFactory:"0x6ff518884f21168c30c58CB21184D6AdBC18Ad90",MultiSigDeleGatorImpl:"0xd1f421EDbA5e3FA9efe3874827114b20C5BEC40C",HybridDeleGatorImpl:"0x941f3a016F8726d5643Ce62452d0D78492D42b42",AllowedCalldataEnforcer:"0xff71d60f3208469cBCE0859717B5198042DCB3F3",AllowedMethodsEnforcer:"0xe32C2561792e8446Abe73B9f557B881C13906186",AllowedTargetsEnforcer:"0x06aaE4c67EEA95277c46Bf79b1583d4a01772D22",BlockNumberEnforcer:"0x8E470D2Ae278457b42d2405E0B8Cd4BE21Ed9045",DeployedEnforcer:"0xf9088f013dBD9ebb7Cebd66fEB48253c6Ac5a820",ERC20BalanceGteEnforcer:"0xB7B6f32ec6343261D814e55Ed8C5925d91Cab861",ERC20TransferAmountEnforcer:"0x9A069b18032B31429A363AeCFb1B6A0564b44471",IdEnforcer:"0x91015c3b9D9523966eD2399885e5Df7A567f916c",LimitedCallsEnforcer:"0xe694bFfffEA3E85923b1210b37e6a0175e910863",NonceEnforcer:"0xE83BCFD8bBE672A96747e831050a91cf44F4F87A",TimestampEnforcer:"0x550FdD13eEBC1f22ea2a2480024BacBF0Ad7e5CE",ValueLteEnforcer:"0xBE32a6DB7471F63BB168C088c57Db01AfAe87967",NativeTokenTransferAmountEnforcer:"0x5eD3833d7B957A8DB8A461c3AF2d668Ec25382E0",NativeBalanceGteEnforcer:"0x376a98860E210DdEda3689fb39565592c563cB0A",ArgsEqualityCheckEnforcer:"0x7378dE585998d3E18Ce147867C335C25B3dB8Ee5",NativeTokenPaymentEnforcer:"0x87Fe18EbF99e42fcE8A03a25F1d20E119407f8e7",RedeemerEnforcer:"0x926672b130D1EF60A9d6b11D2048d121b30f40C1"},a={DelegationManager:"0xbe4138886cb096bdc1b930f2f0ca7892aa234d78",EntryPoint:"0x0000000071727De22E5E9d8BAf0edAc6f37da032",SimpleFactory:"0x6ff518884f21168c30c58CB21184D6AdBC18Ad90",MultiSigDeleGatorImpl:"0x11f555af5844d85bfcf5d61d2a22866527eb585a",HybridDeleGatorImpl:"0xd6edd1256deccb2b06bdecef92dc16bcf26e531b",AllowedCalldataEnforcer:"0x48db3835a873d64a4af2c09f014052407c003bd7",AllowedMethodsEnforcer:"0xfd731951bf1c52afccee3e6f14ab656475b76dd4",AllowedTargetsEnforcer:"0xbc8673c0afa52d86d991c06881e55b2966920564",BlockNumberEnforcer:"0xc15faffa0d879b9263c15a46ce31eacfa2e0e8ae",DeployedEnforcer:"0x5accb9559b56a6c1e3f90e342c85c42d93720d43",ERC20BalanceGteEnforcer:"0xb5d6b1ec6d868a3bae5b7f48178eaa2686a7a087",ERC20TransferAmountEnforcer:"0x92ac423b9c111962179a6242e1adb58d02c103be",IdEnforcer:"0x34152d9f3f8f74338d50703e780389e829b4abac",LimitedCallsEnforcer:"0x4b3adad4a328bee8ba17b86074d92fe7372180cd",NonceEnforcer:"0x2f32ff3fc3086d7f63f16fe8d0065390d460b40d",TimestampEnforcer:"0x78e05f779490c24bf3bfa135b4112e7003b321cd",ValueLteEnforcer:"0xfc20ede0a1132e839fbda9d7ed3904ff3c89540f"},i={mainnet:1,polygon:137,bsc:56,optimism:10,arbitrum:42161,linea:59144,base:8453,gnosis:100,sepolia:11155111,lineaSepolia:59141,baseSepolia:84532,megaEthTestnet:6342,chiado:10200,lineaGoerli:59140},o={"1.0.0":{[i.optimism]:a,[i.polygon]:a,[i.base]:a,[i.arbitrum]:a,[i.linea]:a,[i.sepolia]:{...a,HybridDeleGatorImpl:"0x5989F5D13DF8fc818EdA65e417AED90459fD67F7"},[i.lineaSepolia]:{...a,HybridDeleGatorImpl:"0x5989F5D13DF8fc818EdA65e417AED90459fD67F7"}},"1.1.0":{[i.arbitrum]:r,[i.base]:r,[i.linea]:r,[i.optimism]:r,[i.polygon]:r,[i.sepolia]:r,[i.lineaSepolia]:r,[i.baseSepolia]:{...r,SimpleFactory:"0xE8eA1DE8D6AfE400B7C8C1A81B7C29B7876b4d02"}},"1.3.0":{[i.mainnet]:s,[i.polygon]:s,[i.bsc]:s,[i.optimism]:s,[i.arbitrum]:s,[i.linea]:s,[i.base]:s,[i.gnosis]:s,[i.sepolia]:s,[i.lineaSepolia]:s,[i.baseSepolia]:s,[i.megaEthTestnet]:s,[i.chiado]:s}};n.CHAIN_ID=i,n.DELEGATOR_CONTRACTS=o}}},{package:"@metamask/delegation-deployments",file:"node_modules/@metamask/delegation-deployments/dist/index.js"}],[124,{"../../../../shared/lib/translate":5347,"@metamask/notification-services-controller":2070},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createNotificationMessage=function(e){return s.NotificationServicesPushController.Utils.createOnChainPushNotificationMessage(e,i)};var s=e("@metamask/notification-services-controller"),r=e("../../../../shared/lib/translate");const a=(...e)=>(0,r.t)(...e)??"",i={...{pushPlatformNotificationsFundsSentTitle:()=>a("pushPlatformNotificationsFundsSentTitle"),pushPlatformNotificationsFundsSentDescriptionDefault:()=>a("pushPlatformNotificationsFundsSentDescriptionDefault"),pushPlatformNotificationsFundsSentDescription:(e,t)=>a("pushPlatformNotificationsFundsSentDescription",e,t),pushPlatformNotificationsFundsReceivedTitle:()=>a("pushPlatformNotificationsFundsReceivedTitle"),pushPlatformNotificationsFundsReceivedDescriptionDefault:()=>a("pushPlatformNotificationsFundsReceivedDescriptionDefault"),pushPlatformNotificationsFundsReceivedDescription:(e,t)=>a("pushPlatformNotificationsFundsReceivedDescription",e,t),pushPlatformNotificationsSwapCompletedTitle:()=>a("pushPlatformNotificationsSwapCompletedTitle"),pushPlatformNotificationsSwapCompletedDescription:()=>a("pushPlatformNotificationsSwapCompletedDescription"),pushPlatformNotificationsNftSentTitle:()=>a("pushPlatformNotificationsNftSentTitle"),pushPlatformNotificationsNftSentDescription:()=>a("pushPlatformNotificationsNftSentDescription"),pushPlatformNotificationsNftReceivedTitle:()=>a("pushPlatformNotificationsNftReceivedTitle"),pushPlatformNotificationsNftReceivedDescription:()=>a("pushPlatformNotificationsNftReceivedDescription"),pushPlatformNotificationsStakingRocketpoolStakeCompletedTitle:()=>a("pushPlatformNotificationsStakingRocketpoolStakeCompletedTitle"),pushPlatformNotificationsStakingRocketpoolStakeCompletedDescription:()=>a("pushPlatformNotificationsStakingRocketpoolStakeCompletedDescription"),pushPlatformNotificationsStakingRocketpoolUnstakeCompletedTitle:()=>a("pushPlatformNotificationsStakingRocketpoolUnstakeCompletedTitle"),pushPlatformNotificationsStakingRocketpoolUnstakeCompletedDescription:()=>a("pushPlatformNotificationsStakingRocketpoolUnstakeCompletedDescription"),pushPlatformNotificationsStakingLidoStakeCompletedTitle:()=>a("pushPlatformNotificationsStakingLidoStakeCompletedTitle"),pushPlatformNotificationsStakingLidoStakeCompletedDescription:()=>a("pushPlatformNotificationsStakingLidoStakeCompletedDescription"),pushPlatformNotificationsStakingLidoStakeReadyToBeWithdrawnTitle:()=>a("pushPlatformNotificationsStakingLidoStakeReadyToBeWithdrawnTitle"),pushPlatformNotificationsStakingLidoStakeReadyToBeWithdrawnDescription:()=>a("pushPlatformNotificationsStakingLidoStakeReadyToBeWithdrawnDescription"),pushPlatformNotificationsStakingLidoWithdrawalRequestedTitle:()=>a("pushPlatformNotificationsStakingLidoWithdrawalRequestedTitle"),pushPlatformNotificationsStakingLidoWithdrawalRequestedDescription:()=>a("pushPlatformNotificationsStakingLidoWithdrawalRequestedDescription"),pushPlatformNotificationsStakingLidoWithdrawalCompletedTitle:()=>a("pushPlatformNotificationsStakingLidoWithdrawalCompletedTitle"),pushPlatformNotificationsStakingLidoWithdrawalCompletedDescription:()=>a("pushPlatformNotificationsStakingLidoWithdrawalCompletedDescription")},...{PositionLiquidatedTitle:()=>a("pushNotificationPositionLiquidatedTitle"),PositionLiquidatedDescriptionLong:e=>a("pushNotificationPositionLiquidatedDescriptionLong",e),PositionLiquidatedDescriptionShort:e=>a("pushNotificationPositionLiquidatedDescriptionShort",e),StopLossTriggeredTitle:()=>a("pushNotificationStopLossTriggeredTitle"),StopLossTriggeredDescriptionLong:e=>a("pushNotificationStopLossTriggeredDescriptionLong",e),StopLossTriggeredDescriptionShort:e=>a("pushNotificationStopLossTriggeredDescriptionShort",e),TakeProfitTriggeredTitle:()=>a("pushNotificationTakeProfitTriggeredTitle"),TakeProfitTriggeredDescriptionLong:e=>a("pushNotificationTakeProfitTriggeredDescriptionLong",e),TakeProfitTriggeredDescriptionShort:e=>a("pushNotificationTakeProfitTriggeredDescriptionShort",e),LimitOrderFilledTitle:()=>a("pushNotificationLimitOrderFilledTitle"),LimitOrderFilledDescriptionLong:e=>a("pushNotificationLimitOrderFilledDescriptionLong",e),LimitOrderFilledDescriptionShort:e=>a("pushNotificationLimitOrderFilledDescriptionShort",e)}}}}},{package:"$root$",file:"app/scripts/controllers/push-notifications/get-notification-message.ts"}],[125,{"../../platforms/extension":447,"./get-notification-image":123,"./get-notification-message":124},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.onPushNotificationClicked=async function(e,t){var n;e.notification.close();const s=t??(null==e||null===(n=e.notification)||void 0===n?void 0:n.data),r=`${c.getExtensionURL(null,null)}#notifications/${s.id}`;e.waitUntil(o.clients.openWindow(r))},n.onPushNotificationReceived=async function(e){const t=(0,i.createNotificationMessage)(e);if(!t)return;const n=null==o?void 0:o.registration;if(!n)return;const s=await(0,a.getNotificationImage)();await n.showNotification(t.title,{body:t.description,icon:s,tag:null==e?void 0:e.id,data:e})};var s,r=(s=e("../../platforms/extension"))&&s.__esModule?s:{default:s},a=e("./get-notification-image"),i=e("./get-notification-message");const o=self,c=new r.default}}},{package:"$root$",file:"app/scripts/controllers/push-notifications/index.ts"}],[126,{"../../../../shared/constants/common":5247,"../../../../shared/constants/gas":5252,"../../../../shared/constants/metametrics":5259,"../../../../shared/constants/network":5262,"../../../../shared/constants/smartTransactions":5271,"../../../../shared/constants/swaps":5275,"../../../../shared/constants/time":5277,"../../../../shared/lib/fetch-with-cache":5324,"../../../../shared/lib/sentry":5336,"../../../../shared/lib/swaps-utils":5339,"../../../../shared/lib/transactions-controller-utils":5344,"../../../../shared/modules/Numeric":5349,"../../../../shared/modules/conversion.utils":5354,"../../../../shared/modules/string-utils":5375,"../../../../shared/modules/swaps.utils":5376,"./swaps.constants":127,"./swaps.utils":128,"@ethersproject/contracts":595,"@ethersproject/providers":633,"@metamask/base-controller":1140,"bignumber.js":3481,"human-standard-token-abi":4148,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("@ethersproject/contracts"),r=e("@ethersproject/providers"),a=e("@metamask/base-controller"),i=e("bignumber.js"),o=_(e("human-standard-token-abi")),c=e("lodash"),l=e("../../../../shared/lib/sentry"),u=e("../../../../shared/constants/common"),d=e("../../../../shared/constants/gas"),p=e("../../../../shared/constants/metametrics"),h=e("../../../../shared/constants/network"),m=e("../../../../shared/constants/smartTransactions"),f=e("../../../../shared/constants/swaps"),g=e("../../../../shared/constants/time"),y=_(e("../../../../shared/lib/fetch-with-cache")),w=e("../../../../shared/lib/swaps-utils"),b=e("../../../../shared/lib/transactions-controller-utils"),E=e("../../../../shared/modules/conversion.utils"),v=e("../../../../shared/modules/Numeric"),T=e("../../../../shared/modules/string-utils"),S=e("../../../../shared/modules/swaps.utils"),A=e("./swaps.constants"),k=e("./swaps.utils");function _(e){return e&&e.__esModule?e:{default:e}}function M(e,t,n){C(e,t),t.set(e,n)}function C(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function P(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e,t){return e.get(O(e,t))}function N(e,t,n){return e.set(O(e,t),n),n}function O(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const D={swapsState:{persist:!1,anonymous:!1}};var j=new WeakMap,R=new WeakMap,L=new WeakMap,B=new WeakMap,x=new WeakMap,U=new WeakMap,F=new WeakSet;class G extends a.BaseController{constructor(e,t){var n,s,r;super({name:A.controllerName,metadata:D,messenger:e.messenger,state:{swapsState:{...(0,A.getDefaultSwapsControllerState)().swapsState,swapsFeatureFlags:(null==t||null===(n=t.swapsState)||void 0===n?void 0:n.swapsFeatureFlags)||{}}}}),C(s=this,r=F),r.add(s),P(this,"getBufferedGasLimit",void 0),P(this,"resetState",void 0),P(this,"trackMetaMetricsEvent",void 0),M(this,j,void 0),M(this,R,void 0),M(this,L,null),M(this,B,void 0),M(this,x,void 0),M(this,U,void 0),P(this,"_fetchTradesInfo",w.fetchTradesInfo),P(this,"__test__updateState",e=>{this.update(t=>({swapsState:{...t.swapsState,...e.swapsState}}))}),this.messagingSystem.registerActionHandler("SwapsController:fetchAndSetQuotes",this.fetchAndSetQuotes.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSelectedQuoteAggId",this.setSelectedQuoteAggId.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:resetSwapsState",this.resetSwapsState.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsTokens",this.setSwapsTokens.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:clearSwapsQuotes",this.clearSwapsQuotes.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setApproveTxId",this.setApproveTxId.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setTradeTxId",this.setTradeTxId.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsTxGasPrice",this.setSwapsTxGasPrice.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsTxGasLimit",this.setSwapsTxGasLimit.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsTxMaxFeePerGas",this.setSwapsTxMaxFeePerGas.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsTxMaxFeePriorityPerGas",this.setSwapsTxMaxFeePriorityPerGas.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:safeRefetchQuotes",this.safeRefetchQuotes.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:stopPollingForQuotes",this.stopPollingForQuotes.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setBackgroundSwapRouteState",this.setBackgroundSwapRouteState.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:resetPostFetchState",this.resetPostFetchState.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsErrorKey",this.setSwapsErrorKey.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setInitialGasEstimate",this.setInitialGasEstimate.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setCustomApproveTxData",this.setCustomApproveTxData.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsLiveness",this.setSwapsLiveness.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsFeatureFlags",this.setSwapsFeatureFlags.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsUserFeeLevel",this.setSwapsUserFeeLevel.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsQuotesPollingLimitEnabled",this.setSwapsQuotesPollingLimitEnabled.bind(this)),this.getBufferedGasLimit=e.getBufferedGasLimit,this.trackMetaMetricsEvent=e.trackMetaMetricsEvent,this.resetState=()=>{this.update(e=>{e.swapsState={...(0,A.getDefaultSwapsControllerState)().swapsState,swapsFeatureFlags:null==e?void 0:e.swapsState.swapsFeatureFlags}})},N(B,this,e.getEIP1559GasFeeEstimates),N(x,this,e.getLayer1GasFee),N(j,this,0),N(R,this,0),this._fetchTradesInfo=e.fetchTradesInfo||w.fetchTradesInfo}clearSwapsQuotes(){this.update(e=>{e.swapsState.quotes={},e.swapsState.selectedAggId=null,e.swapsState.topAggId=null})}async fetchAndSetQuotes(e,t,n=!1){var s;if(!e)return null;let r;r=(null===(s=I(U,this))||void 0===s?void 0:s.clientId)===t.networkClientId?I(U,this):O(F,this,$).call(this,t.networkClientId);const{quotesPollingLimitEnabled:a,saveFetchedQuotes:i}=this.state.swapsState;n||N(R,this,0),I(L,this)&&clearTimeout(I(L,this)),n||this.setSwapsErrorKey("");const o=I(j,this)+1;N(j,this,o),i||this._setSaveFetchedQuotes(!0);let[l]=await Promise.all([this._fetchTradesInfo(e,{chainId:r.chainId}),this._setSwapsNetworkConfig(r)]);const{saveFetchedQuotes:u}=this.state.swapsState;if(!u)return[{},null];l=(0,c.mapValues)(l,e=>({...e,sourceTokenInfo:null==t?void 0:t.sourceTokenInfo,destinationTokenInfo:null==t?void 0:t.destinationTokenInfo}));const d=r.chainId===h.CHAIN_IDS.OPTIMISM.toString(),p=r.chainId===h.CHAIN_IDS.BASE.toString();(d||p)&&Object.values(l).length>0&&await Promise.all(Object.values(l).map(async e=>{if(e.trade){const t=await I(x,this).call(this,{transactionParams:e.trade,networkClientId:r.clientId});e.multiLayerL1TradeFeeTotal=t}return e}));const m=Date.now();let g=!1;if(!(0,S.isSwapsDefaultTokenAddress)(e.sourceToken,r.chainId)&&Object.values(l).length){const t=await this._getERC20Allowance(e.sourceToken,e.fromAddress,r),[s]=Object.values(l);if(g=s.approvalNeeded&&(t.eq(0)||t.lt(s.sourceAmount))&&"wrappedNative"!==s.aggregator,g){if(!n&&s.approvalNeeded){const{gasLimit:e}=await this._timedoutGasReturn(s.approvalNeeded,s.aggregator);l=(0,c.mapValues)(l,t=>t.approvalNeeded?{...t,approvalNeeded:{...t.approvalNeeded,gas:e||f.DEFAULT_ERC20_APPROVE_GAS}}:t)}}else l=(0,c.mapValues)(l,e=>({...e,approvalNeeded:null}))}let y=null;if(g||null!=e&&e.balanceError||(l=await this._getAllQuotesWithGasEstimates(l)),0===Object.values(l).length)this.setSwapsErrorKey(f.QUOTES_NOT_AVAILABLE_ERROR);else{const e=await this.getTopQuoteWithCalculatedSavings({quotes:l});Array.isArray(e)&&(y=e[0],l=e[1])}if(I(j,this)!==o)throw new Error(f.SWAPS_FETCH_ORDER_CONFLICT);let{selectedAggId:w}=this.state.swapsState;return w&&l[w]||(w=null),this.update(n=>{n.swapsState.quotes=l,n.swapsState.fetchParams={...e,metaData:t},n.swapsState.quotesLastFetched=m,n.swapsState.selectedAggId=w,n.swapsState.topAggId=y}),a&&N(R,this,I(R,this)+1),!a||I(R,this)<A.POLL_COUNT_LIMIT+1?(this._pollForNewQuotes(),[l,y]):(this.resetPostFetchState(),this.setSwapsErrorKey(f.QUOTES_EXPIRED_ERROR),null)}async getTopQuoteWithCalculatedSavings({quotes:e,networkClientId:t}){var n;let s;if(t){const e=this.messagingSystem.call("NetworkController:getNetworkClientById",t);s=e.configuration.chainId}else{if(I(U,this)===undefined)throw new Error("There is no network set");s=I(U,this).chainId}const{marketData:r}=this._getTokenRatesState(),a=(null==r?void 0:r[s])??{},{customGasPrice:o,customMaxPriorityFeePerGas:l}=this.state.swapsState;if(0===Object.keys(e).length)return{};const p=(0,c.cloneDeep)(e),{gasFeeEstimates:h,gasEstimateType:m}=await I(B,this).call(this,{networkClientId:t});let f="0x0";if(m===d.GasEstimateTypes.feeMarket){const{high:{suggestedMaxPriorityFeePerGas:e},estimatedBaseFee:t}=h,n=(0,E.decGWEIToHexWEI)(Number(e)),s=new v.Numeric(t,10,u.EtherDenomination.GWEI).toDenomination(u.EtherDenomination.WEI);f=new v.Numeric(l||n,16).add(s).round(6).toString()}else m===d.GasEstimateTypes.legacy?f=o||(0,E.decGWEIToHexWEI)(Number(h.high)):m===d.GasEstimateTypes.ethGasPrice&&(f=o||(0,E.decGWEIToHexWEI)(Number(h.gasPrice)));let g,y="";Object.values(p).forEach(e=>{const{aggregator:t,approvalNeeded:n,averageGas:r,destinationAmount:o,destinationToken:c,destinationTokenInfo:l,gasEstimateWithRefund:d,sourceAmount:p,sourceToken:h,trade:m,fee:w,multiLayerL1TradeFeeTotal:k}=e;if(!m||!c)return;const _=(d?new i.BigNumber(d,16):new i.BigNumber(r||A.MAX_GAS_LIMIT,10)).plus((null==n?void 0:n.gas)||"0x0",16).toString(16);let M=(0,b.calcGasTotal)(_,f);null!==k&&(M=(0,E.sumHexes)(M||"0x0",k||"0x0"));const C=new v.Numeric(M,16,u.EtherDenomination.WEI).add(new v.Numeric(m.value,16,u.EtherDenomination.WEI)),P=C.toDenomination(u.EtherDenomination.ETH).round(6).value,I=(0,S.isSwapsDefaultTokenAddress)(h,s)?C.minus(new v.Numeric(p,10)).toDenomination(u.EtherDenomination.ETH).round(6).value:P,N=(0,b.calcTokenAmount)(o??"0",l.decimals),O=new i.BigNumber(100,10).minus(w,10).div(100),D=N.div(O).minus(N),j=Object.keys(a).find(e=>(0,T.isEqualCaseInsensitive)(e,c)),R=j?a[j]:null,L=(null==R?void 0:R.price)||1,B=N.times(L.toString(10),10),x=(0,S.isSwapsDefaultTokenAddress)(c,s)?1:null==R?void 0:R.price,U=x?B.minus(I,10):B;e.ethFee=I.toString(10),x&&(e.ethValueOfTokens=B.toString(10),e.overallValueOfQuote=U.toString(10),e.metaMaskFeeInEth=D.times(x.toString(10)).toString(10)),g&&!U.gt(g||0)||(y=t,g=U)});const w=Object.keys(a).find(e=>{var t;return(0,T.isEqualCaseInsensitive)(e,null===(t=p[y])||void 0===t?void 0:t.destinationToken)}),_=w?a[w]:null;if((0,S.isSwapsDefaultTokenAddress)(null===(n=p[y])||void 0===n?void 0:n.destinationToken,s)||Boolean(null==_?void 0:_.price)){const e=p[y],{ethFee:t,metaMaskFeeInEth:n,ethValueOfTokens:s}=(0,k.getMedianEthValueQuote)(Object.values(p)),r=new i.BigNumber(e.ethValueOfTokens,10).minus(s,10).toString(10),a=new i.BigNumber(t).minus(e.ethFee,10).toString(10),o=e.metaMaskFeeInEth,c={performance:r,fee:a,total:new i.BigNumber(r).plus(a).minus(o).toString(10),metaMaskFee:o,medianMetaMaskFee:n};p[y].isBestQuote=!0,p[y].savings=c}return[y,p]}resetPostFetchState(){this.update(e=>{e.swapsState={...(0,A.getDefaultSwapsControllerState)().swapsState,tokens:e.swapsState.tokens,fetchParams:e.swapsState.fetchParams,swapsFeatureIsLive:e.swapsState.swapsFeatureIsLive,swapsQuoteRefreshTime:e.swapsState.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsState.swapsQuotePrefetchingRefreshTime,swapsFeatureFlags:e.swapsState.swapsFeatureFlags}}),I(L,this)&&clearTimeout(I(L,this))}resetSwapsState(){this.update(e=>{e.swapsState={...(0,A.getDefaultSwapsControllerState)().swapsState,swapsQuoteRefreshTime:e.swapsState.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsState.swapsQuotePrefetchingRefreshTime,swapsFeatureFlags:e.swapsState.swapsFeatureFlags}}),I(L,this)&&clearTimeout(I(L,this))}safeRefetchQuotes(){!I(L,this)&&this.state.swapsState.fetchParams&&this.fetchAndSetQuotes(this.state.swapsState.fetchParams,{...this.state.swapsState.fetchParams.metaData})}setApproveTxId(e){this.update(t=>{t.swapsState.approveTxId=e})}setBackgroundSwapRouteState(e){this.update(t=>{t.swapsState.routeState=e})}setCustomApproveTxData(e){this.update(t=>{t.swapsState.customApproveTxData=e})}async setInitialGasEstimate(e){const t={...this.state.swapsState.quotes[e]},{gasLimit:n,simulationFails:s}=t.trade?await this._timedoutGasReturn(t.trade,t.aggregator):{gasLimit:null,simulationFails:!0};if(n&&!s){const e=(0,k.calculateGasEstimateWithRefund)(t.maxGas,t.estimatedRefund,n);t.gasEstimate=n,t.gasEstimateWithRefund=e}this.update(n=>{n.swapsState.quotes={...n.swapsState.quotes,[e]:t}})}setSelectedQuoteAggId(e){this.update(t=>{t.swapsState.selectedAggId=e})}setSwapsFeatureFlags(e){this.update(t=>{t.swapsState.swapsFeatureFlags=e})}setSwapsErrorKey(e){this.update(t=>{t.swapsState.errorKey=e})}setSwapsLiveness(e){const{swapsFeatureIsLive:t}=e;this.update(e=>{e.swapsState.swapsFeatureIsLive=t})}setSwapsQuotesPollingLimitEnabled(e){this.update(t=>{t.swapsState.quotesPollingLimitEnabled=e})}setSwapsTokens(e){this.update(t=>{t.swapsState.tokens=e})}setSwapsTxGasLimit(e){this.update(t=>{t.swapsState.customMaxGas=e})}setSwapsTxGasPrice(e){this.update(t=>{t.swapsState.customGasPrice=e})}setSwapsTxMaxFeePerGas(e){this.update(t=>{t.swapsState.customMaxFeePerGas=e})}setSwapsTxMaxFeePriorityPerGas(e){this.update(t=>{t.swapsState.customMaxPriorityFeePerGas=e})}setSwapsUserFeeLevel(e){this.update(t=>{t.swapsState.swapsUserFeeLevel=e})}setTradeTxId(e){this.update(t=>{t.swapsState.tradeTxId=e})}stopPollingForQuotes(){I(L,this)&&clearTimeout(I(L,this))}async _fetchSwapsNetworkConfig(e){const t=await(0,y.default)({url:(0,w.getBaseApi)("network",e.chainId),fetchOptions:{method:"GET"},cacheOptions:{cacheRefreshTime:6e5},functionName:"_fetchSwapsNetworkConfig"}),{refreshRates:n,parameters:s={}}=t||{};if(!n||"number"!=typeof n.quotes||"number"!=typeof n.quotesPrefetching)throw new Error(`MetaMask - invalid response for refreshRates: ${t}`);return{quotes:1e3*n.quotes,quotesPrefetching:1e3*n.quotesPrefetching,stxGetTransactions:1e3*n.stxGetTransactions,stxBatchStatus:1e3*n.stxBatchStatus,stxStatusDeadline:n.stxStatusDeadline,stxMaxFeeMultiplier:s.stxMaxFeeMultiplier}}async _getAllQuotesWithGasEstimates(e){const t=await Promise.all(Object.values(e).map(async e=>{if(!e.trade)return{gasLimit:null,simulationFails:!0,aggId:e.aggregator};const{gasLimit:t,simulationFails:n}=await this._timedoutGasReturn(e.trade,e.aggregator);return{gasLimit:t,simulationFails:n,aggId:e.aggregator}})),n={};return t.forEach(({gasLimit:t,simulationFails:s,aggId:r})=>{if(t&&!s){const s=(0,k.calculateGasEstimateWithRefund)(e[r].maxGas,e[r].estimatedRefund,t);n[r]={...e[r],gasEstimate:t,gasEstimateWithRefund:s}}else e[r].approvalNeeded&&(n[r]=e[r])}),n}async _getERC20Allowance(e,t,n){const r=new s.Contract(e,o.default,n.ethersProvider);return await r.allowance(t,f.SWAPS_CHAINID_CONTRACT_ADDRESS_MAP[n.chainId])}_getTokenRatesState(){const{marketData:e}=this.messagingSystem.call("TokenRatesController:getState");return{marketData:e}}_pollForNewQuotes(){const{swapsQuoteRefreshTime:e,swapsQuotePrefetchingRefreshTime:t,quotesPollingLimitEnabled:n}=this.state.swapsState;N(L,this,setTimeout(()=>{var e;this.fetchAndSetQuotes(this.state.swapsState.fetchParams,null===(e=this.state.swapsState.fetchParams)||void 0===e?void 0:e.metaData,!0)},n?e:t))}_setSaveFetchedQuotes(e){this.update(t=>{t.swapsState.saveFetchedQuotes=e})}async _setSwapsNetworkConfig(e){let t=null;try{t=await this._fetchSwapsNetworkConfig(e)}catch(e){console.error("Request for Swaps network config failed: ",e)}this.update(e=>{var n,s,r,a,i,o;e.swapsState.swapsQuoteRefreshTime=(null===(n=t)||void 0===n?void 0:n.quotes)||A.FALLBACK_QUOTE_REFRESH_TIME,e.swapsState.swapsQuotePrefetchingRefreshTime=(null===(s=t)||void 0===s?void 0:s.quotesPrefetching)||A.FALLBACK_QUOTE_REFRESH_TIME,e.swapsState.swapsStxGetTransactionsRefreshTime=(null===(r=t)||void 0===r?void 0:r.stxGetTransactions)||m.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,e.swapsState.swapsStxBatchStatusRefreshTime=(null===(a=t)||void 0===a?void 0:a.stxBatchStatus)||m.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,e.swapsState.swapsStxMaxFeeMultiplier=(null===(i=t)||void 0===i?void 0:i.stxMaxFeeMultiplier)||m.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER,e.swapsState.swapsStxStatusDeadline=(null===(o=t)||void 0===o?void 0:o.stxStatusDeadline)||m.FALLBACK_SMART_TRANSACTIONS_DEADLINE})}_timedoutGasReturn(e,t=""){return new Promise(n=>{let s=!1;const r=setTimeout(()=>{s=!0,this.trackMetaMetricsEvent({event:p.MetaMetricsEventName.QuoteError,category:p.MetaMetricsEventCategory.Swaps,properties:{error_type:p.MetaMetricsEventErrorType.GasTimeout,aggregator:t}}),n({gasLimit:null,simulationFails:!0})},5*g.SECOND),a={data:e.data,from:e.from,to:e.to,value:e.value};this.getBufferedGasLimit({txParams:a},1).then(({gasLimit:e,simulationFails:t})=>{s||(clearTimeout(r),n({gasLimit:e,simulationFails:t}))}).catch(e=>{(0,l.captureException)(e,{extra:{aggregator:t}}),s||(clearTimeout(r),n({gasLimit:null,simulationFails:!0}))})})}}function $(e){const t=this.messagingSystem.call("NetworkController:getNetworkClientById",e),{chainId:n}=t.configuration,s={client:t,clientId:e,chainId:n,ethersProvider:new r.Web3Provider(t.provider)};return N(U,this,s),s}n.default=G}}},{package:"$root$",file:"app/scripts/controllers/swaps/index.ts"}],[127,{"../../../../shared/constants/smartTransactions":5271,"../../../../shared/constants/time":5277},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.controllerName=n.POLL_COUNT_LIMIT=n.MAX_GAS_LIMIT=n.FALLBACK_QUOTE_REFRESH_TIME=void 0,n.getDefaultSwapsControllerState=function(){return{swapsState:{quotes:{},quotesPollingLimitEnabled:!1,fetchParams:null,tokens:null,tradeTxId:null,approveTxId:null,quotesLastFetched:null,customMaxGas:"",customGasPrice:null,customMaxFeePerGas:null,customMaxPriorityFeePerGas:null,swapsUserFeeLevel:"",selectedAggId:null,customApproveTxData:"",errorKey:"",topAggId:null,routeState:"",swapsFeatureIsLive:!0,saveFetchedQuotes:!1,swapsQuoteRefreshTime:a,swapsQuotePrefetchingRefreshTime:a,swapsStxBatchStatusRefreshTime:s.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxStatusDeadline:s.FALLBACK_SMART_TRANSACTIONS_DEADLINE,swapsStxGetTransactionsRefreshTime:s.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxMaxFeeMultiplier:s.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER,swapsFeatureFlags:{}}}};var s=e("../../../../shared/constants/smartTransactions"),r=e("../../../../shared/constants/time");n.controllerName="SwapsController",n.MAX_GAS_LIMIT=25e5,n.POLL_COUNT_LIMIT=3;const a=n.FALLBACK_QUOTE_REFRESH_TIME=r.MINUTE}}},{package:"$root$",file:"app/scripts/controllers/swaps/swaps.constants.ts"}],[128,{"./swaps.constants":127,"bignumber.js":3481},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.calculateGasEstimateWithRefund=function(e=r.MAX_GAS_LIMIT,t="0",n="0"){const a=new s.BigNumber(e,10).minus(t,10),i=a.lt(0);return!i&&a.lt(n,16)?`0x${a.toString(16)}`:n},n.getMedianEthValueQuote=function(e){if(!Array.isArray(e)||0===e.length)throw new Error("Expected non-empty array param.");const t=[...e];if(t.sort((e,t)=>{const n=new s.BigNumber(e.overallValueOfQuote,10),r=new s.BigNumber(t.overallValueOfQuote,10);return n.equals(r)?0:n.lessThan(r)?-1:1}),t.length%2==1){const e=t[(t.length-1)/2].overallValueOfQuote;return a(t.filter(t=>e===t.overallValueOfQuote))}const n=t.length/2,r=n-1,i=t[n].overallValueOfQuote,o=t[r].overallValueOfQuote,c=t.filter(e=>i===e.overallValueOfQuote),l=t.filter(e=>o===e.overallValueOfQuote),u=a(c),d=a(l);return{ethFee:new s.BigNumber(u.ethFee,10).plus(d.ethFee,10).dividedBy(2).toString(10),metaMaskFeeInEth:new s.BigNumber(u.metaMaskFeeInEth,10).plus(d.metaMaskFeeInEth,10).dividedBy(2).toString(10),ethValueOfTokens:new s.BigNumber(u.ethValueOfTokens,10).plus(d.ethValueOfTokens,10).dividedBy(2).toString(10)}},n.meansOfQuotesFeesAndValue=a;var s=e("bignumber.js"),r=e("./swaps.constants");function a(e){const t=e.reduce((e,t)=>({ethFee:e.ethFee.plus(t.ethFee,10),metaMaskFeeInEth:e.metaMaskFeeInEth.plus(t.metaMaskFeeInEth,10),ethValueOfTokens:e.ethValueOfTokens.plus(t.ethValueOfTokens,10)}),{ethFee:new s.BigNumber(0,10),metaMaskFeeInEth:new s.BigNumber(0,10),ethValueOfTokens:new s.BigNumber(0,10)});return{ethFee:t.ethFee.div(e.length,10).toString(10),metaMaskFeeInEth:t.metaMaskFeeInEth.div(e.length,10).toString(10),ethValueOfTokens:t.ethValueOfTokens.div(e.length,10).toString(10)}}}}},{package:"$root$",file:"app/scripts/controllers/swaps/swaps.utils.ts"}],[129,{"../../shared/constants/app":5244,"./lib/util":237,"webextension-polyfill":5227},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.onMessageReceived=n.checkForMultipleVersionsRunning=void 0;var s,r=(s=e("webextension-polyfill"))&&s.__esModule?s:{default:s},a=e("../../shared/constants/app"),i=e("./lib/util");const o="isRunning";n.onMessageReceived=e=>{e===o&&console.warn("Warning! You have multiple instances of MetaMask running!")};n.checkForMultipleVersionsRunning=async()=>{if((0,i.getPlatform)()!==a.PLATFORM_CHROME&&(0,i.getPlatform)()!==a.PLATFORM_FIREFOX)return;const e=(0,i.getPlatform)()===a.PLATFORM_CHROME?a.CHROME_BUILD_IDS:a.FIREFOX_BUILD_IDS,t=r.default.runtime.id;for(const n of e)if(n!==t)try{await r.default.runtime.sendMessage(n,o)}catch(e){}}}}},{package:"$root$",file:"app/scripts/detect-multiple-instances.js"}],[13,{"../../../../shared/constants/network":5262,"../../controllers/network-order":114,"@metamask/keyring-api":1914,"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateAndFixNetworkState=n.NetworkOrderControllerInit=void 0;var s=e("@metamask/keyring-api"),r=e("@metamask/utils"),a=e("../../../../shared/constants/network"),i=e("../../controllers/network-order");const o=(e,t)=>{var n,s;const{state:a}=e;if(null==a||null===(n=a.enabledNetworkMap)||void 0===n||!n[r.KnownCaipNamespace.Eip155]){return void(Object.keys(a.enabledNetworkMap||{}).filter(e=>e!==r.KnownCaipNamespace.Eip155).some(e=>Object.keys(a.enabledNetworkMap[e]||{}).length>0)||e.setEnabledNetworks(["0x1"],r.KnownCaipNamespace.Eip155))}const i=Object.keys(null==a||null===(s=a.enabledNetworkMap)||void 0===s?void 0:s[r.KnownCaipNamespace.Eip155]);if(0===i.length){return void(Object.keys(a.enabledNetworkMap).filter(e=>e!==r.KnownCaipNamespace.Eip155).some(e=>Object.keys(a.enabledNetworkMap[e]).length>0)||e.setEnabledNetworks(["0x1"],r.KnownCaipNamespace.Eip155))}if(i.length>1){i.length===t.length&&t.every(e=>i.includes(e))||e.setEnabledNetworks(t,r.KnownCaipNamespace.Eip155)}};n.validateAndFixNetworkState=o;n.NetworkOrderControllerInit=({controllerMessenger:e,persistedState:t,getController:n})=>{const c=new i.NetworkOrderController({messenger:e,state:{orderedNetworkList:[],enabledNetworkMap:{[r.KnownCaipNamespace.Eip155]:{[a.CHAIN_IDS.MAINNET]:!0},[r.KnownCaipNamespace.Solana]:{[s.SolScope.Mainnet]:!0}},...t.NetworkOrderController}});return setTimeout(()=>{const e=n("NetworkController").state.networkConfigurationsByChainId,t=a.FEATURED_NETWORK_CHAIN_IDS.filter(t=>t in e);o(c,t)},0),{controller:c}}}}},{package:"$root$",file:"app/scripts/controller-init/assets/network-order-controller-init.ts"}],[130,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default={config:{}}}}},{package:"$root$",file:"app/scripts/first-time-state.js"}],[131,{"@metamask/name-controller":2014},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ChangeType=n.AbstractPetnamesBridge=void 0;var s=e("@metamask/name-controller");function r(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t,n){i(e,t),t.set(e,n)}function i(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o(e,t){return e.get(l(e,t))}function c(e,t,n){return e.set(l(e,t),n),n}function l(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}let u=n.ChangeType=function(e){return e.ADDED="ADDED",e.UPDATED="UPDATED",e.DELETED="DELETED",e}({});var d=function(e){return e.SOURCE_TO_PETNAMES="Source->Petnames",e.PETNAMES_TO_SOURCE="Petnames->Source",e}(d||{});function p({type:e,variation:t,value:n}){return`${e}/${t}/${e===s.NameType.ETHEREUM_ADDRESS?n.toLowerCase():n}`}var h=new WeakMap,m=new WeakMap,f=new WeakMap,g=new WeakSet;function y(e){if(o(f,this)===e)throw new Error(`Attempted to synchronize recursively in same direction: ${e}`);if(null!==o(f,this))return;c(f,this,e);const[t,n]="Source->Petnames"===e?[this.getSourceEntries(),l(g,this,w).call(this)]:[l(g,this,w).call(this),this.getSourceEntries()],s=l(g,this,E).call(this,n,t);l(g,this,v).call(this,s),c(f,this,null)}function w(){const{names:e}=o(m,this).state,t=[];for(const n of Object.values(s.NameType))for(const s of Object.keys(e[n]))for(const r of Object.keys(e[n][s])){const{name:a,sourceId:i,origin:o}=e[n][s][r];if(!a)continue;const c={value:s,type:n,name:a,variation:r,sourceId:i??undefined,origin:o??undefined};this.shouldSyncPetname(c)&&t.push(c)}return t}function b(e,t){e===u.DELETED?(delete t.sourceId,delete t.origin,o(m,this).setName({...t,name:null})):o(m,this).setName(t)}function E(e,t){const n=[],s=[],r=[],a=new Map(e.map(e=>[p(e),e])),i=new Map(t.map(e=>[p(e),e]));return i.forEach((e,t)=>{const r=a.get(t);r?e.name!==r.name&&s.push(e):n.push(e)}),a.forEach((e,t)=>{i.has(t)||r.push(e)}),{[u.ADDED]:n,[u.UPDATED]:s,[u.DELETED]:r}}function v(e){const t=o(f,this)===d.SOURCE_TO_PETNAMES?l(g,this,b).bind(this):this.updateSourceEntry.bind(this);for(const n of Object.values(u))for(const s of e[n])t(n,s)}n.AbstractPetnamesBridge=class{constructor({isTwoWay:e,nameController:t,messenger:n}){var s,o;i(s=this,o=g),o.add(s),a(this,h,void 0),a(this,m,void 0),a(this,f,null),r(this,"messenger",void 0),c(h,this,e),c(m,this,t),this.messenger=n}init(){o(h,this)&&this.messenger.subscribe("NameController:stateChange",()=>l(g,this,y).call(this,d.PETNAMES_TO_SOURCE)),this.onSourceChange(()=>l(g,this,y).call(this,d.SOURCE_TO_PETNAMES))}updateSourceEntry(e,t){throw new Error("updateSourceEntry must be overridden for two-way bridges")}shouldSyncPetname(e){return!0}}}}},{package:"$root$",file:"app/scripts/lib/AbstractPetnamesBridge.ts"}],[132,{"./AbstractPetnamesBridge":131,"@metamask/name-controller":2014},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AccountIdentitiesPetnamesBridge=void 0;var s=e("@metamask/name-controller"),r=e("./AbstractPetnamesBridge");class a extends r.AbstractPetnamesBridge{constructor({nameController:e,messenger:t}){super({isTwoWay:!1,nameController:e,messenger:t})}getSourceEntries(){return this.messenger.call("AccountsController:listAccounts").map(e=>({value:e.address,type:s.NameType.ETHEREUM_ADDRESS,name:e.metadata.name,sourceId:undefined,variation:s.FALLBACK_VARIATION,origin:s.NameOrigin.ACCOUNT_IDENTITY}))}onSourceChange(e){this.messenger.subscribe("AccountsController:stateChange",e)}shouldSyncPetname(e){return e.origin===s.NameOrigin.ACCOUNT_IDENTITY}}n.AccountIdentitiesPetnamesBridge=a}}},{package:"$root$",file:"app/scripts/lib/AccountIdentitiesPetnamesBridge.ts"}],[133,{"./AbstractPetnamesBridge":131,"@metamask/name-controller":2014,"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AddressBookPetnamesBridge=void 0;var s=e("@metamask/name-controller"),r=e("@metamask/utils"),a=e("./AbstractPetnamesBridge");function i(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function o(e,t){return e.get(c(e,t))}function c(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var l=new WeakMap;class u extends a.AbstractPetnamesBridge{constructor({addressBookController:e,nameController:t,messenger:n}){var s,r,a;super({isTwoWay:!0,nameController:t,messenger:n}),i(this,l,void 0),r=this,a=e,(s=l).set(c(s,r),a)}getSourceEntries(){const e=[],{state:t}=o(l,this);for(const n of Object.keys(t.addressBook)){if(!(0,r.isStrictHexString)(n))continue;const a=t.addressBook[n];for(const r of Object.keys(a)){const a=t.addressBook[n][r],i=n.toLowerCase(),{name:o,isEns:c}=a;null!=o&&o.length&&null!=r&&r.length&&e.push({value:r,name:o,variation:i,type:s.NameType.ETHEREUM_ADDRESS,sourceId:c?"ens":undefined,origin:s.NameOrigin.ADDRESS_BOOK})}}return e}updateSourceEntry(e,t){e===a.ChangeType.DELETED?o(l,this).delete(t.variation,t.value):o(l,this).set(t.value,t.name,t.variation)}onSourceChange(e){this.messenger.subscribe("AddressBookController:stateChange",e)}}n.AddressBookPetnamesBridge=u}}},{package:"$root$",file:"app/scripts/lib/AddressBookPetnamesBridge.ts"}],[134,{"@metamask/base-controller":1140,"@metamask/obs-store":2083},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("@metamask/obs-store"),r=e("@metamask/base-controller");function a(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var c=new WeakSet;class l extends s.ObservableStore{constructor({config:e,controllerMessenger:t,state:n,persist:s}){super(n),a(this,c),i(this,"config",{}),this.persist=s,this.controllerMessenger=t,e&&this.updateStructure(e)}updateStructure(e){this.config=e,this.removeAllListeners();const t={};for(const s of Object.keys(e)){var n;if(!e[s])throw new Error(`Undefined '${s}'`);const a=e[s];a.subscribe?e[s].subscribe(e=>{o(c,this,u).call(this,s,e)}):this.persist?this.controllerMessenger.subscribe(`${a.name}:stateChange`,(t,n)=>{o(c,this,d).call(this,e[s].metadata,n)&&o(c,this,u).call(this,s,(0,r.getPersistentState)(t,e[s].metadata))}):this.controllerMessenger.subscribe(`${a.name}:stateChange`,e=>o(c,this,u).call(this,s,e));const i=a.state??(null===(n=a.getState)||void 0===n?void 0:n.call(a));t[s]=this.persist&&e[s].metadata?(0,r.getPersistentState)(i,e[s].metadata):i}this.updateState(t)}getFlatState(){if(!this.config)return{};let e={};for(const t of Object.keys(this.config)){const n=this.config[t],s=n.getState?n.getState():n.state;e={...e,...s}}return e}}function u(e,t){const n=this.getState()[e];this.updateState({[e]:t}),this.emit("stateChange",{oldState:n,newState:t,controllerKey:e})}function d(e,t){return t.some(t=>{if(0===t.path.length)return!0;const n=t.path[0];return!e[n]||e[n].persist})}n.default=l}}},{package:"$root$",file:"app/scripts/lib/ComposableObservableStore.js"}],[135,{"webextension-polyfill":5227},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CronjobControllerStorageManager=n.CronjobControllerStorageKey=void 0;var s,r=(s=e("webextension-polyfill"))&&s.__esModule?s:{default:s};function a(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function i(e,t){return e.get(c(e,t))}function o(e,t,n){return e.set(c(e,t),n),n}function c(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const l=n.CronjobControllerStorageKey="temp-cronjob-storage";var u=new WeakMap,d=new WeakMap;n.CronjobControllerStorageManager=class{constructor(){a(this,u,null),a(this,d,!1)}async init(){o(u,this,(await r.default.storage.local.get(l))[l]),o(d,this,!0)}getInitialState(){if(!i(d,this))throw new Error("CronjobControllerStorageManager not yet initialized");return i(u,this)}set(e){if(!i(d,this))throw new Error("CronjobControllerStorageManager not yet initialized");r.default.storage.local.set({[l]:e}).catch(console.error)}}}}},{package:"$root$",file:"app/scripts/lib/CronjobControllerStorageManager.ts"}],[136,{"./state-utils":212,"@metamask/utils":2632,uuid:5195},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PatchStore=void 0;var s=e("@metamask/utils"),r=e("uuid"),a=e("./state-utils");function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const o=(0,s.createProjectLogger)("patch-store");n.PatchStore=class{constructor(e){i(this,"id",void 0),i(this,"observableStore",void 0),i(this,"pendingPatches",new Map),i(this,"listener",void 0),this.id=(0,r.v4)(),this.observableStore=e,this.listener=this._onStateChange.bind(this),this.observableStore.on("stateChange",this.listener),o("Created",this.id)}flushPendingPatches(){const e=[...this.pendingPatches.values()];this.pendingPatches.clear();for(const t of e)o("Flushed",t.path.join("."),this.id,t);return e}destroy(){this.observableStore.removeListener("stateChange",this.listener),o("Destroyed",this.id)}_onStateChange({oldState:e,newState:t}){const n=(0,a.sanitizeUIState)(t),s=this._generatePatches(e,n),r=Boolean(t.vault);if(r&&s.push({op:"replace",path:["isInitialized"],value:r}),s.length)for(const e of s){const t=e.path.join(".");this.pendingPatches.set(t,e),o("Updated",t,this.id,e)}}_generatePatches(e,t){return Object.keys(t).map(n=>{const s=e[n],r=t[n];return s===r?null:{op:"replace",path:[n],value:r}}).filter(Boolean)}}}}},{package:"$root$",file:"app/scripts/lib/PatchStore.ts"}],[137,{"@metamask/name-controller":2014,"@metamask/snaps-rpc-methods":2346,"@metamask/snaps-utils":2516,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SnapsNameProvider=void 0;var s,r=e("@metamask/name-controller"),a=e("@metamask/snaps-utils"),i=(s=e("loglevel"))&&s.__esModule?s:{default:s},o=e("@metamask/snaps-rpc-methods");function c(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l(e,t){return e.get(u(e,t))}function u(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var d=new WeakMap,p=new WeakSet;function h(e){const t=l(d,this).call("PermissionController:getState").subjects;return l(d,this).call("SnapController:getAll").filter(({id:n})=>{var s;const r=null===(s=t[n])||void 0===s?void 0:s.permissions["endowment:name-lookup"];if(!r)return!1;const a=(0,o.getChainIdsCaveat)(r);return!(e&&a&&!a.includes(e))})}async function m(e,t,n){const s=e,r={chainId:t,address:n};let o,c;try{const t=await l(d,this).call("SnapController:handleRequest",{snapId:e,origin:"metamask",handler:a.HandlerType.OnNameLookup,request:{jsonrpc:"2.0",method:" ",params:r}}),n=null==t?void 0:t.resolvedDomains;o=n?[...new Set(n.map(e=>e.resolvedDomain))]:[]}catch(t){i.default.error("Snap name provider request failed",{snapId:e,request:r,error:t}),c=t}return{sourceId:s,result:{proposedNames:o,error:c}}}n.SnapsNameProvider=class{constructor({messenger:e}){var t,n,s;!function(e,t){c(e,t),t.add(e)}(this,p),function(e,t,n){c(e,t),t.set(e,n)}(this,d,void 0),n=this,s=e,(t=d).set(u(t,n),s)}getMetadata(){const e=u(p,this,h).call(this);return{sourceIds:{[r.NameType.ETHEREUM_ADDRESS]:e.map(e=>e.id)},sourceLabels:e.reduce((e,t)=>{const n=l(d,this).call("SnapController:get",t.id),s=null==n?void 0:n.manifest.proposedName;return{...e,[t.id]:s||t.id}},{})}}async getProposedNames(e){const{variation:t,value:n}=e,s=`eip155:${parseInt(t,16)}`,r=u(p,this,h).call(this,s);return{results:(await Promise.all(r.map(e=>u(p,this,m).call(this,e.id,s,n)))).reduce((e,t)=>{const{sourceId:n,result:s}=t;return{...e,[n]:s}},{})}}}}}},{package:"$root$",file:"app/scripts/lib/SnapsNameProvider.ts"}],[138,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.WeakRefObjectMap=void 0;class r{constructor(){s(this,"map",void 0),this.map=new Map}set(e,t){const n={};for(const e in t){if(!Object.prototype.hasOwnProperty.call(t,e))continue;const s=t[e];if("object"!=typeof s||null===s)throw new Error(`Property ${String(e)} is not an object and cannot be weakly referenced.`);n[e]=new WeakRef(s)}return this.map.set(e,n),this}get(e){const t=this.map.get(e);if(!t)return undefined;const n={};for(const s in t){if(!Object.prototype.hasOwnProperty.call(t,s))continue;const r=t[s].deref();if(r===undefined)return this.map.delete(e),undefined;n[s]=r}return n}has(e){return this.get(e)!==undefined}delete(e){return this.get(e)!==undefined&&this.map.delete(e)}clear(){this.map.clear()}get size(){return this.map.size}entries(){const e=[];return this.map.forEach((t,n)=>{const s=this.get(n);s!==undefined&&e.push([n,s])}),e.values()}keys(){return this.map.keys()}values(){const e=[];return this.map.forEach((t,n)=>{const s=this.get(n);s!==undefined&&e.push(s)}),e.values()}[Symbol.iterator](){return this.entries()}get[Symbol.toStringTag](){return"WeakRefObjectMap"}forEach(e,t){this.map.forEach((n,s)=>{const r=this.get(s);r!==undefined&&(t?e.call(t,r,s,this):e(r,s,this))})}}n.WeakRefObjectMap=r}}},{package:"$root$",file:"app/scripts/lib/WeakRefObjectMap.ts"}],[139,{"../../../../shared/constants/app":5244,"@metamask/controller-utils":1224,"@metamask/rpc-errors":2224,"@metamask/snaps-rpc-methods":2346,"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.rejectAllApprovals=function({approvalController:e,deleteInterface:t}){const n=e.state.pendingApprovals,s=Object.values(n);for(const n of s)l({approvalController:e,approvalRequest:n,deleteInterface:t})},n.rejectOriginApprovals=function({approvalController:e,deleteInterface:t,origin:n}){const s=e.state.pendingApprovals,r=Object.values(s).filter(e=>e.origin===n);for(const n of r)l({approvalController:e,approvalRequest:n,deleteInterface:t})};var s=e("@metamask/controller-utils"),r=e("@metamask/snaps-rpc-methods"),a=e("@metamask/rpc-errors"),i=e("@metamask/utils"),o=e("../../../../shared/constants/app");const c=(0,i.createProjectLogger)("approval-utils");function l({approvalController:e,approvalRequest:t,deleteInterface:n}){var i;const{id:l,type:u,origin:d}=t,p=null===(i=t.requestData)||void 0===i?void 0:i.id;switch(u){case s.ApprovalType.SnapDialogAlert:case s.ApprovalType.SnapDialogPrompt:case r.DIALOG_APPROVAL_TYPES.default:c("Rejecting snap dialog",{id:l,interfaceId:p,origin:d,type:u}),e.accept(l,null),null==n||n(p);break;case s.ApprovalType.SnapDialogConfirmation:c("Rejecting snap confirmation",{id:l,interfaceId:p,origin:d,type:u}),e.accept(l,!1),null==n||n(p);break;case o.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountCreation:case o.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountRemoval:case o.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.showSnapAccountRedirect:c("Rejecting snap account confirmation",{id:l,origin:d,type:u}),e.accept(l,!1);break;default:c("Rejecting pending approval",{id:l,origin:d,type:u}),e.reject(l,a.providerErrors.userRejectedRequest({data:{cause:"rejectAllApprovals"}}))}}}}},{package:"$root$",file:"app/scripts/lib/approval/utils.ts"}],[14,{"../../../../shared/constants/metametrics":5259,"@metamask/assets-controllers":1076,"@metamask/bridge-controller":1147},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NftControllerInit=void 0;var s=e("@metamask/assets-controllers"),r=e("@metamask/bridge-controller"),a=e("../../../../shared/constants/metametrics");n.NftControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:n})=>({controller:new s.NftController({state:n.NftController,messenger:e,onNftAdded:({address:e,symbol:n,tokenId:s,standard:i,source:o})=>t.call("MetaMetricsController:trackEvent",{event:a.MetaMetricsEventName.NftAdded,category:a.MetaMetricsEventCategory.Wallet,sensitiveProperties:{token_contract_address:e,token_symbol:n??null,token_id:s,token_standard:i,asset_type:r.AssetType.NFT,source:o}})})})}}},{package:"$root$",file:"app/scripts/controller-init/assets/nft-controller-init.ts"}],[140,{"../../../shared/modules/string-utils":5375},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("../../../shared/modules/string-utils");n.default=class{constructor(e={}){const{preferencesController:t,addressBookController:n,accountsController:s,networkController:r,trackMetaMetricsEvent:a}=e;this.preferencesController=t,this.accountsController=s,this.addressBookController=n,this.networkController=r,this._trackMetaMetricsEvent=a}async restoreUserData(e){const t=this.preferencesController.state,{preferences:n,addressBook:s,network:r,internalAccounts:a}=JSON.parse(e);n&&(n.identities=t.identities,n.lostIdentities=t.lostIdentities,n.selectedAddress=t.selectedAddress,this.preferencesController.update(n)),s&&this.addressBookController.update(s,!0),r&&this.networkController.loadBackup(r),a&&this.accountsController.loadBackup(a),(n||s||r||a)&&this._trackMetaMetricsEvent({event:"User Data Imported",category:"Backup"})}async backupUserData(){const e={preferences:{...this.preferencesController.state},internalAccounts:{internalAccounts:this.accountsController.state.internalAccounts},addressBook:{...this.addressBookController.state},network:{networkConfigurationsByChainId:this.networkController.state.networkConfigurationsByChainId}};delete e.preferences.identities,delete e.preferences.lostIdentities,delete e.preferences.selectedAddress;const t=JSON.stringify(e),n=new Date,r=e=>(0,s.prependZero)(e,2);return{fileName:`MetaMaskUserData.${n.getFullYear()}_${r(n.getMonth()+1)}_${r(n.getDay())}_${r(n.getHours())}_${r(n.getMinutes())}_${r(n.getDay())}.json`,data:t}}}}}},{package:"$root$",file:"app/scripts/lib/backup.js"}],[141,{"../../../shared/constants/time":5277,loglevel:4370,"readable-stream":4805},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.THREE_MINUTES=void 0,n.default=function(){const e=c();return new r.Transform({transform(t,n,s){const r=t.id===undefined,i=e.add(t.id);r||i?s(null,t):(a.default.debug(`RPC request with id "${t.id}" already seen.`),s())},objectMode:!0})};var s,r=e("readable-stream"),a=(s=e("loglevel"))&&s.__esModule?s:{default:s},i=e("../../../shared/constants/time");const o=n.THREE_MINUTES=3*i.MINUTE,c=()=>{const e=new Map;return setInterval(()=>{const t=Date.now()-o;for(const[n,s]of e.entries()){if(!(s<=t))break;e.delete(n)}},o),{add:t=>!e.has(t)&&(e.set(t,Date.now()),!0)}}}}},{package:"$root$",file:"app/scripts/lib/createDupeReqFilterStream.ts"}],[142,{"../../../shared/constants/permissions":5266,"../controllers/permissions":119,"@metamask/keyring-api":1914},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({messenger:e}){return function(t,n,r,a){const o=e.call("AccountsController:getSelectedAccount");if((0,s.isEvmAccountType)(o.type))return r();if(i.includes(t.method))return a(new Error(`Non-EVM account cannot request this method: ${t.method}`));if("wallet_requestPermissions"===t.method&&null!=t&&t.params&&Array.isArray(t.params)&&t.params.length>0&&t.params[0]){const e=Object.keys(t.params[0]);if(i.some(t=>e.includes(t)))return a(new Error(`Non-EVM account cannot request this method: ${e.toString()}`))}return r()}};var s=e("@metamask/keyring-api"),r=e("../../../shared/constants/permissions"),a=e("../controllers/permissions");const i=[...Object.values(r.RestrictedEthMethods),...a.unrestrictedEthSigningMethods]}}},{package:"$root$",file:"app/scripts/lib/createEvmMethodsToNonEvmAccountReqFilterMiddleware.ts"}],[143,{loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return function(t,n,s){s(s=>{n.error&&r.default.debug("Error in RPC response:\n",n),t.isMetamaskInternal||(r.default.info(`RPC (${e.origin}): ${t.method} -> ${n.error?"error":"success"}`),s())})}};var s,r=(s=e("loglevel"))&&s.__esModule?s:{default:s}}}},{package:"$root$",file:"app/scripts/lib/createLoggerMiddleware.js"}],[144,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({mainFrameOrigin:e}){return function(t,n,s){t.mainFrameOrigin=e,s()}}}}},{package:"$root$",file:"app/scripts/lib/createMainFrameOriginMiddleware.ts"}],[145,{"./stream-utils":217,"@metamask/rpc-errors":2224},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("@metamask/rpc-errors"),r=e("./stream-utils");n.default=(e,t)=>async n=>{if(!(0,r.isStreamWritable)(t))return;if(!e[n.method])return void t.write({jsonrpc:"2.0",error:s.rpcErrors.methodNotFound({message:`${n.method} not found`}),id:n.id});let a,i;try{a=await e[n.method](...n.params)}catch(e){i=e}(0,r.isStreamWritable)(t)?i?t.write({jsonrpc:"2.0",error:(0,s.serializeError)(i,{shouldIncludeStack:!0}),id:n.id}):t.write({jsonrpc:"2.0",result:a,id:n.id}):i&&console.error(i)}}}},{package:"$root$",file:"app/scripts/lib/createMetaRPCHandler.js"}],[146,{"./middleware/pending":164,"@metamask/eth-json-rpc-middleware":1646,"@metamask/json-rpc-engine":1863},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({version:e,getAccounts:t,getCallsStatus:n,getCapabilities:i,processTransaction:o,processTypedMessage:c,processTypedMessageV3:l,processTypedMessageV4:u,processPersonalMessage:d,processDecryptMessage:p,processEncryptionPublicKey:h,processSendCalls:m,getPendingNonce:f,getPendingTransactionByHash:g,processRequestExecutionPermissions:y}){return(0,s.mergeMiddleware)([(0,s.createScaffoldMiddleware)({eth_syncing:!1,web3_clientVersion:`MetaMask/v${e}`}),(0,r.createWalletMiddleware)({getAccounts:t,getCallsStatus:n,getCapabilities:i,processTransaction:o,processTypedMessage:c,processTypedMessageV3:l,processTypedMessageV4:u,processPersonalMessage:d,processDecryptMessage:p,processEncryptionPublicKey:h,processSendCalls:m,processRequestExecutionPermissions:y}),(0,a.createPendingNonceMiddleware)({getPendingNonce:f}),(0,a.createPendingTxMiddleware)({getPendingTransactionByHash:g})])};var s=e("@metamask/json-rpc-engine"),r=e("@metamask/eth-json-rpc-middleware"),a=e("./middleware/pending")}}},{package:"$root$",file:"app/scripts/lib/createMetamaskMiddleware.js"}],[147,{loglevel:4370,"webextension-polyfill":5227},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({location:e,registerOnboarding:t}){return async function(n,a,i,o){try{if("wallet_registerOnboarding"!==n.method)return void i();n.tabId&&n.tabId!==r.default.tabs.TAB_ID_NONE?await t(e,n.tabId):s.default.debug(`'wallet_registerOnboarding' message from ${e} ignored due to missing tabId`),a.result=!0,o()}catch(e){o(e)}}};var s=a(e("loglevel")),r=a(e("webextension-polyfill"));function a(e){return e&&e.__esModule?e:{default:e}}}}},{package:"$root$",file:"app/scripts/lib/createOnboardingMiddleware.js"}],[148,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return function(t,n,s){t.origin=e.origin,s()}}}}},{package:"$root$",file:"app/scripts/lib/createOriginMiddleware.js"}],[149,{"../../../shared/constants/app":5244,"@metamask/rpc-errors":2224},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SPAM_FILTER_ACTIVATED_ERROR=n.REJECTION_THRESHOLD_IN_MS=n.NUMBER_OF_REJECTIONS_THRESHOLD=n.BLOCKING_THRESHOLD_IN_MS=n.BLOCKABLE_METHODS=void 0,n.default=function({getThrottledOriginState:e,updateThrottledOriginState:t}){return function(n,s,r,p){const{method:h,origin:m}=n;if(!c.has(h)||l.includes(m))return void r();!function(e){if(!e)return!1;const t=Date.now(),{rejections:n,lastRejection:s}=e,r=t-s<=o;return n>=a&&r}(e(m))?r(n=>{if("error"in s&&s.error&&d(s.error)){var r;const a=null===(r=s.error)||void 0===r?void 0:r.data;if("rejectAllApprovals"===(null==a?void 0:a.cause))return void n();const o=e(m)||{rejections:0,lastRejection:0},c=Date.now(),l=c-o.lastRejection<i?o.rejections+1:1;t(m,{rejections:l,lastRejection:c})}else{const n=e(m);Boolean(n)&&t(m,{rejections:0,lastRejection:0})}n()}):p(u)}};var s=e("@metamask/rpc-errors"),r=e("../../../shared/constants/app");const a=n.NUMBER_OF_REJECTIONS_THRESHOLD=3,i=n.REJECTION_THRESHOLD_IN_MS=3e4,o=n.BLOCKING_THRESHOLD_IN_MS=6e4,c=n.BLOCKABLE_METHODS=new Set([r.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN,r.MESSAGE_TYPE.ETH_SEND_TRANSACTION,r.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA,r.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V1,r.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3,r.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4,r.MESSAGE_TYPE.PERSONAL_SIGN,r.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN,r.MESSAGE_TYPE.WALLET_SEND_CALLS,r.MESSAGE_TYPE.WATCH_ASSET]),l=["http://127.0.0.1:8080","http://127.0.0.1:8081","http://127.0.0.1:8082","http://localhost:8080","http://localhost:8081","http://localhost:8082"],u=n.SPAM_FILTER_ACTIVATED_ERROR=s.providerErrors.unauthorized("Request blocked due to spam filter."),d=e=>e.code===s.errorCodes.provider.userRejectedRequest}}},{package:"$root$",file:"app/scripts/lib/createOriginThrottlingMiddleware.ts"}],[15,{"@metamask/assets-controllers":1076},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NftDetectionControllerInit=void 0;var s=e("@metamask/assets-controllers");n.NftDetectionControllerInit=e=>{const{controllerMessenger:t,getController:n}=e,r=()=>n("NftController");return{controller:new s.NftDetectionController({messenger:t,addNft:(...e)=>r().addNft(...e),getNftState:()=>r().state,disabled:!n("PreferencesController").state.useNftDetection})}}}}},{package:"$root$",file:"app/scripts/controller-init/assets/nft-detection-controller-init.ts"}],[150,{"../../../shared/constants/app":5244,"../../../shared/constants/metametrics":5259,"../../../shared/constants/security-provider":5269,"../../../shared/constants/signatures":5270,"../../../shared/constants/transaction":5279,"../../../shared/lib/confirmation.utils":5291,"../../../shared/lib/snaps/snaps":5337,"../../../shared/modules/error":5356,"../../../shared/modules/transaction.utils":5377,"../../../ui/helpers/utils/metrics":6497,"./snap-keyring/metrics":205,"@metamask/controller-utils":1224,"@metamask/rpc-errors":2224,"ethereumjs-util":3849},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({rateLimitTimeout:e=3e5,rateLimitSamplePercent:t=.001,globalRateLimitTimeout:n=3e5,globalRateLimitMaxAmount:_=10,getAccountType:M,getDeviceModel:C,getHardwareTypeForMetric:P,snapAndHardwareMessenger:I,appStateController:N,metaMetricsController:O,getHDEntropyIndex:D}){return async function(j,R,L){const{origin:B,method:x,params:U}=j,F=function(e){return[i.MESSAGE_TYPE.WALLET_CREATE_SESSION,i.MESSAGE_TYPE.WALLET_INVOKE_METHOD].includes(e)}(x),G=F?o.MetaMetricsRequestedThrough.MultichainApi:o.MetaMetricsRequestedThrough.EthereumProvider,$=F?o.MetaMetricsEventCategory.MultichainApi:o.MetaMetricsEventCategory.InpageProvider;let H,K=x;var W;x===i.MESSAGE_TYPE.WALLET_INVOKE_METHOD&&(K=null==U||null===(W=U.request)||void 0===W?void 0:W.method,H=null==U?void 0:U.scope);const q=b[K];let V;switch(q){case y.TIMEOUT:V=void 0!==A[K];break;case y.NON_RATE_LIMITED:V=!1;break;case y.BLOCKED:V=!0;break;default:case y.RANDOM_SAMPLE:V=Math.random()>=t}const Y=_>0&&k>=_,z=!0===O.state.participateInMetaMetrics,Q=v[K],J={api_source:G};let X;H&&(J.chain_id_caip=H);const Z=(0,f.isSnapPreinstalled)(B),ee=B!==i.ORIGIN_METAMASK&&!Z&&!V&&!Y&&!0===z;if(ee){var te;const t=Q?Q.REQUESTED:o.MetaMetricsEventName.ProviderMethodCalled;if(t===o.MetaMetricsEventName.SignatureRequested){var ne,se,re,ae,ie;let e;var oe,ce;if(J.signature_type=K,J.hd_entropy_index=D(),(0,a.isValidAddress)(null==j||null===(ne=j.params)||void 0===ne?void 0:ne[1]))e=null==j||null===(oe=j.params)||void 0===oe?void 0:oe[0];else e=null==j||null===(ce=j.params)||void 0===ce?void 0:ce[1];null!==(se=j.securityAlertResponse)&&void 0!==se&&se.providerRequestsCount&&Object.keys(j.securityAlertResponse.providerRequestsCount).forEach(e=>{J[`ppom_${e}_count`]=j.securityAlertResponse.providerRequestsCount[e]}),J.security_alert_response=(null===(re=j.securityAlertResponse)||void 0===re?void 0:re.result_type)??l.BlockaidResultType.NotApplicable,J.security_alert_reason=(null===(ae=j.securityAlertResponse)||void 0===ae?void 0:ae.reason)??l.BlockaidReason.notApplicable,null!==(ie=j.securityAlertResponse)&&void 0!==ie&&ie.description&&(J.security_alert_description=j.securityAlertResponse.description),(0,m.shouldUseRedesignForSignatures)({approvalType:E[K]})&&(J.ui_customizations=[...J.ui_customizations||[],o.MetaMetricsEventUiCustomization.RedesignedConfirmation]);const t=await(0,g.getSnapAndHardwareInfoForMetrics)(M,C,P,I);Object.assign(J,t);try{if(K===i.MESSAGE_TYPE.PERSONAL_SIGN){const{isSIWEMessage:t}=(0,s.detectSIWE)({data:e});t&&(J.ui_customizations=[...J.ui_customizations||[],o.MetaMetricsEventUiCustomization.Siwe])}else if(K===i.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4){const t=(0,c.parseTypedDataMessage)(e);X={},J.eip712_primary_type=t.primaryType,X.eip712_verifyingContract=t.domain.verifyingContract,X.eip712_domain_version=t.domain.version,X.eip712_domain_name=t.domain.name,u.PRIMARY_TYPES_PERMIT.includes(t.primaryType)?J.ui_customizations=[...J.ui_customizations||[],o.MetaMetricsEventUiCustomization.Permit]:u.PRIMARY_TYPES_ORDER.includes(t.primaryType)&&(J.ui_customizations=[...J.ui_customizations||[],o.MetaMetricsEventUiCustomization.Order])}}catch(e){console.warn(`createRPCMethodTrackingMiddleware: Errored - ${e}`)}}else J.method=K;const r=T[K];if(r&&(J.params=r(U)),null===(te=S[K])||void 0===te||te.call(S,j,undefined,w.REQUESTED,J),t===o.MetaMetricsEventName.SignatureRequested){!function(e,t,n,s){e.createEventFragment({category:s,initialEvent:o.MetaMetricsEventName.SignatureRequested,successEvent:o.MetaMetricsEventName.SignatureApproved,failureEvent:o.MetaMetricsEventName.SignatureRejected,uniqueIdentifier:(0,h.generateSignatureUniqueId)(t.id),persist:!0,referrer:{url:t.origin},...n})}(O,j,{properties:J,sensitiveProperties:X},$)}else O.trackEvent({event:t,category:$,referrer:{url:B},properties:J});q===y.TIMEOUT&&(A[K]=setTimeout(()=>{delete A[K]},e)),k+=1,setTimeout(()=>{k-=1},n)}L(async e=>{var t,n,s,a;if(!1===ee||void 0===Q)return e();const i=null===(t=R.error)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.location;let c,l;const u=(0,p.getErrorMessage)(R.error);if((null===(n=R.error)||void 0===n?void 0:n.code)===r.errorCodes.provider.userRejectedRequest?(c=Q.REJECTED,l=w.REJECTED):(null===(s=R.error)||void 0===s?void 0:s.code)===r.errorCodes.rpc.internal&&[u,R.error.message].includes("Request rejected by user or snap.")?(c=Q.REJECTED,l=w.REJECTED,J.status=u):(c=Q.APPROVED,l=w.APPROVED),!c)return e();null===(a=S[K])||void 0===a||a.call(S,j,R,l,J);let m={};if(d.SIGNING_METHODS.includes(K)){var f;const e=N.getSignatureSecurityAlertResponse(null===(f=j.securityAlertResponse)||void 0===f?void 0:f.securityAlertId);m=(0,h.getBlockaidMetricsProps)({securityAlertResponse:e})}const g={...J,...m,location:i};if(c===o.MetaMetricsEventName.SignatureRejected||c===o.MetaMetricsEventName.SignatureApproved){const e={abandoned:c===Q.REJECTED},t={properties:{...g,hd_entropy_index:D()},sensitiveProperties:X};!function(e,t,n,s){const r=(0,h.generateSignatureUniqueId)(t.id);e.updateEventFragment(r,s),e.finalizeEventFragment(r,n)}(O,j,e,t)}else O.trackEvent({event:c,category:$,referrer:{url:B},properties:g});return e()})}};var s=e("@metamask/controller-utils"),r=e("@metamask/rpc-errors"),a=e("ethereumjs-util"),i=e("../../../shared/constants/app"),o=e("../../../shared/constants/metametrics"),c=e("../../../shared/modules/transaction.utils"),l=e("../../../shared/constants/security-provider"),u=e("../../../shared/constants/signatures"),d=e("../../../shared/constants/transaction"),p=e("../../../shared/modules/error"),h=e("../../../ui/helpers/utils/metrics"),m=e("../../../shared/lib/confirmation.utils"),f=e("../../../shared/lib/snaps/snaps"),g=e("./snap-keyring/metrics");const y={TIMEOUT:"timeout",BLOCKED:"blocked",NON_RATE_LIMITED:"non_rate_limited",RANDOM_SAMPLE:"random_sample"},w={REQUESTED:"REQUESTED",APPROVED:"APPROVED",REJECTED:"REJECTED"},b={[i.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:y.NON_RATE_LIMITED,[i.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:y.NON_RATE_LIMITED,[i.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:y.NON_RATE_LIMITED,[i.MESSAGE_TYPE.PERSONAL_SIGN]:y.NON_RATE_LIMITED,[i.MESSAGE_TYPE.ETH_DECRYPT]:y.NON_RATE_LIMITED,[i.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY]:y.NON_RATE_LIMITED,[i.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN]:y.NON_RATE_LIMITED,[i.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN]:y.NON_RATE_LIMITED,[i.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS]:y.TIMEOUT,[i.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS]:y.TIMEOUT,[i.MESSAGE_TYPE.WALLET_CREATE_SESSION]:y.NON_RATE_LIMITED,[i.MESSAGE_TYPE.SEND_METADATA]:y.BLOCKED,[i.MESSAGE_TYPE.ETH_CHAIN_ID]:y.BLOCKED,[i.MESSAGE_TYPE.ETH_ACCOUNTS]:y.BLOCKED,[i.MESSAGE_TYPE.LOG_WEB3_SHIM_USAGE]:y.BLOCKED,[i.MESSAGE_TYPE.GET_PROVIDER_STATE]:y.BLOCKED,[i.MESSAGE_TYPE.WALLET_GET_CALLS_STATUS]:y.NON_RATE_LIMITED,[i.MESSAGE_TYPE.WALLET_GET_CAPABILITIES]:y.NON_RATE_LIMITED,[i.MESSAGE_TYPE.WALLET_SEND_CALLS]:y.NON_RATE_LIMITED},E={[i.MESSAGE_TYPE.PERSONAL_SIGN]:s.ApprovalType.PersonalSign,[i.MESSAGE_TYPE.SIGN]:s.ApprovalType.SignTransaction,[i.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:s.ApprovalType.EthSignTypedData,[i.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V1]:s.ApprovalType.EthSignTypedData,[i.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:s.ApprovalType.EthSignTypedData,[i.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:s.ApprovalType.EthSignTypedData},v={[i.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:{APPROVED:o.MetaMetricsEventName.SignatureApproved,REJECTED:o.MetaMetricsEventName.SignatureRejected,REQUESTED:o.MetaMetricsEventName.SignatureRequested},[i.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:{APPROVED:o.MetaMetricsEventName.SignatureApproved,REJECTED:o.MetaMetricsEventName.SignatureRejected,REQUESTED:o.MetaMetricsEventName.SignatureRequested},[i.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:{APPROVED:o.MetaMetricsEventName.SignatureApproved,REJECTED:o.MetaMetricsEventName.SignatureRejected,REQUESTED:o.MetaMetricsEventName.SignatureRequested},[i.MESSAGE_TYPE.PERSONAL_SIGN]:{APPROVED:o.MetaMetricsEventName.SignatureApproved,REJECTED:o.MetaMetricsEventName.SignatureRejected,REQUESTED:o.MetaMetricsEventName.SignatureRequested},[i.MESSAGE_TYPE.ETH_DECRYPT]:{APPROVED:o.MetaMetricsEventName.DecryptionApproved,REJECTED:o.MetaMetricsEventName.DecryptionRejected,REQUESTED:o.MetaMetricsEventName.DecryptionRequested},[i.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY]:{APPROVED:o.MetaMetricsEventName.EncryptionPublicKeyApproved,REJECTED:o.MetaMetricsEventName.EncryptionPublicKeyRejected,REQUESTED:o.MetaMetricsEventName.EncryptionPublicKeyRequested},[i.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS]:{APPROVED:o.MetaMetricsEventName.PermissionsApproved,REJECTED:o.MetaMetricsEventName.PermissionsRejected,REQUESTED:o.MetaMetricsEventName.PermissionsRequested},[i.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS]:{APPROVED:o.MetaMetricsEventName.PermissionsApproved,REJECTED:o.MetaMetricsEventName.PermissionsRejected,REQUESTED:o.MetaMetricsEventName.PermissionsRequested},[i.MESSAGE_TYPE.WALLET_CREATE_SESSION]:{APPROVED:o.MetaMetricsEventName.PermissionsApproved,REJECTED:o.MetaMetricsEventName.PermissionsRejected,REQUESTED:o.MetaMetricsEventName.PermissionsRequested},[i.MESSAGE_TYPE.WALLET_GET_CALLS_STATUS]:{REQUESTED:o.MetaMetricsEventName.Wallet5792Called},[i.MESSAGE_TYPE.WALLET_GET_CAPABILITIES]:{REQUESTED:o.MetaMetricsEventName.Wallet5792Called},[i.MESSAGE_TYPE.WALLET_SEND_CALLS]:{REQUESTED:o.MetaMetricsEventName.Wallet5792Called}},T={[i.MESSAGE_TYPE.WATCH_ASSET]:({type:e})=>({type:e}),[i.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN]:([{chainId:e}])=>({chainId:e}),[i.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN]:([{chainId:e}])=>({chainId:e})},S={[i.MESSAGE_TYPE.WALLET_SEND_CALLS]:function(e,t,n,s){var r;if(n!==w.REQUESTED)return;const{params:a}=e,i=null==a||null===(r=a[0])||void 0===r||null===(r=r.calls)||void 0===r?void 0:r.length;i&&(s.batch_transaction_count=i)},[i.MESSAGE_TYPE.WALLET_CREATE_SESSION]:function(e,t,n,s){if(n===w.REQUESTED){const{params:t}=e,n=(null==t?void 0:t.requiredScopes)||{},r=(null==t?void 0:t.optionalScopes)||{},a=new Set;for(const e of Object.keys(n))a.add(e);for(const e of Object.keys(r))a.add(e);s.chain_id_list=Array.from(a)}else if(n===w.APPROVED){const{result:e}=t,n=Object.keys((null==e?void 0:e.sessionScopes)||{});s.chain_id_list=n}}},A={};let k=0}}},{package:"$root$",file:"app/scripts/lib/createRPCMethodTrackingMiddleware.js"}],[151,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return function(t,n,s){t.tabId=e.tabId,s()}}}}},{package:"$root$",file:"app/scripts/lib/createTabIdMiddleware.js"}],[152,{"../../../shared/constants/app":5244,"../../../shared/lib/trace":5342},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return async function(e,t,n){const{id:s,method:o}=e,c=a[o];c&&(e.traceContext=await(0,r.trace)({name:c,id:s,tags:i[o]}),await(0,r.trace)({name:r.TraceName.Middleware,id:s,parentContext:e.traceContext})),n()}};var s=e("../../../shared/constants/app"),r=e("../../../shared/lib/trace");const a={[s.MESSAGE_TYPE.ETH_SEND_TRANSACTION]:r.TraceName.Transaction,[s.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:r.TraceName.Signature,[s.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V1]:r.TraceName.Signature,[s.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:r.TraceName.Signature,[s.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:r.TraceName.Signature,[s.MESSAGE_TYPE.PERSONAL_SIGN]:r.TraceName.Signature},i={[s.MESSAGE_TYPE.ETH_SEND_TRANSACTION]:{source:"dapp"}}}}},{package:"$root$",file:"app/scripts/lib/createTracingMiddleware.ts"}],[153,{"../../../../shared/lib/deep-links/constants":5293,"../../../../shared/lib/deep-links/parse":5295,"../../../../shared/lib/deep-links/routes/route":5303,"../../../../shared/lib/deep-links/verify":5305,"../../../../shared/modules/mv3.utils":5363,events:3902,loglevel:4370,"webextension-polyfill":5227},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DeepLinkRouter=void 0;var s=d(e("events")),r=d(e("webextension-polyfill")),a=d(e("loglevel")),i=e("../../../../shared/modules/mv3.utils"),o=e("../../../../shared/lib/deep-links/parse"),c=e("../../../../shared/lib/deep-links/constants"),l=e("../../../../shared/lib/deep-links/routes/route"),u=e("../../../../shared/lib/deep-links/verify");function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h=l.DEEP_LINK_ROUTE.replace(/^\//u,"");class m extends s.default{constructor({getExtensionURL:e,getState:t}){super(),p(this,"getExtensionURL",void 0),p(this,"getState",void 0),p(this,"handleBeforeRequest",({tabId:e,url:t})=>e===r.default.tabs.TAB_ID_NONE?{}:this.tryNavigateTo(e,t)),this.getExtensionURL=e,this.getState=t}get404ErrorURL(){return this.getExtensionURL(h,new URLSearchParams({errorCode:"404"}).toString())}async redirectTab(e,t){try{await r.default.tabs.update(e,{url:t})}catch(e){a.default.error("Error redirecting tab:",e),this.emit("error",e)}}install(){r.default.webRequest.onBeforeRequest.addListener(this.handleBeforeRequest,{urls:[`*://*.${c.DEEP_LINK_HOST}/*`],types:["main_frame"]},i.isManifestV3?[]:["blocking"])}uninstall(){r.default.webRequest.onBeforeRequest.removeListener(this.handleBeforeRequest)}async tryNavigateTo(e,t){if(t.length>c.DEEP_LINK_MAX_LENGTH)return a.default.debug("Url is too long, skipping deep link handling"),{};let n;try{const e=new URL(t),s=await(0,o.parse)(e);if(s)if(this.emit("navigate",{url:e,parsed:s}),"redirectTo"in s.destination)n=s.destination.redirectTo.toString();else if(this.canSkipInterstitial(s.signature))n=this.getExtensionURL(s.destination.path,s.destination.query.toString());else{const t=new URLSearchParams({u:e.pathname+e.search});n=this.getExtensionURL(h,t.toString())}else n=this.get404ErrorURL()}catch(e){a.default.error("Invalid URL:",t,e),this.emit("error",e),n=this.get404ErrorURL()}return this.redirectTab(e,n),i.isManifestV3?{}:{cancel:!0}}canSkipInterstitial(e){var t;return e===u.VALID&&Boolean(null===(t=this.getState().preferences)||void 0===t?void 0:t.skipDeepLinkInterstitial)}}n.DeepLinkRouter=m}}},{package:"$root$",file:"app/scripts/lib/deep-links/deep-link-router.ts"}],[154,{"../../../../shared/constants/metametrics":5259},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createEvent=function({signature:e,url:t}){const n={route:t.pathname,signature:e},a={};for(const[e,s]of t.searchParams.entries())"sig"!==e&&("attributionId"===e?n.attribution_id=s:r.has(e)?n[e]=s:a[e]=s);return{category:s.MetaMetricsEventCategory.DeepLink,event:s.MetaMetricsEventName.DeepLinkUsed,properties:n,sensitiveProperties:a}};var s=e("../../../../shared/constants/metametrics");const r=new Set(["utm_campaign","utm_content","utm_medium","utm_source","utm_term"])}}},{package:"$root$",file:"app/scripts/lib/deep-links/metrics.ts"}],[155,{"@metamask/browser-passworder":1180},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.encryptorFactory=void 0;var s=e("@metamask/browser-passworder");const r=e=>async(t,n,r,a)=>(0,s.encrypt)(t,n,r,a,{algorithm:"PBKDF2",params:{iterations:e}}),a=e=>async(t,n,r)=>(0,s.encryptWithDetail)(t,n,r,{algorithm:"PBKDF2",params:{iterations:e}}),i=e=>async(t,n,r,a)=>(0,s.keyFromPassword)(t,n,r,a??{algorithm:"PBKDF2",params:{iterations:e}}),o=e=>t=>(0,s.isVaultUpdated)(t,{algorithm:"PBKDF2",params:{iterations:e}});n.encryptorFactory=e=>({encrypt:r(e),encryptWithKey:s.encryptWithKey,encryptWithDetail:a(e),decrypt:s.decrypt,decryptWithKey:s.decryptWithKey,decryptWithDetail:s.decryptWithDetail,keyFromPassword:i(e),isVaultUpdated:o(e),importKey:s.importKey,exportKey:s.exportKey,generateSalt:s.generateSalt})}}},{package:"$root$",file:"app/scripts/lib/encryptor-factory.ts"}],[156,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=[{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"resolver",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"label",type:"bytes32"},{name:"owner",type:"address"}],name:"setSubnodeOwner",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"ttl",type:"uint64"}],name:"setTTL",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"ttl",outputs:[{name:"",type:"uint64"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"resolver",type:"address"}],name:"setResolver",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"owner",type:"address"}],name:"setOwner",outputs:[],payable:!1,type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"label",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"NewOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"resolver",type:"address"}],name:"NewResolver",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"ttl",type:"uint64"}],name:"NewTTL",type:"event"}]}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/contracts/registry.js"}],[157,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=[{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes32"}],name:"setContent",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"content",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"interfaceID",type:"bytes4"}],name:"supportsInterface",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"},{name:"value",type:"string"}],name:"setText",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"contentTypes",type:"uint256"}],name:"ABI",outputs:[{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],name:"setPubkey",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes"}],name:"setContenthash",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"addr",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"}],name:"text",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],name:"setABI",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"name",type:"string"}],name:"setName",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"contenthash",outputs:[{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"pubkey",outputs:[{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"addr",type:"address"}],name:"setAddr",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{name:"ensAddr",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"a",type:"address"}],name:"AddrChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"name",type:"string"}],name:"NameChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"contentType",type:"uint256"}],name:"ABIChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"x",type:"bytes32"},{indexed:!1,name:"y",type:"bytes32"}],name:"PubkeyChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"indexedKey",type:"string"},{indexed:!1,name:"key",type:"string"}],name:"TextChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"hash",type:"bytes"}],name:"ContenthashChanged",type:"event"}]}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/contracts/resolver.js"}],[158,{"./contracts/registry":156,"./contracts/resolver":157,"@ensdomains/content-hash":507,"@ethersproject/contracts":595,"@ethersproject/providers":633,"eth-ens-namehash":3795},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=async function({provider:e,name:t}){const n=s.default.hash(t),l=Number.parseInt(await e.request({method:"net_version"}),10),d=function(e){switch(e){case 1:case 3:case 4:case 5:case 6:return"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";default:return null}}(l);if(!d)throw new Error(`EnsIpfsResolver - no known ens-ipfs registry for chainId "${l}"`);const p=new a.Web3Provider(e),h=new i.Contract(d,o.default,p),m=await h.resolver(n);if(u(m))throw new Error(`EnsIpfsResolver - no resolver found for name "${t}"`);const f=new i.Contract(m,c.default,p),g=await f.supportsInterface("0xbc1c58d1"),y=await f.supportsInterface("0xd8389dc5");if(g){const e=(await f.contenthash(n))[0];let t=r.default.decode(e);const s=r.default.getCodec(e);return"ipfs-ns"!==s&&"ipns-ns"!==s||(t=r.default.helpers.cidV0ToV1Base32(t)),{type:s,hash:t}}if(y){const e=(await f.content(n))[0];if(u(e))throw new Error(`EnsIpfsResolver - no content ID found for name "${t}"`);return{type:"swarm-ns",hash:e.slice(2)}}throw new Error(`EnsIpfsResolver - the resolver for name "${t}" is not standard, it should either supports contenthash() or content()`)};var s=l(e("eth-ens-namehash")),r=l(e("@ensdomains/content-hash")),a=e("@ethersproject/providers"),i=e("@ethersproject/contracts"),o=l(e("./contracts/registry")),c=l(e("./contracts/resolver"));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return[undefined,null,"0x","0x0","0x0000000000000000000000000000000000000000000000000000000000000000"].includes(e)}}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/resolver.js"}],[159,{"../../../../shared/modules/fetch-with-timeout":5358,"./resolver":158,"base32-encode":3478,"base64-js":3479,"webextension-polyfill":5227},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({provider:e,getCurrentChainId:t,getIpfsGateway:n,getUseAddressBarEnsResolution:i}){const c=u.map(e=>`*://*.${e}/*`);return a.default.webRequest.onErrorOccurred.addListener(d,{urls:c,types:["main_frame"]}),{remove(){a.default.webRequest.onErrorOccurred.removeListener(d)}};async function d(c){const{tabId:d,url:p}=c;if(-1===d||"0x1"!==t())return;const{hostname:h,pathname:m,search:f,hash:g}=new URL(p),y=h.split("."),w=y[y.length-1];u.includes(w)&&async function({tabId:t,name:c,pathname:u,search:d,fragment:p}){const h=n(),m=i(),f=`https://app.ens.domains/name/${c}`;m&&h&&await a.default.tabs.update(t,{url:"loading.html"});let g=f;0;try{const{type:t,hash:n}=await(0,o.default)({provider:e,name:c});if("ipfs-ns"===t||"ipns-ns"===t){if(""===h)return void(g=null);const e=`https://${n}.${t.slice(0,4)}.${h}${u}${d||""}${p||""}`;try{200===(await l(e,{method:"HEAD"})).status&&(g=e)}catch(e){console.warn(e)}}else if("swarm-ns"===t)g=`https://swarm-gateways.net/bzz:/${n}${u}${d||""}${p||""}`;else if("onion"===t||"onion3"===t)g=`http://${n}.onion${u}${d||""}${p||""}`;else if("zeronet"===t)g=`http://127.0.0.1:43110/${n}${u}${d||""}${p||""}`;else if("skynet-ns"===t){const e=n.padEnd(n.length+4-n.length%4,"="),t=r.default.toByteArray(e),a={padding:!1};g=`https://${(0,s.default)(t,"RFC4648-HEX",a).toLowerCase()}.siasky.net${u}${d||""}${p||""}`}}catch(e){console.warn(e)}finally{g&&(m||!m&&g!==f)&&await a.default.tabs.update(t,{url:g})}}({tabId:d,name:h,pathname:m,search:f,fragment:g})}};var s=c(e("base32-encode")),r=c(e("base64-js")),a=c(e("webextension-polyfill")),i=c(e("../../../../shared/modules/fetch-with-timeout")),o=c(e("./resolver"));function c(e){return e&&e.__esModule?e:{default:e}}const l=(0,i.default)(),u=["eth"]}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/setup.js"}],[16,{"@metamask/assets-controllers":1076},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TokenRatesControllerInit=void 0;var s=e("@metamask/assets-controllers");n.TokenRatesControllerInit=e=>{var t;const{controllerMessenger:n,getController:r,persistedState:a}=e;return{controller:new s.TokenRatesController({messenger:n,state:a.TokenRatesController,tokenPricesService:new s.CodefiTokenPricesServiceV2,disabled:!(null!==(t=r("PreferencesController").state)&&void 0!==t&&t.useCurrencyRateCheck)})}}}}},{package:"$root$",file:"app/scripts/controller-init/assets/token-rates-controller-init.ts"}],[160,{"@metamask/snaps-sdk":2402,"@metamask/snaps-utils":2516},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.forwardRequestToSnap=async function(e,t,n){const{method:a,params:i,origin:o}=n,{handleRequest:c,snapId:l}=e;if(!l)throw new r.InternalError(`No snapId configured for method ${a}`);if(!o)throw new r.InternalError(`No origin specified for method ${a}`);return await c({snapId:l,origin:o,handler:s.HandlerType.OnRpcRequest,request:{jsonrpc:"2.0",method:a,params:i}})};var s=e("@metamask/snaps-utils"),r=e("@metamask/snaps-sdk")}}},{package:"$root$",file:"app/scripts/lib/forwardRequestToSnap.ts"}],[161,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return r((0,s.cloneDeep)(e),e=>null===e?"null":typeof e)};var s=e("lodash");function r(e={},t){return Object.entries(e).forEach(([n,s])=>{e[n]="object"==typeof s&&null!==s?r(s,t):t(s)}),e}}}},{package:"$root$",file:"app/scripts/lib/getObjStructure.js"}],[1611,{"@metamask/keyring-controller":1924},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.EIP5792ErrorCode=n.MessageType=n.KEYRING_TYPES_SUPPORTING_7702=n.VERSION=void 0;const s=e("@metamask/keyring-controller");var r,a;n.VERSION="2.0.0",n.KEYRING_TYPES_SUPPORTING_7702=[s.KeyringTypes.hd,s.KeyringTypes.simple],function(e){e.SendTransaction="eth_sendTransaction"}(r||(n.MessageType=r={})),function(e){e[e.UnsupportedNonOptionalCapability=5700]="UnsupportedNonOptionalCapability",e[e.UnsupportedChainId=5710]="UnsupportedChainId",e[e.UnknownBundleId=5730]="UnknownBundleId",e[e.RejectedUpgrade=5750]="RejectedUpgrade"}(a||(n.EIP5792ErrorCode=a={}))}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/constants.cjs"}],[1612,{"./methods/getCallsStatus.cjs":1613,"./methods/getCapabilities.cjs":1614,"./methods/processSendCalls.cjs":1615},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getCapabilities=n.getCallsStatus=n.processSendCalls=void 0;var s=e("./methods/processSendCalls.cjs");Object.defineProperty(n,"processSendCalls",{enumerable:!0,get:function(){return s.processSendCalls}});var r=e("./methods/getCallsStatus.cjs");Object.defineProperty(n,"getCallsStatus",{enumerable:!0,get:function(){return r.getCallsStatus}});var a=e("./methods/getCapabilities.cjs");Object.defineProperty(n,"getCapabilities",{enumerable:!0,get:function(){return a.getCapabilities}})}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/index.cjs"}],[1613,{"../constants.cjs":1611,"@metamask/eth-json-rpc-middleware":1646,"@metamask/rpc-errors":2224,"@metamask/transaction-controller":2587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getCallsStatus=void 0;const s=e("@metamask/eth-json-rpc-middleware"),r=e("@metamask/rpc-errors"),a=e("@metamask/transaction-controller"),i=e("../constants.cjs");n.getCallsStatus=function(e,t){const n=e.call("TransactionController:getState").transactions.filter(e=>e.batchId===t);if(!n?.length)throw new r.JsonRpcError(i.EIP5792ErrorCode.UnknownBundleId,"No matching bundle found");const o=n[0],{chainId:c,txReceipt:l}=o,u=function(e){const{hash:t,status:n}=e;if(n===a.TransactionStatus.confirmed)return s.GetCallsStatusCode.CONFIRMED;if(n===a.TransactionStatus.failed)return t?s.GetCallsStatusCode.REVERTED:s.GetCallsStatusCode.FAILED_OFFCHAIN;if(n===a.TransactionStatus.dropped)return s.GetCallsStatusCode.REVERTED;return s.GetCallsStatusCode.PENDING}(o),d=l,p=d?.logs??[],h=d&&[{blockHash:d.blockHash,blockNumber:d.blockNumber,gasUsed:d.gasUsed,logs:p.map(e=>({address:e.address,data:e.data,topics:e.topics})),status:d.status,transactionHash:d.transactionHash}];return{version:i.VERSION,id:t,chainId:c,atomic:!0,status:u,receipts:h}}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/methods/getCallsStatus.cjs"}],[1614,{"../constants.cjs":1611,"../utils.cjs":1616},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getCapabilities=void 0;const s=e("../constants.cjs"),r=e("../utils.cjs");n.getCapabilities=async function(e,t,n,a){const{getDismissSmartAccountSuggestionEnabled:i,getIsSmartTransaction:o,isAtomicBatchSupported:c,isRelaySupported:l,getSendBundleSupportedChains:u}=e;let d=a?.map(e=>e.toLowerCase());if(!d?.length){const e=t.call("NetworkController:getState").networkConfigurationsByChainId;d=Object.keys(e)}const p=await c({address:n,chainIds:d}),h=await async function(e,t,n,s,r,a){const i=a.call("PreferencesController:getState").useTransactionSimulations,o=await Promise.all(t.map(({chainId:e})=>e).map(e=>s(e))),c=await r(e),l=t.map((e,t)=>({...e,relaySupportedForChain:o[t]}));return e.reduce((e,t)=>{const s=l.find(({chainId:e})=>e===t)??{},{isSupported:r=!1,relaySupportedForChain:a}=s,o=n(t),u=c[t]??!1;return i&&(o&&u||r&&a)&&(e[t]={alternateGasFees:{supported:!0}}),e},{})}(d,p,o,l,u,t);return d.reduce((e,a)=>{const o=p.find(({chainId:e})=>e===a)??{},{delegationAddress:c,isSupported:l,upgradeContractAddress:u}=o,d=i();let h=!1;try{const e=(0,r.getAccountKeyringType)(n,t);h=s.KEYRING_TYPES_SUPPORTING_7702.includes(e)}catch{}if(!l&&!(!d&&u&&!c&&h))return e;const m=l?"supported":"ready";return e[a]===undefined&&(e[a]={}),e[a].atomic={status:m},e},h)}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/methods/getCapabilities.cjs"}],[1615,{"../constants.cjs":1611,"../utils.cjs":1616,"@metamask/rpc-errors":2224,"@metamask/transaction-controller":2587,"@metamask/utils":2632,uuid:5195},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.processSendCalls=void 0;const s=e("@metamask/rpc-errors"),r=e("@metamask/transaction-controller"),a=e("@metamask/utils"),i=e("uuid"),o=e("../constants.cjs"),c=e("../utils.cjs");function l(e){const{version:t}=e;if(t!==o.VERSION)throw s.rpcErrors.invalidInput(`Version not supported: Got ${t}, expected ${o.VERSION}`)}function u(e,t){const{chainId:n}=e;if(n&&n.toLowerCase()!==t.toLowerCase())throw s.rpcErrors.invalidParams(`Chain ID must match the dApp selected network: Got ${n}, expected ${t}`)}function d(e){const{calls:t,capabilities:n}=e,r=[...Object.keys(n??{}).filter(e=>!0!==n?.[e].optional),...t.flatMap(e=>Object.keys(e.capabilities??{}).filter(t=>!0!==e.capabilities?.[t].optional))];if(r?.length)throw new s.JsonRpcError(o.EIP5792ErrorCode.UnsupportedNonOptionalCapability,`Unsupported non-optional capabilities: ${r.join(", ")}`)}n.processSendCalls=async function(e,t,n,p){const{addTransactionBatch:h,addTransaction:m,getDismissSmartAccountSuggestionEnabled:f,isAtomicBatchSupported:g,validateSecurity:y}=e,{calls:w,from:b}=n,{networkClientId:E,origin:v}=p,T=w.map(e=>({params:e})),{chainId:S}=t.call("NetworkController:getNetworkClientById",E).configuration,A=b??t.call("AccountsController:getSelectedAccount").address,k=(0,i.v4)(),_=y.bind(null,k);let M;return M=1===Object.keys(T).length?await async function({addTransaction:e,chainId:t,from:n,networkClientId:s,origin:c,securityAlertId:p,sendCalls:h,transactions:m,validateSecurity:f}){!function(e,t){l(e),d(e),u(e,t)}(h,t);const g={from:n,...m[0].params,type:r.TransactionEnvelopeType.feeMarket},y={method:o.MessageType.SendTransaction,params:[g],origin:c};f(y,t);const w=function(){const e=(0,i.v4)(),t=new Uint8Array((0,i.parse)(e));return(0,a.bytesToHex)(t)}();return await e(g,{networkClientId:s,origin:c,securityAlertResponse:{securityAlertId:p},batchId:w}),w}({addTransaction:m,chainId:S,from:A,networkClientId:E,origin:v,securityAlertId:k,sendCalls:n,transactions:T,validateSecurity:_}):await async function({addTransactionBatch:e,isAtomicBatchSupported:t,chainId:n,from:r,getDismissSmartAccountSuggestionEnabled:a,networkClientId:i,messenger:p,origin:h,sendCalls:m,securityAlertId:f,transactions:g,validateSecurity:y}){const w=await t({address:r,chainIds:[n]}),b=w?.[0],E=(0,c.getAccountKeyringType)(r,p),v=a();!function(e,t,n,r,a){l(e),function(e,t,n){if(u(e,t),!n)throw new s.JsonRpcError(o.EIP5792ErrorCode.UnsupportedChainId,`EIP-7702 not supported on chain: ${t}`)}(e,t,r),d(e),function(e,t,n){if(t?.delegationAddress)return;if(e)throw new s.JsonRpcError(o.EIP5792ErrorCode.RejectedUpgrade,"EIP-7702 upgrade disabled by the user");if(!o.KEYRING_TYPES_SUPPORTING_7702.includes(n))throw new s.JsonRpcError(o.EIP5792ErrorCode.RejectedUpgrade,"EIP-7702 upgrade not supported on account")}(n,r,a)}(m,n,v,b,E);const T=await e({from:r,networkClientId:i,origin:h,securityAlertId:f,transactions:g,validateSecurity:y});return T.batchId}({addTransactionBatch:h,isAtomicBatchSupported:g,chainId:S,from:A,getDismissSmartAccountSuggestionEnabled:f,messenger:t,networkClientId:E,origin:v,sendCalls:n,securityAlertId:k,transactions:T,validateSecurity:_}),{id:M}}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/methods/processSendCalls.cjs"}],[1616,{"./constants.cjs":1611,"@metamask/rpc-errors":2224},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAccountKeyringType=void 0;const s=e("@metamask/rpc-errors"),r=e("./constants.cjs");n.getAccountKeyringType=function(e,t){const{accounts:n}=t.call("AccountsController:getState").internalAccounts,a=Object.values(n).find(t=>t.address.toLowerCase()===e.toLowerCase()),i=a?.metadata?.keyring?.type;if(!i)throw new s.JsonRpcError(r.EIP5792ErrorCode.RejectedUpgrade,"EIP-7702 upgrade not supported as account type is unknown");return i}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/utils.cjs"}],[1617,{"@ethersproject/providers":633,"@metamask/base-controller":1140,"@metamask/controller-utils":1224,"@metamask/utils":2632,"punycode/punycode.js":4666},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},l=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.EnsController=n.DEFAULT_ENS_NETWORK_MAP=void 0;const u=e("@ethersproject/providers"),d=e("@metamask/base-controller"),p=e("@metamask/controller-utils"),h=e("@metamask/utils"),m=e("punycode/punycode.js"),f=(0,h.createProjectLogger)("ens-controller");n.DEFAULT_ENS_NETWORK_MAP={1:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",3:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",4:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",5:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",17e3:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",11155111:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"};const g={ensEntries:{persist:!0,anonymous:!1},ensResolutionsByAddress:{persist:!0,anonymous:!1}},y={ensEntries:{},ensResolutionsByAddress:{}};class w extends d.BaseController{constructor({registriesByChainId:e=n.DEFAULT_ENS_NETWORK_MAP,messenger:t,state:o={},onNetworkDidChange:l}){super({name:"EnsController",metadata:g,messenger:t,state:{...y,ensEntries:Object.fromEntries(Object.entries(e).map(([e,t])=>[(0,p.toHex)(e),{".":{address:t,chainId:(0,p.toHex)(e),ensName:"."}}])),...o}}),s.add(this),r.set(this,null),c(this,s,"m",a).call(this,e),l&&l(({selectedNetworkClientId:t})=>{this.resetState(),c(this,s,"m",i).call(this,t,e)})}resetState(){this.update(e=>{e.ensResolutionsByAddress={}})}clear(){this.update(e=>{e.ensEntries={}})}delete(e,t){const n=(0,p.normalizeEnsName)(t);return!!((0,p.isSafeDynamicKey)(e)&&n&&this.state.ensEntries[e]&&this.state.ensEntries[e][n])&&(this.update(t=>{delete t.ensEntries[e][n],0===Object.keys(t.ensEntries[e]).length&&delete t.ensEntries[e]}),!0)}get(e,t){const n=(0,p.normalizeEnsName)(t);return n&&this.state.ensEntries[e]&&this.state.ensEntries[e][n]||null}set(e,t,n){if(!Number.isInteger(Number.parseInt(e,10))||!t||"string"!=typeof t||n&&!(0,p.isValidHexAddress)(n))throw new Error(`Invalid ENS entry: { chainId:${e}, ensName:${t}, address:${n}}`);const s=(0,p.normalizeEnsName)(t);if(!s)throw new Error(`Invalid ENS name: ${t}`);const r=n?(0,p.toChecksumHexAddress)(n):null,a=this.state.ensEntries[e];return(!a?.[s]||a[s].address!==r)&&(this.update(t=>{t.ensEntries={...this.state.ensEntries,[e]:{...this.state.ensEntries[e],[s]:{address:r,chainId:e,ensName:s}}}}),!0)}async reverseResolveAddress(e){if(!c(this,r,"f"))return undefined;const t=(0,p.toChecksumHexAddress)(e);if(this.state.ensResolutionsByAddress[t])return this.state.ensResolutionsByAddress[t];let n,s;try{n=await c(this,r,"f").lookupAddress(t)}catch(e){return f(e),undefined}if(!n)return undefined;try{s=await c(this,r,"f").resolveName(n)}catch(e){return f(e),undefined}return s?"0x0000000000000000000000000000000000000000"===s||"0x"===s||(0,p.toChecksumHexAddress)(s)!==t?undefined:(this.update(e=>{e.ensResolutionsByAddress[t]=(0,m.toASCII)(n)}),n):undefined}}n.EnsController=w,r=new WeakMap,s=new WeakSet,a=function(e){const{selectedNetworkClientId:t}=this.messagingSystem.call("NetworkController:getState");c(this,s,"m",i).call(this,t,e)},i=function(e,t){const{configuration:{chainId:n},provider:a}=this.messagingSystem.call("NetworkController:getNetworkClientById",e);t&&t[parseInt(n,16)]&&c(this,s,"m",o).call(this,n)?l(this,r,new u.Web3Provider(a,{chainId:(0,p.convertHexToDecimal)(n),name:p.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP[n],ensAddress:t[parseInt(n,16)]}),"f"):l(this,r,null,"f")},o=function(e){return Boolean(this.state.ensEntries[e])},n.default=w}}},{package:"@metamask/ens-controller",file:"node_modules/@metamask/ens-controller/dist/EnsController.cjs"}],[1618,{"./EnsController.cjs":1617},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./EnsController.cjs"),n)}}},{package:"@metamask/ens-controller",file:"node_modules/@metamask/ens-controller/dist/index.cjs"}],[1619,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},i=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorReportingService=void 0;n.ErrorReportingService=class{constructor({messenger:e,captureException:t}){s.set(this,void 0),r.set(this,void 0),a(this,r,e,"f"),a(this,s,t,"f"),i(this,r,"f").registerActionHandler("ErrorReportingService:captureException",i(this,s,"f").bind(this))}captureException(e){i(this,s,"f").call(this,e)}},s=new WeakMap,r=new WeakMap}}},{package:"@metamask/error-reporting-service",file:"node_modules/@metamask/error-reporting-service/dist/error-reporting-service.cjs"}],[162,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.hardwareKeyringBuilderFactory=function(e,t){const n=()=>new e({bridge:new t});return n.type=e.type,n}}}},{package:"$root$",file:"app/scripts/lib/hardware-keyring-builder-factory.ts"}],[1620,{"./error-reporting-service.cjs":1619},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorReportingService=void 0;var s=e("./error-reporting-service.cjs");Object.defineProperty(n,"ErrorReportingService",{enumerable:!0,get:function(){return s.ErrorReportingService}})}}},{package:"@metamask/error-reporting-service",file:"node_modules/@metamask/error-reporting-service/dist/index.cjs"}],[1627,{"./base-filter":1628},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const s=e("./base-filter");t.exports=class extends s{constructor(){super(),this.allResults=[]}async update(){throw new Error("BaseFilterWithHistory - no update method specified")}addResults(e){this.allResults=this.allResults.concat(e),super.addResults(e)}addInitialResults(e){this.allResults=this.allResults.concat(e),super.addInitialResults(e)}getAllResults(){return this.allResults}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/base-filter-history.js"}],[1628,{"@metamask/safe-event-emitter":2226},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const s=e("@metamask/safe-event-emitter").default;t.exports=class extends s{constructor(){super(),this.updates=[]}async initialize(){}async update(){throw new Error("BaseFilter - no update method specified")}addResults(e){this.updates=this.updates.concat(e),e.forEach(e=>this.emit("update",e))}addInitialResults(e){}getChangesAndClear(){const e=this.updates;return this.updates=[],e}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/base-filter.js"}],[1629,{"./base-filter":1628,"./getBlocksForRange":1630,"./hexUtils":1631},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const s=e("./base-filter"),r=e("./getBlocksForRange"),{incrementHexInt:a}=e("./hexUtils");t.exports=class extends s{constructor({provider:e,params:t}){super(),this.type="block",this.provider=e}async update({oldBlock:e,newBlock:t}){const n=t,s=a(e),i=(await r({provider:this.provider,fromBlock:s,toBlock:n})).map(e=>e.hash);this.addResults(i)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/block-filter.js"}],[1630,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e){return e===undefined||null===e?e:Number.parseInt(e,16)}function r(e){if(e===undefined||null===e)return e;return"0x"+e.toString(16)}t.exports=async function({provider:e,fromBlock:t,toBlock:n}){t||(t=n);const a=s(t),i=s(n),o=Array(i-a+1).fill().map((e,t)=>a+t).map(r);let c=await Promise.all(o.map(t=>async function(e,t,n){for(let s=0;s<3;s++)try{return e.request({id:1,jsonrpc:"2.0",method:t,params:n})}catch(e){console.error(`provider.request failed: ${e.stack||e.message||e}`)}return null}(e,"eth_getBlockByNumber",[t,!1])));return c=c.filter(e=>null!==e),c}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/getBlocksForRange.js"}],[1631,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e){return e.sort((e,t)=>"latest"===e||"earliest"===t?1:"latest"===t||"earliest"===e?-1:r(e)-r(t))}function r(e){return e===undefined||null===e?e:Number.parseInt(e,16)}function a(e){if(e===undefined||null===e)return e;let t=e.toString(16);return t.length%2&&(t="0"+t),"0x"+t}function i(){return Math.floor(16*Math.random()).toString(16)}t.exports={minBlockRef:function(...e){return s(e)[0]},maxBlockRef:function(...e){const t=s(e);return t[t.length-1]},sortBlockRefs:s,bnToHex:function(e){return"0x"+e.toString(16)},blockRefIsNumber:function(e){return e&&!["earliest","latest","pending"].includes(e)},hexToInt:r,incrementHexInt:function(e){if(e===undefined||null===e)return e;return a(r(e)+1)},intToHex:a,unsafeRandomBytes:function(e){let t="0x";for(let n=0;n<e;n++)t+=i(),t+=i();return t}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/hexUtils.js"}],[1632,{"./block-filter.js":1629,"./hexUtils":1631,"./log-filter.js":1633,"./tx-filter.js":1635,"@metamask/json-rpc-engine":1863,"async-mutex":3415},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const s=e("async-mutex").Mutex,{createAsyncMiddleware:r,createScaffoldMiddleware:a}=e("@metamask/json-rpc-engine"),i=e("./log-filter.js"),o=e("./block-filter.js"),c=e("./tx-filter.js"),{intToHex:l,hexToInt:u}=e("./hexUtils");function d(e){return p(async(...t)=>{const n=await e(...t);return l(n.id)})}function p(e){return r(async(t,n)=>{const s=await e.apply(null,t.params);n.result=s})}function h(e,t){const n=[];for(let t in e)n.push(e[t]);return n}t.exports=function({blockTracker:e,provider:t}){let n=0,r={};const m=new s,f=function({mutex:e}){return t=>async(n,s,r,a)=>{(await e.acquire())(),t(n,s,r,a)}}({mutex:m}),g=a({eth_newFilter:f(d(w)),eth_newBlockFilter:f(d(b)),eth_newPendingTransactionFilter:f(d(E)),eth_uninstallFilter:f(p(S)),eth_getFilterChanges:f(p(v)),eth_getFilterLogs:f(p(T))}),y=async({oldBlock:e,newBlock:t})=>{if(0===r.length)return;const n=await m.acquire();try{await Promise.all(h(r).map(async n=>{try{await n.update({oldBlock:e,newBlock:t})}catch(e){console.error(e)}}))}catch(e){console.error(e)}n()};return g.newLogFilter=w,g.newBlockFilter=b,g.newPendingTransactionFilter=E,g.uninstallFilter=S,g.getFilterChanges=v,g.getFilterLogs=T,g.destroy=()=>{!async function(){const e=h(r).length;r={},k({prevFilterCount:e,newFilterCount:0})}()},g;async function w(e){const n=new i({provider:t,params:e});await A(n);return n}async function b(){const e=new o({provider:t});await A(e);return e}async function E(){const e=new c({provider:t});await A(e);return e}async function v(e){const t=u(e),n=r[t];if(!n)throw new Error(`No filter for index "${t}"`);return n.getChangesAndClear()}async function T(e){const t=u(e),n=r[t];if(!n)throw new Error(`No filter for index "${t}"`);let s=[];return"log"===n.type&&(s=n.getAllResults()),s}async function S(e){const t=u(e),n=r[t],s=Boolean(n);return s&&await async function(e){const t=h(r).length;delete r[e];const n=h(r).length;k({prevFilterCount:t,newFilterCount:n})}(t),s}async function A(t){const s=h(r).length,a=await e.getLatestBlock();await t.initialize({currentBlock:a}),n++,r[n]=t,t.id=n,t.idHex=l(n);return k({prevFilterCount:s,newFilterCount:h(r).length}),n}function k({prevFilterCount:t,newFilterCount:n}){0===t&&n>0?e.on("sync",y):t>0&&0===n&&e.removeListener("sync",y)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/index.js"}],[1633,{"./base-filter-history":1627,"./hexUtils":1631,"@metamask/eth-query":1756,pify:4593},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const s=e("@metamask/eth-query"),r=e("pify"),a=e("./base-filter-history"),{bnToHex:i,hexToInt:o,incrementHexInt:c,minBlockRef:l,blockRefIsNumber:u}=e("./hexUtils");t.exports=class extends a{constructor({provider:e,params:t}){super(),this.type="log",this.ethQuery=new s(e),this.params=Object.assign({fromBlock:"latest",toBlock:"latest",address:undefined,topics:[]},t),this.params.address&&(Array.isArray(this.params.address)||(this.params.address=[this.params.address]),this.params.address=this.params.address.map(e=>e.toLowerCase()))}async initialize({currentBlock:e}){let t=this.params.fromBlock;["latest","pending"].includes(t)&&(t=e),"earliest"===t&&(t="0x0"),this.params.fromBlock=t;const n=l(this.params.toBlock,e),s=Object.assign({},this.params,{toBlock:n}),r=await this._fetchLogs(s);this.addInitialResults(r)}async update({oldBlock:e,newBlock:t}){const n=t;let s;s=e?c(e):t;const r=Object.assign({},this.params,{fromBlock:s,toBlock:n}),a=(await this._fetchLogs(r)).filter(e=>this.matchLog(e));this.addResults(a)}async _fetchLogs(e){return await r(t=>this.ethQuery.getLogs(e,t))()}matchLog(e){if(o(this.params.fromBlock)>=o(e.blockNumber))return!1;if(u(this.params.toBlock)&&o(this.params.toBlock)<=o(e.blockNumber))return!1;const t=e.address&&e.address.toLowerCase();if(this.params.address&&t&&!this.params.address.includes(t))return!1;return this.params.topics.every((t,n)=>{let s=e.topics[n];if(!s)return!1;s=s.toLowerCase();let r=Array.isArray(t)?t:[t];if(r.includes(null))return!0;r=r.map(e=>e.toLowerCase());return r.includes(s)})}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/log-filter.js"}],[1634,{"./getBlocksForRange.js":1630,"./hexUtils.js":1631,"./index.js":1632,"@metamask/json-rpc-engine":1863,"@metamask/safe-event-emitter":2226},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const s=e("@metamask/safe-event-emitter").default,{createAsyncMiddleware:r,createScaffoldMiddleware:a}=e("@metamask/json-rpc-engine"),i=e("./index.js"),{unsafeRandomBytes:o,incrementHexInt:c}=e("./hexUtils.js"),l=e("./getBlocksForRange.js");function u(e){return null===e||e===undefined?null:{hash:e.hash,parentHash:e.parentHash,sha3Uncles:e.sha3Uncles,miner:e.miner,stateRoot:e.stateRoot,transactionsRoot:e.transactionsRoot,receiptsRoot:e.receiptsRoot,logsBloom:e.logsBloom,difficulty:e.difficulty,number:e.number,gasLimit:e.gasLimit,gasUsed:e.gasUsed,nonce:e.nonce,mixHash:e.mixHash,timestamp:e.timestamp,extraData:e.extraData}}t.exports=function({blockTracker:e,provider:t}){const n={},d=i({blockTracker:e,provider:t});let p=!1;const h=new s,m=a({eth_subscribe:r(async function(s,r){if(p)throw new Error("SubscriptionManager - attempting to use after destroying");const a=s.params[0],i=o(16);let h;switch(a){case"newHeads":h=m({subId:i});break;case"logs":const e=s.params[1];h=g({subId:i,filter:await d.newLogFilter(e)});break;default:throw new Error(`SubscriptionManager - unsupported subscription type "${a}"`)}return n[i]=h,void(r.result=i);function m({subId:n}){const s={type:a,destroy:async()=>{e.removeListener("sync",s.update)},update:async({oldBlock:e,newBlock:s})=>{const r=s,a=c(e);(await l({provider:t,fromBlock:a,toBlock:r})).map(u).filter(e=>null!==e).forEach(e=>{f(n,e)})}};return e.on("sync",s.update),s}function g({subId:e,filter:t}){t.on("update",t=>f(e,t));return{type:a,destroy:async()=>await d.uninstallFilter(t.idHex)}}}),eth_unsubscribe:r(async function(e,t){if(p)throw new Error("SubscriptionManager - attempting to use after destroying");const s=e.params[0],r=n[s];if(!r)return void(t.result=!1);delete n[s],await r.destroy(),t.result=!0})});return m.destroy=function(){h.removeAllListeners();for(const e in n)n[e].destroy(),delete n[e];p=!0},{events:h,middleware:m};function f(e,t){h.emit("notification",{jsonrpc:"2.0",method:"eth_subscription",params:{subscription:e,result:t}})}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/subscriptionManager.js"}],[1635,{"./base-filter":1628,"./getBlocksForRange":1630,"./hexUtils":1631},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const s=e("./base-filter"),r=e("./getBlocksForRange"),{incrementHexInt:a}=e("./hexUtils");t.exports=class extends s{constructor({provider:e}){super(),this.type="tx",this.provider=e}async update({oldBlock:e}){const t=e,n=a(e),s=await r({provider:this.provider,fromBlock:n,toBlock:t}),i=[];for(const e of s)i.push(...e.transactions);this.addResults(i)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/tx-filter.js"}],[164,{"../util":237,"@metamask/json-rpc-engine":1863},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createPendingNonceMiddleware=function({getPendingNonce:e}){return(0,s.createAsyncMiddleware)(async(t,n,s)=>{const{method:r,params:a}=t;if("eth_getTransactionCount"!==r)return void s();const[i,o]=a;"pending"===o?n.result=await e(i,t.networkClientId):s()})},n.createPendingTxMiddleware=function({getPendingTransactionByHash:e}){return(0,s.createAsyncMiddleware)(async(t,n,s)=>{const{method:a,params:i}=t;if("eth_getTransactionByHash"!==a)return void s();const[o]=i,c=e(o);c?n.result=(0,r.formatTxMetaForRpcResult)(c):s()})};var s=e("@metamask/json-rpc-engine"),r=e("../util")}}},{package:"$root$",file:"app/scripts/lib/middleware/pending.js"}],[165,{events:3902,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=a(e("events")),r=a(e("loglevel"));function a(e){return e&&e.__esModule?e:{default:e}}class i extends s.default{constructor(e={}){super();const t=e.migrations||[];this.migrations=t.sort((e,t)=>e.version-t.version);const n=this.migrations.slice(-1)[0];this.defaultVersion=e.defaultVersion||n&&n.version||0}async migrateData(e=this.generateInitialState()){const t=this.migrations.filter(function(t){return t.version>e.meta.version});for(const n of t)try{r.default.info(`Running migration ${n.version}...`);const t=await n.migrate(e);if(!t.data)throw new Error("Migrator - migration returned empty data");if(t.version!==undefined&&t.meta.version!==n.version)throw new Error("Migrator - Migration did not update version number correctly");e=t,r.default.info(`Migration ${n.version} complete`)}catch(t){const s=t.message;return t.message=`MetaMask Migration Error #${n.version}: ${s}`,this.emit("error",t),e}return e}generateInitialState(e){return{data:e,meta:{version:this.defaultVersion}}}}n.default=i}}},{package:"$root$",file:"app/scripts/lib/migrator/index.js"}],[1667,{"./ledger-hw-app.cjs":1669,"./ledger-iframe-bridge.cjs":1670,"./ledger-keyring.cjs":1671,"./ledger-mobile-bridge.cjs":1672,"./ledger-transport-middleware.cjs":1673},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./ledger-keyring.cjs"),n),r(e("./ledger-iframe-bridge.cjs"),n),r(e("./ledger-mobile-bridge.cjs"),n),r(e("./ledger-transport-middleware.cjs"),n),r(e("./ledger-hw-app.cjs"),n)}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/index.cjs"}],[1668,{"./type.cjs":1674,"@ledgerhq/hw-transport":820},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.handleLedgerTransportError=function(e,t){if(e instanceof s.TransportStatusError){const t=e;throw new r.LedgerStatusError(t.statusCode,function(e){switch(e.statusCode){case 27013:return"Ledger: User rejected the transaction";case 27264:return"Ledger: Blind signing must be enabled";case 21781:return"Ledger: Device is locked. Unlock it to continue";case 25871:return"Ledger: Ethereum app closed. Open it to unlock";default:return e.message}}(t))}throw e instanceof Error?e:new Error(t)};const s=e("@ledgerhq/hw-transport"),r=e("./type.cjs")}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-error-handler.cjs"}],[1669,{"@ledgerhq/hw-app-eth":805,buffer:3590},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.MetaMaskLedgerHwAppEth=void 0;const r=s(e("@ledgerhq/hw-app-eth")),a=e("buffer");class i extends r.default{constructor(){super(...arguments),this.mainAppName="BOLOS",this.ethAppName="Ethereum",this.transportEncoding="ascii"}async openEthApp(){await this.transport.send(224,216,0,0,a.Buffer.from(this.ethAppName,this.transportEncoding))}async closeApps(){await this.transport.send(176,167,0,0)}async getAppNameAndVersion(){const e=await this.transport.send(176,1,0,0);if(1!==e[0])throw new Error("Incorrect format return from getAppNameAndVersion.");let t=1;const n=e[t]??0;t+=1;const s=e.slice(t,t+=n).toString(this.transportEncoding),r=e[t]??0;t+=1;return{appName:s,version:e.slice(t,t+=r).toString(this.transportEncoding)}}}n.MetaMaskLedgerHwAppEth=i}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-hw-app.cjs"}],[167,{"../../../../shared/constants/metametrics":5259,"../../../../shared/lib/only-keep-host":5334,"./utils":168,"@metamask/utils":2632,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.onRpcEndpointDegraded=function({chainId:e,endpointUrl:t,error:n,infuraProjectId:s,metaMetricsId:r,trackEvent:a}){l(i.MetaMetricsEventName.RpcServiceDegraded,{chainId:e,endpointUrl:t,error:n,infuraProjectId:s,metaMetricsId:r,trackEvent:a})},n.onRpcEndpointUnavailable=function({chainId:e,endpointUrl:t,error:n,infuraProjectId:s,metaMetricsId:r,trackEvent:a}){l(i.MetaMetricsEventName.RpcServiceUnavailable,{chainId:e,endpointUrl:t,error:n,infuraProjectId:s,metaMetricsId:r,trackEvent:a})},n.trackRpcEndpointEvent=l;var s,r=(s=e("loglevel"))&&s.__esModule?s:{default:s},a=e("@metamask/utils"),i=e("../../../../shared/constants/metametrics"),o=e("../../../../shared/lib/only-keep-host"),c=e("./utils");function l(e,{chainId:t,endpointUrl:n,error:s,infuraProjectId:l,trackEvent:u,metaMetricsId:d}){if(!(0,c.shouldCreateRpcServiceEvents)({endpointUrl:n,error:s,infuraProjectId:l,metaMetricsId:d}))return;const p={chain_id_caip:`eip155:${(0,a.hexToNumber)(t)}`,rpc_endpoint_url:(0,o.onlyKeepHost)(n),...(0,a.isObject)(s)&&"httpStatus"in s&&(0,a.isValidJson)(s.httpStatus)?{http_status:s.httpStatus}:{}};r.default.debug(`Creating Segment event "${e}" with ${JSON.stringify(p)}`),u({category:i.MetaMetricsEventCategory.Network,event:e,properties:p})}}}},{package:"$root$",file:"app/scripts/lib/network-controller/messenger-action-handlers.ts"}],[1670,{"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,l,u,d,p=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},h=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.LedgerIframeBridge=n.IFrameMessageAction=void 0;const m=e("@metamask/utils");var f;!function(e){e.LedgerIsIframeReady="ledger-is-iframe-ready",e.LedgerConnectionChange="ledger-connection-change",e.LedgerUnlock="ledger-unlock",e.LedgerMakeApp="ledger-make-app",e.LedgerUpdateTransport="ledger-update-transport",e.LedgerSignTransaction="ledger-sign-transaction",e.LedgerSignPersonalMessage="ledger-sign-personal-message",e.LedgerSignTypedData="ledger-sign-typed-data"}(f||(n.IFrameMessageAction=f={}));n.LedgerIframeBridge=class{constructor(e={bridgeUrl:"https://metamask.github.io/eth-ledger-bridge-keyring"}){s.add(this),this.iframeLoaded=!1,r.set(this,void 0),this.isDeviceConnected=!1,this.currentMessageId=0,a.set(this,new Map),p(this,s,"m",d).call(this,e),h(this,r,{bridgeUrl:e?.bridgeUrl},"f")}async init(){await p(this,s,"m",o).call(this,p(this,r,"f").bridgeUrl),this.eventListener=p(this,s,"m",l).bind(this,p(this,r,"f").bridgeUrl),window.addEventListener("message",this.eventListener)}async destroy(){this.eventListener&&window.removeEventListener("message",this.eventListener)}async getOptions(){return p(this,r,"f")}async setOptions(e){p(this,s,"m",d).call(this,e),p(this,r,"f")?.bridgeUrl!==e.bridgeUrl&&(p(this,r,"f").bridgeUrl=e.bridgeUrl,await this.destroy(),await this.init())}async attemptMakeApp(){const e=await p(this,s,"m",u).call(this,{action:f.LedgerMakeApp},{timeout:8e3});if("success"in e&&e.success)return!0;throw"error"in e?e.error:new Error("Unknown error occurred")}async updateTransportMethod(e){if(!this.iframeLoaded)throw new Error("The iframe is not loaded yet");const t=await p(this,s,"m",u).call(this,{action:f.LedgerUpdateTransport,params:{transportType:e}},{timeout:8e3});if("success"in t&&t.success)return!0;throw new Error("Ledger transport could not be updated")}async getPublicKey(e){return p(this,s,"m",i).call(this,f.LedgerUnlock,e)}async deviceSignTransaction(e){return p(this,s,"m",i).call(this,f.LedgerSignTransaction,e)}async deviceSignMessage(e){return p(this,s,"m",i).call(this,f.LedgerSignPersonalMessage,e)}async deviceSignTypedData(e){return p(this,s,"m",i).call(this,f.LedgerSignTypedData,e)}},r=new WeakMap,a=new WeakMap,s=new WeakSet,i=async function(...[e,t]){const n=await p(this,s,"m",u).call(this,{action:e,params:t});if("payload"in n&&n.payload){if("success"in n&&n.success)return n.payload;if("error"in n.payload)throw n.payload.error}throw new Error("Unknown error occurred")},o=async function(e){return new Promise(t=>{this.iframe=document.createElement("iframe"),this.iframe.src=e,this.iframe.allow="hid 'src'",this.iframe.onload=async()=>{this.iframeLoaded=!0,t()},document.head.appendChild(this.iframe)})},c=function(e){const t=e.split("/");return t.splice(-1,1),t.join("/")},l=function(e,t){const{origin:n,data:r}=t;if(n===p(this,s,"m",c).call(this,e)&&r){const e=p(this,a,"f").get(r.messageId);e?(e.resolve(r),p(this,a,"f").delete(r.messageId)):r.action===f.LedgerConnectionChange&&(this.isDeviceConnected=r.payload.connected)}},u=async function(e,{timeout:t}={}){this.currentMessageId+=1;const n={...e,messageId:this.currentMessageId,target:"LEDGER-IFRAME"},s=(0,m.createDeferredPromise)();if(p(this,a,"f").set(this.currentMessageId,s),!this.iframeLoaded||!this.iframe?.contentWindow)throw new Error("The iframe is not loaded yet");return t&&setTimeout(()=>{p(this,a,"f").has(n.messageId)&&(p(this,a,"f").delete(n.messageId),s.reject(new Error("Ledger iframe message timeout")))},t),this.iframe.contentWindow.postMessage(n,"*"),s.promise},d=function(e){if("string"!=typeof e.bridgeUrl||0===e.bridgeUrl.length)throw new Error("bridgeURL is not a valid URL")}}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-iframe-bridge.cjs"}],[1671,{"./ledger-error-handler.cjs":1668,"@ethereumjs/rlp":519,"@ethereumjs/tx":532,"@ethereumjs/util":546,"@metamask/eth-sig-util":1758,"@metamask/utils":2632,buffer:3590,hdkey:4137},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,l,u,d,p,h,m,f,g,y=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},w=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.LedgerKeyring=void 0;const b=e("@ethereumjs/rlp"),E=e("@ethereumjs/tx"),v=e("@ethereumjs/util"),T=e("@metamask/eth-sig-util"),S=e("@metamask/utils"),A=e("buffer"),k=w(e("hdkey")),_=e("./ledger-error-handler.cjs"),M="m",C=`${M}/44'/60'/0'`,P="Ledger Hardware";var I;!function(e){e.Ropsten="https://api-ropsten.etherscan.io",e.Kovan="https://api-kovan.etherscan.io",e.Rinkeby="https://api-rinkeby.etherscan.io",e.Mainnet="https://api.etherscan.io"}(I||(I={}));class N{constructor({bridge:e}){if(s.add(this),this.deviceId="",this.type=P,this.page=0,this.perPage=5,this.unlockedAccount=0,this.accounts=[],this.accountDetails={},this.hdk=new k.default,this.hdPath=C,this.paths={},this.network=I.Mainnet,this.implementFullBIP44=!1,!e)throw new Error("Bridge is a required dependency for the keyring");this.bridge=e}async init(){return this.bridge.init()}async destroy(){return this.bridge.destroy()}async serialize(){return{hdPath:this.hdPath,accounts:this.accounts.slice(),deviceId:this.deviceId,accountDetails:this.accountDetails,implementFullBIP44:!1}}async deserialize(e){this.hdPath=e.hdPath??C,this.accounts=e.accounts??[],this.deviceId=e.deviceId??"",this.accountDetails=e.accountDetails??{},e.accountDetails||y(this,s,"m",r).call(this,e),this.implementFullBIP44=e.implementFullBIP44??!1;const t=new Set(Object.keys(this.accountDetails));return this.accounts=this.accounts.filter(e=>t.has(y(this,s,"m",g).call(this,e))),Promise.resolve()}setDeviceId(e){this.deviceId=e}getDeviceId(){return this.deviceId}isUnlocked(){return Boolean(this.hdk.publicKey)}isConnected(){return this.bridge.isDeviceConnected}setAccountToUnlock(e){this.unlockedAccount=e}setHdPath(e){this.hdPath!==e&&(this.hdk=new k.default),this.hdPath=e}async unlock(e,t=!0){if(this.isUnlocked()&&!e)return y(this,s,"m",g).call(this,(0,S.bytesToHex)((0,v.publicToAddress)(this.hdk.publicKey,!0)));const n=e?y(this,s,"m",h).call(this,e):this.hdPath;let r;try{r=await this.bridge.getPublicKey({hdPath:n})}catch(e){(0,_.handleLedgerTransportError)(e,"Ledger: Unknown error while unlocking account")}return t&&r.chainCode&&(this.hdk.publicKey=A.Buffer.from(r.publicKey,"hex"),this.hdk.chainCode=A.Buffer.from(r.chainCode,"hex")),(0,S.add0x)(r.address)}async addAccounts(e){return new Promise((t,n)=>{this.unlock().then(async n=>{const r=this.unlockedAccount,a=r+e,i=[];for(let e=r;e<a;e++){const t=y(this,s,"m",d).call(this,e);let n;n=y(this,s,"m",p).call(this)?await this.unlock(t):y(this,s,"m",l).call(this,M,e),this.accountDetails[y(this,s,"m",g).call(this,n)]={bip44:y(this,s,"m",p).call(this),hdPath:t},this.accounts.includes(n)||(this.accounts=[...this.accounts,n],i.push(n)),this.page=0}t(i)}).catch(n)})}getName(){return P}async getFirstPage(){return this.page=0,y(this,s,"m",i).call(this,1)}async getNextPage(){return y(this,s,"m",i).call(this,1)}async getPreviousPage(){return y(this,s,"m",i).call(this,-1)}async getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){const t=this.accounts.filter(t=>t.toLowerCase()!==e.toLowerCase());if(t.length===this.accounts.length)throw new Error(`Address ${e} not found in this keyring`);this.accounts=t,delete this.accountDetails[y(this,s,"m",g).call(this,e)]}async attemptMakeApp(){return this.bridge.attemptMakeApp()}async updateTransportMethod(e){return this.bridge.updateTransportMethod(e)}async signTransaction(e,t){let n;if(function(e){return"getChainId"in e&&"function"==typeof e.getChainId}(t))return t.v=t.getChainId(),t.r="0x00",t.s="0x00",n=t.serialize().toString("hex"),y(this,s,"m",a).call(this,e,n,e=>(t.v=A.Buffer.from(e.v,"hex"),t.r=A.Buffer.from(e.r,"hex"),t.s=A.Buffer.from(e.s,"hex"),t));const r=t.getMessageToSign();return n=Array.isArray(r)?A.Buffer.from(b.RLP.encode(r)).toString("hex"):(0,S.bytesToHex)(r),y(this,s,"m",a).call(this,e,n,e=>{const n=t.toJSON();return n.type=t.type,n.v=(0,S.add0x)(e.v),n.r=(0,S.add0x)(e.r),n.s=(0,S.add0x)(e.s),E.TransactionFactory.fromTxData(n,{common:t.common,freeze:Object.isFrozen(t)})})}async signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,t){const n=await this.unlockAccountByAddress(e);if(!n)throw new Error("Ledger: Unknown error while signing message");let r;try{r=await this.bridge.deviceSignMessage({hdPath:n,message:(0,S.remove0x)(t)})}catch(e){(0,_.handleLedgerTransportError)(e,"Ledger: Unknown error while signing message")}let a=parseInt(String(r.v),10).toString(16);a.length<2&&(a=`0${a}`);const i=`0x${r.r}${r.s}${a}`,o=(0,T.recoverPersonalSignature)({data:t,signature:i});if(y(this,s,"m",g).call(this,o)!==y(this,s,"m",g).call(this,e))throw new Error("Ledger: The signature doesnt match the right address");return i}async unlockAccountByAddress(e){const t=y(this,s,"m",g).call(this,e),n=this.accountDetails[t];if(!n)throw new Error(`Ledger: Account for address '${t}' not found`);const{hdPath:r}=n;if((await this.unlock(r,!1)).toLowerCase()!==e.toLowerCase())throw new Error(`Ledger: Account ${e} does not belong to the connected device`);return r}async signTypedData(e,t,n){const{version:r}=n??{};if(!("V4"===r))throw new Error("Ledger: Only version 4 of typed data signing is supported");const{domain:a,types:i,primaryType:o,message:c}=T.TypedDataUtils.sanitizeData(t),l=await this.unlockAccountByAddress(e);if(!l)throw new Error("Ledger: Unknown error while signing message");let u;try{u=await this.bridge.deviceSignTypedData({hdPath:l,message:{domain:{name:a.name,chainId:a.chainId,version:a.version,verifyingContract:a.verifyingContract,salt:a.salt instanceof ArrayBuffer?A.Buffer.from(a.salt).toString("hex"):a.salt},types:i,primaryType:o.toString(),message:c}})}catch(e){(0,_.handleLedgerTransportError)(e,"Ledger: Unknown error while signing message")}let d=parseInt(String(u.v),10).toString(16);d.length<2&&(d=`0${d}`);const p=`0x${u.r}${u.s}${d}`,h=(0,T.recoverTypedSignature)({data:t,signature:p,version:T.SignTypedDataVersion.V4});if(y(this,s,"m",g).call(this,h)!==y(this,s,"m",g).call(this,e))throw new Error("Ledger: The signature doesnt match the right address");return p}forgetDevice(){this.deviceId="",this.accounts=[],this.page=0,this.unlockedAccount=0,this.paths={},this.accountDetails={},this.hdk=new k.default}}n.LedgerKeyring=N,s=new WeakSet,r=function(e){if(y(this,s,"m",p).call(this)&&e.accountIndexes)for(const[t,n]of Object.entries(e.accountIndexes))this.accountDetails[t]={bip44:!0,hdPath:y(this,s,"m",d).call(this,n)};const t=new Set(Object.keys(this.accountDetails));y(this,s,"m",p).call(this)||this.accounts.forEach(e=>{const n=y(this,s,"m",g).call(this,e);t.has(n)||(this.accountDetails[n]={bip44:!1,hdPath:y(this,s,"m",u).call(this,e)})})},a=async function(e,t,n){const s=await this.unlockAccountByAddress(e);if(!s)throw new Error("Ledger: hdPath is empty while signing transaction");let r;try{r=await this.bridge.deviceSignTransaction({tx:(0,S.remove0x)(t),hdPath:s})}catch(e){(0,_.handleLedgerTransportError)(e,"Ledger: Unknown error while signing transaction")}const a=n(r);if(a.verifySignature())return a;throw new Error("Ledger: The transaction signature is not valid")},i=async function(e){this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,n=t+this.perPage;let r;return await this.unlock(),r=y(this,s,"m",p).call(this)?await y(this,s,"m",o).call(this,t,n):y(this,s,"m",c).call(this,t,n),r},o=async function(e,t){const n=[];for(let r=e;r<t;r++){const e=y(this,s,"m",d).call(this,r),t=await this.unlock(e),a=!this.implementFullBIP44||await y(this,s,"m",m).call(this,t);if(n.push({address:t,balance:null,index:r}),!a)break}return n},c=function(e,t){const n=[];for(let r=e;r<t;r++){const e=y(this,s,"m",l).call(this,M,r);n.push({address:e,balance:null,index:r}),this.paths[y(this,s,"m",g).call(this,e)]=r}return n},l=function(e,t){const n=this.hdk.derive(`${e}/${t}`),r=(0,S.bytesToHex)((0,v.publicToAddress)(n.publicKey,!0));return y(this,s,"m",g).call(this,r)},u=function(e){const t=y(this,s,"m",g).call(this,e);let n=this.paths[t];if(void 0===n)for(let e=0;e<1e3;e++)if(t===y(this,s,"m",l).call(this,M,e)){n=e;break}if(void 0===n)throw new Error("Unknown address");return y(this,s,"m",d).call(this,n)},d=function(e){return y(this,s,"m",p).call(this)?`m/44'/60'/${e}'/0/0`:`${this.hdPath}/${e}`},p=function(){return"m/44'/60'/0'/0/0"===this.hdPath},h=function(e){return e.toString().replace("m/","")},m=async function(e){const t=y(this,s,"m",f).call(this),n=await window.fetch(`${t}/api?module=account&action=txlist&address=${e}&tag=latest&page=1&offset=1`),r=await n.json();return"0"!==r.status&&r.result.length>0},f=function(){return this.network},g=function(e){return(0,S.getChecksumAddress)((0,S.add0x)(e))},N.type=P}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-keyring.cjs"}],[1672,{"./ledger-hw-app.cjs":1669},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.LedgerMobileBridge=void 0;e("./ledger-hw-app.cjs");n.LedgerMobileBridge=class{constructor(e,t={}){s.add(this),r.set(this,void 0),a.set(this,void 0),this.isDeviceConnected=!1,c(this,a,t,"f"),c(this,r,e,"f")}async init(){return Promise.resolve()}async destroy(){try{await l(this,s,"m",i).call(this).dispose()}catch(e){console.error(e)}this.isDeviceConnected=!1}async deviceSignMessage({hdPath:e,message:t}){return l(this,s,"m",o).call(this).signPersonalMessage(e,t)}async deviceSignTypedData({hdPath:e,message:t}){return l(this,s,"m",o).call(this).signEIP712Message(e,t)}async deviceSignTransaction({tx:e,hdPath:t}){return l(this,s,"m",o).call(this).clearSignTransaction(t,e,{externalPlugins:!0,erc20:!0,nft:!0})}async getPublicKey({hdPath:e}){return await l(this,s,"m",o).call(this).getAddress(e,!1,!0)}async getOptions(){return l(this,a,"f")}async setOptions(e){c(this,a,e,"f")}async updateTransportMethod(e){if(!e.deviceModel)throw new Error("Property `deviceModel` is not defined in `transport`.");if(!e.deviceModel.id)throw new Error("Property `deviceModel.id` is not defined in `transport`.");return l(this,s,"m",i).call(this).setTransport(e),this.isDeviceConnected=!0,Promise.resolve(!0)}async attemptMakeApp(){throw new Error("Method not supported.")}async openEthApp(){await l(this,s,"m",o).call(this).openEthApp()}async closeApps(){await l(this,s,"m",o).call(this).closeApps()}async getAppNameAndVersion(){return l(this,s,"m",o).call(this).getAppNameAndVersion()}},r=new WeakMap,a=new WeakMap,s=new WeakSet,i=function(){if(l(this,r,"f"))return l(this,r,"f");throw new Error("Instance `transportMiddleware` is not initialized.")},o=function(){return l(this,s,"m",i).call(this).getEthApp()}}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-mobile-bridge.cjs"}],[1673,{"./ledger-hw-app.cjs":1669},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},a=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.LedgerTransportMiddleware=void 0;const i=e("./ledger-hw-app.cjs");n.LedgerTransportMiddleware=class{constructor(){this.mainAppName="BOLOS",this.ethAppName="Ethereum",this.transportEncoding="ascii",s.set(this,void 0)}async dispose(){const e=this.getTransport();await e.close()}setTransport(e){r(this,s,e,"f")}getTransport(){if(!a(this,s,"f"))throw new Error("Instance `transport` is not initialized.");return a(this,s,"f")}getEthApp(){return new i.MetaMaskLedgerHwAppEth(this.getTransport())}},s=new WeakMap}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-transport-middleware.cjs"}],[1674,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LedgerStatusError=void 0;class s extends Error{constructor(e,t){super(t),this.statusCode=e}}n.LedgerStatusError=s}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/type.cjs"}],[168,{"../../../../development/build/constants":460,"../../../../shared/constants/network":5262,"@metamask/controller-utils":1224,"@metamask/network-controller":2026,"@metamask/remote-feature-flag-controller":2217,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PRODUCTION_LIKE_ENVIRONMENTS=n.KNOWN_CUSTOM_ENDPOINTS=void 0,n.getIsMetaMaskInfuraEndpointUrl=m,n.getIsQuicknodeEndpointUrl=f,n.shouldCreateRpcServiceEvents=function({endpointUrl:e,error:t,infuraProjectId:n,metaMetricsId:s}){return(!t||!(0,r.isConnectionError)(t))&&s!==undefined&&null!==s&&function(e){if("production"===undefined)return!1;if(u.includes("production"))return(0,a.generateDeterministicRandomNumber)(e)<l;return!0}(s)&&function(e,t){const n=m(e,t),s=f(e),r=h.includes(e);return n||s||r}(e,n)};var s=e("lodash"),r=e("@metamask/network-controller"),a=e("@metamask/remote-feature-flag-controller"),i=e("@metamask/controller-utils"),o=e("../../../../shared/constants/network"),c=e("../../../../development/build/constants");const l=.01,u=n.PRODUCTION_LIKE_ENVIRONMENTS=[c.ENVIRONMENT.PRODUCTION,c.ENVIRONMENT.RELEASE_CANDIDATE],d=o.FEATURED_RPCS.flatMap(e=>e.rpcEndpoints.map(t=>({name:t.name??e.name,url:t.url}))),p=Object.entries(i.BUILT_IN_CUSTOM_NETWORKS_RPC).map(([e,t])=>({name:e,url:t})),h=(n.KNOWN_CUSTOM_ENDPOINTS=[...d,...p]).map(({url:e})=>e);function m(e,t){return new RegExp(`^https://[^.]+\\.infura\\.io/v3/${(0,s.escapeRegExp)(t)}$`,"u").test(e)}function f(e){return Object.values(o.QUICKNODE_ENDPOINT_URLS_BY_INFURA_NETWORK_NAME).map(e=>e()).includes(e)}}}},{package:"$root$",file:"app/scripts/lib/network-controller/utils.ts"}],[169,{"../../../shared/constants/notifications":5263,"../platforms/extension":447,"@metamask/safe-event-emitter":2226},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.NOTIFICATION_MANAGER_EVENTS=void 0;var s=i(e("@metamask/safe-event-emitter")),r=i(e("../platforms/extension")),a=e("../../../shared/constants/notifications");function i(e){return e&&e.__esModule?e:{default:e}}const o=n.NOTIFICATION_MANAGER_EVENTS={POPUP_CLOSED:"onPopupClosed"};class c extends s.default{constructor(){super(),this.platform=new r.default,this.platform.addOnRemovedListener(this._onWindowClosed.bind(this))}markAsAutomaticallyClosed(){this._popupAutomaticallyClosed=!0}async showPopup(e,t){this._popupId=t,this._setCurrentPopupId=e;const n=await this._getPopup(t);if(n)await this.platform.focusWindow(n.id);else{let e=0,t=0;try{const n=await this.platform.getLastFocusedWindow();t=n.top,e=Math.max(n.left+(n.width-a.NOTIFICATION_WIDTH),0)}catch(n){const{screenX:s,screenY:r,outerWidth:i}=window;t=Math.max(r,0),e=Math.max(s+(i-a.NOTIFICATION_WIDTH),0)}const n=await this.platform.openWindow({url:"notification.html",type:"popup",width:a.NOTIFICATION_WIDTH,height:a.NOTIFICATION_HEIGHT,left:e,top:t});n.left!==e&&"fullscreen"!==n.state&&await this.platform.updateWindowPosition(n.id,e,t),this._setCurrentPopupId(n.id),this._popupId=n.id}}_onWindowClosed(e){e===this._popupId&&(this._setCurrentPopupId(undefined),this._popupId=undefined,this.emit(o.POPUP_CLOSED,{automaticallyClosed:this._popupAutomaticallyClosed}),this._popupAutomaticallyClosed=undefined)}async _getPopup(){const e=await this.platform.getAllWindows();return this._getPopupIn(e)}_getPopupIn(e){return e?e.find(e=>e&&"popup"===e.type&&e.id===this._popupId):null}}n.default=c}}},{package:"$root$",file:"app/scripts/lib/notification-manager.js"}],[17,{"../../lib/ppom/indexed-db-backend":175,"../../lib/ppom/ppom":178,"@metamask/ppom-validator":2117},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PPOMControllerInit=void 0;var s=e("@metamask/ppom-validator"),r=e("../../lib/ppom/indexed-db-backend"),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var o=r?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(s,a,o):s[a]=e[a]}return s.default=e,n&&n.set(e,s),s}(e("../../lib/ppom/ppom"));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}n.PPOMControllerInit=e=>{const{controllerMessenger:t,initMessenger:n,getController:i,getGlobalChainId:o,getProvider:c,persistedState:l}=e;return{controller:new s.PPOMController({messenger:t,storageBackend:new r.IndexedDBPPOMStorage("PPOMDB",1),provider:c(),ppomProvider:{PPOM:a.PPOM,ppomInit:()=>a.default("./ppom_bg.wasm")},state:l.PPOMController,chainId:o(),securityAlertsEnabled:i("PreferencesController").state.securityAlertsEnabled,onPreferencesChange:n.subscribe.bind(n,"PreferencesController:stateChange"),cdnBaseUrl:"static.cx.metamask.io/api/v1/confirmations/ppom",blockaidPublicKey:"066ad3e8af5583385e312c156d238055215d5f25247c1e91055afa756cb98a88"})}}}}},{package:"$root$",file:"app/scripts/controller-init/confirmations/ppom-controller-init.ts"}],[170,{"../../../../shared/constants/offscreen-communication":5264,"eth-lattice-keyring":3796},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LatticeKeyringOffscreen=void 0;var s,r=(s=e("eth-lattice-keyring"))&&s.__esModule?s:{default:s},a=e("../../../../shared/constants/offscreen-communication");class i extends r.default{constructor(e={}){super(e)}async _getCreds(){try{const e=this.appName?this.appName:"Unknown",t=`${a.KnownOrigins.lattice}?keyring=${e}&forceLogin=true`;return await new Promise((e,n)=>{chrome.runtime.sendMessage({target:a.OffscreenCommunicationTarget.latticeOffscreen,params:{url:t}},t=>{t.error&&n(t.error),e(t.result)})})}catch(e){throw new Error(e)}}}n.LatticeKeyringOffscreen=i,function(e,t,n){(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(i,"type",void 0),i.type=r.default.type}}},{package:"$root$",file:"app/scripts/lib/offscreen-bridge/lattice-offscreen-keyring.ts"}],[171,{"../../../../shared/constants/offscreen-communication":5264,"@ledgerhq/errors":801},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LedgerOffscreenBridge=void 0;var s=e("@ledgerhq/errors"),r=e("../../../../shared/constants/offscreen-communication");function a(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var c=new WeakSet;async function l(e,{timeout:t}={}){return new Promise((n,a)=>{let i;t&&(i=setTimeout(()=>{a(new Error("Ledger iframe timeout"))},t)),chrome.runtime.sendMessage({...e,target:r.OffscreenCommunicationTarget.ledgerOffscreen},e=>{if(clearTimeout(i),null!=e&&e.success)n(e.payload||e.success);else{var t;const n=null==e||null===(t=e.payload)||void 0===t?void 0:t.error;if(n&&"number"==typeof n.statusCode&&n.statusCode>0){const e=new s.TransportStatusError(n.statusCode);a(e)}else if(null!=n&&n.message){const e=new Error(n.message,{cause:n});a(e)}else a(new Error("Unknown Ledger error occurred"))}})})}n.LedgerOffscreenBridge=class{constructor(){a(this,c),i(this,"isDeviceConnected",!1)}init(){return chrome.runtime.onMessage.addListener(e=>{e.target===r.OffscreenCommunicationTarget.extension&&e.event===r.OffscreenCommunicationEvents.ledgerDeviceConnect&&(this.isDeviceConnected=!0)}),Promise.resolve()}destroy(){return Promise.resolve()}getOptions(){return Promise.resolve({})}setOptions(){return Promise.resolve()}attemptMakeApp(){return o(c,this,l).call(this,{action:r.LedgerAction.makeApp},{timeout:4e3})}updateTransportMethod(e){return o(c,this,l).call(this,{action:r.LedgerAction.updateTransport,params:{transportType:e}},{timeout:4e3})}getPublicKey(e){return o(c,this,l).call(this,{action:r.LedgerAction.getPublicKey,params:e})}deviceSignTransaction(e){return o(c,this,l).call(this,{action:r.LedgerAction.signTransaction,params:e})}deviceSignMessage(e){return o(c,this,l).call(this,{action:r.LedgerAction.signPersonalMessage,params:e})}deviceSignTypedData(e){return o(c,this,l).call(this,{action:r.LedgerAction.signTypedData,params:e})}}}}},{package:"$root$",file:"app/scripts/lib/offscreen-bridge/ledger-offscreen-bridge.ts"}],[172,{"../../../../shared/constants/offscreen-communication":5264},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TrezorOffscreenBridge=void 0;var s=e("../../../../shared/constants/offscreen-communication");function r(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.TrezorOffscreenBridge=class{constructor(){r(this,"model",void 0),r(this,"minorVersion",void 0)}init(e){return chrome.runtime.onMessage.addListener(e=>{e.target===s.OffscreenCommunicationTarget.extension&&e.event===s.OffscreenCommunicationEvents.trezorDeviceConnect&&(this.model=e.payload.model,this.minorVersion=e.payload.minorVersion)}),new Promise(t=>{chrome.runtime.sendMessage({target:s.OffscreenCommunicationTarget.trezorOffscreen,action:s.TrezorAction.init,params:e},()=>{t()})})}dispose(){return new Promise(e=>{chrome.runtime.sendMessage({target:s.OffscreenCommunicationTarget.trezorOffscreen,action:s.TrezorAction.dispose},()=>{e()})})}getPublicKey(e){return new Promise(t=>{chrome.runtime.sendMessage({target:s.OffscreenCommunicationTarget.trezorOffscreen,action:s.TrezorAction.getPublicKey,params:e},e=>{t(e)})})}ethereumSignTransaction(e){return new Promise(t=>{chrome.runtime.sendMessage({target:s.OffscreenCommunicationTarget.trezorOffscreen,action:s.TrezorAction.signTransaction,params:e},e=>{t(e)})})}ethereumSignMessage(e){return new Promise(t=>{chrome.runtime.sendMessage({target:s.OffscreenCommunicationTarget.trezorOffscreen,action:s.TrezorAction.signMessage,params:e},e=>{t(e)})})}ethereumSignTypedData(e){return new Promise(t=>{chrome.runtime.sendMessage({target:s.OffscreenCommunicationTarget.trezorOffscreen,action:s.TrezorAction.signTypedData,params:e},e=>{t(e)})})}}}}},{package:"$root$",file:"app/scripts/lib/offscreen-bridge/trezor-offscreen-bridge.ts"}],[173,{"webextension-polyfill":5227},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.openUpdateTabAndReload=async function(e){try{await r.default.tabs.create({url:"https://metamask.io/updating",active:!0})}catch(e){console.error(e)}await e()};var s,r=(s=e("webextension-polyfill"))&&s.__esModule?s:{default:s}}}},{package:"$root$",file:"app/scripts/lib/open-update-tab-and-reload.ts"}],[174,{"../../../shared/lib/promise-with-resolvers":5335,lodash:4362,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OperationSafener=void 0;var s,r=e("lodash"),a=(s=e("loglevel"))&&s.__esModule?s:{default:s},i=e("../../../shared/lib/promise-with-resolvers");function o(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function l(e,t){return e.get(d(e,t))}function u(e,t,n){return e.set(d(e,t),n),n}function d(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var p=new WeakMap,h=new WeakMap;n.OperationSafener=class{constructor({op:e,wait:t,options:n}){c(this,p,void 0),c(this,h,null),o(this,"evacuate",()=>{if(l(h,this))return a.default.warn("already evacuating"),l(h,this);const e=l(p,this).flush();if(e){const{promise:t,resolve:n}=(0,i.withResolvers)();e.finally(n),u(h,this,t)}else u(h,this,Promise.resolve());return l(h,this)}),o(this,"execute",(...e)=>l(h,this)?(a.default.warn("evacuating, ignoring call to `execute`"),!1):(l(p,this).call(this,...e),!0));const s={mode:"exclusive"};u(p,this,(0,r.debounce)((...t)=>navigator.locks.request("operation-safener-lock",s,()=>e(...t)),t,n))}}}}},{package:"$root$",file:"app/scripts/lib/operation-safener.ts"}],[175,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function r(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.IndexedDBPPOMStorage=void 0;const a=async(e,t,n)=>{const s=await crypto.subtle.digest("SHA-256",t);if(Array.from(new Uint8Array(s)).map(e=>e.toString(16).padStart(2,"0")).join("")!==n)throw new Error(`Checksum mismatch for key ${e}`)};var i=new WeakSet;function o(e){return new Promise((t,n)=>{const s=indexedDB.open(this.storeName,this.dbVersion);s.onerror=e=>{var t;n(new Error(`Failed to open database ${this.storeName}: ${null===(t=e.target)||void 0===t?void 0:t.error}`))},s.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this.storeName)||t.createObjectStore(this.storeName,{keyPath:["name","chainId"]})},s.onsuccess=n=>{const s=n.target.result.transaction([this.storeName],e).objectStore(this.storeName);t(s)}})}n.IndexedDBPPOMStorage=class{constructor(e,t){s(this,i),r(this,"storeName",void 0),r(this,"dbVersion",void 0),this.storeName=e,this.dbVersion=t}async objectStoreAction(e,t,n="readonly"){return new Promise((s,r)=>{(function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")})(i,this,o).call(this,n).then(n=>{const a=n[e](t);a.onsuccess=async e=>{s(e)},a.onerror=t=>{var n;r(new Error(`Error in indexDB operation ${e}: ${null===(n=t.target)||void 0===n?void 0:n.error}`))}}).catch(e=>{r(e)})})}async read(e,t){var n;const s=null===(n=(await this.objectStoreAction("get",[e.name,e.chainId])).target)||void 0===n||null===(n=n.result)||void 0===n?void 0:n.data;return await a(e,s,t),s}async write(e,t,n){await a(e,t,n),await this.objectStoreAction("put",{...e,data:t},"readwrite")}async delete(e){await this.objectStoreAction("delete",[e.name,e.chainId],"readwrite")}async dir(){var e;return null===(e=(await this.objectStoreAction("getAllKeys")).target)||void 0===e?void 0:e.result.map(([e,t])=>({name:e,chainId:t}))}}}}},{package:"$root$",file:"app/scripts/lib/ppom/indexed-db-backend.ts"}],[176,{"../../../../shared/constants/app":5244,"../../../../shared/constants/security-provider":5269,"../../../../shared/constants/transaction":5279,"../../../../shared/lib/trace":5342,"./ppom-util":177,"@metamask/controller-utils":1224},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createPPOMMiddleware=function(e,t,n,u,d,p,h){return async(m,f,g)=>{try{const{securityAlertsEnabled:f}=t.state,{chainId:g}=n.getNetworkConfigurationByNetworkClientId(m.networkClientId)??{};if(!g)throw Error("ChainID not found for networkClientId");if(!f||!l.includes(m.method))return;const y=m.params[0];if("string"==typeof y){const{isSIWEMessage:e}=(0,s.detectSIWE)({data:y});if(e)return}else if(m.method===r.MESSAGE_TYPE.ETH_SEND_TRANSACTION){const{to:e}=y??{},t=d.listAccounts();if(t.some(({address:t})=>(null==t?void 0:t.toLowerCase())===(null==e?void 0:e.toLowerCase())))return}const w=(0,c.generateSecurityAlertId)();(0,i.trace)({name:i.TraceName.PPOMValidation,parentContext:m.traceContext},()=>(0,c.validateRequestWithPPOM)({ppomController:e,request:m,securityAlertId:w,chainId:g,updateSecurityAlertResponse:p,getSecurityAlertsConfig:null==h?void 0:h()}));const b={...o.LOADING_SECURITY_ALERT_RESPONSE,securityAlertId:w};a.SIGNING_METHODS.includes(m.method)&&u.addSignatureSecurityAlertResponse(b),m.securityAlertResponse=b}catch(e){m.securityAlertResponse=(0,c.handlePPOMError)(e,"Error createPPOMMiddleware: ")}finally{g()}}};var s=e("@metamask/controller-utils"),r=e("../../../../shared/constants/app"),a=e("../../../../shared/constants/transaction"),i=e("../../../../shared/lib/trace"),o=e("../../../../shared/constants/security-provider"),c=e("./ppom-util");const l=Object.freeze(["eth_sendRawTransaction","eth_sendTransaction",...a.SIGNING_METHODS])}}},{package:"$root$",file:"app/scripts/lib/ppom/ppom-middleware.ts"}],[177,{"../../../../shared/constants/app":5244,"../../../../shared/constants/security-provider":5269,"../../../../shared/constants/transaction":5279,"../../../../shared/modules/transaction.utils":5377,"../../../../shared/modules/typed-signature":5378,"./security-alerts-api":179,"@metamask/transaction-controller":2587,"@metamask/utils":2632,lodash:4362,uuid:5195},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.generateSecurityAlertId=function(){return(0,a.v4)()},n.handlePPOMError=g,n.updateSecurityAlertResponse=async function({appStateController:e,messenger:t,method:n,securityAlertId:s,securityAlertResponse:r,signatureController:a,transactionController:i}){if(c.SIGNING_METHODS.includes(n)){const n=await async function(e,t,n){const s=e=>Object.values(e.signatureRequests).find(e=>{var n;return(null===(n=e.securityAlertResponse)||void 0===n?void 0:n.securityAlertId)===t});return new Promise(r=>{const a=s(e.state);if(a)return void r(a);const i=e=>{const t=s(e);t&&(h("Found signature request",t),n.unsubscribe("SignatureController:stateChange",i),r(t))};h("Waiting for signature request",t),n.subscribe("SignatureController:stateChange",i)})}(a,s,t);return e.addSignatureSecurityAlertResponse({...r,securityAlertId:s}),n}const o=await async function(e,t,n){const s=e=>{var n;return(null===(n=e.securityAlertResponse)||void 0===n?void 0:n.securityAlertId)===t};return new Promise(r=>{const a=e.state.transactions.find(s);if(a)return void r(a);const i=e=>{s(e)&&(h("Found transaction metadata",e),n.unsubscribe("TransactionController:unapprovedTransactionAdded",i),r(e))};h("Waiting for transaction metadata",t),n.subscribe("TransactionController:unapprovedTransactionAdded",i)})}(i,s,t);return i.updateSecurityAlertResponse(o.id,{...r,securityAlertId:s}),o},n.validateRequestWithPPOM=async function({ppomController:e,request:t,securityAlertId:n,chainId:r,updateSecurityAlertResponse:a,getSecurityAlertsConfig:c}){try{const m=function(e,t){let n=(0,i.cloneDeep)(e);n=function(e){if(e.method!==d.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3&&e.method!==d.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4)return e;if(!Array.isArray(e.params)||!e.params[1])return e;const t=(0,u.parseTypedDataMessage)(e.params[1]),n=(0,l.sanitizeMessageRecursively)(t.message,t.types,t.primaryType);return{...e,params:[e.params[0],JSON.stringify({...t,message:n})]}}(n),n=function(e,t){if(e.method!==d.MESSAGE_TYPE.ETH_SEND_TRANSACTION)return e;if(!Array.isArray(e.params)||!e.params[0])return e;const n=e.params[0];n.gas=t.txParams.gas,n.gasPrice=t.txParams.maxFeePerGas??t.txParams.gasPrice,delete n.gasLimit,delete n.maxFeePerGas,delete n.maxPriorityFeePerGas,delete n.type;const r=(0,s.normalizeTransactionParams)(n);return h("Normalized transaction params",r),{...e,params:[r]}}(n,t);const{delegationMock:r,id:a,jsonrpc:o,method:c,origin:p,params:m}=n;return{delegationMock:r,id:a,jsonrpc:o,method:c,origin:p,params:m}}(t,await a(t.method,n,o.LOADING_SECURITY_ALERT_RESPONSE));h("Normalized request",m);const f=(0,p.isSecurityAlertsAPIEnabled)()?await async function(e,t,n,s){try{return{...await(0,p.validateWithSecurityAlertsAPI)(t,n,s),source:o.SecurityAlertSource.API}}catch(s){return g(s,"Error validating request with security alerts API"),await y(e,n,t)}}(e,r,m,c):await y(e,m,r);await a(t.method,n,f)}catch(e){h("Error",e),await a(t.method,n,g(e,"Error validating JSON RPC using PPOM: "))}};var s=e("@metamask/transaction-controller"),r=e("@metamask/utils"),a=e("uuid"),i=e("lodash"),o=e("../../../../shared/constants/security-provider"),c=e("../../../../shared/constants/transaction"),l=e("../../../../shared/modules/typed-signature"),u=e("../../../../shared/modules/transaction.utils"),d=e("../../../../shared/constants/app"),p=e("./security-alerts-api");const h=(0,r.createProjectLogger)("ppom-util"),{sentry:m}=global,f={result_type:o.BlockaidResultType.Errored,reason:o.BlockaidReason.errored};function g(e,t,n=o.SecurityAlertSource.API){const s=function(e){if("object"==typeof e||"string"==typeof e)return e;return JSON.stringify(e)}(e),r=function(e){if(e instanceof Error)return`${e.name}: ${e.message}`;return JSON.stringify(e)}(e);return n===o.SecurityAlertSource.Local&&(null==m||m.captureException(e)),console.error(t,s),{...f,description:r,source:n}}async function y(e,t,n){try{return{...await e.usePPOM(e=>e.validateJsonRpc(t),n),source:o.SecurityAlertSource.Local}}catch(e){return g(e,"Error validating request with PPOM controller",o.SecurityAlertSource.Local)}}}}},{package:"$root$",file:"app/scripts/lib/ppom/ppom-util.ts"}],[178,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){let s;Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.PPOM=void 0,n.initSync=function(e){if(s!==undefined)return s;const t=_();e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e));const n=new WebAssembly.Instance(e,t);return M(n,e)},n.main=function(){s.main()};const r="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&r.decode();let a=null;function i(){return null!==a&&0!==a.byteLength||(a=new Uint8Array(s.memory.buffer)),a}function o(e,t){return e>>>=0,r.decode(i().subarray(e,e+t))}const c=new Array(128).fill(undefined);c.push(undefined,null,!0,!1);let l=c.length;function u(e){l===c.length&&c.push(c.length+1);const t=l;return l=c[t],c[t]=e,t}function d(e){return c[e]}function p(e){const t=d(e);return function(e){e<132||(c[e]=l,l=e)}(e),t}let h=0;const m="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},f="function"==typeof m.encodeInto?function(e,t){return m.encodeInto(e,t)}:function(e,t){const n=m.encode(e);return t.set(n),{read:e.length,written:n.length}};function g(e,t,n){if(n===undefined){const n=m.encode(e),s=t(n.length,1)>>>0;return i().subarray(s,s+n.length).set(n),h=n.length,s}let s=e.length,r=t(s,1)>>>0;const a=i();let o=0;for(;o<s;o++){const t=e.charCodeAt(o);if(t>127)break;a[r+o]=t}if(o!==s){0!==o&&(e=e.slice(o)),r=n(r,s,s=o+3*e.length,1)>>>0;const t=i().subarray(r+o,r+s);o+=f(e,t).written}return h=o,r}let y=null;function w(){return null!==y&&0!==y.byteLength||(y=new Int32Array(s.memory.buffer)),y}function b(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let n="[";t>0&&(n+=b(e[0]));for(let s=1;s<t;s++)n+=", "+b(e[s]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let s;if(!(n.length>1))return toString.call(e);if(s=n[1],"Object"==s)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:s}function E(e,t,n){s.wasm_bindgen__convert__closures__invoke1_mut(e,t,u(n))}function v(e,t){s._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__destroy(e,t)}let T=null;function S(e,t){const n=t(4*e.length,4)>>>0,r=(null!==T&&0!==T.byteLength||(T=new Uint32Array(s.memory.buffer)),T);for(let t=0;t<e.length;t++)r[n/4+t]=u(e[t]);return h=e.length,n}function A(e,t){try{return e.apply(this,t)}catch(e){s.__wbindgen_exn_store(u(e))}}class k{static __wrap(e){e>>>=0;const t=Object.create(k.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();s.__wbg_ppom_free(e)}static new(e,t){const n=S(t,s.__wbindgen_malloc),r=h;return p(s.ppom_new(u(e),n,r))}validateJsonRpc(e){return p(s.ppom_validateJsonRpc(this.__wbg_ptr,u(e)))}static version(){return p(s.ppom_version())}}function _(){const e={wbg:{}};return e.wbg.__wbg_buffer_085ec1f694018c4f=function(e){return u(d(e).buffer)},e.wbg.__wbg_call_01734de55d61e11d=function(){return A(function(e,t,n){return u(d(e).call(d(t),d(n)))},arguments)},e.wbg.__wbg_call_4c92f6aec1e1d6e6=function(){return A(function(e,t,n,s){return u(d(e).call(d(t),d(n),d(s)))},arguments)},e.wbg.__wbg_from_d7c216d4616bb368=function(e){return u(Array.from(d(e)))},e.wbg.__wbg_get_44be0491f933a435=function(e,t){return u(d(e)[t>>>0])},e.wbg.__wbg_length_72e2208bbc0efc61=function(e){return d(e).length},e.wbg.__wbg_length_d813e535247d427e=function(e){return d(e).length},e.wbg.__wbg_length_fff51ee6522a1a18=function(e){return d(e).length},e.wbg.__wbg_new_43f1b47c28813cbd=function(e,t){try{var n={a:e,b:t};const r=new Promise((e,t)=>{const r=n.a;n.a=0;try{return function(e,t,n,r){s.wasm_bindgen__convert__closures__invoke2_mut(e,t,u(n),u(r))}(r,n.b,e,t)}finally{n.a=r}});return u(r)}finally{n.a=n.b=0}},e.wbg.__wbg_new_8125e318e6245eed=function(e){return u(new Uint8Array(d(e)))},e.wbg.__wbg_parse_670c19d4e984792e=function(){return A(function(e,t){return u(JSON.parse(o(e,t)))},arguments)},e.wbg.__wbg_ppom_new=function(e){return u(k.__wrap(e))},e.wbg.__wbg_resolve_53698b95aaf7fcf8=function(e){return u(Promise.resolve(d(e)))},e.wbg.__wbg_set_5cf90238115182c3=function(e,t,n){d(e).set(d(t),n>>>0)},e.wbg.__wbg_stringify_e25465938f3f611f=function(){return A(function(e){return u(JSON.stringify(d(e)))},arguments)},e.wbg.__wbg_then_b2267541e2a73865=function(e,t,n){return u(d(e).then(d(t),d(n)))},e.wbg.__wbg_then_f7e06ee3c11698eb=function(e,t){return u(d(e).then(d(t)))},e.wbg.__wbindgen_cb_drop=function(e){const t=p(e).original;if(1==t.cnt--)return t.a=0,!0;return!1},e.wbg.__wbindgen_closure_wrapper_wasm_bindgen__closure__Closure_T___wrap__breaks_if_inlined=function(e,t,n){const s=function(e,t,n,s){const r={a:e,b:t,cnt:1},a=(...e)=>{r.cnt++;const t=r.a;r.a=0;try{return s(t,r.b,...e)}finally{0===--r.cnt?n(t,r.b):r.a=t}};return a.original=r,a}(e,t,v,E);return u(s)},e.wbg.__wbindgen_debug_string=function(e,t){const n=g(b(d(t)),s.__wbindgen_malloc,s.__wbindgen_realloc),r=h;w()[e/4+1]=r,w()[e/4+0]=n},e.wbg.__wbindgen_error_new=function(e,t){return u(new Error(o(e,t)))},e.wbg.__wbindgen_is_undefined=function(e){return d(e)===undefined},e.wbg.__wbindgen_memory=function(){return u(s.memory)},e.wbg.__wbindgen_object_drop_ref=function(e){p(e)},e.wbg.__wbindgen_string_get=function(e,t){const n=d(t),r="string"==typeof n?n:undefined;var a,i=(a=r)===undefined||null===a?0:g(r,s.__wbindgen_malloc,s.__wbindgen_realloc),o=h;w()[e/4+1]=o,w()[e/4+0]=i},e.wbg.__wbindgen_string_new=function(e,t){return u(o(e,t))},e.wbg.__wbindgen_throw=function(e,t){throw new Error(o(e,t))},e}function M(e,t){return s=e.exports,C.__wbindgen_wasm_module=t,y=null,T=null,a=null,s.__wbindgen_start(),s}async function C(e){if(s!==undefined)return s;const t=_();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return M(n,r)}n.PPOM=k;n.default=C}}},{package:"$root$",file:"app/scripts/lib/ppom/ppom.js"}],[1782,{"./util.cjs":1794},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CaseInsensitiveMap=void 0;const s=e("./util.cjs");class r extends Map{static fromObject(e){return new r(Object.entries(e))}toObject(){return Object.fromEntries(this.entries())}get(e){return super.get(e.toLowerCase())}getOrThrow(e,t="Key"){return this.get(e)??(0,s.throwError)(`${t} '${e}' not found`)}has(e){return super.has(e.toLowerCase())}set(e,t){return super.set(e.toLowerCase(),t)}delete(e){return super.delete(e.toLowerCase())}}n.CaseInsensitiveMap=r}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/CaseInsensitiveMap.cjs"}],[1783,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DeferredPromise=void 0;n.DeferredPromise=class{constructor(){if(this.resolve=undefined,this.reject=undefined,this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),!this.resolve||!this.reject)throw new Error("Promise constructor failed")}}}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/DeferredPromise.cjs"}],[1784,{"./CaseInsensitiveMap.cjs":1782},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},a=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SnapIdMap=n.InvalidSnapIdError=void 0;const i=e("./CaseInsensitiveMap.cjs");class o extends Error{constructor(e,t){super(`Snap "${e}" is not allowed to set "${t}"`),this.name="InvalidSnapIdError",this.snapId=e,this.key=t}}n.InvalidSnapIdError=o;class c{constructor(e){s.set(this,void 0),r(this,s,new i.CaseInsensitiveMap(e),"f")}toObject(){return a(this,s,"f").toObject()}static fromObject(e){return new c(Object.entries(e))}get(e,t){const n=a(this,s,"f").get(t);return n?.snapId===e?n:undefined}pop(e,t){const n=this.get(e,t);return this.delete(e,t),n}has(e,t){return this.get(e,t)!==undefined}hasSnapId(e){return[...a(this,s,"f").values()].some(t=>t.snapId===e)}delete(e,t){return this.has(e,t)&&a(this,s,"f").delete(t)}set(e,t){if(a(this,s,"f").has(e)&&!this.has(t.snapId,e))throw new o(t.snapId,e);return a(this,s,"f").set(e,t),this}values(){return a(this,s,"f").values()}get size(){return a(this,s,"f").size}}n.SnapIdMap=c,s=new WeakMap}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/SnapIdMap.cjs"}],[1785,{"./DeferredPromise.cjs":1783,"./SnapIdMap.cjs":1784,"./account.cjs":1786,"./events.cjs":1787,"./logger.cjs":1789,"./migrations/index.cjs":1790,"./options.cjs":1792,"./types.cjs":1793,"./util.cjs":1794,"./versions.cjs":1795,"@ethereumjs/tx":532,"@metamask/eth-sig-util":1758,"@metamask/keyring-api":1914,"@metamask/keyring-internal-api":1927,"@metamask/keyring-internal-snap-client":1931,"@metamask/keyring-utils":1955,"@metamask/superstruct":2538,"@metamask/utils":2632,events:3902,uuid:1796},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,l,u,d,p,h,m,f,g,y,w,b,E,v,T,S,A,k,_,M,C,P,I,N,O,D,j,R,L,B,x=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},U=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SnapKeyring=n.SNAP_KEYRING_TYPE=void 0;const F=e("@ethereumjs/tx"),G=e("@metamask/eth-sig-util"),$=e("@metamask/keyring-api"),H=e("@metamask/keyring-internal-api"),K=e("@metamask/keyring-internal-snap-client"),W=e("@metamask/keyring-utils"),q=e("@metamask/superstruct"),V=e("@metamask/utils"),Y=e("events"),z=e("uuid"),Q=e("./account.cjs"),J=e("./DeferredPromise.cjs"),X=e("./events.cjs"),Z=e("./logger.cjs"),ee=e("./migrations/index.cjs"),te=e("./options.cjs"),ne=e("./SnapIdMap.cjs"),se=e("./types.cjs"),re=e("./util.cjs"),ae=e("./versions.cjs");function ie(e){return(0,$.isEvmAccountType)(e.type)?e.address.toLowerCase():e.address}n.SNAP_KEYRING_TYPE="Snap Keyring";class oe extends Y.EventEmitter{constructor({messenger:e,callbacks:t,isAnyAccountTypeAllowed:n=!1}){super(),s.add(this),r.set(this,void 0),a.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),this.type=oe.type,x(this,r,e,"f"),x(this,a,new K.KeyringInternalSnapClient({messenger:e}),"f"),x(this,o,new ne.SnapIdMap,"f"),x(this,i,new ne.SnapIdMap,"f"),x(this,c,new ne.SnapIdMap,"f"),x(this,l,t,"f"),x(this,u,n,"f")}async handleKeyringSnapMessage(e,t){switch((0,q.assert)(t,se.SnapMessageStruct),t.method){case`${$.KeyringEvent.AccountCreated}`:return U(this,s,"m",h).call(this,e,t);case`${$.KeyringEvent.AccountUpdated}`:return U(this,s,"m",m).call(this,e,t);case`${$.KeyringEvent.AccountDeleted}`:return U(this,s,"m",f).call(this,e,t);case`${$.KeyringEvent.RequestApproved}`:return U(this,s,"m",g).call(this,e,t);case`${$.KeyringEvent.RequestRejected}`:return U(this,s,"m",y).call(this,e,t);case`${$.KeyringEvent.AccountBalancesUpdated}`:return U(this,s,"m",b).call(this,e,t);case`${$.KeyringEvent.AccountAssetListUpdated}`:return U(this,s,"m",E).call(this,e,t);case`${$.KeyringEvent.AccountTransactionsUpdated}`:return U(this,s,"m",v).call(this,e,t);default:throw new Error(`Method not supported: ${t.method}`)}}async serialize(){return{accounts:U(this,i,"f").toObject()}}async deserialize(e){if(e===undefined)return;const t={};for(const[n,s]of Object.entries(e.accounts))(0,ee.isAccountV1)(s.account)?(console.info(`SnapKeyring - Found a KeyringAccountV1, migrating to V2: ${s.account.id}`),t[n]={...s,account:(0,ee.migrateAccountV1)(s.account)}):t[n]=s;x(this,i,ne.SnapIdMap.fromObject(t),"f")}async getAccounts(){return(0,re.unique)([...U(this,i,"f").values()].map(({account:e})=>ie(e)))}async getAccountsBySnapId(e){return(0,re.unique)([...U(this,i,"f").values()].filter(({snapId:t})=>t===e).map(({account:e})=>ie(e)))}async createAccount(e,t,n){const s=new K.KeyringInternalSnapClient({messenger:U(this,r,"f"),snapId:e}),a="metamask";if((0,V.hasProperty)(t,a))throw new Error(`The '${a}' property is reserved for internal use`);if(!n)return await s.createAccount(t);const i=(0,z.v4)();return U(this,c,"f").set(i,{snapId:e,options:n}),await s.createAccount({...t,metamask:{correlationId:i}})}hasSnapId(e){return U(this,i,"f").hasSnapId(e)}async resolveAccountAddress(e,t,n){if(!this.hasSnapId(e))throw new Error(`Unable to resolve account address: unknown Snap ID: ${e}`);return await U(this,a,"f").withSnapId(e).resolveAccountAddress(t,n)}async submitRequest({origin:e,account:t,method:n,params:r,scope:a}){const{account:i,snapId:o}=U(this,s,"m",T).call(this,t);return await U(this,s,"m",k).call(this,{origin:e,snapId:o,account:i,method:n,params:r,scope:a,noPending:!0})}async signTransaction(e,t,n={}){const r=t.common.chainId(),a=(0,re.toJson)({...t.toJSON(),from:e,type:`0x${t.type.toString(16)}`,chainId:(0,V.bigIntToHex)(r)}),i=await U(this,s,"m",S).call(this,{origin:"metamask",address:e,method:$.EthMethod.SignTransaction,params:[a],scope:(0,V.toCaipChainId)(V.KnownCaipNamespace.Eip155,`${r}`)}),o=(0,q.mask)(i,(0,q.object)({r:(0,q.string)(),s:(0,q.string)(),v:(0,q.string)()}));return F.TransactionFactory.fromTxData({...a,r:o.r,s:o.s,v:o.v})}async signTypedData(e,t,n={version:G.SignTypedDataVersion.V1}){const r={[G.SignTypedDataVersion.V1]:$.EthMethod.SignTypedDataV1,[G.SignTypedDataVersion.V3]:$.EthMethod.SignTypedDataV3,[G.SignTypedDataVersion.V4]:$.EthMethod.SignTypedDataV4}[n.version]||$.EthMethod.SignTypedDataV1,a=t.domain?.chainId;return(0,W.strictMask)(await U(this,s,"m",S).call(this,{origin:"metamask",address:e,method:r,params:(0,re.toJson)([e,t]),...a===undefined?{}:{scope:(0,V.toCaipChainId)(V.KnownCaipNamespace.Eip155,`${a}`)}}),$.EthBytesStruct)}async signMessage(e,t){return(0,W.strictMask)(await U(this,s,"m",S).call(this,{origin:"metamask",address:e,method:$.EthMethod.Sign,params:(0,re.toJson)([e,t])}),$.EthBytesStruct)}async signPersonalMessage(e,t){return(0,W.strictMask)(await U(this,s,"m",S).call(this,{origin:"metamask",address:e,method:$.EthMethod.PersonalSign,params:(0,re.toJson)([t,e])}),$.EthBytesStruct)}async prepareUserOperation(e,t,n){return(0,W.strictMask)(await U(this,s,"m",S).call(this,{origin:"metamask",address:e,method:$.EthMethod.PrepareUserOperation,params:(0,re.toJson)(t),noPending:!0,scope:(0,V.toCaipChainId)(V.KnownCaipNamespace.Eip155,n.chainId)}),$.EthBaseUserOperationStruct)}async patchUserOperation(e,t,n){return(0,W.strictMask)(await U(this,s,"m",S).call(this,{origin:"metamask",address:e,method:$.EthMethod.PatchUserOperation,params:(0,re.toJson)([t]),noPending:!0,scope:(0,V.toCaipChainId)(V.KnownCaipNamespace.Eip155,n.chainId)}),$.EthUserOperationPatchStruct)}async signUserOperation(e,t,n){return(0,W.strictMask)(await U(this,s,"m",S).call(this,{origin:"metamask",address:e,method:$.EthMethod.SignUserOperation,params:(0,re.toJson)([t]),scope:(0,V.toCaipChainId)(V.KnownCaipNamespace.Eip155,n.chainId)}),$.EthBytesStruct)}exportAccount(e){throw new Error("Exporting accounts from snaps is not supported.")}async removeAccount(e){const{account:t,snapId:n}=U(this,s,"m",j).call(this,e);await U(this,s,"m",D).call(this,n,t)}getAccountByAddress(e){return this.listAccounts().find(({address:t})=>(0,re.equalsIgnoreCase)(t,e))}listAccounts(){return[...U(this,i,"f").values()].map(({account:e,snapId:t})=>{const n=U(this,s,"m",L).call(this,t);return{...e,address:ie(e),metadata:{name:"",importTime:0,keyring:{type:this.type},...n!==undefined&&{snap:n}}}})}}n.SnapKeyring=oe,r=new WeakMap,a=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,s=new WeakSet,d=function(e){return(0,ae.getKeyringVersionFromPlatform)(t=>U(this,r,"f").call("SnapController:isMinimumPlatformVersion",e,t))},p=function(e,t){if(t){const n=U(this,c,"f").pop(e,t);if(n)return n.options;console.warn(`SnapKeyring - Received unmapped correlation ID: "${t}"`)}return undefined},h=async function(e,t){(0,q.assert)(t,X.AccountCreatedEventStruct);const{metamask:n,account:r,accountNameSuggestion:a,displayAccountNameSuggestion:o,displayConfirmation:c}=t.params,d=(0,Q.transformAccount)(r);if(!U(this,u,"f")&&d.type===$.AnyAccountType.Account)throw new Error(`Cannot create generic account '${d.id}'`);const h=ie(d);if(await U(this,l,"f").addressExists(h))throw new Error(`Account address '${h}' already exists`);if(U(this,i,"f").has(e,d.id))throw new Error(`Account '${d.id}' already exists`);const m=new J.DeferredPromise;return await U(this,l,"f").addAccount(h,e,async t=>{t&&(U(this,i,"f").set(d.id,{account:d,snapId:e}),U(this,l,"f").saveState().then(()=>{m.resolve(d.id)}).catch(async t=>{await U(this,s,"m",D).call(this,e,d),m.reject(t)}))},m.promise,a,(0,te.getInternalOptionsOf)([U(this,s,"m",p).call(this,e,n?.correlationId)??{},{displayConfirmation:c,displayAccountNameSuggestion:o}])),null},m=async function(e,t){(0,q.assert)(t,X.AccountUpdatedEventStruct);const{account:n}=t.params,{account:s}=U(this,i,"f").get(e,n.id)??(0,re.throwError)(`Account '${n.id}' not found`),r=(0,Q.transformAccount)(n),a=r.type===$.AnyAccountType.Account||s.type===$.AnyAccountType.Account;if(!U(this,u,"f")&&a)throw new Error(`Cannot update generic account '${r.id}'`);if(!(0,re.equalsIgnoreCase)(s.address,r.address))throw new Error(`Cannot change address of account '${r.id}'`);return U(this,i,"f").set(r.id,{account:r,snapId:e}),await U(this,l,"f").saveState(),null},f=async function(e,t){(0,q.assert)(t,X.AccountDeletedEventStruct);const{id:n}=t.params,s=U(this,i,"f").get(e,n);if(s===undefined)return null;const{account:r}=s;return await U(this,l,"f").removeAccount(ie(r),e,async e=>{e&&await U(this,l,"f").saveState()}),null},g=async function(e,t){(0,q.assert)(t,X.RequestApprovedEventStruct);const{id:n,result:s}=t.params,{promise:r}=U(this,o,"f").get(e,n)??(0,re.throwError)(`Request '${n}' not found`);return U(this,o,"f").delete(e,n),r.resolve(s),null},y=async function(e,t){(0,q.assert)(t,X.RequestRejectedEventStruct);const{id:n}=t.params,{promise:s}=U(this,o,"f").get(e,n)??(0,re.throwError)(`Request '${n}' not found`);return U(this,o,"f").delete(e,n),s.reject(new Error("Request rejected by user or snap.")),null},w=async function(e,t,n){return U(this,r,"f").publish(t,...n(n=>Object.entries(n).reduce((n,[s,r])=>(U(this,i,"f").has(e,s)?n[s]=r:console.warn(`SnapKeyring - ${t} - Found an unknown account ID "${s}" for Snap ID "${e}". Skipping.`),n),{}))),null},b=async function(e,t){(0,q.assert)(t,$.AccountBalancesUpdatedEventStruct);const n=t.params;return U(this,s,"m",w).call(this,e,"SnapKeyring:accountBalancesUpdated",e=>(n.balances=e(n.balances),[n]))},E=async function(e,t){(0,q.assert)(t,$.AccountAssetListUpdatedEventStruct);const n=t.params;return U(this,s,"m",w).call(this,e,"SnapKeyring:accountAssetListUpdated",e=>(n.assets=e(n.assets),[n]))},v=async function(e,t){(0,q.assert)(t,$.AccountTransactionsUpdatedEventStruct);const n=t.params;return U(this,s,"m",w).call(this,e,"SnapKeyring:accountTransactionsUpdated",e=>(n.transactions=e(n.transactions),[n]))},T=function(e){const t=[...U(this,i,"f").values()].find(t=>t.account.id===e);if(!t)throw new Error(`Unable to get account: unknown account ID: '${e}'`);return t},S=async function({origin:e,address:t,method:n,params:r,scope:a="",noPending:i=!1}){const{account:o,snapId:c}=U(this,s,"m",j).call(this,t);return await U(this,s,"m",k).call(this,{origin:e,snapId:c,account:o,method:n,params:r,scope:a,noPending:i})},A=async function({snapId:e,version:t,request:n}){const s=U(this,a,"f").withSnapId(e);return t===H.KeyringVersion.V1?await s.submitRequestV1((0,H.toKeyringRequestV1)(n)):await s.submitRequest(n)},k=async function({origin:e,snapId:t,account:n,method:r,params:a,scope:i,noPending:o}){if(!U(this,s,"m",_).call(this,n,r))throw new Error(`Method '${r}' not supported for account ${n.address}`);if(!e?.trim())throw new Error("An `origin` is required");const c=(0,z.v4)(),l=U(this,s,"m",M).call(this,c,t);try{const u=U(this,s,"m",d).call(this,t),p={id:c,origin:e,scope:i,account:n.id,request:{method:r,...a!==undefined&&{params:a}}};(0,Z.projectLogger)("Submit Snap request: ",p);const h=await U(this,s,"m",A).call(this,{version:u,snapId:t,request:p});if(o&&h.pending)throw new Error(`Request '${c}' to Snap '${t}' is pending and noPending is true.`);return h.pending?((h.redirect?.message||h.redirect?.url)&&await U(this,s,"m",I).call(this,h.redirect,t),l.promise):U(this,s,"m",P).call(this,h,c,t)}catch(e){throw(0,Z.projectLogger)("Snap Request failed: ",{requestId:c}),U(this,s,"m",C).call(this,c,t),e}},_=function(e,t){return e.methods.includes(t)},M=function(e,t){const n=new J.DeferredPromise;return U(this,o,"f").set(e,{promise:n,snapId:t}),n},C=function(e,t){U(this,o,"f").delete(t,e)},P=function(e,t,n){return U(this,o,"f").delete(n,t),e.result},I=async function(e,t){const{message:n="",url:r=""}=e,a=U(this,s,"m",N).call(this,r);a&&U(this,s,"m",O).call(this,a,t),await U(this,l,"f").redirectUser(t,a,n)},N=function(e){return e?(0,re.sanitizeUrl)(e):e},O=function(e,t){const{origin:n}=new URL(e),r=U(this,s,"m",R).call(this,t);if(!r)throw new Error(`Snap '${t}' not found.`);if(!U(this,s,"m",B).call(this,r).includes(n))throw new Error(`Redirect URL domain '${n}' is not an allowed origin by snap '${t}'`)},D=async function(e,t){U(this,i,"f").delete(e,t.id);try{await U(this,a,"f").withSnapId(e).deleteAccount(t.id)}catch(n){console.error(`Account '${t.address}' may not have been removed from snap '${e}':`,n)}},j=function(e){return[...U(this,i,"f").values()].find(({account:t})=>(0,re.equalsIgnoreCase)(t.address,e))??(0,re.throwError)(`Account '${e}' not found`)},R=function(e){return U(this,r,"f").call("SnapController:get",e)},L=function(e){const t=U(this,s,"m",R).call(this,e);return t?{id:e,name:t.manifest.proposedName,enabled:t.enabled}:undefined},B=function(e){return e.manifest.initialPermissions["endowment:keyring"]?.allowedOrigins??[]},oe.type=n.SNAP_KEYRING_TYPE}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/SnapKeyring.cjs"}],[1786,{"./migrations/index.cjs":1790,"@metamask/keyring-api":1914,"@metamask/superstruct":2538},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.KeyringAccountV1Struct=void 0,n.assertKeyringAccount=i,n.transformAccount=function(e){return i((0,a.isAccountV1)(e)?(0,a.transformAccountV1)(e):e)};const s=e("@metamask/keyring-api"),r=e("@metamask/superstruct"),a=e("./migrations/index.cjs");function i(e){switch(e.type){case s.BtcAccountType.P2pkh:return(0,r.assert)(e,s.BtcP2pkhAccountStruct),e;case s.BtcAccountType.P2sh:return(0,r.assert)(e,s.BtcP2shAccountStruct),e;case s.BtcAccountType.P2wpkh:return(0,r.assert)(e,s.BtcP2wpkhAccountStruct),e;case s.BtcAccountType.P2tr:return(0,r.assert)(e,s.BtcP2trAccountStruct),e;case s.SolAccountType.DataAccount:return(0,r.assert)(e,s.SolDataAccountStruct),e;case s.EthAccountType.Erc4337:return(0,r.assert)(e,s.EthErc4337AccountStruct),e;case s.EthAccountType.Eoa:return(0,r.assert)(e,s.EthEoaAccountStruct),e;case s.TrxAccountType.Eoa:return(0,r.assert)(e,s.TrxEoaAccountStruct),e;case s.AnyAccountType.Account:return(0,r.assert)(e,s.KeyringAccountStruct),e;default:throw new Error(`Unknown account type: '${e.type}'`)}}n.KeyringAccountV1Struct=(0,r.omit)(s.KeyringAccountStruct,["scopes"])}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/account.cjs"}],[1787,{"./account.cjs":1786,"@metamask/keyring-api":1914,"@metamask/keyring-utils":1955,"@metamask/superstruct":2538},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RequestRejectedEventStruct=n.RequestApprovedEventStruct=n.AccountDeletedEventStruct=n.AccountUpdatedEventStruct=n.AccountCreatedEventStruct=void 0;const s=e("@metamask/keyring-api");Object.defineProperty(n,"AccountDeletedEventStruct",{enumerable:!0,get:function(){return s.AccountDeletedEventStruct}}),Object.defineProperty(n,"RequestApprovedEventStruct",{enumerable:!0,get:function(){return s.RequestApprovedEventStruct}}),Object.defineProperty(n,"RequestRejectedEventStruct",{enumerable:!0,get:function(){return s.RequestRejectedEventStruct}});const r=e("@metamask/keyring-utils"),a=e("@metamask/superstruct"),i=e("./account.cjs");n.AccountCreatedEventStruct=(0,r.object)({...s.AccountCreatedEventStruct.schema,params:(0,r.object)({...s.AccountCreatedEventStruct.schema.params.schema,account:(0,a.union)([i.KeyringAccountV1Struct,s.KeyringAccountStruct])})}),n.AccountUpdatedEventStruct=(0,r.object)({...s.AccountUpdatedEventStruct.schema,params:(0,r.object)({...s.AccountUpdatedEventStruct.schema.params.schema,account:(0,a.union)([i.KeyringAccountV1Struct,s.KeyringAccountStruct])})})}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/events.cjs"}],[1788,{"./SnapKeyring.cjs":1785,"./options.cjs":1792,"./types.cjs":1793},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./options.cjs"),n),r(e("./types.cjs"),n),r(e("./SnapKeyring.cjs"),n)}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/index.cjs"}],[1789,{"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createModuleLogger=n.projectLogger=void 0;const s=e("@metamask/utils");Object.defineProperty(n,"createModuleLogger",{enumerable:!0,get:function(){return s.createModuleLogger}}),n.projectLogger=(0,s.createProjectLogger)("eth-snap-keyring")}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/logger.cjs"}],[1790,{"./v1.cjs":1791},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./v1.cjs"),n)}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/migrations/index.cjs"}],[1791,{"../account.cjs":1786,"@metamask/keyring-api":1914,"@metamask/keyring-utils":1955,"@metamask/superstruct":2538},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isAccountV1=o,n.getScopesForAccountV1=c,n.transformAccountV1=function(e){const{type:t}=e;if(t===s.EthAccountType.Eoa)return{...e,scopes:c(e)};return(0,i.assertKeyringAccount)(e)},n.migrateAccountV1=function(e){if(!o(e))return e;return{...e,scopes:c(e)}};const s=e("@metamask/keyring-api"),r=e("@metamask/keyring-utils"),a=e("@metamask/superstruct"),i=e("../account.cjs");function o(e){return(0,a.is)(e,i.KeyringAccountV1Struct)}function c(e){switch(e.type){case s.EthAccountType.Eoa:return[s.EthScope.Eoa];case s.EthAccountType.Erc4337:return[s.EthScope.Testnet];case s.BtcAccountType.P2pkh:case s.BtcAccountType.P2sh:case s.BtcAccountType.P2wpkh:case s.BtcAccountType.P2tr:return[(0,r.isBtcMainnetAddress)(e.address)?s.BtcScope.Mainnet:s.BtcScope.Testnet];case s.SolAccountType.DataAccount:return[s.SolScope.Mainnet,s.SolScope.Testnet,s.SolScope.Devnet];case s.TrxAccountType.Eoa:return[s.TrxScope.Mainnet,s.TrxScope.Nile,s.TrxScope.Shasta];default:return[s.EthScope.Eoa]}}}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/migrations/v1.cjs"}],[1792,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(){return{displayAccountNameSuggestion:!0,displayConfirmation:!0,setSelectedAccount:!0}}Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultInternalOptions=s,n.getInternalOptionsOf=function(e){const t={},n={displayAccountNameSuggestion:!0,displayConfirmation:!0,setSelectedAccount:!0},s=Object.keys(n);for(const r of s){t[r]=undefined;for(const s of[...e,n])s[r]!==undefined&&t[r]===undefined&&(t[r]=s[r])}return t}}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/options.cjs"}],[1793,{"@metamask/superstruct":2538,"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SnapMessageStruct=void 0;const s=e("@metamask/superstruct"),r=e("@metamask/utils");n.SnapMessageStruct=(0,s.object)({method:(0,s.string)(),params:(0,s.optional)((0,s.union)([(0,s.array)(r.JsonStruct),(0,s.record)((0,s.string)(),r.JsonStruct)]))})}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/types.cjs"}],[1794,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.unique=function(e){return[...new Set(e)]},n.toJson=function(e){return JSON.parse(JSON.stringify(e))},n.ensureDefined=function(e){if(e===undefined)throw new Error("Argument is undefined")},n.throwError=function(e){throw new Error(e)},n.equalsIgnoreCase=function(e,t){return e.toLowerCase()===t.toLowerCase()},n.sanitizeUrl=function(e){return new URL(e).toString()}}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/util.cjs"}],[1795,{"@metamask/keyring-internal-api":1927},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PLATFORM_VERSION_TO_KEYRING_VERSION=void 0,n.getKeyringVersionFromPlatform=function(e){for(const[t,s]of n.PLATFORM_VERSION_TO_KEYRING_VERSION)if(e(t))return s;return s.KeyringVersion.V1};const s=e("@metamask/keyring-internal-api");n.PLATFORM_VERSION_TO_KEYRING_VERSION=[["7.0.0",s.KeyringVersion.V2]]}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/versions.cjs"}],[1796,{"./nil.js":1799,"./parse.js":1800,"./stringify.js":1804,"./v1.js":1805,"./v3.js":1806,"./v4.js":1808,"./v5.js":1809,"./validate.js":1810,"./version.js":1811},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"NIL",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"parse",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(n,"stringify",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"v1",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"v4",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"v5",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"validate",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"version",{enumerable:!0,get:function(){return c.default}});var s=p(e("./v1.js")),r=p(e("./v3.js")),a=p(e("./v4.js")),i=p(e("./v5.js")),o=p(e("./nil.js")),c=p(e("./version.js")),l=p(e("./validate.js")),u=p(e("./stringify.js")),d=p(e("./parse.js"));function p(e){return e&&e.__esModule?e:{default:e}}}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/index.js"}],[1797,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e){return 14+(e+64>>>9<<4)+1}function r(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function a(e,t,n,s,a,i){return r((o=r(r(t,e),r(s,i)))<<(c=a)|o>>>32-c,n);var o,c}function i(e,t,n,s,r,i,o){return a(t&n|~t&s,e,t,r,i,o)}function o(e,t,n,s,r,i,o){return a(t&s|n&~s,e,t,r,i,o)}function c(e,t,n,s,r,i,o){return a(t^n^s,e,t,r,i,o)}function l(e,t,n,s,r,i,o){return a(n^(t|~s),e,t,r,i,o)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var u=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){const t=[],n=32*e.length,s="0123456789abcdef";for(let r=0;r<n;r+=8){const n=e[r>>5]>>>r%32&255,a=parseInt(s.charAt(n>>>4&15)+s.charAt(15&n),16);t.push(a)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[s(t)-1]=t;let n=1732584193,a=-271733879,u=-1732584194,d=271733878;for(let t=0;t<e.length;t+=16){const s=n,p=a,h=u,m=d;n=i(n,a,u,d,e[t],7,-680876936),d=i(d,n,a,u,e[t+1],12,-389564586),u=i(u,d,n,a,e[t+2],17,606105819),a=i(a,u,d,n,e[t+3],22,-1044525330),n=i(n,a,u,d,e[t+4],7,-176418897),d=i(d,n,a,u,e[t+5],12,1200080426),u=i(u,d,n,a,e[t+6],17,-1473231341),a=i(a,u,d,n,e[t+7],22,-45705983),n=i(n,a,u,d,e[t+8],7,1770035416),d=i(d,n,a,u,e[t+9],12,-1958414417),u=i(u,d,n,a,e[t+10],17,-42063),a=i(a,u,d,n,e[t+11],22,-1990404162),n=i(n,a,u,d,e[t+12],7,1804603682),d=i(d,n,a,u,e[t+13],12,-40341101),u=i(u,d,n,a,e[t+14],17,-1502002290),a=i(a,u,d,n,e[t+15],22,1236535329),n=o(n,a,u,d,e[t+1],5,-165796510),d=o(d,n,a,u,e[t+6],9,-1069501632),u=o(u,d,n,a,e[t+11],14,643717713),a=o(a,u,d,n,e[t],20,-373897302),n=o(n,a,u,d,e[t+5],5,-701558691),d=o(d,n,a,u,e[t+10],9,38016083),u=o(u,d,n,a,e[t+15],14,-660478335),a=o(a,u,d,n,e[t+4],20,-405537848),n=o(n,a,u,d,e[t+9],5,568446438),d=o(d,n,a,u,e[t+14],9,-1019803690),u=o(u,d,n,a,e[t+3],14,-187363961),a=o(a,u,d,n,e[t+8],20,1163531501),n=o(n,a,u,d,e[t+13],5,-1444681467),d=o(d,n,a,u,e[t+2],9,-51403784),u=o(u,d,n,a,e[t+7],14,1735328473),a=o(a,u,d,n,e[t+12],20,-1926607734),n=c(n,a,u,d,e[t+5],4,-378558),d=c(d,n,a,u,e[t+8],11,-2022574463),u=c(u,d,n,a,e[t+11],16,1839030562),a=c(a,u,d,n,e[t+14],23,-35309556),n=c(n,a,u,d,e[t+1],4,-1530992060),d=c(d,n,a,u,e[t+4],11,1272893353),u=c(u,d,n,a,e[t+7],16,-155497632),a=c(a,u,d,n,e[t+10],23,-1094730640),n=c(n,a,u,d,e[t+13],4,681279174),d=c(d,n,a,u,e[t],11,-358537222),u=c(u,d,n,a,e[t+3],16,-722521979),a=c(a,u,d,n,e[t+6],23,76029189),n=c(n,a,u,d,e[t+9],4,-640364487),d=c(d,n,a,u,e[t+12],11,-421815835),u=c(u,d,n,a,e[t+15],16,530742520),a=c(a,u,d,n,e[t+2],23,-995338651),n=l(n,a,u,d,e[t],6,-198630844),d=l(d,n,a,u,e[t+7],10,1126891415),u=l(u,d,n,a,e[t+14],15,-1416354905),a=l(a,u,d,n,e[t+5],21,-57434055),n=l(n,a,u,d,e[t+12],6,1700485571),d=l(d,n,a,u,e[t+3],10,-1894986606),u=l(u,d,n,a,e[t+10],15,-1051523),a=l(a,u,d,n,e[t+1],21,-2054922799),n=l(n,a,u,d,e[t+8],6,1873313359),d=l(d,n,a,u,e[t+15],10,-30611744),u=l(u,d,n,a,e[t+6],15,-1560198380),a=l(a,u,d,n,e[t+13],21,1309151649),n=l(n,a,u,d,e[t+4],6,-145523070),d=l(d,n,a,u,e[t+11],10,-1120210379),u=l(u,d,n,a,e[t+2],15,718787259),a=l(a,u,d,n,e[t+9],21,-343485551),n=r(n,s),a=r(a,p),u=r(u,h),d=r(d,m)}return[n,a,u,d]}(function(e){if(0===e.length)return[];const t=8*e.length,n=new Uint32Array(s(t));for(let s=0;s<t;s+=8)n[s>>5]|=(255&e[s/8])<<s%32;return n}(e),8*e.length))};n.default=u}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/md5-browser.js"}],[1798,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};n.default=s}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/native-browser.js"}],[1799,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default="00000000-0000-0000-0000-000000000000"}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/nil.js"}]],[],{});