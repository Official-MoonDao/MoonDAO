LavaPack.loadBundle([[238,{"../../development/build/constants":460,"../../shared/constants/app":5244,"../../shared/constants/bridge":5246,"../../shared/constants/hardware-wallets":5253,"../../shared/constants/keyring":5255,"../../shared/constants/logs":5257,"../../shared/constants/metametrics":5259,"../../shared/constants/multichain/networks":5261,"../../shared/constants/network":5262,"../../shared/constants/onboarding":5265,"../../shared/constants/permissions":5266,"../../shared/constants/swaps":5275,"../../shared/constants/time":5277,"../../shared/constants/tokens":5278,"../../shared/constants/transaction":5279,"../../shared/lib/accounts":5284,"../../shared/lib/accounts/solana-wallet-snap":5287,"../../shared/lib/fetch-with-cache":5324,"../../shared/lib/metamask-controller-utils":5329,"../../shared/lib/sentry":5336,"../../shared/lib/snaps/snaps":5337,"../../shared/lib/storage-helpers":5338,"../../shared/lib/token-util":5341,"../../shared/lib/trace":5342,"../../shared/lib/transactions-controller-utils":5344,"../../shared/lib/translate":5347,"../../shared/modules/environment":5355,"../../shared/modules/mv3.utils":5363,"../../shared/modules/network.utils":5364,"../../shared/modules/selectors":5370,"../../shared/modules/selectors/networks":5371,"../../shared/modules/shield":5374,"../../shared/modules/string-utils":5375,"../../shared/modules/transaction.utils":5377,"../../shared/notifications":5379,"./constants/stream":9,"./controller-init/accounts/account-tree-controller-init":10,"./controller-init/assets":12,"./controller-init/confirmations/ppom-controller-init":17,"./controller-init/confirmations/transaction-controller-init":18,"./controller-init/defi-positions/defi-positions-controller-init":19,"./controller-init/delegation/delegation-controller-init":20,"./controller-init/gator-permissions/gator-permissions-controller-init":21,"./controller-init/identity/authentication-controller-init":22,"./controller-init/identity/user-storage-controller-init":23,"./controller-init/institutional-snap/institutional-snap-controller-init":24,"./controller-init/metametrics-controller-init":73,"./controller-init/multichain":74,"./controller-init/multichain/multichain-account-service-init":75,"./controller-init/notifications/notification-services-controller-init":82,"./controller-init/notifications/notification-services-push-controller-init":83,"./controller-init/seedless-onboarding":84,"./controller-init/shield/shield-controller-init":87,"./controller-init/smart-transactions/smart-transactions-controller-init":88,"./controller-init/snaps":91,"./controller-init/token-balances-controller-init":98,"./controller-init/token-detection-controller-init":99,"./controller-init/token-list-controller-init":100,"./controller-init/tokens-controller-init":101,"./controller-init/utils":103,"./controllers/account-order":104,"./controllers/account-tracker-controller":105,"./controllers/alert-controller":106,"./controllers/app-metadata":107,"./controllers/app-state-controller":108,"./controllers/decrypt-message":109,"./controllers/encryption-public-key":110,"./controllers/metametrics-data-deletion/metametrics-data-deletion":113,"./controllers/onboarding":115,"./controllers/permissions":119,"./controllers/preferences-controller":122,"./controllers/swaps":126,"./detect-multiple-instances":129,"./lib/AccountIdentitiesPetnamesBridge":132,"./lib/AddressBookPetnamesBridge":133,"./lib/ComposableObservableStore":134,"./lib/PatchStore":136,"./lib/SnapsNameProvider":137,"./lib/WeakRefObjectMap":138,"./lib/approval/utils":139,"./lib/backup":140,"./lib/createDupeReqFilterStream":141,"./lib/createEvmMethodsToNonEvmAccountReqFilterMiddleware":142,"./lib/createLoggerMiddleware":143,"./lib/createMainFrameOriginMiddleware":144,"./lib/createMetaRPCHandler":145,"./lib/createMetamaskMiddleware":146,"./lib/createOnboardingMiddleware":147,"./lib/createOriginMiddleware":148,"./lib/createOriginThrottlingMiddleware":149,"./lib/createRPCMethodTrackingMiddleware":150,"./lib/createTabIdMiddleware":151,"./lib/createTracingMiddleware":152,"./lib/encryptor-factory":155,"./lib/forwardRequestToSnap":160,"./lib/hardware-keyring-builder-factory":162,"./lib/multichain/address":166,"./lib/network-controller/messenger-action-handlers":167,"./lib/network-controller/utils":168,"./lib/offscreen-bridge/lattice-offscreen-keyring":170,"./lib/offscreen-bridge/ledger-offscreen-bridge":171,"./lib/offscreen-bridge/trezor-offscreen-bridge":172,"./lib/open-update-tab-and-reload":173,"./lib/ppom/ppom-middleware":176,"./lib/ppom/ppom-util":177,"./lib/qr-keyring-builder-factory":180,"./lib/rpc-method-middleware":196,"./lib/signature/util":201,"./lib/snap-keyring":203,"./lib/snap-keyring/keyring-snaps-permissions":204,"./lib/state-utils":212,"./lib/stream-utils":217,"./lib/transaction/containers/util":219,"./lib/transaction/decode/util":225,"./lib/transaction/metrics":229,"./lib/transaction/sentinel-api":230,"./lib/transaction/transaction-relay":231,"./lib/transaction/util":232,"./lib/trust-signals/trust-signals-middleware":234,"./lib/util":237,"./services/data-deletion-service":448,"@ethersproject/abi":572,"@metamask/accounts-controller":1033,"@metamask/address-book-controller":1036,"@metamask/announcement-controller":1038,"@metamask/approval-controller":1041,"@metamask/assets-controllers":1076,"@metamask/base-controller":1140,"@metamask/bridge-controller":1147,"@metamask/bridge-status-controller":1171,"@metamask/chain-agnostic-permission":1204,"@metamask/controller-utils":1224,"@metamask/eip-5792-middleware":1612,"@metamask/ens-controller":1618,"@metamask/error-reporting-service":1620,"@metamask/eth-json-rpc-filters":1632,"@metamask/eth-json-rpc-filters/subscriptionManager":1634,"@metamask/eth-json-rpc-middleware":1646,"@metamask/eth-ledger-bridge-keyring":1667,"@metamask/eth-qr-keyring":1676,"@metamask/eth-sig-util":1758,"@metamask/eth-trezor-keyring":1820,"@metamask/gas-fee-controller":1843,"@metamask/json-rpc-engine":1863,"@metamask/json-rpc-middleware-stream":1867,"@metamask/keyring-api":1914,"@metamask/keyring-controller":1924,"@metamask/logging-controller":1961,"@metamask/metamask-eth-abis":1979,"@metamask/multichain-api-middleware":1995,"@metamask/name-controller":2014,"@metamask/network-controller":2026,"@metamask/notification-services-controller/notification-services":2042,"@metamask/obs-store":2083,"@metamask/obs-store/dist/asStream":2082,"@metamask/permission-controller":2090,"@metamask/permission-log-controller":2099,"@metamask/phishing-controller":2103,"@metamask/remote-feature-flag-controller":2217,"@metamask/rpc-errors":2224,"@metamask/scure-bip39/dist/wordlists/english":2228,"@metamask/seedless-onboarding-controller":2244,"@metamask/selected-network-controller":2249,"@metamask/signature-controller":2256,"@metamask/snaps-controllers":2282,"@metamask/snaps-rpc-methods":2346,"@metamask/transaction-controller":2587,"@metamask/user-operation-controller":2614,"@metamask/utils":2632,"await-semaphore":3419,buffer:3590,"eth-chainlist":3791,"eth-lattice-keyring":3796,events:3902,lodash:4362,loglevel:4370,nanoid:4546,"readable-stream":4805},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.METAMASK_CONTROLLER_EVENTS=void 0;var n=yr(e("events")),o=e("readable-stream"),s=e("@metamask/assets-controllers"),a=e("@metamask/json-rpc-engine"),i=e("@metamask/json-rpc-middleware-stream"),l=e("@metamask/obs-store"),c=e("@metamask/obs-store/dist/asStream"),d=e("@metamask/eth-json-rpc-middleware"),u=e("lodash"),h=e("@metamask/keyring-controller"),p=yr(e("@metamask/eth-json-rpc-filters")),m=yr(e("@metamask/eth-json-rpc-filters/subscriptionManager")),f=e("@metamask/rpc-errors"),g=e("await-semaphore"),v=yr(e("loglevel")),y=e("@metamask/eth-trezor-keyring"),C=e("@metamask/eth-ledger-bridge-keyring"),b=yr(e("eth-lattice-keyring")),w=e("eth-chainlist"),k=e("@metamask/eth-qr-keyring"),S=e("nanoid"),P=e("@metamask/address-book-controller"),T=e("@metamask/approval-controller"),M=e("@metamask/base-controller"),E=e("@metamask/ens-controller"),A=e("@metamask/phishing-controller"),O=e("@metamask/announcement-controller"),j=e("@metamask/network-controller"),_=e("@metamask/gas-fee-controller"),I=e("@metamask/permission-controller"),N=e("@metamask/selected-network-controller"),R=e("@metamask/logging-controller"),D=e("@metamask/permission-log-controller"),F=e("@metamask/snaps-controllers"),x=e("@metamask/snaps-rpc-methods"),L=e("@metamask/controller-utils"),$=e("@metamask/accounts-controller"),B=e("@metamask/remote-feature-flag-controller"),U=e("@metamask/signature-controller"),K=e("@metamask/scure-bip39/dist/wordlists/english"),G=e("@metamask/name-controller"),q=e("@metamask/user-operation-controller"),V=e("@metamask/bridge-controller"),H=e("@metamask/transaction-controller"),W=e("@ethersproject/abi"),z=e("@metamask/metamask-eth-abis"),Y=e("@metamask/keyring-api"),Q=e("@metamask/utils"),J=e("@metamask/eth-sig-util"),Z=e("@metamask/notification-services-controller/notification-services"),X=e("@metamask/multichain-api-middleware"),ee=e("@metamask/eip-5792-middleware"),te=e("@metamask/chain-agnostic-permission"),re=e("@metamask/bridge-status-controller"),ne=e("@metamask/error-reporting-service"),oe=e("@metamask/seedless-onboarding-controller"),se=e("../../shared/lib/sentry"),ae=e("../../shared/constants/transaction"),ie=e("../../shared/constants/swaps"),le=e("../../shared/constants/network"),ce=e("../../shared/constants/hardware-wallets"),de=e("../../shared/constants/keyring"),ue=e("../../shared/constants/permissions"),he=e("../../shared/notifications"),pe=e("../../shared/constants/time"),me=e("../../shared/constants/app"),fe=e("../../shared/constants/metametrics"),ge=e("../../shared/constants/logs"),ve=e("../../shared/lib/storage-helpers"),ye=e("../../shared/lib/token-util"),Ce=e("../../shared/modules/string-utils"),be=e("../../shared/modules/transaction.utils"),we=e("../../shared/constants/tokens"),ke=e("../../shared/lib/metamask-controller-utils"),Se=e("../../shared/modules/mv3.utils"),Pe=e("../../shared/modules/network.utils"),Te=e("../../shared/modules/selectors"),Me=e("../../shared/lib/transactions-controller-utils"),Ee=e("../../shared/modules/selectors/networks"),Ae=e("../../shared/lib/trace"),Oe=e("../../development/build/constants"),je=yr(e("../../shared/lib/fetch-with-cache")),_e=e("../../shared/constants/multichain/networks"),Ie=e("../../shared/constants/bridge"),Ne=e("../../shared/lib/accounts"),Re=e("../../shared/lib/accounts/solana-wallet-snap"),De=e("../../shared/constants/onboarding"),Fe=e("../../shared/lib/translate"),xe=e("../../shared/modules/environment"),Le=e("../../shared/lib/snaps/snaps"),$e=e("../../shared/modules/shield"),Be=e("./lib/transaction/metrics"),Ue=e("./lib/snap-keyring/keyring-snaps-permissions"),Ke=e("./lib/SnapsNameProvider"),Ge=e("./lib/AddressBookPetnamesBridge"),qe=e("./lib/AccountIdentitiesPetnamesBridge"),Ve=e("./lib/ppom/ppom-middleware"),He=e("./lib/trust-signals/trust-signals-middleware"),We=e("./detect-multiple-instances"),ze=yr(e("./lib/ComposableObservableStore")),Ye=yr(e("./controllers/account-tracker-controller")),Qe=yr(e("./lib/createDupeReqFilterStream")),Je=yr(e("./lib/createLoggerMiddleware")),Ze=e("./lib/rpc-method-middleware"),Xe=yr(e("./lib/createOriginMiddleware")),et=yr(e("./lib/createMainFrameOriginMiddleware")),tt=yr(e("./lib/createTabIdMiddleware")),rt=e("./controllers/account-order"),nt=yr(e("./lib/createOnboardingMiddleware")),ot=e("./lib/stream-utils"),st=e("./controllers/preferences-controller"),at=e("./controllers/app-state-controller"),it=e("./controllers/alert-controller"),lt=yr(e("./controllers/onboarding")),ct=yr(e("./lib/backup")),dt=yr(e("./controllers/decrypt-message")),ut=yr(e("./controllers/swaps")),ht=yr(e("./lib/createMetaRPCHandler")),pt=e("./lib/util"),mt=yr(e("./lib/createMetamaskMiddleware")),ft=e("./lib/hardware-keyring-builder-factory"),gt=yr(e("./controllers/encryption-public-key")),vt=yr(e("./controllers/app-metadata")),yt=e("./controllers/permissions"),Ct=e("./controllers/metametrics-data-deletion/metametrics-data-deletion"),bt=e("./services/data-deletion-service"),wt=yr(e("./lib/createRPCMethodTrackingMiddleware")),kt=e("./lib/offscreen-bridge/trezor-offscreen-bridge"),St=e("./lib/offscreen-bridge/ledger-offscreen-bridge"),Pt=e("./lib/snap-keyring"),Tt=e("./lib/encryptor-factory"),Mt=e("./lib/transaction/util"),Et=e("./lib/signature/util"),At=e("./lib/offscreen-bridge/lattice-offscreen-keyring"),Ot=e("./lib/WeakRefObjectMap"),jt=e("./constants/stream"),_t=e("./lib/ppom/ppom-util"),It=yr(e("./lib/createEvmMethodsToNonEvmAccountReqFilterMiddleware")),Nt=e("./lib/multichain/address"),Rt=e("./lib/transaction/decode/util"),Dt=yr(e("./lib/createTracingMiddleware")),Ft=yr(e("./lib/createOriginThrottlingMiddleware")),xt=e("./lib/PatchStore"),Lt=e("./lib/state-utils"),$t=e("./lib/approval/utils"),Bt=e("./controller-init/institutional-snap/institutional-snap-controller-init"),Ut=e("./controller-init/multichain"),Kt=e("./controller-init/assets"),Gt=e("./controller-init/confirmations/transaction-controller-init"),qt=e("./controller-init/confirmations/ppom-controller-init"),Vt=e("./controller-init/smart-transactions/smart-transactions-controller-init"),Ht=e("./controller-init/utils"),Wt=e("./controller-init/snaps"),zt=e("./controller-init/identity/authentication-controller-init"),Yt=e("./controller-init/identity/user-storage-controller-init"),Qt=e("./controller-init/defi-positions/defi-positions-controller-init"),Jt=e("./controller-init/notifications/notification-services-controller-init"),Zt=e("./controller-init/notifications/notification-services-push-controller-init"),Xt=e("./controller-init/delegation/delegation-controller-init"),er=e("./lib/network-controller/messenger-action-handlers"),tr=e("./lib/network-controller/utils"),rr=e("./lib/transaction/transaction-relay"),nr=e("./lib/open-update-tab-and-reload"),or=e("./controller-init/accounts/account-tree-controller-init"),sr=e("./lib/qr-keyring-builder-factory"),ar=e("./controller-init/multichain/multichain-account-service-init"),ir=e("./controller-init/seedless-onboarding"),lr=e("./lib/transaction/containers/util"),cr=e("./lib/transaction/sentinel-api"),dr=e("./controller-init/shield/shield-controller-init"),ur=e("./controller-init/gator-permissions/gator-permissions-controller-init"),hr=e("./lib/forwardRequestToSnap"),pr=e("./controller-init/metametrics-controller-init"),mr=e("./controller-init/token-list-controller-init"),fr=e("./controller-init/token-detection-controller-init"),gr=e("./controller-init/tokens-controller-init"),vr=e("./controller-init/token-balances-controller-init");function yr(e){return e&&e.__esModule?e:{default:e}}function Cr(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function br(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wr(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}r.METAMASK_CONTROLLER_EVENTS={UPDATE_BADGE:"updateBadge",DECRYPT_MESSAGE_MANAGER_UPDATE_BADGE:"DecryptMessageManager:updateBadge",ENCRYPTION_PUBLIC_KEY_MANAGER_UPDATE_BADGE:"EncryptionPublicKeyManager:updateBadge",APPROVAL_STATE_CHANGE:"ApprovalController:stateChange",APP_STATE_UNLOCK_CHANGE:"AppStateController:unlockChange",METAMASK_NOTIFICATIONS_LIST_UPDATED:"NotificationServicesController:notificationsListUpdated",METAMASK_NOTIFICATIONS_MARK_AS_READ:"NotificationServicesController:markNotificationsAsRead"};const kr="eip-1193",Sr="caip-multichain",Pr={[Oe.ENVIRONMENT.DEVELOPMENT]:B.EnvironmentType.Development,[Oe.ENVIRONMENT.RELEASE_CANDIDATE]:B.EnvironmentType.ReleaseCandidate,[Oe.ENVIRONMENT.PRODUCTION]:B.EnvironmentType.Production},Tr={flask:B.DistributionType.Flask,main:B.DistributionType.Main,beta:B.DistributionType.Beta,experimental:B.DistributionType.Main};var Mr=new WeakSet;class Er extends n.default{constructor(e){var t;super(),Cr(this,Mr),br(this,"handleWatchAssetRequest",({asset:e,type:t,origin:r,networkClientId:n})=>{switch(t){case L.ERC20:return this.tokensController.watchAsset({asset:e,type:t,networkClientId:n});case L.ERC721:case L.ERC1155:return this.nftController.watchNft(e,t,r,n);default:throw new Error(`Asset type ${t} not supported`)}}),br(this,"removePermissionsFor",e=>{try{this.permissionController.revokePermissions(e)}catch(e){if(!(e instanceof I.PermissionsRequestNotFoundError))throw e}}),br(this,"updateCaveat",(e,t,r,n)=>{try{this.controllerMessenger.call("PermissionController:updateCaveat",e,t,r,n)}catch(e){if(!(e instanceof I.PermissionsRequestNotFoundError))throw e}}),br(this,"updateNetworksList",e=>{try{this.networkOrderController.updateNetworksList(e)}catch(e){throw v.default.error(e.message),e}}),br(this,"updateAccountsList",e=>{try{this.accountOrderController.updateAccountsList(e)}catch(e){throw v.default.error(e.message),e}}),br(this,"setEnabledNetworks",(e,t)=>{try{this.networkOrderController.setEnabledNetworks(e,t)}catch(e){throw v.default.error(e.message),e}}),br(this,"setEnabledNetworksMultichain",(e,t)=>{try{this.networkOrderController.setEnabledNetworksMultichain(e,t)}catch(e){throw v.default.error(e.message),e}}),br(this,"updateHiddenAccountsList",e=>{try{this.accountOrderController.updateHiddenAccountsList(e)}catch(e){throw v.default.error(e.message),e}}),br(this,"rejectPermissionsRequest",e=>{try{this.permissionController.rejectPermissionsRequest(e)}catch(e){if(!(e instanceof I.PermissionsRequestNotFoundError))throw e}}),br(this,"acceptPermissionsRequest",e=>{try{this.permissionController.acceptPermissionsRequest(e)}catch(e){if(!(e instanceof I.PermissionsRequestNotFoundError))throw e}}),br(this,"resolvePendingApproval",async(e,t,r)=>{try{await this.approvalController.accept(e,t,r)}catch(e){if(!(e instanceof T.ApprovalRequestNotFoundError))throw e}}),br(this,"rejectPendingApproval",(e,t)=>{try{this.approvalController.reject(e,new f.JsonRpcError(t.code,t.message,t.data))}catch(e){if(!(e instanceof T.ApprovalRequestNotFoundError))throw e}});const{isFirstMetaMaskControllerSetup:r}=e;this.defaultMaxListeners=20,this.sendUpdate=(0,u.debounce)(this.privateSendUpdate.bind(this),200*pe.MILLISECOND),this.opts=e,this.requestSafeReload=e.requestSafeReload??(()=>Promise.resolve()),this.extension=e.browser,this.platform=e.platform,this.notificationManager=e.notificationManager;const n=e.initState||{},o="13.4.0";this.recordFirstTimeInfo(n),this.featureFlags=e.featureFlags,this.activeControllerConnections=0,this.offscreenPromise=e.offscreenPromise??Promise.resolve(),this.getRequestAccountTabIds=e.getRequestAccountTabIds,this.getOpenMetamaskTabsIds=e.getOpenMetamaskTabsIds,this.initializeChainlist(),this.controllerMessenger=new M.Messenger,this.loggingController=new R.LoggingController({messenger:this.controllerMessenger.getRestricted({name:"LoggingController",allowedActions:[],allowedEvents:[]}),state:n.LoggingController}),this.currentMigrationVersion=e.currentMigrationVersion,this.store=new ze.default({state:n,controllerMessenger:this.controllerMessenger,persist:!0}),this.connections={},this.createVaultMutex=new g.Mutex,this.seedlessOperationMutex=new g.Mutex,this.extension.runtime.onInstalled.addListener(e=>{"update"===e.reason&&this.loggingController.add({type:R.LogType.GenericLog,data:{event:ge.LOG_EVENT.VERSION_UPDATE,previousVersion:e.previousVersion,version:o}})}),this.appMetadataController=new vt.default({state:n.AppMetadataController,messenger:this.controllerMessenger.getRestricted({name:"AppMetadataController",allowedActions:[],allowedEvents:[]}),currentMigrationVersion:this.currentMigrationVersion,currentAppVersion:o}),this.approvalController=new T.ApprovalController({messenger:this.controllerMessenger.getRestricted({name:"ApprovalController"}),showApprovalRequest:e.showUserConfirmation,typesExcludedFromRateLimiting:[L.ApprovalType.PersonalSign,L.ApprovalType.EthSignTypedData,L.ApprovalType.Transaction,L.ApprovalType.WatchAsset,L.ApprovalType.EthGetEncryptionPublicKey,L.ApprovalType.EthDecrypt,me.SMART_TRANSACTION_CONFIRMATION_TYPES.showSmartTransactionStatusPage]});const a=this.controllerMessenger.getRestricted({name:"ErrorReportingService",allowedActions:[],allowedEvents:[]});new ne.ErrorReportingService({messenger:a,captureException:se.captureException});const i=this.controllerMessenger.getRestricted({name:"NetworkController",allowedEvents:[],allowedActions:["ErrorReportingService:captureException"]});let l=n.NetworkController;const c=[L.ChainId["megaeth-testnet"],L.ChainId["monad-testnet"]];if(!l){l=(0,j.getDefaultNetworkControllerState)(c);const e=l.networkConfigurationsByChainId;let t;Object.values(e).forEach(e=>{const t=e.rpcEndpoints[0].networkClientId;(0,Q.hasProperty)(L.BlockExplorerUrl,t)&&(e.blockExplorerUrls=[L.BlockExplorerUrl[t]]),e.defaultBlockExplorerUrlIndex=0}),e[le.CHAIN_IDS.MAINNET].rpcEndpoints[0].failoverUrls=(0,le.getFailoverUrlsForInfuraNetwork)("ethereum-mainnet"),e[le.CHAIN_IDS.LINEA_MAINNET].rpcEndpoints[0].failoverUrls=(0,le.getFailoverUrlsForInfuraNetwork)("linea-mainnet"),e[le.CHAIN_IDS.BASE].rpcEndpoints[0].failoverUrls=(0,le.getFailoverUrlsForInfuraNetwork)("base-mainnet"),t=e[le.CHAIN_IDS.MAINNET],l.selectedNetworkClientId=t.rpcEndpoints[t.defaultRpcEndpointIndex].networkClientId}l.networkConfigurationsByChainId&&!Object.values(l.networkConfigurationsByChainId).flatMap(e=>e.rpcEndpoints.map(e=>e.networkClientId)).includes(l.selectedNetworkClientId)&&((0,se.captureException)(new Error(`NetworkController state is invalid: \`selectedNetworkClientId\` '${l.selectedNetworkClientId}' does not refer to an RPC endpoint within a network configuration`)),l.selectedNetworkClientId=l.networkConfigurationsByChainId[le.CHAIN_IDS.MAINNET].rpcEndpoints[0].networkClientId),this.networkController=new j.NetworkController({messenger:i,state:l,infuraProjectId:e.infuraProjectId,getBlockTrackerOptions:()=>({pollingInterval:20*pe.SECOND,retryTimeout:20*pe.SECOND}),getRpcServiceOptions:e=>{const t={fetch:globalThis.fetch.bind(globalThis),btoa:globalThis.btoa.bind(globalThis)};return(0,tr.getIsQuicknodeEndpointUrl)(e)?{...t,policyOptions:{maxRetries:4,maxConsecutiveFailures:70}}:{...t,policyOptions:{maxRetries:4,maxConsecutiveFailures:35}}},additionalDefaultNetworks:c}),i.subscribe("NetworkController:rpcEndpointUnavailable",async({chainId:t,endpointUrl:r,error:n})=>{(0,er.onRpcEndpointUnavailable)({chainId:t,endpointUrl:r,error:n,infuraProjectId:e.infuraProjectId,trackEvent:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:trackEvent"),metaMetricsId:this.controllerMessenger.call("MetaMetricsController:getMetaMetricsId")})}),i.subscribe("NetworkController:rpcEndpointDegraded",async({chainId:t,endpointUrl:r,error:n})=>{(0,er.onRpcEndpointDegraded)({chainId:t,endpointUrl:r,error:n,infuraProjectId:e.infuraProjectId,trackEvent:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:trackEvent"),metaMetricsId:this.controllerMessenger.call("MetaMetricsController:getMetaMetricsId")})}),this.networkController.initializeProvider(),this.multichainSubscriptionManager=new X.MultichainSubscriptionManager({getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController),findNetworkClientIdByChainId:this.networkController.findNetworkClientIdByChainId.bind(this.networkController)}),this.multichainMiddlewareManager=new X.MultichainMiddlewareManager,this.provider=this.networkController.getProviderAndBlockTracker().provider,this.blockTracker=this.networkController.getProviderAndBlockTracker().blockTracker,this.deprecatedNetworkVersions={};const d=this.controllerMessenger.getRestricted({name:"AccountsController",allowedEvents:["SnapController:stateChange","KeyringController:accountRemoved","KeyringController:stateChange","SnapKeyring:accountAssetListUpdated","SnapKeyring:accountBalancesUpdated","SnapKeyring:accountTransactionsUpdated","MultichainNetworkController:networkDidChange"],allowedActions:["KeyringController:getState","KeyringController:getKeyringsByType"]});this.accountsController=new $.AccountsController({messenger:d,state:n.AccountsController});const p=this.controllerMessenger.getRestricted({name:"PreferencesController",allowedActions:["AccountsController:setSelectedAccount","AccountsController:getSelectedAccount","AccountsController:getAccountByAddress","AccountsController:setAccountName","NetworkController:getState"],allowedEvents:["AccountsController:stateChange"]});this.preferencesController=new st.PreferencesController({state:{currentLocale:e.initLangCode??"",...n.PreferencesController},messenger:p});const m=new bt.DataDeletionService,w=this.controllerMessenger.getRestricted({name:"MetaMetricsDataDeletionController",allowedActions:["MetaMetricsController:getState"],allowedEvents:[]});this.metaMetricsDataDeletionController=new Ct.MetaMetricsDataDeletionController({dataDeletionService:m,messenger:w,state:n.metaMetricsDataDeletionController});const S=this.controllerMessenger.getRestricted({name:"GasFeeController",allowedActions:["NetworkController:getEIP1559Compatibility","NetworkController:getNetworkClientById","NetworkController:getState"],allowedEvents:["NetworkController:stateChange"]}),x=ie.GAS_API_BASE_URL;this.gasFeeController=new _.GasFeeController({state:n.GasFeeController,interval:1e4,messenger:S,clientId:ie.SWAPS_CLIENT_ID,getProvider:()=>this.networkController.getProviderAndBlockTracker().provider,onNetworkDidChange:e=>{i.subscribe("NetworkController:networkDidChange",()=>e(this.networkController.state))},getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getCurrentAccountEIP1559Compatibility:this.getCurrentAccountEIP1559Compatibility.bind(this),legacyAPIEndpoint:`${x}/networks/<chain_id>/gasPrices`,EIP1559APIEndpoint:`${x}/networks/<chain_id>/suggestedGasFees`,getCurrentNetworkLegacyGasAPICompatibility:()=>wr(Mr,this,Or).call(this)===le.CHAIN_IDS.BSC,getChainId:()=>wr(Mr,this,Or).call(this)});const K=this.controllerMessenger.getRestricted({name:"AppStateController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,"PreferencesController:getState"],allowedEvents:["PreferencesController:stateChange"]});this.appStateController=new at.AppStateController({addUnlockListener:this.on.bind(this,"unlock"),isUnlocked:this.isUnlocked.bind(this),state:n.AppStateController,onInactiveTimeout:()=>this.setLocked(),messenger:K,extension:this.extension});const W=this.controllerMessenger.getRestricted({name:"CurrencyRateController",allowedActions:[`${this.networkController.name}:getNetworkClientById`]});this.currencyRateController=new s.CurrencyRateController({includeUsdRate:!0,messenger:W,state:n.CurrencyController,useExternalServices:()=>this.preferencesController.state.useExternalServices});const z=this.currencyRateController.fetchMultiExchangeRate.bind(this.currencyRateController);this.currencyRateController.fetchMultiExchangeRate=(...e)=>this.preferencesController.state.useCurrencyRateCheck?z(...e):{conversionRate:null,usdConversionRate:null};const Y=this.controllerMessenger.getRestricted({name:"PhishingController"});this.phishingController=new A.PhishingController({messenger:Y,state:n.PhishingController,hotlistRefreshInterval:undefined,stalelistRefreshInterval:undefined});const J=this.controllerMessenger.getRestricted({name:"AnnouncementController"});this.announcementController=new O.AnnouncementController({messenger:J,allAnnouncements:he.UI_NOTIFICATIONS,state:n.AnnouncementController});const Z=this.controllerMessenger.getRestricted({name:"AccountOrderController"});this.accountOrderController=new rt.AccountOrderController({messenger:Z,state:n.AccountOrderController});const te=this.controllerMessenger.getRestricted({name:"RatesController"});this.multichainRatesController=new s.RatesController({state:n.MultichainRatesController,messenger:te,includeUsdRate:!0,fetchMultiExchangeRate:s.fetchMultiExchangeRate}),this.controllerMessenger.subscribe("PreferencesController:stateChange",(0,pt.previousValueComparator)((e,t)=>{const{useCurrencyRateCheck:r}=e,{useCurrencyRateCheck:n}=t;n&&!r?this.tokenRatesController.enable():!n&&r&&this.tokenRatesController.disable()},this.preferencesController.state)),this.ensController=new E.EnsController({messenger:this.controllerMessenger.getRestricted({name:"EnsController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState"],allowedEvents:[]}),onNetworkDidChange:i.subscribe.bind(i,"NetworkController:networkDidChange")});const oe=this.controllerMessenger.getRestricted({name:"OnboardingController",allowedActions:[],allowedEvents:[]});this.onboardingController=new lt.default({messenger:oe,state:n.OnboardingController});const ae=null===(t=this.opts.overrides)||void 0===t?void 0:t.keyrings,ce=[(0,sr.qrKeyringBuilderFactory)((null==ae?void 0:ae.qr)||k.QrKeyring,(null==ae?void 0:ae.qrBridge)||k.QrKeyringScannerBridge,{requestScan:async e=>K.call("AppStateController:requestQrCodeScan",e)})];!1===Se.isManifestV3?ce.push((0,h.keyringBuilderFactory)((null==ae?void 0:ae.lattice)||b.default),(0,ft.hardwareKeyringBuilderFactory)(y.TrezorKeyring,(null==ae?void 0:ae.trezorBridge)||y.TrezorConnectBridge),(0,ft.hardwareKeyringBuilderFactory)(y.OneKeyKeyring,(null==ae?void 0:ae.oneKey)||y.TrezorConnectBridge),(0,ft.hardwareKeyringBuilderFactory)(C.LedgerKeyring,(null==ae?void 0:ae.ledgerBridge)||C.LedgerIframeBridge)):ce.push((0,ft.hardwareKeyringBuilderFactory)(y.TrezorKeyring,(null==ae?void 0:ae.trezorBridge)||kt.TrezorOffscreenBridge),(0,ft.hardwareKeyringBuilderFactory)(y.OneKeyKeyring,(null==ae?void 0:ae.oneKey)||kt.TrezorOffscreenBridge),(0,ft.hardwareKeyringBuilderFactory)(C.LedgerKeyring,(null==ae?void 0:ae.ledgerBridge)||St.LedgerOffscreenBridge),(0,h.keyringBuilderFactory)(At.LatticeKeyringOffscreen));const de=this.controllerMessenger.getRestricted({name:"SnapKeyring",allowedActions:["ApprovalController:addRequest","ApprovalController:acceptRequest","ApprovalController:rejectRequest","ApprovalController:startFlow","ApprovalController:endFlow","ApprovalController:showSuccess","ApprovalController:showError","PhishingController:test","PhishingController:maybeUpdateState","KeyringController:getAccounts","AccountsController:setSelectedAccount","AccountsController:getAccountByAddress","AccountsController:setAccountName","AccountsController:listMultichainAccounts","SnapController:handleRequest","SnapController:get","SnapController:isMinimumPlatformVersion","PreferencesController:getState"]}),ve=async()=>{await this.keyringController.persistAllKeyrings(),await this.accountsController.updateAccounts()};ce.push((0,Pt.snapKeyringBuilder)(de,{persistKeyringHelper:()=>ve(),removeAccountHelper:e=>this.removeAccount(e),trackEvent:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:trackEvent")}));const ye=this.controllerMessenger.getRestricted({name:"KeyringController"});this.keyringController=new h.KeyringController({cacheEncryptionKey:!0,keyringBuilders:ce,state:n.KeyringController,encryptor:e.encryptor||(0,Tt.encryptorFactory)(6e5),messenger:ye}),this.controllerMessenger.subscribe("KeyringController:unlock",()=>this._onUnlock()),this.controllerMessenger.subscribe("KeyringController:lock",()=>this._onLock()),this.controllerMessenger.subscribe("KeyringController:stateChange",e=>{this._onKeyringControllerUpdate(e)}),this.permissionController=new I.PermissionController({messenger:this.controllerMessenger.getRestricted({name:"PermissionController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:hasRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`,"SnapController:getPermitted","SnapController:install","SubjectMetadataController:getSubjectMetadata"]}),state:n.PermissionController,caveatSpecifications:(0,yt.getCaveatSpecifications)({listAccounts:this.accountsController.listAccounts.bind(this.accountsController),findNetworkClientIdByChainId:this.networkController.findNetworkClientIdByChainId.bind(this.networkController),isNonEvmScopeSupported:this.controllerMessenger.call.bind(this.controllerMessenger,"MultichainRouter:isSupportedScope"),getNonEvmAccountAddresses:this.controllerMessenger.call.bind(this.controllerMessenger,"MultichainRouter:getSupportedAccounts")}),permissionSpecifications:{...(0,yt.getPermissionSpecifications)(),...this.getSnapPermissionSpecifications()},unrestrictedMethods:yt.unrestrictedMethods}),this.selectedNetworkController=new N.SelectedNetworkController({messenger:this.controllerMessenger.getRestricted({name:"SelectedNetworkController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState","NetworkController:getSelectedNetworkClient","PermissionController:hasPermissions","PermissionController:getSubjectNames"],allowedEvents:["NetworkController:stateChange","PermissionController:stateChange"]}),state:n.SelectedNetworkController,useRequestQueuePreference:!0,onPreferencesStateChange:()=>{},domainProxyMap:new Ot.WeakRefObjectMap}),this.permissionLogController=new D.PermissionLogController({messenger:this.controllerMessenger.getRestricted({name:"PermissionLogController"}),restrictedMethods:new Set(Object.keys(ue.RestrictedMethods)),state:n.PermissionLogController}),this.subjectMetadataController=new I.SubjectMetadataController({messenger:this.controllerMessenger.getRestricted({name:"SubjectMetadataController",allowedActions:[`${this.permissionController.name}:hasPermissions`]}),state:n.SubjectMetadataController,subjectCacheLimit:100});const Ce=this.controllerMessenger.getRestricted({name:"MultichainRouter",allowedActions:["SnapController:getAll","SnapController:handleRequest",`${this.permissionController.name}:getPermissions`,"AccountsController:listMultichainAccounts"],allowedEvents:[]});this.multichainRouter=new F.MultichainRouter({messenger:Ce,withSnapKeyring:async e=>e({keyring:await this.getSnapKeyring()})}),this.accountTrackerController=new Ye.default({state:{accounts:{}},messenger:this.controllerMessenger.getRestricted({name:"AccountTrackerController",allowedActions:["AccountsController:getSelectedAccount","NetworkController:getState","NetworkController:getNetworkClientById","OnboardingController:getState","PreferencesController:getState"],allowedEvents:["AccountsController:selectedEvmAccountChange","OnboardingController:stateChange","KeyringController:accountRemoved"]}),provider:this.provider,blockTracker:this.blockTracker,getNetworkIdentifier:e=>{const{type:t,rpcUrl:r}=e??(0,Ee.getProviderConfig)({metamask:this.networkController.state});return t===le.NETWORK_TYPES.RPC?r:t}}),this.on("controllerConnectionChanged",e=>{const{completedOnboarding:t}=this.onboardingController.state;e>0&&t?this.triggerNetworkrequests():this.stopNetworkRequests()}),this.controllerMessenger.subscribe(`${this.onboardingController.name}:stateChange`,(0,pt.previousValueComparator)(async(e,t)=>{const{completedOnboarding:r}=e,{completedOnboarding:n,firstTimeFlowType:o}=t;if(!r&&n){const{address:e}=this.accountsController.getSelectedAccount();o===De.FirstTimeFlowType.socialImport?await this._importAccountsWithBalances():await this._addAccountsWithBalance(),this.postOnboardingInitialization(),this.triggerNetworkrequests(),await this.tokenDetectionController.detectTokens({selectedAddress:e})}},this.onboardingController.state));const be=this.controllerMessenger.getRestricted({name:"AddressBookController",allowedActions:[],allowedEvents:[]});this.addressBookController=new P.AddressBookController({messenger:be,state:n.AddressBookController}),this.alertController=new it.AlertController({state:n.AlertController,messenger:this.controllerMessenger.getRestricted({name:"AlertController",allowedEvents:["AccountsController:selectedAccountChange"],allowedActions:["AccountsController:getSelectedAccount"]})}),this.backup=new ct.default({preferencesController:this.preferencesController,addressBookController:this.addressBookController,accountsController:this.accountsController,networkController:this.networkController,trackMetaMetricsEvent:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:trackEvent")}),this.snapAndHardwareMetricsParams={getSelectedAccount:this.accountsController.getSelectedAccount.bind(this.accountsController),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),getHardwareTypeForMetric:this.getHardwareTypeForMetric.bind(this),snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]})},this.decryptMessageController=new dt.default({getState:this.getState.bind(this),messenger:this.controllerMessenger.getRestricted({name:"DecryptMessageController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`,`${this.keyringController.name}:decryptMessage`],allowedEvents:["DecryptMessageManager:stateChange","DecryptMessageManager:unapprovedMessage"]}),managerMessenger:this.controllerMessenger.getRestricted({name:"DecryptMessageManager"}),metricsEvent:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:trackEvent")}),this.encryptionPublicKeyController=new gt.default({messenger:this.controllerMessenger.getRestricted({name:"EncryptionPublicKeyController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`],allowedEvents:["EncryptionPublicKeyManager:stateChange","EncryptionPublicKeyManager:unapprovedMessage"]}),managerMessenger:this.controllerMessenger.getRestricted({name:"EncryptionPublicKeyManager"}),getEncryptionPublicKey:this.keyringController.getEncryptionPublicKey.bind(this.keyringController),getAccountKeyringType:this.keyringController.getAccountKeyringType.bind(this.keyringController),getState:this.getState.bind(this),metricsEvent:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:trackEvent")}),this.signatureController=new U.SignatureController({messenger:this.controllerMessenger.getRestricted({name:"SignatureController",allowedActions:[`${this.accountsController.name}:getState`,`${this.approvalController.name}:addRequest`,`${this.keyringController.name}:signMessage`,`${this.keyringController.name}:signPersonalMessage`,`${this.keyringController.name}:signTypedMessage`,`${this.loggingController.name}:add`,`${this.networkController.name}:getNetworkClientById`]}),trace:Ae.trace,decodingApiUrl:"https://signature-insights.api.cx.metamask.io/v1",isDecodeSignatureRequestEnabled:()=>this.preferencesController.state.useTransactionSimulations}),this.signatureController.hub.on("cancelWithReason",({metadata:e,reason:t})=>{this.controllerMessenger.call("MetaMetricsController:trackEvent",{event:t,category:fe.MetaMetricsEventCategory.Transactions,properties:{action:"Sign Request",type:e.type}})});const we=this.controllerMessenger.getRestricted({name:"SwapsController",allowedActions:["NetworkController:getState","NetworkController:getNetworkClientById","TokenRatesController:getState"],allowedEvents:[]});this.swapsController=new ut.default({messenger:we,getBufferedGasLimit:async(e,t)=>{const{gas:r,simulationFails:n}=await this.txController.estimateGasBuffered(e.txParams,t,wr(Mr,this,jr).call(this));return{gasLimit:r,simulationFails:n}},getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getLayer1GasFee:(...e)=>this.txController.getLayer1GasFee(...e),trackMetaMetricsEvent:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:trackEvent")},n.SwapsController);const ke=this.controllerMessenger.getRestricted({name:V.BRIDGE_CONTROLLER_NAME,allowedActions:["AccountsController:getSelectedMultichainAccount","SnapController:handleRequest","NetworkController:getState","NetworkController:getNetworkClientById","NetworkController:findNetworkClientIdByChainId","TokenRatesController:getState","MultichainAssetsRatesController:getState","RemoteFeatureFlagController:getState","CurrencyRateController:getState"],allowedEvents:[]});this.bridgeController=new V.BridgeController({messenger:ke,clientId:V.BridgeClientId.EXTENSION,getLayer1GasFee:(...e)=>this.txController.getLayer1GasFee(...e),fetchFn:async(e,{cacheOptions:t,functionName:r,...n})=>"fetchBridgeTokens"===r?await(0,je.default)({url:e,fetchOptions:{method:"GET",...n},cacheOptions:t,functionName:r}):await(0,L.handleFetch)(e,{method:"GET",...n}),trackMetaMetricsFn:(e,t)=>{const r=(Date.now()+Math.random()).toString();this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:trackEvent")({category:V.UNIFIED_SWAP_BRIDGE_EVENT_CATEGORY,event:e,properties:{...t??{},environmentType:(0,pt.getEnvironmentType)(),actionId:r}})},traceFn:(...e)=>(0,Ae.trace)(...e),config:{customBridgeApiBaseUrl:Ie.BRIDGE_API_BASE_URL}});const Pe=this.controllerMessenger.getRestricted({name:re.BRIDGE_STATUS_CONTROLLER_NAME,allowedActions:["AccountsController:getSelectedMultichainAccount","NetworkController:getNetworkClientById","NetworkController:findNetworkClientIdByChainId","NetworkController:getState","BridgeController:getBridgeERC20Allowance","BridgeController:trackUnifiedSwapBridgeEvent","BridgeController:stopPollingForQuotes","GasFeeController:getState","AccountsController:getAccountByAddress","SnapController:handleRequest","TransactionController:getState","RemoteFeatureFlagController:getState"],allowedEvents:["MultichainTransactionsController:transactionConfirmed","TransactionController:transactionFailed","TransactionController:transactionConfirmed"]});this.bridgeStatusController=new re.BridgeStatusController({messenger:Pe,state:n.BridgeStatusController,fetchFn:async(e,t)=>await(0,L.handleFetch)(e,{method:"GET",...t}),addTransactionFn:(...e)=>this.txController.addTransaction(...e),addTransactionBatchFn:(...e)=>this.txController.addTransactionBatch(...e),estimateGasFeeFn:(...e)=>this.txController.estimateGasFee(...e),updateTransactionFn:(...e)=>this.txController.updateTransaction(...e),config:{customBridgeApiBaseUrl:Ie.BRIDGE_API_BASE_URL},traceFn:(...e)=>(0,Ae.trace)(...e)});const Me=()=>this.preferencesController.state.useExternalNameSources;this.nameController=new G.NameController({messenger:this.controllerMessenger.getRestricted({name:"NameController",allowedActions:[]}),providers:[new G.ENSNameProvider({reverseLookup:this.ensController.reverseResolveAddress.bind(this.ensController)}),new G.EtherscanNameProvider({isEnabled:Me}),new G.TokenNameProvider({isEnabled:Me}),new G.LensNameProvider({isEnabled:Me}),new Ke.SnapsNameProvider({messenger:this.controllerMessenger.getRestricted({name:"SnapsNameProvider",allowedActions:["SnapController:getAll","SnapController:get","SnapController:handleRequest","PermissionController:getState"]})})],state:n.NameController});const Oe=this.controllerMessenger.getRestricted({name:"PetnamesBridge",allowedEvents:["NameController:stateChange","AccountsController:stateChange","AddressBookController:stateChange"],allowedActions:["AccountsController:listAccounts"]});new Ge.AddressBookPetnamesBridge({addressBookController:this.addressBookController,nameController:this.nameController,messenger:Oe}).init(),new qe.AccountIdentitiesPetnamesBridge({nameController:this.nameController,messenger:Oe}).init(),this.userOperationController=new q.UserOperationController({entrypoint:null,getGasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),messenger:this.controllerMessenger.getRestricted({name:"UserOperationController",allowedActions:["ApprovalController:addRequest","NetworkController:getNetworkClientById","KeyringController:prepareUserOperation","KeyringController:patchUserOperation","KeyringController:signUserOperation"]}),state:n.UserOperationController}),this.userOperationController.hub.on("user-operation-added",this._onUserOperationAdded.bind(this)),this.userOperationController.hub.on("transaction-updated",this._onUserOperationTransactionUpdated.bind(this)),i.subscribe("NetworkController:networkDidChange",()=>{this.accountTrackerController.updateAccounts()}),this.controllerMessenger.subscribe("PreferencesController:stateChange",(0,pt.previousValueComparator)((e,t)=>{const{useExternalServices:r}=e,{useExternalServices:n}=t;n&&!r?(this.remoteFeatureFlagController.enable(),this.remoteFeatureFlagController.updateRemoteFeatureFlags().catch(e=>{console.error("Failed to update remote feature flags:",e)})):!n&&r&&this.remoteFeatureFlagController.disable()},this.preferencesController.state));const _e=this.controllerMessenger.getRestricted({name:"RemoteFeatureFlagController",allowedActions:[],allowedEvents:[]});_e.subscribe("RemoteFeatureFlagController:stateChange",e=>{e?(console.log("isRpcFailoverEnabled = ",e,", enabling RPC failover"),this.networkController.enableRpcFailover()):(console.log("isRpcFailoverEnabled = ",e,", disabling RPC failover"),this.networkController.disableRpcFailover())},e=>e.remoteFeatureFlags.walletFrameworkRpcFailoverEnabled),this.remoteFeatureFlagController=new B.RemoteFeatureFlagController({messenger:_e,fetchInterval:9e5,disabled:!this.preferencesController.state.useExternalServices,getMetaMetricsId:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:getMetaMetricsId"),clientConfigApiService:new B.ClientConfigApiService({fetch:globalThis.fetch.bind(globalThis),config:{client:B.ClientType.Extension,distribution:this._getConfigForRemoteFeatureFlagRequest().distribution,environment:this._getConfigForRemoteFeatureFlagRequest().environment}})});const Ne=[this.networkController,this.preferencesController,this.gasFeeController,this.onboardingController,this.keyringController,this.accountsController],Re={MetaMetricsController:pr.MetaMetricsControllerInit,ExecutionService:Wt.ExecutionServiceInit,InstitutionalSnapController:Bt.InstitutionalSnapControllerInit,RateLimitController:Wt.RateLimitControllerInit,SnapsRegistry:Wt.SnapsRegistryInit,CronjobController:Wt.CronjobControllerInit,SnapController:Wt.SnapControllerInit,SnapInsightsController:Wt.SnapInsightsControllerInit,SnapInterfaceController:Wt.SnapInterfaceControllerInit,WebSocketService:Wt.WebSocketServiceInit,PPOMController:qt.PPOMControllerInit,TransactionController:Gt.TransactionControllerInit,SmartTransactionsController:Vt.SmartTransactionsControllerInit,NftController:Kt.NftControllerInit,AssetsContractController:Kt.AssetsContractControllerInit,NftDetectionController:Kt.NftDetectionControllerInit,TokenListController:mr.TokenListControllerInit,TokenDetectionController:fr.TokenDetectionControllerInit,TokensController:gr.TokensControllerInit,TokenBalancesController:vr.TokenBalancesControllerInit,TokenRatesController:Kt.TokenRatesControllerInit,MultichainAssetsController:Ut.MultichainAssetsControllerInit,MultichainAssetsRatesController:Ut.MultichainAssetsRatesControllerInit,MultichainBalancesController:Ut.MultichainBalancesControllerInit,MultichainTransactionsController:Ut.MultichainTransactionsControllerInit,MultichainAccountService:ar.MultichainAccountServiceInit,MultichainNetworkController:Ut.MultichainNetworkControllerInit,AuthenticationController:zt.AuthenticationControllerInit,UserStorageController:Yt.UserStorageControllerInit,NotificationServicesController:Jt.NotificationServicesControllerInit,NotificationServicesPushController:Zt.NotificationServicesPushControllerInit,DeFiPositionsController:Qt.DeFiPositionsControllerInit,DelegationController:Xt.DelegationControllerInit,AccountTreeController:or.AccountTreeControllerInit,OAuthService:ir.OAuthServiceInit,SeedlessOnboardingController:ir.SeedlessOnboardingControllerInit,NetworkOrderController:Kt.NetworkOrderControllerInit,ShieldController:dr.ShieldControllerInit,GatorPermissionsController:ur.GatorPermissionsControllerInit},{controllerApi:Fe,controllerMemState:Le,controllerPersistedState:Be,controllersByName:Ue}=wr(Mr,this,_r).call(this,{existingControllers:Ne,initFunctions:Re,initState:n});this.controllerApi=Fe,this.controllerMemState=Le,this.controllerPersistedState=Be,this.controllersByName=Ue,this.metaMetricsController=Ue.MetaMetricsController,this.cronjobController=Ue.CronjobController,this.rateLimitController=Ue.RateLimitController,this.snapController=Ue.SnapController,this.snapInsightsController=Ue.SnapInsightsController,this.snapInterfaceController=Ue.SnapInterfaceController,this.snapsRegistry=Ue.SnapsRegistry,this.ppomController=Ue.PPOMController,this.txController=Ue.TransactionController,this.smartTransactionsController=Ue.SmartTransactionsController,this.nftController=Ue.NftController,this.nftDetectionController=Ue.NftDetectionController,this.assetsContractController=Ue.AssetsContractController,this.multichainAssetsController=Ue.MultichainAssetsController,this.multichainBalancesController=Ue.MultichainBalancesController,this.multichainTransactionsController=Ue.MultichainTransactionsController,this.multichainAssetsRatesController=Ue.MultichainAssetsRatesController,this.multichainAccountService=Ue.MultichainAccountService,this.tokenBalancesController=Ue.TokenBalancesController,this.tokenListController=Ue.TokenListController,this.tokenDetectionController=Ue.TokenDetectionController,this.tokensController=Ue.TokensController,this.tokenRatesController=Ue.TokenRatesController,this.multichainNetworkController=Ue.MultichainNetworkController,this.authenticationController=Ue.AuthenticationController,this.userStorageController=Ue.UserStorageController,this.delegationController=Ue.DelegationController,this.notificationServicesController=Ue.NotificationServicesController,this.notificationServicesPushController=Ue.NotificationServicesPushController,this.deFiPositionsController=Ue.DeFiPositionsController,this.accountTreeController=Ue.AccountTreeController,this.oauthService=Ue.OAuthService,this.seedlessOnboardingController=Ue.SeedlessOnboardingController,this.networkOrderController=Ue.NetworkOrderController,this.shieldController=Ue.ShieldController,this.gatorPermissionsController=Ue.GatorPermissionsController,this.on("update",e=>{this.metaMetricsController.handleMetaMaskStateUpdate(e)}),this.getSecurityAlertsConfig=()=>async e=>(0,$e.getShieldGatewayConfig)(()=>this.controllerMessenger.call("AuthenticationController:getBearerToken"),e),this.notificationServicesController.init(),this.snapController.init(),this.cronjobController.init(),this.controllerMessenger.subscribe("TransactionController:transactionStatusUpdated",({transactionMeta:e})=>{this._onFinishedTransaction(e)}),this.controllerMessenger.subscribe("NotificationServicesPushController:onNewNotifications",e=>{this.metaMetricsController.trackEvent({category:fe.MetaMetricsEventCategory.PushNotifications,event:fe.MetaMetricsEventName.PushNotificationReceived,properties:{notification_id:e.id,notification_type:e.type,chain_id:null==e?void 0:e.chain_id}})}),this.controllerMessenger.subscribe("NotificationServicesPushController:pushNotificationClicked",e=>{this.metaMetricsController.trackEvent({category:fe.MetaMetricsEventCategory.PushNotifications,event:fe.MetaMetricsEventName.PushNotificationClicked,properties:{notification_id:e.id,notification_type:e.type,chain_id:null==e?void 0:e.chain_id}})}),this.metamaskMiddleware=(0,mt.default)({static:{eth_syncing:!1,web3_clientVersion:`MetaMask/v${o}`},version:o,getAccounts:({origin:e})=>{if(e===me.ORIGIN_METAMASK){const e=this.accountsController.getSelectedAccount().address;return e?[e]:[]}return this.getPermittedAccounts(e)},processTransaction:(e,t)=>(0,Mt.addDappTransaction)(this.getAddTransactionRequest({transactionParams:e,dappRequest:t})),processTypedMessage:(...e)=>(0,Et.addTypedMessage)({signatureController:this.signatureController,signatureParams:e}),processTypedMessageV3:(...e)=>(0,Et.addTypedMessage)({signatureController:this.signatureController,signatureParams:e}),processTypedMessageV4:(...e)=>(0,Et.addTypedMessage)({signatureController:this.signatureController,signatureParams:e}),processPersonalMessage:(...e)=>(0,Et.addPersonalMessage)({signatureController:this.signatureController,signatureParams:e}),processEncryptionPublicKey:this.encryptionPublicKeyController.newRequestEncryptionPublicKey.bind(this.encryptionPublicKeyController),processDecryptMessage:this.decryptMessageController.newRequestDecryptMessage.bind(this.decryptMessageController),getPendingNonce:this.getPendingNonce.bind(this),getPendingTransactionByHash:e=>this.txController.state.transactions.find(t=>t.hash===e&&t.status===H.TransactionStatus.submitted),processSendCalls:ee.processSendCalls.bind(null,{addTransaction:this.txController.addTransaction.bind(this.txController),addTransactionBatch:this.txController.addTransactionBatch.bind(this.txController),getDismissSmartAccountSuggestionEnabled:()=>this.preferencesController.state.preferences.dismissSmartAccountSuggestionEnabled,isAtomicBatchSupported:this.txController.isAtomicBatchSupported.bind(this.txController),validateSecurity:(e,t,r)=>(0,_t.validateRequestWithPPOM)({chainId:r,ppomController:this.ppomController,request:t,securityAlertId:e,updateSecurityAlertResponse:this.updateSecurityAlertResponse.bind(this)})},this.controllerMessenger),getCallsStatus:ee.getCallsStatus.bind(null,this.controllerMessenger),getCapabilities:ee.getCapabilities.bind(null,{getDismissSmartAccountSuggestionEnabled:()=>this.preferencesController.state.preferences.dismissSmartAccountSuggestionEnabled,getIsSmartTransaction:e=>(0,Te.getIsSmartTransaction)(this._getMetaMaskState(),e),isAtomicBatchSupported:this.txController.isAtomicBatchSupported.bind(this.txController),isRelaySupported:rr.isRelaySupported,getSendBundleSupportedChains:cr.getSendBundleSupportedChains},this.controllerMessenger),processRequestExecutionPermissions:(0,xe.isGatorPermissionsFeatureEnabled)()?hr.forwardRequestToSnap.bind(null,{snapId:"npm:@metamask/permissions-kernel-snap",handleRequest:this.handleSnapRequest.bind(this)}):undefined}),this.on("update",e=>this._onStateUpdate(e));const Ve={AccountTracker:this.accountTrackerController,TokenRatesController:this.tokenRatesController,DecryptMessageController:this.decryptMessageController,EncryptionPublicKeyController:this.encryptionPublicKeyController,SignatureController:this.signatureController,SwapsController:this.swapsController,BridgeController:this.bridgeController,BridgeStatusController:this.bridgeStatusController,EnsController:this.ensController,ApprovalController:this.approvalController};this.store.updateStructure({AccountsController:this.accountsController,AppStateController:this.appStateController,AppMetadataController:this.appMetadataController,KeyringController:this.keyringController,PreferencesController:this.preferencesController,MetaMetricsController:this.metaMetricsController,MetaMetricsDataDeletionController:this.metaMetricsDataDeletionController,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,MultichainNetworkController:this.multichainNetworkController,NetworkController:this.networkController,AlertController:this.alertController,OnboardingController:this.onboardingController,SeedlessOnboardingController:this.seedlessOnboardingController,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController,SubjectMetadataController:this.subjectMetadataController,AnnouncementController:this.announcementController,NetworkOrderController:this.networkOrderController,AccountOrderController:this.accountOrderController,GasFeeController:this.gasFeeController,GatorPermissionsController:this.gatorPermissionsController,TokenListController:this.tokenListController,TokensController:this.tokensController,TokenBalancesController:this.tokenBalancesController,SmartTransactionsController:this.smartTransactionsController,NftController:this.nftController,PhishingController:this.phishingController,SelectedNetworkController:this.selectedNetworkController,LoggingController:this.loggingController,MultichainRatesController:this.multichainRatesController,NameController:this.nameController,UserOperationController:this.userOperationController,AuthenticationController:this.authenticationController,UserStorageController:this.userStorageController,NotificationServicesController:this.notificationServicesController,NotificationServicesPushController:this.notificationServicesPushController,RemoteFeatureFlagController:this.remoteFeatureFlagController,DeFiPositionsController:this.deFiPositionsController,...Ve,...Be}),this.memStore=new ze.default({config:{AccountsController:this.accountsController,AppStateController:this.appStateController,AppMetadataController:this.appMetadataController,MultichainAssetsController:this.multichainAssetsController,MultichainBalancesController:this.multichainBalancesController,MultichainTransactionsController:this.multichainTransactionsController,MultichainAssetsRatesController:this.multichainAssetsRatesController,TokenRatesController:this.tokenRatesController,MultichainNetworkController:this.multichainNetworkController,NetworkController:this.networkController,KeyringController:this.keyringController,PreferencesController:this.preferencesController,MetaMetricsController:this.metaMetricsController,MetaMetricsDataDeletionController:this.metaMetricsDataDeletionController,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,AlertController:this.alertController,OnboardingController:this.onboardingController,SeedlessOnboardingController:this.seedlessOnboardingController,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController,SubjectMetadataController:this.subjectMetadataController,AnnouncementController:this.announcementController,NetworkOrderController:this.networkOrderController,AccountOrderController:this.accountOrderController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,TokenBalancesController:this.tokenBalancesController,SmartTransactionsController:this.smartTransactionsController,NftController:this.nftController,SelectedNetworkController:this.selectedNetworkController,LoggingController:this.loggingController,MultichainRatesController:this.multichainRatesController,SnapController:this.snapController,CronjobController:this.cronjobController,SnapsRegistry:this.snapsRegistry,SnapInterfaceController:this.snapInterfaceController,SnapInsightsController:this.snapInsightsController,NameController:this.nameController,UserOperationController:this.userOperationController,AuthenticationController:this.authenticationController,UserStorageController:this.userStorageController,NotificationServicesController:this.notificationServicesController,NotificationServicesPushController:this.notificationServicesPushController,RemoteFeatureFlagController:this.remoteFeatureFlagController,DeFiPositionsController:this.deFiPositionsController,PhishingController:this.phishingController,ShieldController:this.shieldController,...Ve,...Le},controllerMessenger:this.controllerMessenger});const He=[this.accountTrackerController.resetState.bind(this.accountTrackerController),this.decryptMessageController.resetState.bind(this.decryptMessageController),this.encryptionPublicKeyController.resetState.bind(this.encryptionPublicKeyController),this.signatureController.resetState.bind(this.signatureController),this.swapsController.resetState.bind(this.swapsController),this.bridgeController.resetState.bind(this.bridgeController),this.ensController.resetState.bind(this.ensController),this.approvalController.clear.bind(this.approvalController)];Se.isManifestV3?!0===r&&(this.resetStates(He),this.extension.storage.session.set({isFirstMetaMaskControllerSetup:!1})):this.resetStates(He);!this.isUnlocked()&&this.onboardingController.state.completedOnboarding,this._startUISync(),this.extension.runtime.getPlatformInfo().then(({os:e})=>{this.appStateController.setBrowserEnvironment(e,this.extension.runtime.getBrowserInfo===undefined?"chrome":"firefox")}),this.setupControllerEventSubscriptions(),this.setupMultichainDataAndSubscriptions(),this.publicConfigStore=this.createPublicConfigStore(),this.extension.runtime.onMessageExternal.addListener(We.onMessageReceived),(0,We.checkForMultipleVersionsRunning)(),this.onboardingController.state.completedOnboarding&&this.postOnboardingInitialization()}getInfuraFeatureFlags(){(0,je.default)({url:"https://bridge.api.cx.metamask.io/featureFlags",cacheRefreshTime:20*pe.MINUTE}).then(this.onFeatureFlagResponseReceived).catch(e=>{v.default.warn("Feature flag endpoint is unreachable",e)})}onFeatureFlagResponseReceived(e){const{multiChainAssets:t={}}=e,{pollInterval:r}=t;r>0&&this.tokenBalancesController.setIntervalLength(r*pe.SECOND)}postOnboardingInitialization(){const{usePhishDetect:e}=this.preferencesController.state;this.networkController.lookupNetwork(),e&&this.phishingController.maybeUpdateState()}triggerNetworkrequests(){this.tokenDetectionController.enable(),this.getInfuraFeatureFlags(),(0,Y.isEvmAccountType)(this.accountsController.getSelectedMultichainAccount().type)||this.multichainRatesController.start()}stopNetworkRequests(){this.txController.stopIncomingTransactionPolling(),this.tokenDetectionController.disable(),this.multichainRatesController.stop()}resetStates(e){e.forEach(e=>{try{e()}catch(e){console.error(e)}})}async getSnapKeyring(){let[e]=this.keyringController.getKeyringsByType(de.KeyringType.snap);return e||(await this.keyringController.addNewKeyring(de.KeyringType.snap),[e]=this.keyringController.getKeyringsByType(de.KeyringType.snap)),e}trackInsightSnapView(e){this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.InsightSnapViewed,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:e}})}_getSnapMetadata(e){var t;return null===(t=this.snapsRegistry.state.database)||void 0===t||null===(t=t.verifiedSnaps)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.metadata}async handleSnapRequest(e){return await this.controllerMessenger.call("SnapController:handleRequest",e)}getLocale(){const{currentLocale:e}=this.preferencesController.state;return e}getPreferences(){const{preferences:e,securityAlertsEnabled:t,useCurrencyRateCheck:r,useTransactionSimulations:n,useTokenDetection:o,useMultiAccountBalanceChecker:s,openSeaEnabled:a,useNftDetection:i}=this.preferencesController.state;return{privacyMode:e.privacyMode,showTestnets:e.showTestNetworks,securityAlertsEnabled:t,useCurrencyRateCheck:r,useTransactionSimulations:n,useTokenDetection:o,useMultiAccountBalanceChecker:s,openSeaEnabled:a,useNftDetection:i}}getSnapPermissionSpecifications(){return{...(0,x.buildSnapEndowmentSpecifications)(Object.keys(ue.ExcludedSnapEndowments)),...(0,x.buildSnapRestrictedMethodSpecifications)(Object.keys(ue.ExcludedSnapPermissions),{getPreferences:()=>{const e=this.getLocale(),t=this.currencyRateController.state.currentCurrency,{privacyMode:r,securityAlertsEnabled:n,useCurrencyRateCheck:o,useTransactionSimulations:s,useTokenDetection:a,useMultiAccountBalanceChecker:i,openSeaEnabled:l,useNftDetection:c,showTestnets:d}=this.getPreferences();return{locale:e,currency:t,hideBalances:r,useSecurityAlerts:n,useExternalPricingData:o,simulateOnChainActions:s,useTokenDetection:a,batchCheckBalances:i,displayNftMedia:l,useNftDetection:c,showTestnets:d}},clearSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:clearSnapState"),getMnemonic:async e=>{if(!e)return this.getPrimaryKeyringMnemonic();try{const{type:t,mnemonic:r}=await this.controllerMessenger.call("KeyringController:withKeyring",{id:e},async({keyring:e})=>({type:e.type,mnemonic:e.mnemonic}));if(t!==h.KeyringTypes.hd||!r)throw new Error(`Entropy source with ID "${e}" not found.`);return r}catch{throw new Error(`Entropy source with ID "${e}" not found.`)}},getMnemonicSeed:async e=>{if(!e)return this.getPrimaryKeyringMnemonicSeed();try{const{type:t,seed:r}=await this.controllerMessenger.call("KeyringController:withKeyring",{id:e},async({keyring:e})=>({type:e.type,seed:e.seed}));if(t!==h.KeyringTypes.hd||!r)throw new Error(`Entropy source with ID "${e}" not found.`);return r}catch{throw new Error(`Entropy source with ID "${e}" not found.`)}},getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),getSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:get"),handleSnapRpcRequest:this.handleSnapRequest.bind(this),getSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getSnapState"),requestUserApproval:this.approvalController.addAndShowApprovalRequest.bind(this.approvalController),showNativeNotification:(e,t)=>this.controllerMessenger.call("RateLimitController:call",e,"showNativeNotification",e,t.message),showInAppNotification:(e,t)=>{const{message:r,title:n,footerLink:o}=t,s={interfaceId:t.content,message:r,title:n,footerLink:o};return this.controllerMessenger.call("RateLimitController:call",e,"showInAppNotification",e,s)},updateSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:updateSnapState"),maybeUpdatePhishingList:()=>{const{usePhishDetect:e}=this.preferencesController.state;e&&this.controllerMessenger.call("PhishingController:maybeUpdateState")},isOnPhishingList:e=>{const{usePhishDetect:t}=this.preferencesController.state;return!!t&&this.controllerMessenger.call("PhishingController:testOrigin",e).result},createInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:createInterface"),getInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:getInterface"),getClientCryptography:()=>({}),getSnapKeyring:this.getSnapKeyring.bind(this)})}}setupControllerEventSubscriptions(){let e,t;try{var r;t=null===(r=this.accountsController.getSelectedMultichainAccount(_e.MultichainNetworks.SOLANA))||void 0===r?void 0:r.address}catch{}this.controllerMessenger.subscribe("PreferencesController:stateChange",(0,pt.previousValueComparator)(async(e,t)=>{const{currentLocale:r}=t;await(0,Fe.updateCurrentLocale)(r)},this.preferencesController.state)),this.controllerMessenger.subscribe(`${this.accountsController.name}:selectedAccountChange`,async t=>{t.address&&t.address!==e&&(e=t.address,await this._onAccountChange(t.address))}),this.controllerMessenger.subscribe(`${this.permissionController.name}:stateChange`,async(e,t)=>{const r=(0,yt.diffMap)(e,t);for(const[e,t]of r.entries())this._notifyAccountsChange(e,t)},yt.getPermittedAccountsByOrigin),this.controllerMessenger.subscribe(`${this.permissionController.name}:stateChange`,async(e,t)=>{const r=(0,yt.getChangedAuthorizations)(e,t),n=(0,yt.getRemovedAuthorizations)(e,t);for(const[e,t]of n.entries()){const r=(0,te.getSessionScopes)(t,{getNonEvmSupportedMethods:this.getNonEvmSupportedMethods.bind(this)});Object.entries(r).forEach(([t,r])=>{r.notifications.includes("eth_subscription")&&r.methods.includes("eth_subscribe")&&this.removeMultichainApiEthSubscriptionMiddleware({scope:t,origin:e})})}for(const[e,t]of r.entries()){const r=(0,te.getSessionScopes)(t,{getNonEvmSupportedMethods:this.getNonEvmSupportedMethods.bind(this)});Object.entries(r).forEach(([t,r])=>{r.notifications.includes("eth_subscription")&&r.methods.includes("eth_subscribe")?Object.values(this.connections[e]??{}).forEach(({tabId:r})=>{this.addMultichainApiEthSubscriptionMiddleware({scope:t,origin:e,tabId:r})}):this.removeMultichainApiEthSubscriptionMiddleware({scope:t,origin:e})}),this._notifyAuthorizationChange(e,t)}},yt.getAuthorizedScopesByOrigin),this.controllerMessenger.subscribe(`${this.permissionController.name}:stateChange`,async(e,t)=>{(0,u.uniq)([...t.keys(),...e.keys()]).forEach(r=>{var n,o;const s=t.get(r),a=e.get(r),i=Boolean(null==s||null===(n=s.sessionProperties)||void 0===n?void 0:n[te.KnownSessionProperties.SolanaAccountChangedNotifications]),l=Boolean(null==a||null===(o=a.sessionProperties)||void 0===o?void 0:o[te.KnownSessionProperties.SolanaAccountChangedNotifications]);if(!i&&!l)return;const c=(s?(0,te.getPermittedAccountsForScopes)(s,[_e.MultichainNetworks.SOLANA,_e.MultichainNetworks.SOLANA_DEVNET,_e.MultichainNetworks.SOLANA_TESTNET]):[]).map(e=>{const{address:t}=(0,Q.parseCaipAccountId)(e);return t}),d=(0,u.uniq)(c),[h]=this.sortMultichainAccountsByLastSelected(d),p=(a?(0,te.getPermittedAccountsForScopes)(a,[_e.MultichainNetworks.SOLANA,_e.MultichainNetworks.SOLANA_DEVNET,_e.MultichainNetworks.SOLANA_TESTNET]):[]).map(e=>{const{address:t}=(0,Q.parseCaipAccountId)(e);return t}),m=(0,u.uniq)(p),[f]=this.sortMultichainAccountsByLastSelected(m);h!==f&&this._notifySolanaAccountChange(r,f?[f]:[])})},yt.getAuthorizedScopesByOrigin),this.controllerMessenger.subscribe(`${this.accountsController.name}:selectedAccountChange`,async e=>{if(e.type===Y.SolAccountType.DataAccount&&e.address!==t){t=e.address;const r=(0,yt.getOriginsWithSessionProperty)(this.permissionController.state,te.KnownSessionProperties.SolanaAccountChangedNotifications),n=(0,yt.getPermittedAccountsForScopesByOrigin)(this.permissionController.state,[_e.MultichainNetworks.SOLANA,_e.MultichainNetworks.SOLANA_DEVNET,_e.MultichainNetworks.SOLANA_TESTNET]);if(n.size>0)for(const[t,o]of n.entries()){o.map(e=>{const{address:t}=(0,Q.parseCaipAccountId)(e);return t}).includes(e.address)&&r[t]&&this._notifySolanaAccountChange(t,[e.address])}}}),this.controllerMessenger.subscribe(`${this.permissionController.name}:stateChange`,async(e,t)=>{const r=(0,yt.diffMap)(e,t);for(const[e,t]of r.entries()){const r=this.selectedNetworkController.getNetworkClientIdForDomain(e),n=this.networkController.getNetworkConfigurationByNetworkClientId(r);if(!n){v.default.warn(`No network configuration found for clientId: ${r}`);continue}const{chainId:o}=n;if(t.length>0&&!t.includes(o)){const r=this.networkController.findNetworkClientIdByChainId(t[0]);this.networkController.setActiveNetwork(r),this.selectedNetworkController.setNetworkClientIdForDomain(e,r)}}},yt.getPermittedChainsByOrigin),this.controllerMessenger.subscribe("NetworkController:networkRemoved",({chainId:e})=>{const t=(0,Q.toCaipChainId)("eip155",(0,Q.hexToBigInt)(e).toString(10));this.removeAllScopePermissions(t)}),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstallStarted`,(e,t,r)=>{var n;const o=null===(n=this._getSnapMetadata(e))||void 0===n?void 0:n.category;this.metaMetricsController.trackEvent({event:r?fe.MetaMetricsEventName.SnapUpdateStarted:fe.MetaMetricsEventName.SnapInstallStarted,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,origin:t,snap_category:o}})}),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstallFailed`,(e,t,r,n)=>{var o;const s=n.includes("User rejected the request."),a=r?fe.MetaMetricsEventName.SnapUpdateFailed:fe.MetaMetricsEventName.SnapInstallFailed,i=r?fe.MetaMetricsEventName.SnapUpdateRejected:fe.MetaMetricsEventName.SnapInstallRejected,l=null===(o=this._getSnapMetadata(e))||void 0===o?void 0:o.category;this.metaMetricsController.trackEvent({event:s?i:a,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,origin:t,snap_category:l}})}),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstalled`,(e,t,r)=>{var n;if(r)return;const o=e.id,s=null===(n=this._getSnapMetadata(o))||void 0===n?void 0:n.category;this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.SnapInstalled,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:o,version:e.version,origin:t,snap_category:s}})}),this.controllerMessenger.subscribe(`${this.snapController.name}:snapUpdated`,(e,t,r,n)=>{var o;if(n)return;const s=e.id,a=null===(o=this._getSnapMetadata(s))||void 0===o?void 0:o.category;this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.SnapUpdated,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:s,old_version:t,new_version:e.version,origin:r,snap_category:a}})}),this.controllerMessenger.subscribe(`${this.snapController.name}:snapTerminated`,e=>{const t=Object.values(this.approvalController.state.pendingApprovals).filter(t=>t.origin===e.id&&t.type.startsWith(ue.RestrictedMethods.snap_dialog));for(const e of t)this.approvalController.reject(e.id,new Error("Snap was terminated."))}),this.controllerMessenger.subscribe(`${this.snapController.name}:snapUninstalled`,e=>{var t;const r=this.notificationServicesController.getNotificationsByType(Z.TRIGGER_TYPES.SNAP).filter(t=>t.data.origin===e.id).map(e=>e.id);this.notificationServicesController.deleteNotificationsById(r);const n=e.id,o=null===(t=this._getSnapMetadata(n))||void 0===t?void 0:t.category;this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.SnapUninstalled,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:n,version:e.version,snap_category:o}})})}setupMultichainDataAndSubscriptions(){this.controllerMessenger.subscribe("AccountsController:selectedAccountChange",e=>{0===this.activeControllerConnections||(0,Y.isEvmAccountType)(e.type)?this.multichainRatesController.stop():this.multichainRatesController.start()}),this.controllerMessenger.subscribe("CurrencyRateController:stateChange",({currentCurrency:e})=>{e!==this.multichainRatesController.state.fiatCurrency&&this.multichainRatesController.setFiatCurrency(e)})}addMultichainApiEthSubscriptionMiddleware({scope:e,origin:t,tabId:r}){const n=this.multichainSubscriptionManager.subscribe({scope:e,origin:t,tabId:r});this.multichainMiddlewareManager.addMiddleware({scope:e,origin:t,tabId:r,middleware:n.middleware})}removeMultichainApiEthSubscriptionMiddleware({scope:e,origin:t}){this.multichainMiddlewareManager.removeMiddlewareByScopeAndOrigin(e,t),this.multichainSubscriptionManager.unsubscribeByScopeAndOrigin(e,t)}createPublicConfigStore(){const e=new l.ObservableStore,t=async({isUnlocked:e})=>{const{chainId:t,networkVersion:r,isConnected:n}=await this.getProviderNetworkState();return{isUnlocked:e,chainId:t,networkVersion:n?r:"loading"}},r=async r=>{var n;(null===(n=r.networksMetadata[r.selectedNetworkClientId])||void 0===n?void 0:n.status)===le.NetworkStatus.Available&&e.putState(await t(r))};return this.on("update",r),r(this.getState()),e}async getProviderState(e,{isInitializingStreamProvider:t=!1}={}){const r=await this.getProviderNetworkState({origin:e,isInitializingStreamProvider:t}),n={};if(Se.isManifestV3){var o;const{chrome:e}=globalThis;n.extensionId=null==e||null===(o=e.runtime)||void 0===o?void 0:o.id}return{isUnlocked:!0,accounts:this.getPermittedAccounts(e),...n,...r}}async getProviderNetworkState({origin:e=N.METAMASK_DOMAIN,isInitializingStreamProvider:t=!1}={}){const r=this.controllerMessenger.call("SelectedNetworkController:getNetworkClientIdForDomain",e),n=this.controllerMessenger.call("NetworkController:getNetworkClientById",r),{chainId:o}=n.configuration,{completedOnboarding:s}=this.onboardingController.state;let a=this.deprecatedNetworkVersions[r];if(a===undefined&&s&&!t){try{const e=await n.provider.request({method:"net_version"});a=(0,Pe.convertNetworkId)(e)}catch(e){console.error(e),a=null}this.deprecatedNetworkVersions[r]=a}const i=this.networkController.state.networksMetadata[r];return{chainId:o,networkVersion:a??"loading",isConnected:(null==i?void 0:i.status)===le.NetworkStatus.Available}}getState(){const{vault:e}=this.keyringController.state,t=Boolean(e),r=this.memStore.getFlatState();return{isInitialized:t,...(0,Lt.sanitizeUIState)(r)}}getApi(){const{accountsController:e,addressBookController:t,alertController:r,appStateController:n,nftController:o,nftDetectionController:s,currencyRateController:a,tokenBalancesController:i,tokenDetectionController:l,ensController:c,tokenListController:d,gasFeeController:u,gatorPermissionsController:h,metaMetricsController:p,networkController:m,multichainNetworkController:f,announcementController:g,onboardingController:v,permissionController:y,preferencesController:C,tokensController:b,smartTransactionsController:w,txController:k,backup:S,approvalController:P,phishingController:T,tokenRatesController:M,accountTrackerController:E,authenticationController:A,userStorageController:O,notificationServicesController:j,notificationServicesPushController:_,deFiPositionsController:I,multichainAssetsRatesController:N}=this;return{getState:this.getState.bind(this),setCurrentCurrency:a.setCurrentCurrency.bind(a),setUseBlockie:C.setUseBlockie.bind(C),setAvatarType:e=>C.setPreference("avatarType",e),setUsePhishDetect:C.setUsePhishDetect.bind(C),setUseMultiAccountBalanceChecker:C.setUseMultiAccountBalanceChecker.bind(C),setUseSafeChainsListValidation:C.setUseSafeChainsListValidation.bind(C),setUseTokenDetection:C.setUseTokenDetection.bind(C),setUseNftDetection:C.setUseNftDetection.bind(C),setUse4ByteResolution:C.setUse4ByteResolution.bind(C),setUseCurrencyRateCheck:C.setUseCurrencyRateCheck.bind(C),setOpenSeaEnabled:C.setOpenSeaEnabled.bind(C),getProviderConfig:()=>(0,Ee.getProviderConfig)({metamask:this.networkController.state}),grantPermissionsIncremental:this.permissionController.grantPermissionsIncremental.bind(this.permissionController),grantPermissions:this.permissionController.grantPermissions.bind(this.permissionController),setSecurityAlertsEnabled:C.setSecurityAlertsEnabled.bind(C),setAddSnapAccountEnabled:C.setAddSnapAccountEnabled.bind(C),setUseExternalNameSources:C.setUseExternalNameSources.bind(C),setUseTransactionSimulations:C.setUseTransactionSimulations.bind(C),setIpfsGateway:C.setIpfsGateway.bind(C),setIsIpfsGatewayEnabled:C.setIsIpfsGatewayEnabled.bind(C),setUseAddressBarEnsResolution:C.setUseAddressBarEnsResolution.bind(C),setParticipateInMetaMetrics:p.setParticipateInMetaMetrics.bind(p),setDataCollectionForMarketing:p.setDataCollectionForMarketing.bind(p),setMarketingCampaignCookieId:p.setMarketingCampaignCookieId.bind(p),setCurrentLocale:C.setCurrentLocale.bind(C),setServiceWorkerKeepAlivePreference:C.setServiceWorkerKeepAlivePreference.bind(C),markPasswordForgotten:this.markPasswordForgotten.bind(this),unMarkPasswordForgotten:this.unMarkPasswordForgotten.bind(this),getRequestAccountTabIds:this.getRequestAccountTabIds,getOpenMetamaskTabsIds:this.getOpenMetamaskTabsIds,markNotificationPopupAsAutomaticallyClosed:()=>this.notificationManager.markAsAutomaticallyClosed(),getCode:this.getCode.bind(this),addNewAccount:this.addNewAccount.bind(this),getSeedPhrase:this.getSeedPhrase.bind(this),resetAccount:this.resetAccount.bind(this),removeAccount:this.removeAccount.bind(this),importAccountWithStrategy:this.importAccountWithStrategy.bind(this),getNextAvailableAccountName:e.getNextAvailableAccountName.bind(e),getAccountsBySnapId:e=>(0,Pt.getAccountsBySnapId)(this.getSnapKeyring.bind(this),e),checkIsSeedlessPasswordOutdated:this.checkIsSeedlessPasswordOutdated.bind(this),syncPasswordAndUnlockWallet:this.syncPasswordAndUnlockWallet.bind(this),connectHardware:this.connectHardware.bind(this),forgetDevice:this.forgetDevice.bind(this),checkHardwareStatus:this.checkHardwareStatus.bind(this),unlockHardwareWalletAccount:this.unlockHardwareWalletAccount.bind(this),attemptLedgerTransportCreation:this.attemptLedgerTransportCreation.bind(this),completeQrCodeScan:n.completeQrCodeScan.bind(n),cancelQrCodeScan:n.cancelQrCodeScan.bind(n),submitPassword:this.submitPassword.bind(this),verifyPassword:this.verifyPassword.bind(this),setActiveNetwork:async e=>await this.multichainNetworkController.setActiveNetwork(e),findNetworkClientIdByChainId:this.networkController.findNetworkClientIdByChainId.bind(this.networkController),getNetworksWithTransactionActivityByAccounts:this.multichainNetworkController.getNetworksWithTransactionActivityByAccounts.bind(this.multichainNetworkController),setActiveNetworkConfigurationId:e=>{this.networkController.setActiveNetwork(e)},setNetworkClientIdForDomain:(e,t)=>this.selectedNetworkController.setNetworkClientIdForDomain(e,t),rollbackToPreviousProvider:m.rollbackToPreviousProvider.bind(m),addNetwork:this.networkController.addNetwork.bind(this.networkController),updateNetwork:this.networkController.updateNetwork.bind(this.networkController),removeNetwork:this.multichainNetworkController.removeNetwork.bind(this.multichainNetworkController),getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getNetworkConfigurationByNetworkClientId:this.networkController.getNetworkConfigurationByNetworkClientId.bind(this.networkController),setSelectedAddress:e=>{const t=this.accountsController.getAccountByAddress(e);if(!t)throw new Error(`No account found for address: ${e}`);this.accountsController.setSelectedAccount(t.id)},toggleExternalServices:this.toggleExternalServices.bind(this),addToken:b.addToken.bind(b),updateTokenType:b.updateTokenType.bind(b),setFeatureFlag:C.setFeatureFlag.bind(C),setPreference:C.setPreference.bind(C),addKnownMethodData:C.addKnownMethodData.bind(C),setDismissSeedBackUpReminder:C.setDismissSeedBackUpReminder.bind(C),setOverrideContentSecurityPolicyHeader:C.setOverrideContentSecurityPolicyHeader.bind(C),setAdvancedGasFee:C.setAdvancedGasFee.bind(C),setTheme:C.setTheme.bind(C),setSnapsAddSnapAccountModalDismissed:C.setSnapsAddSnapAccountModalDismissed.bind(C),setManageInstitutionalWallets:C.setManageInstitutionalWallets.bind(C),setSelectedInternalAccount:e=>{this.accountsController.getAccount(e)&&this.accountsController.setSelectedAccount(e)},setAccountName:e.setAccountName.bind(e),setAccountLabel:(e,t)=>{const r=this.accountsController.getAccountByAddress(e);if(r===undefined)throw new Error(`No account found for address: ${e}`);this.accountsController.setAccountName(r.id,t)},setSelectedMultichainAccount:e=>{this.accountTreeController.setSelectedAccountGroup(e)},setAccountGroupName:(e,t)=>{this.accountTreeController.setAccountGroupName(e,t)},createNextMultichainAccountGroup:async e=>{await this.multichainAccountService.createNextMultichainAccountGroup({entropySource:e})},getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),getTokenSymbol:this.getTokenSymbol.bind(this),getTokenStandardAndDetailsByChain:this.getTokenStandardAndDetailsByChain.bind(this),getERC1155BalanceOf:this.assetsContractController.getERC1155BalanceOf.bind(this.assetsContractController),getERC721AssetSymbol:this.assetsContractController.getERC721AssetSymbol.bind(this.assetsContractController),addNft:o.addNft.bind(o),addNftVerifyOwnership:o.addNftVerifyOwnership.bind(o),removeAndIgnoreNft:o.removeAndIgnoreNft.bind(o),removeNft:o.removeNft.bind(o),checkAndUpdateAllNftsOwnershipStatus:o.checkAndUpdateAllNftsOwnershipStatus.bind(o),checkAndUpdateSingleNftOwnershipStatus:o.checkAndUpdateSingleNftOwnershipStatus.bind(o),getNFTContractInfo:o.getNFTContractInfo.bind(o),isNftOwner:o.isNftOwner.bind(o),updateIncomingTransactions:k.updateIncomingTransactions.bind(k),setAddressBook:t.set.bind(t),removeFromAddressBook:t.delete.bind(t),setLastActiveTime:n.setLastActiveTime.bind(n),setCurrentExtensionPopupId:n.setCurrentExtensionPopupId.bind(n),setDefaultHomeActiveTabName:n.setDefaultHomeActiveTabName.bind(n),setConnectedStatusPopoverHasBeenShown:n.setConnectedStatusPopoverHasBeenShown.bind(n),setRecoveryPhraseReminderHasBeenShown:n.setRecoveryPhraseReminderHasBeenShown.bind(n),setRecoveryPhraseReminderLastShown:n.setRecoveryPhraseReminderLastShown.bind(n),setTermsOfUseLastAgreed:n.setTermsOfUseLastAgreed.bind(n),setSurveyLinkLastClickedOrClosed:n.setSurveyLinkLastClickedOrClosed.bind(n),setOnboardingDate:n.setOnboardingDate.bind(n),setLastViewedUserSurvey:n.setLastViewedUserSurvey.bind(n),setRampCardClosed:n.setRampCardClosed.bind(n),setNewPrivacyPolicyToastClickedOrClosed:n.setNewPrivacyPolicyToastClickedOrClosed.bind(n),setNewPrivacyPolicyToastShownDate:n.setNewPrivacyPolicyToastShownDate.bind(n),setSnapsInstallPrivacyWarningShownStatus:n.setSnapsInstallPrivacyWarningShownStatus.bind(n),setOutdatedBrowserWarningLastShown:n.setOutdatedBrowserWarningLastShown.bind(n),setIsUpdateAvailable:n.setIsUpdateAvailable.bind(n),setUpdateModalLastDismissedAt:n.setUpdateModalLastDismissedAt.bind(n),setLastUpdatedAt:n.setLastUpdatedAt.bind(n),setShowTestnetMessageInDropdown:n.setShowTestnetMessageInDropdown.bind(n),setShowBetaHeader:n.setShowBetaHeader.bind(n),setShowPermissionsTour:n.setShowPermissionsTour.bind(n),setShowAccountBanner:n.setShowAccountBanner.bind(n),setProductTour:n.setProductTour.bind(n),setShowNetworkBanner:n.setShowNetworkBanner.bind(n),updateNftDropDownState:n.updateNftDropDownState.bind(n),getLastInteractedConfirmationInfo:n.getLastInteractedConfirmationInfo.bind(n),setLastInteractedConfirmationInfo:n.setLastInteractedConfirmationInfo.bind(n),updateSlides:n.updateSlides.bind(n),removeSlide:n.removeSlide.bind(n),setEnableEnforcedSimulations:n.setEnableEnforcedSimulations.bind(n),setEnableEnforcedSimulationsForTransaction:n.setEnableEnforcedSimulationsForTransaction.bind(n),setEnforcedSimulationsSlippageForTransaction:n.setEnforcedSimulationsSlippageForTransaction.bind(n),tryReverseResolveAddress:c.reverseResolveAddress.bind(c),startOAuthLogin:this.oauthService.startOAuthLogin.bind(this.oauthService),setMarketingConsent:this.oauthService.setMarketingConsent.bind(this.oauthService),getMarketingConsent:this.oauthService.getMarketingConsent.bind(this.oauthService),authenticate:this.seedlessOnboardingController.authenticate.bind(this.seedlessOnboardingController),resetOAuthLoginState:this.seedlessOnboardingController.clearState.bind(this.seedlessOnboardingController),createSeedPhraseBackup:this.createSeedPhraseBackup.bind(this),storeKeyringEncryptionKey:this.seedlessOnboardingController.storeKeyringEncryptionKey.bind(this.seedlessOnboardingController),restoreSocialBackupAndGetSeedPhrase:this.restoreSocialBackupAndGetSeedPhrase.bind(this),syncSeedPhrases:this.syncSeedPhrases.bind(this),changePassword:this.changePassword.bind(this),fetchAndUpdateGatorPermissions:h.fetchAndUpdateGatorPermissions.bind(h),setLocked:this.setLocked.bind(this),createNewVaultAndKeychain:this.createNewVaultAndKeychain.bind(this),createNewVaultAndRestore:this.createNewVaultAndRestore.bind(this),generateNewMnemonicAndAddToVault:this.generateNewMnemonicAndAddToVault.bind(this),importMnemonicToVault:this.importMnemonicToVault.bind(this),exportAccount:this.exportAccount.bind(this),updateTransaction:k.updateTransaction.bind(k),approveTransactionsWithSameNonce:k.approveTransactionsWithSameNonce.bind(k),createCancelTransaction:this.createCancelTransaction.bind(this),createSpeedUpTransaction:this.createSpeedUpTransaction.bind(this),estimateGas:this.estimateGas.bind(this),estimateGasFee:k.estimateGasFee.bind(k),getNextNonce:this.getNextNonce.bind(this),addTransaction:(e,t)=>(0,Mt.addTransaction)(this.getAddTransactionRequest({transactionParams:e,transactionOptions:t,waitForSubmit:!1})),addTransactionAndWaitForPublish:(e,t)=>(0,Mt.addTransaction)(this.getAddTransactionRequest({transactionParams:e,transactionOptions:t,waitForSubmit:!0})),createTransactionEventFragment:Be.createTransactionEventFragmentWithTxId.bind(null,this.getTransactionMetricsRequest()),setTransactionActive:k.setTransactionActive.bind(k),decryptMessage:this.decryptMessageController.decryptMessage.bind(this.decryptMessageController),decryptMessageInline:this.decryptMessageController.decryptMessageInline.bind(this.decryptMessageController),cancelDecryptMessage:this.decryptMessageController.cancelDecryptMessage.bind(this.decryptMessageController),encryptionPublicKey:this.encryptionPublicKeyController.encryptionPublicKey.bind(this.encryptionPublicKeyController),cancelEncryptionPublicKey:this.encryptionPublicKeyController.cancelEncryptionPublicKey.bind(this.encryptionPublicKeyController),setSeedPhraseBackedUp:v.setSeedPhraseBackedUp.bind(v),completeOnboarding:v.completeOnboarding.bind(v),setFirstTimeFlowType:v.setFirstTimeFlowType.bind(v),setAlertEnabledness:r.setAlertEnabledness.bind(r),setUnconnectedAccountAlertShown:r.setUnconnectedAccountAlertShown.bind(r),setWeb3ShimUsageAlertDismissed:r.setWeb3ShimUsageAlertDismissed.bind(r),removePermissionsFor:this.removePermissionsFor,approvePermissionsRequest:this.acceptPermissionsRequest,rejectPermissionsRequest:this.rejectPermissionsRequest,...(0,yt.getPermissionBackgroundApiMethods)({permissionController:y,approvalController:P,accountsController:e,networkController:m,multichainNetworkController:f}),disableSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:disable"),enableSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:enable"),updateSnap:(e,t)=>(this.controllerMessenger.call("SnapController:install",e,t),null),removeSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:remove"),handleSnapRequest:this.handleSnapRequest.bind(this),revokeDynamicSnapPermissions:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:revokeDynamicPermissions"),disconnectOriginFromSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:disconnectOrigin"),updateNetworksList:this.updateNetworksList.bind(this),updateAccountsList:this.updateAccountsList.bind(this),setEnabledNetworks:this.setEnabledNetworks.bind(this),setEnabledNetworksMultichain:this.setEnabledNetworksMultichain.bind(this),updateHiddenAccountsList:this.updateHiddenAccountsList.bind(this),getPhishingResult:async e=>(await T.maybeUpdateState(),T.test(e)),deleteInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:deleteInterface"),updateInterfaceState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:updateInterfaceState"),fetchAndSetQuotes:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:fetchAndSetQuotes"),setSelectedQuoteAggId:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSelectedQuoteAggId"),resetSwapsState:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:resetSwapsState"),setSwapsTokens:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsTokens"),clearSwapsQuotes:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:clearSwapsQuotes"),setApproveTxId:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setApproveTxId"),setTradeTxId:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setTradeTxId"),setSwapsTxGasPrice:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsTxGasPrice"),setSwapsTxGasLimit:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsTxGasLimit"),setSwapsTxMaxFeePerGas:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsTxMaxFeePerGas"),setSwapsTxMaxFeePriorityPerGas:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsTxMaxFeePriorityPerGas"),safeRefetchQuotes:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:safeRefetchQuotes"),stopPollingForQuotes:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:stopPollingForQuotes"),setBackgroundSwapRouteState:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setBackgroundSwapRouteState"),resetPostFetchState:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:resetPostFetchState"),setSwapsErrorKey:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsErrorKey"),setInitialGasEstimate:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setInitialGasEstimate"),setCustomApproveTxData:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setCustomApproveTxData"),setSwapsLiveness:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsLiveness"),setSwapsFeatureFlags:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsFeatureFlags"),setSwapsUserFeeLevel:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsUserFeeLevel"),setSwapsQuotesPollingLimitEnabled:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsQuotesPollingLimitEnabled"),[V.BridgeBackgroundAction.RESET_STATE]:this.controllerMessenger.call.bind(this.controllerMessenger,`${V.BRIDGE_CONTROLLER_NAME}:${V.BridgeBackgroundAction.RESET_STATE}`),[V.BridgeUserAction.UPDATE_QUOTE_PARAMS]:this.controllerMessenger.call.bind(this.controllerMessenger,`${V.BRIDGE_CONTROLLER_NAME}:${V.BridgeUserAction.UPDATE_QUOTE_PARAMS}`),[V.BridgeBackgroundAction.TRACK_METAMETRICS_EVENT]:this.controllerMessenger.call.bind(this.controllerMessenger,`${V.BRIDGE_CONTROLLER_NAME}:${V.BridgeBackgroundAction.TRACK_METAMETRICS_EVENT}`),[re.BridgeStatusAction.SUBMIT_TX]:this.controllerMessenger.call.bind(this.controllerMessenger,`${re.BRIDGE_STATUS_CONTROLLER_NAME}:${re.BridgeStatusAction.SUBMIT_TX}`),fetchSmartTransactionFees:w.getFees.bind(w),clearSmartTransactionFees:w.clearFees.bind(w),submitSignedTransactions:w.submitSignedTransactions.bind(w),cancelSmartTransaction:w.cancelSmartTransaction.bind(w),fetchSmartTransactionsLiveness:w.fetchLiveness.bind(w),updateSmartTransaction:w.updateSmartTransaction.bind(w),setStatusRefreshInterval:w.setStatusRefreshInterval.bind(w),trackMetaMetricsEvent:p.trackEvent.bind(p),trackMetaMetricsPage:p.trackPage.bind(p),createEventFragment:p.createEventFragment.bind(p),updateEventFragment:p.updateEventFragment.bind(p),finalizeEventFragment:p.finalizeEventFragment.bind(p),trackInsightSnapView:this.trackInsightSnapView.bind(this),addEventBeforeMetricsOptIn:p.addEventBeforeMetricsOptIn.bind(p),bufferedTrace:p.bufferedTrace.bind(p),bufferedEndTrace:p.bufferedEndTrace.bind(p),rejectAllPendingApprovals:this.rejectAllPendingApprovals.bind(this),rejectPendingApproval:this.rejectPendingApproval,requestUserApproval:P.addAndShowApprovalRequest.bind(P),resolvePendingApproval:this.resolvePendingApproval,resetViewedNotifications:g.resetViewed.bind(g),updateViewedNotifications:g.updateViewed.bind(g),currencyRateStartPolling:a.startPolling.bind(a),currencyRateStopPollingByPollingToken:a.stopPollingByPollingToken.bind(a),multichainAssetsRatesStartPolling:N.startPolling.bind(N),multichainAssetsRatesStopPollingByPollingToken:N.stopPollingByPollingToken.bind(N),tokenRatesStartPolling:M.startPolling.bind(M),tokenRatesStopPollingByPollingToken:M.stopPollingByPollingToken.bind(M),accountTrackerStartPolling:E.startPollingByNetworkClientId.bind(E),accountTrackerStopPollingByPollingToken:E.stopPollingByPollingToken.bind(E),tokenDetectionStartPolling:l.startPolling.bind(l),tokenDetectionStopPollingByPollingToken:l.stopPollingByPollingToken.bind(l),tokenListStartPolling:d.startPolling.bind(d),tokenListStopPollingByPollingToken:d.stopPollingByPollingToken.bind(d),tokenBalancesStartPolling:i.startPolling.bind(i),tokenBalancesStopPollingByPollingToken:i.stopPollingByPollingToken.bind(i),deFiStartPolling:I.startPolling.bind(I),deFiStopPolling:I.stopPollingByPollingToken.bind(I),gasFeeStartPolling:u.startPolling.bind(u),gasFeeStopPollingByPollingToken:u.stopPollingByPollingToken.bind(u),getGasFeeTimeEstimate:u.getTimeEstimate.bind(u),addPollingTokenToAppState:n.addPollingToken.bind(n),removePollingTokenFromAppState:n.removePollingToken.bind(n),updateThrottledOriginState:n.updateThrottledOriginState.bind(n),backupUserData:S.backupUserData.bind(S),restoreUserData:S.restoreUserData.bind(S),detectTokens:l.detectTokens.bind(l),fetchHistoricalPricesForAsset:(...e)=>this.multichainAssetsRatesController.fetchHistoricalPricesForAsset(...e),detectNfts:s.detectNfts.bind(s),addDetectedTokens:b.addDetectedTokens.bind(b),addImportedTokens:b.addTokens.bind(b),ignoreTokens:b.ignoreTokens.bind(b),getBalancesInSingleCall:(...e)=>this.assetsContractController.getBalancesInSingleCall(...e),performSignIn:A.performSignIn.bind(A),performSignOut:A.performSignOut.bind(A),getUserProfileLineage:A.getUserProfileLineage.bind(A),setIsBackupAndSyncFeatureEnabled:O.setIsBackupAndSyncFeatureEnabled.bind(O),syncInternalAccountsWithUserStorage:O.syncInternalAccountsWithUserStorage.bind(O),setHasAccountSyncingSyncedAtLeastOnce:O.setHasAccountSyncingSyncedAtLeastOnce.bind(O),setIsAccountSyncingReadyToBeDispatched:O.setIsAccountSyncingReadyToBeDispatched.bind(O),deleteAccountSyncingDataFromUserStorage:O.performDeleteStorageAllFeatureEntries.bind(O),syncContactsWithUserStorage:O.syncContactsWithUserStorage.bind(O),checkAccountsPresence:j.checkAccountsPresence.bind(j),createOnChainTriggers:j.createOnChainTriggers.bind(j),disableAccounts:j.disableAccounts.bind(j),enableAccounts:j.enableAccounts.bind(j),fetchAndUpdateMetamaskNotifications:j.fetchAndUpdateMetamaskNotifications.bind(j),deleteNotificationsById:j.deleteNotificationsById.bind(j),getNotificationsByType:j.getNotificationsByType.bind(j),markMetamaskNotificationsAsRead:j.markMetamaskNotificationsAsRead.bind(j),setFeatureAnnouncementsEnabled:j.setFeatureAnnouncementsEnabled.bind(j),enablePushNotifications:_.enablePushNotifications.bind(_),disablePushNotifications:_.disablePushNotifications.bind(_),enableMetamaskNotifications:j.enableMetamaskNotifications.bind(j),disableMetamaskNotifications:j.disableNotificationServices.bind(j),throwTestError:this.throwTestError.bind(this),captureTestError:this.captureTestError.bind(this),updateProposedNames:this.nameController.updateProposedNames.bind(this.nameController),setName:this.nameController.setName.bind(this.nameController),createSnapAccount:async(e,t,r)=>{const n=await this.getSnapKeyring();return await n.createAccount(e,t,r)},multichainUpdateBalance:e=>this.multichainBalancesController.updateBalance(e),multichainUpdateTransactions:e=>this.multichainTransactionsController.updateTransactionsForAccount(e),decodeTransactionData:e=>(0,Rt.decodeTransactionData)({...e,provider:this.provider}),createMetaMetricsDataDeletionTask:this.metaMetricsDataDeletionController.createMetaMetricsDataDeletionTask.bind(this.metaMetricsDataDeletionController),updateDataDeletionTaskStatus:this.metaMetricsDataDeletionController.updateDataDeletionTaskStatus.bind(this.metaMetricsDataDeletionController),endTrace:Ae.endTrace,isRelaySupported:rr.isRelaySupported,isSendBundleSupported:cr.isSendBundleSupported,openUpdateTabAndReload:()=>(0,nr.openUpdateTabAndReload)(this.requestSafeReload.bind(this)),requestSafeReload:this.requestSafeReload.bind(this),applyTransactionContainersExisting:(e,t)=>(0,lr.applyTransactionContainersExisting)({containerTypes:t,messenger:this.controllerMessenger,transactionId:e,updateEditableParams:this.txController.updateEditableParams.bind(this.txController)})}}rejectOriginPendingApprovals(e){(0,$t.rejectOriginApprovals)({approvalController:this.approvalController,deleteInterface:e=>this.controllerMessenger.call("SnapInterfaceController:deleteInterface",e),origin:e})}async exportAccount(e,t){return await this.verifyPassword(t),this.keyringController.exportAccount(t,e)}async getTokenStandardAndDetails(e,t,r){var n,o,s,a;const i=wr(Mr,this,Or).call(this),{tokensChainsCache:l}=this.tokenListController.state,c=(null==l||null===(n=l[i])||void 0===n?void 0:n.data)||{},{allTokens:d}=this.tokensController.state,u=(null==d||null===(o=d[i])||void 0===o?void 0:o[t])||[],h={...we.STATIC_MAINNET_TOKEN_LIST[null==e?void 0:e.toLowerCase()]||{},...c[null==e?void 0:e.toLowerCase()]||{},...u.find(({address:t})=>(0,Ce.isEqualCaseInsensitive)(t,e))||{}},p=(0,Ce.isEqualCaseInsensitive)(h.standard,ae.TokenStandard.ERC20)||!0===h.erc20,m=!(r||(0,Ce.isEqualCaseInsensitive)(h.standard,ae.TokenStandard.ERC1155)||(0,Ce.isEqualCaseInsensitive)(h.standard,ae.TokenStandard.ERC721)||h.erc721),f=h.decimals!==undefined&&h.symbol;let g;if(p||m&&f)try{const r=t?await(0,ye.fetchTokenBalance)(e,t,this.provider):undefined;g={address:e,balance:r,standard:ae.TokenStandard.ERC20,decimals:h.decimals,symbol:h.symbol}}catch(e){v.default.warn(`Failed to get token balance. Error: ${e}`)}if(g===undefined)try{g=await this.assetsContractController.getTokenStandardAndDetails(e,t,r)}catch(e){v.default.warn(`Failed to get token standard and details. Error: ${e}`)}if(g){if((0,Ce.isEqualCaseInsensitive)(g.standard,ae.TokenStandard.ERC1155))try{const n=await(0,ye.fetchERC1155Balance)(e,t,r,this.provider),o=null!=n&&n._hex?parseInt(n._hex,16).toString():null;g={...g,balance:o}}catch(e){v.default.warn("Failed to get token balance. Error:",e)}}return{...g,decimals:null===(s=g)||void 0===s||null===(s=s.decimals)||void 0===s?void 0:s.toString(10),balance:null===(a=g)||void 0===a||null===(a=a.balance)||void 0===a?void 0:a.toString(10)}}async getTokenStandardAndDetailsByChain(e,t,r,n){var o,s,a,i;const{tokensChainsCache:l}=this.tokenListController.state,c=(null==l||null===(o=l[n])||void 0===o?void 0:o.data)||{},{allTokens:d}=this.tokensController.state,u=this.accountsController.getSelectedAccount(),h=(null==d||null===(s=d[n])||void 0===s?void 0:s[u.address])||[];let p={};n===le.CHAIN_IDS.MAINNET&&(p=we.STATIC_MAINNET_TOKEN_LIST[null==e?void 0:e.toLowerCase()]||{});const m=c[null==e?void 0:e.toLowerCase()]||{},f=h.find(({address:t})=>(0,Ce.isEqualCaseInsensitive)(t,e))||{},g={...p,...m,...f},y=(0,Ce.isEqualCaseInsensitive)(g.standard,ae.TokenStandard.ERC20)||!0===g.erc20,C=!(r||(0,Ce.isEqualCaseInsensitive)(g.standard,ae.TokenStandard.ERC1155)||(0,Ce.isEqualCaseInsensitive)(g.standard,ae.TokenStandard.ERC721)||g.erc721),b=g.decimals!==undefined&&g.symbol;let w;if(y||C&&b)try{let r=0;wr(Mr,this,Or).call(this)===n&&(r=await(0,ye.fetchTokenBalance)(e,t,this.provider)),w={address:e,balance:r,standard:ae.TokenStandard.ERC20,decimals:g.decimals,symbol:g.symbol}}catch(e){v.default.warn(`Failed to get token balance. Error: ${e}`)}if(w===undefined)try{var k,S;const o=null===(k=this.networkController)||void 0===k||null===(k=k.state)||void 0===k||null===(k=k.networkConfigurationsByChainId)||void 0===k||null===(k=k[n])||void 0===k||null===(k=k.rpcEndpoints[null===(S=this.networkController)||void 0===S||null===(S=S.state)||void 0===S||null===(S=S.networkConfigurationsByChainId)||void 0===S||null===(S=S[n])||void 0===S?void 0:S.defaultRpcEndpointIndex])||void 0===k?void 0:k.networkClientId;w=await this.assetsContractController.getTokenStandardAndDetails(e,t,r,o)}catch(e){v.default.warn(`Failed to get token standard and details. Error: ${e}`)}if(w){if((0,Ce.isEqualCaseInsensitive)(w.standard,ae.TokenStandard.ERC1155))try{const n=await(0,ye.fetchERC1155Balance)(e,t,r,this.provider),o=null!=n&&n._hex?parseInt(n._hex,16).toString():null;w={...w,balance:o}}catch(e){v.default.warn("Failed to get token balance. Error:",e)}}return{...w,decimals:null===(a=w)||void 0===a||null===(a=a.decimals)||void 0===a?void 0:a.toString(10),balance:null===(i=w)||void 0===i||null===(i=i.balance)||void 0===i?void 0:i.toString(10)}}async getTokenSymbol(e){try{const t=await this.assetsContractController.getTokenStandardAndDetails(e);return null==t?void 0:t.symbol}catch(e){return null}}async createSeedPhraseBackup(e,r,n){let o=!1;try{var s,a;null===(s=(a=this.metaMetricsController).bufferedTrace)||void 0===s||s.call(a,{name:Ae.TraceName.OnboardingCreateKeyAndBackupSrp,op:Ae.TraceOperation.OnboardingSecurityOp});const i=t.from(r),l=this._convertMnemonicToWordlistIndices(i);await this.seedlessOnboardingController.createToprfKeyAndBackupSeedPhrase(e,l,n),o=!0,await this.syncKeyringEncryptionKey()}catch(e){var i,l,c,d;const t=e instanceof Error?e.message:"Unknown error";throw null===(i=(l=this.metaMetricsController).bufferedTrace)||void 0===i||i.call(l,{name:Ae.TraceName.OnboardingCreateKeyAndBackupSrpError,op:Ae.TraceOperation.OnboardingError,tags:{errorMessage:t}}),null===(c=(d=this.metaMetricsController).bufferedEndTrace)||void 0===c||c.call(d,{name:Ae.TraceName.OnboardingCreateKeyAndBackupSrpError}),v.default.error("[createSeedPhraseBackup] error",e),e}finally{var u,h;null===(u=(h=this.metaMetricsController).bufferedEndTrace)||void 0===u||u.call(h,{name:Ae.TraceName.OnboardingCreateKeyAndBackupSrp,data:{success:o}})}}async fetchAllSecretData(e){let t=!1;try{var r,n;null===(r=(n=this.metaMetricsController).bufferedTrace)||void 0===r||r.call(n,{name:Ae.TraceName.OnboardingFetchSrps,op:Ae.TraceOperation.OnboardingSecurityOp});const o=await this.seedlessOnboardingController.fetchAllSecretData(e);return t=!0,o}catch(e){var o,s,a,i;const t=e instanceof Error?e.message:"Unknown error";throw null===(o=(s=this.metaMetricsController).bufferedTrace)||void 0===o||o.call(s,{name:Ae.TraceName.OnboardingFetchSrpsError,op:Ae.TraceOperation.OnboardingError,tags:{errorMessage:t}}),null===(a=(i=this.metaMetricsController).bufferedEndTrace)||void 0===a||a.call(i,{name:Ae.TraceName.OnboardingFetchSrpsError}),e}finally{var l,c;null===(l=(c=this.metaMetricsController).bufferedEndTrace)||void 0===l||l.call(c,{name:Ae.TraceName.OnboardingFetchSrps,data:{success:t}})}}async syncPasswordAndUnlockWallet(e){let t=!1;const r=this.onboardingController.getIsSocialLoginFlow();let n=!1;if(r)try{n=await this.seedlessOnboardingController.checkIsPasswordOutdated({skipCache:!1})}catch(e){v.default.error("error while checking if password is outdated",e)}if(!r||!n)return await this.submitPassword(e),r&&this.seedlessOnboardingController.revokeRefreshToken(e).catch(e=>{v.default.error("error while revoking seedless refresh token",e)}),t=!0,t;const o=await this.seedlessOperationMutex.acquire();try{const r=await this.keyringController.verifyPassword(e).then(()=>!0).catch(e=>{if(e.message.includes("Incorrect password"))return!1;throw v.default.error("error while verifying keyring password",e.message),e});if(await this.seedlessOnboardingController.submitGlobalPassword({globalPassword:e,maxKeyChainLength:20}).then(()=>{t=!0}).catch(e=>{if(v.default.error(`error while submitting global password: ${e.message} , isKeyringPasswordValid: ${r}`),e instanceof oe.RecoveryError){if((null==e?void 0:e.message)===oe.SeedlessOnboardingControllerErrorMessage.IncorrectPassword&&r)throw new Error(oe.SeedlessOnboardingControllerErrorMessage.OutdatedPassword);throw new f.JsonRpcError(-32603,e.message,e.data)}if(e.message!==oe.SeedlessOnboardingControllerErrorMessage.MaxKeyChainLengthExceeded)throw e;t=!1}),!t)return await this.seedlessOnboardingController.refreshAuthTokens(),await this.restoreSocialBackupAndGetSeedPhrase(e),t;const n=await this.seedlessOnboardingController.loadKeyringEncryptionKey();await this.submitEncryptionKey(n);let o=!1;try{var s,a;await this.seedlessOnboardingController.syncLatestGlobalPassword({globalPassword:e}),null===(s=(a=this.metaMetricsController).bufferedTrace)||void 0===s||s.call(a,{name:Ae.TraceName.OnboardingResetPassword,op:Ae.TraceOperation.OnboardingSecurityOp}),await this.keyringController.changePassword(e),o=!0,await this.syncKeyringEncryptionKey(),await this.seedlessOnboardingController.checkIsPasswordOutdated({skipCache:!0}),this.seedlessOnboardingController.revokeRefreshToken(e).catch(e=>{v.default.error("error while revoking seedless refresh token",e)})}catch(e){var i,l,c,d;const t=e instanceof Error?e.message:"Unknown error";throw null===(i=(l=this.metaMetricsController).bufferedTrace)||void 0===i||i.call(l,{name:Ae.TraceName.OnboardingResetPasswordError,op:Ae.TraceOperation.OnboardingError,tags:{errorMessage:t}}),null===(c=(d=this.metaMetricsController).bufferedEndTrace)||void 0===c||c.call(d,{name:Ae.TraceName.OnboardingResetPasswordError}),await this.setLocked({skipSeedlessOperationLock:!0}),e}finally{var u,h;null===(u=(h=this.metaMetricsController).bufferedEndTrace)||void 0===u||u.call(h,{name:Ae.TraceName.OnboardingResetPassword,data:{success:o}})}return t}finally{o()}}async syncKeyringEncryptionKey(){const e=await this.keyringController.exportEncryptionKey();await this.seedlessOnboardingController.storeKeyringEncryptionKey(e)}async checkIsSeedlessPasswordOutdated(e=!1){const t=this.onboardingController.getIsSocialLoginFlow(),{completedOnboarding:r}=this.onboardingController.state;if(!t||!r)return!1;return await this.seedlessOnboardingController.checkIsPasswordOutdated({skipCache:e})}async syncSeedPhrases(){if(!this.onboardingController.getIsSocialLoginFlow())throw new Error("Syncing seed phrases is only available for social login flow");const[e,...r]=await this.fetchAllSecretData();if(!e)throw new Error("No root SRP found");for(const e of r){if(!this.seedlessOnboardingController.getSecretDataBackupState(e.data,e.type)){if(e.type===oe.SecretType.PrivateKey){await this.importAccountWithStrategy("privateKey",[(0,Q.bytesToHex)(e.data)],{shouldCreateSocialBackup:!1,shouldSelectAccount:!1});continue}const r=this._convertEnglishWordlistIndicesToCodepoints(e.data),n=t.from(r).toString("utf8");await this.importMnemonicToVault(n,{shouldCreateSocialBackup:!1,shouldSelectAccount:!1,shouldImportSolanaAccount:!0})}}}async addNewSeedPhraseBackup(e,r,n=!0){const o=t.from(e,"utf8"),s=this._convertMnemonicToWordlistIndices(o);if(n){const e=await this.seedlessOperationMutex.acquire();let t=!1;try{var a,i;null===(a=(i=this.metaMetricsController).bufferedTrace)||void 0===a||a.call(i,{name:Ae.TraceName.OnboardingAddSrp,op:Ae.TraceOperation.OnboardingSecurityOp}),await this.seedlessOnboardingController.addNewSecretData(s,oe.SecretType.Mnemonic,{keyringId:r}),t=!0}catch(e){var l,c,d,u;const t=e instanceof Error?e.message:"Unknown error";throw null===(l=(c=this.metaMetricsController).bufferedTrace)||void 0===l||l.call(c,{name:Ae.TraceName.OnboardingAddSrpError,op:Ae.TraceOperation.OnboardingError,tags:{errorMessage:t}}),null===(d=(u=this.metaMetricsController).bufferedEndTrace)||void 0===d||d.call(u,{name:Ae.TraceName.OnboardingAddSrpError}),e}finally{var h,p;null===(h=(p=this.metaMetricsController).bufferedEndTrace)||void 0===h||h.call(p,{name:Ae.TraceName.OnboardingAddSrp,data:{success:t}}),e()}}else this.seedlessOnboardingController.updateBackupMetadataState({keyringId:r,data:s,type:oe.SecretType.Mnemonic})}async changePassword(e,t){const r=await this.seedlessOperationMutex.acquire(),n=this.onboardingController.getIsSocialLoginFlow();try{if(await this.keyringController.changePassword(e),n)try{await this.seedlessOnboardingController.changePassword(e,t);const r=await this.keyringController.exportEncryptionKey();await this.seedlessOnboardingController.storeKeyringEncryptionKey(r)}catch(e){v.default.error("error while changing seedless-onboarding password",e),v.default.error("reverting keyring password change"),await this.keyringController.changePassword(t);const r=await this.keyringController.exportEncryptionKey();throw await this.seedlessOnboardingController.storeKeyringEncryptionKey(r),e}}catch(e){throw v.default.error("error while changing password",e),e}finally{r()}}async createNewVaultAndKeychain(e){const t=await this.createVaultMutex.acquire();try{return await this.keyringController.createNewVaultAndKeychain(e),this.keyringController.state.keyrings[0]}finally{t()}}async importMnemonicToVault(e,r={shouldCreateSocialBackup:!0,shouldSelectAccount:!0,shouldImportSolanaAccount:!0}){const{shouldCreateSocialBackup:n,shouldSelectAccount:o,shouldImportSolanaAccount:s}=r,a=await this.createVaultMutex.acquire();try{if(this.keyringController.getKeyringsByType(h.KeyringTypes.hd).some(r=>t.from(this._convertEnglishWordlistIndicesToCodepoints(r.mnemonic)).toString("utf8")===e))throw new Error("This Secret Recovery Phrase has already been imported.");const{id:r}=await this.keyringController.addNewKeyring(h.KeyringTypes.hd,{mnemonic:e,numberOfAccounts:1}),[a]=await this.keyringController.withKeyring({id:r},async({keyring:e})=>e.getAccounts());if(this.onboardingController.getIsSocialLoginFlow())try{await this.addNewSeedPhraseBackup(e,r,n)}catch(e){throw await this.keyringController.removeAccount(a),e}if(o){const e=this.accountsController.getAccountByAddress(a);this.accountsController.setSelectedAccount(e.id)}return{newAccountAddress:a,discoveredAccounts:await this._addAccountsWithBalance(r,s)}}finally{a()}}async restoreSeedPhrasesToVault(e){if(!this.onboardingController.getIsSocialLoginFlow())return;const r=!1,n=!1;for(const o of e){if(this.seedlessOnboardingController.getSecretDataBackupState(o.data,o.type))continue;if(o.type===oe.SecretType.PrivateKey){await this.importAccountWithStrategy("privateKey",[(0,Q.bytesToHex)(o.data)],{shouldCreateSocialBackup:r,shouldSelectAccount:n});continue}const e=this._convertEnglishWordlistIndicesToCodepoints(o.data),s=t.from(e).toString("utf8");await this.importMnemonicToVault(s,{shouldCreateSocialBackup:r,shouldSelectAccount:n,shouldImportSolanaAccount:false})}}async restoreSocialBackupAndGetSeedPhrase(e){try{const[r,...n]=await this.fetchAllSecretData(e),o=this._convertEnglishWordlistIndicesToCodepoints(r.data),s=t.from(o).toString("utf8"),a=Array.from(t.from(s,"utf8").values());return await this.createNewVaultAndRestore(e,a),n.length>0&&await this.restoreSeedPhrasesToVault(n),s}catch(e){if(v.default.error("Error restoring social backup and getting seed phrase",e),e instanceof oe.RecoveryError)throw new f.JsonRpcError(-32603,e.message,e.data);throw e}}async generateNewMnemonicAndAddToVault(){const e=await this.createVaultMutex.acquire();try{const{id:e}=await this.keyringController.addNewKeyring(h.KeyringTypes.hd),[t]=await this.keyringController.withKeyring({id:e},async({keyring:e})=>e.getAccounts()),r=this.accountsController.getAccountByAddress(t);return this.accountsController.setSelectedAccount(r.id),t}finally{e()}}async createNewVaultAndRestore(e,r){const n=await this.createVaultMutex.acquire();try{const{completedOnboarding:n}=this.onboardingController.state,o=t.from(r);this.permissionController.clearState(),await this.snapController.clearState(),this.accountOrderController.updateHiddenAccountsList([]),this.accountTrackerController.clearAccounts(),this.txController.clearUnapprovedTransactions(),n&&this.tokenDetectionController.enable();const s=this._convertMnemonicToWordlistIndices(o);if(await this.keyringController.createNewVaultAndRestore(e,s),await this.accountsController.updateAccounts(),this.multichainAccountService.init(),this.accountTreeController.init(),n&&await this._addAccountsWithBalance(),(0,xe.getIsSeedlessOnboardingFeatureEnabled)()){if(this.onboardingController.getIsSocialLoginFlow()){const e=this.keyringController.state.keyrings[0].metadata.id;this.seedlessOnboardingController.updateBackupMetadataState({keyringId:e,data:s,type:oe.SecretType.Mnemonic}),await this.syncKeyringEncryptionKey()}}}finally{n()}}async _getMultichainWalletSnapClient(e){const t=await this.getSnapKeyring(),r=this.controllerMessenger;return new Ne.MultichainWalletSnapClient(e,t,r)}async _addAccountsWithBalance(e,t=!0){try{await this.userStorageController.setHasAccountSyncingSyncedAtLeastOnce(!1),await this.userStorageController.setIsAccountSyncingReadyToBeDispatched(!1);const o=wr(Mr,this,Or).call(this),s=e?{id:e}:{type:h.KeyringTypes.hd},{accounts:a,entropySource:i}=await this.keyringController.withKeyring(s,async({keyring:e,metadata:t})=>({accounts:await e.getAccounts(),entropySource:t.id}));let l=a[a.length-1];for(let e=a.length;;e++){if("0x0"===await this.getBalance(l,this.provider)){var r,n;await this.tokenDetectionController.detectTokens({chainIds:[o],selectedAddress:l});const t=null===(r=this.tokensController.state.allTokens)||void 0===r||null===(r=r[o])||void 0===r?void 0:r[l],s=null===(n=this.tokensController.state.allDetectedTokens)||void 0===n||null===(n=n[o])||void 0===n?void 0:n[l];if(0===((null==t?void 0:t.length)??0)&&0===((null==s?void 0:s.length)??0)){1!==e&&await this.removeAccount(l);break}}l=await this.keyringController.withKeyring(s,async({keyring:e})=>{const[t]=await e.addAccounts(1);return t})}const c={bitcoin:0,solana:0};if(t){const e=await this._getMultichainWalletSnapClient(Re.SOLANA_WALLET_SNAP_ID),t=Y.SolScope.Mainnet,r=await e.discoverAccounts(i,t);c.solana=r.length,0===r.length&&await this._addSnapAccount(i,e,{scope:t})}return c}catch(e){return v.default.warn(`Failed to add accounts with balance. Error: ${e}`),{bitcoin:0,solana:0}}finally{await this.userStorageController.setHasAccountSyncingSyncedAtLeastOnce(!0),await this.userStorageController.setIsAccountSyncingReadyToBeDispatched(!0)}}async _importAccountsWithBalances(){const{keyrings:e}=this.keyringController.state;for(const{metadata:t}of e){await this.keyringController.withKeyring({id:t.id},async({keyring:e})=>e.type===h.KeyringTypes.hd)&&await this._addAccountsWithBalance(t.id,true)}}async _addSnapAccount(e,t,r={}){let n=e;try{if(!n){n=await this.keyringController.withKeyring({type:h.KeyringTypes.hd},async({metadata:e})=>e.id)}return await t.createAccount({...r,entropySource:n},{displayConfirmation:!1,displayAccountNameSuggestion:!1,setSelectedAccount:!1})}catch(e){return v.default.warn(`Failed to add Snap account. Error: ${e}`),(0,se.captureException)(e),null}}_convertMnemonicToWordlistIndices(e){const t=e.toString().split(" ").map(e=>K.wordlist.indexOf(e));return new Uint8Array(new Uint16Array(t).buffer)}_convertEnglishWordlistIndicesToCodepoints(e){return t.from(Array.from(new Uint16Array(e.buffer)).map(e=>K.wordlist[e]).join(" "))}async getBalance(e,t){const r=this.accountTrackerController.state.accountsByChainId[wr(Mr,this,Or).call(this)],n=null==r?void 0:r[e];if(n&&n.balance)return n.balance;try{return await t.request({method:"eth_getBalance",params:[e,"latest"]})||"0x0"}catch(e){throw v.default.error(e),e}}async submitPassword(e){await this.submitPasswordOrEncryptionKey({password:e})}async submitEncryptionKey(e){await this.submitPasswordOrEncryptionKey({encryptionKey:e})}async submitPasswordOrEncryptionKey({password:e,encryptionKey:t}){const r=this.onboardingController.getIsSocialLoginFlow();await this.offscreenPromise,t?await this.keyringController.submitEncryptionKey(t):(await this.keyringController.submitPassword(e),r&&await this.seedlessOnboardingController.submitPassword(e));try{await this.blockTracker.checkForLatestBlock()}catch(e){v.default.error("Error while unlocking extension.",e)}await this.accountsController.updateAccounts(),this.multichainAccountService.init(),this.accountTreeController.init()}async _loginUser(e){try{await this.submitPassword(e),await this.accountTrackerController.updateAccountsAllActiveNetworks()}finally{this._startUISync()}}_startUISync(){this.emit("startUISync"),this.startUISync=!0,this.memStore.subscribe(this.sendUpdate.bind(this))}async submitEncryptionKeyFromSessionStorage(){try{const{loginToken:e,loginSalt:t}=await this.extension.storage.session.get(["loginToken","loginSalt"]);if(e&&t){const{vault:r}=this.keyringController.state;if(JSON.parse(r).salt!==t)return console.warn("submitEncryptionKey: Stored salt and vault salt do not match"),void await this.clearLoginArtifacts();await this.keyringController.submitEncryptionKey(e,t)}}catch(e){throw await this.clearLoginArtifacts(),e}}async clearLoginArtifacts(){await this.extension.storage.session.remove(["loginToken","loginSalt"])}async verifyPassword(e){await this.keyringController.verifyPassword(e)}getPrimaryKeyringMnemonic(){const[e]=this.keyringController.getKeyringsByType(de.KeyringType.hdKeyTree);if(!e.mnemonic)throw new Error("Primary keyring mnemonic unavailable.");return e.mnemonic}getPrimaryKeyringMnemonicSeed(){const[e]=this.keyringController.getKeyringsByType(de.KeyringType.hdKeyTree);if(!e.seed)throw new Error("Primary keyring mnemonic unavailable.");return e.seed}async attemptLedgerTransportCreation(){return await wr(Mr,this,Ar).call(this,{name:ce.HardwareDeviceNames.ledger},async e=>e.attemptMakeApp())}async connectHardware(e,t,r){return wr(Mr,this,Ar).call(this,{name:e,hdPath:r},async e=>{let r=[];switch(t){case-1:r=await e.getPreviousPage();break;case 1:r=await e.getNextPage();break;default:r=await e.getFirstPage()}const n=await this.keyringController.getAccounts(),o=[...new Set(n.concat(r.map(e=>e.address.toLowerCase())))];return this.accountTrackerController.syncWithAddresses(o),r})}async checkHardwareStatus(e,t){return wr(Mr,this,Ar).call(this,{name:e,hdPath:t},async e=>e.isUnlocked())}async getHardwareTypeForMetric(e){return await this.keyringController.withKeyring({address:e},({keyring:e})=>ce.HardwareKeyringType[e.type])}async forgetDevice(e){return wr(Mr,this,Ar).call(this,{name:e},async e=>{for(const t of await e.getAccounts())this._onAccountRemoved(t);return e.forgetDevice(),!0})}async getAccountType(e){switch(await this.keyringController.getAccountKeyringType(e)){case de.KeyringType.trezor:case de.KeyringType.oneKey:case de.KeyringType.lattice:case de.KeyringType.qr:case de.KeyringType.ledger:return"hardware";case de.KeyringType.imported:return"imported";case de.KeyringType.snap:return"snap";default:return"MetaMask"}}async getDeviceModel(e){return this.keyringController.withKeyring({address:e},async({keyring:e})=>{switch(e.type){case de.KeyringType.trezor:case de.KeyringType.oneKey:return e.getModel();case de.KeyringType.qr:return e.getName();case de.KeyringType.ledger:return ce.HardwareDeviceNames.ledger;case de.KeyringType.lattice:return ce.HardwareDeviceNames.lattice;default:return undefined}})}getAccountLabel(e,t,r){return`${e[0].toUpperCase()}${e.slice(1)} ${parseInt(t,10)+1} ${r||""}`.trim()}async unlockHardwareWalletAccount(e,t,r,n){const{address:o}=await wr(Mr,this,Ar).call(this,{name:t,hdPath:r},async r=>{r.setAccountToUnlock(e);const[o]=await r.addAccounts(1);return{address:(0,J.normalize)(o),label:this.getAccountLabel(t===ce.HardwareDeviceNames.qr?r.getName():t,e,n)}});this.preferencesController.setSelectedAddress(o);const s=this.accountsController.listAccounts(),{identities:a}=this.preferencesController.state;return{unlockedAccount:o,identities:a,accounts:s}}async addNewAccount(e,t){const r=await this.keyringController.getAccounts(),n=t?{id:t}:{type:h.KeyringTypes.hd},o=await this.keyringController.withKeyring(n,async({keyring:t})=>{if(t.type!==h.KeyringTypes.hd)throw new Error("Cannot add account to non-HD keyring");const n=await t.getAccounts();if(e&&e!==n.length){if(e>n.length)throw new Error("Account out of sequence");const t=n[e];if(!t)throw new Error(`Can't find account at index ${e}`);return t}const[o]=await t.addAccounts(1);if(r.includes(o))throw await t.removeAccount(o),new Error(`Cannot add duplicate ${o} account`);return o});return r.includes(o)||this.preferencesController.setSelectedAddress(o),o}async getSeedPhrase(e,t){return this._convertEnglishWordlistIndicesToCodepoints(await this.keyringController.exportSeedPhrase(e,t))}async resetAccount(){const e=this.accountsController.getSelectedAccount().address,t=wr(Mr,this,Or).call(this);return this.txController.wipeTransactions({address:e,chainId:t}),this.smartTransactionsController.wipeSmartTransactions({address:e,ignoreNetwork:!1}),this.bridgeStatusController.wipeBridgeStatus({address:e,ignoreNetwork:!1}),this.networkController.resetConnection(),e}captureKeyringTypesWithMissingIdentities(e=[],t=[]){const r=t.filter(t=>!e.some(e=>e.address.toLowerCase()===t.toLowerCase())).map(e=>this.keyringController.getAccountKeyringType(e)),n=e.length,o=this.accountTrackerController.state.accountsByChainId[wr(Mr,this,Or).call(this)],s=Object.keys(o||{}).length;(0,se.captureException)(new Error(`Attempt to get permission specifications failed because their were ${t.length} accounts, but ${n} identities, and the ${r} keyrings included accounts with missing identities. Meanwhile, there are ${s} accounts in the account tracker.`))}sortEvmAccountsByLastSelected(e){const t=this.accountsController.listAccounts();return this.sortAddressesWithInternalAccounts(e,t)}sortMultichainAccountsByLastSelected(e){const t=this.accountsController.listMultichainAccounts();return this.sortAddressesWithInternalAccounts(e,t)}sortAddressesWithInternalAccounts(e,t){return e.sort((r,n)=>{const o=t.find(e=>e.address.toLowerCase()===r.toLowerCase()),s=t.find(e=>e.address.toLowerCase()===n.toLowerCase());if(!o)throw this.captureKeyringTypesWithMissingIdentities(t,e),new Error(`Missing identity for address: "${r}".`);if(!s)throw this.captureKeyringTypesWithMissingIdentities(t,e),new Error(`Missing identity for address: "${n}".`);return o.metadata.lastSelected===s.metadata.lastSelected?0:o.metadata.lastSelected===undefined?1:s.metadata.lastSelected===undefined?-1:s.metadata.lastSelected-o.metadata.lastSelected})}getPermittedAccounts(e){let t;try{t=this.permissionController.getCaveat(e,te.Caip25EndowmentPermissionName,te.Caip25CaveatType)}catch(e){if(e instanceof I.PermissionDoesNotExistError)return[];throw e}const r=(0,te.getEthAccounts)(t.value);return this.sortEvmAccountsByLastSelected(r)}removeAllScopePermissions(e){this.permissionController.updatePermissionsByCaveat(te.Caip25CaveatType,t=>te.Caip25CaveatMutators[te.Caip25CaveatType].removeScope(t,e))}removeAllAccountPermissions(e){this.permissionController.updatePermissionsByCaveat(te.Caip25CaveatType,t=>te.Caip25CaveatMutators[te.Caip25CaveatType].removeAccount(t,e))}async removeAccount(e){return this._onAccountRemoved(e),await this.keyringController.removeAccount(e),e}async importAccountWithStrategy(e,t,r={shouldCreateSocialBackup:!0,shouldSelectAccount:!0}){const{shouldCreateSocialBackup:n,shouldSelectAccount:o}=r,s=await this.keyringController.importAccountWithStrategy(e,t);if(this.onboardingController.getIsSocialLoginFlow()){const{id:e,privateKey:t}=await this.keyringController.withKeyring({address:s},async({keyring:e,metadata:t})=>{const r=await e.exportAccount(s);return{id:t.id,privateKey:r}});try{await this.addNewPrivateKeyBackup(t,e,n)}catch(e){throw await this.keyringController.removeAccount(s),e}}o&&this.preferencesController.setSelectedAddress(s)}async addNewPrivateKeyBackup(e,t,r=!0){const n=(0,Q.hexToBytes)((0,Q.add0x)(e));if(r){const e=await this.seedlessOperationMutex.acquire();try{await this.seedlessOnboardingController.addNewSecretData(n,oe.SecretType.PrivateKey,{keyringId:t})}catch(e){throw v.default.error("Error adding new private key backup",e),e}finally{e()}}else this.seedlessOnboardingController.updateBackupMetadataState({keyringId:t,data:n,type:oe.SecretType.PrivateKey})}async requestPermissionApproval(e,t,r={}){const n=(0,S.nanoid)();return this.approvalController.addAndShowApprovalRequest({id:n,origin:e,requestData:{metadata:{id:n,origin:e},permissions:t,...r},type:I.MethodNames.RequestPermissions})}async requestApprovalPermittedChainsPermission(e,t){const r=(0,te.setPermittedEthChainIds)({requiredScopes:{},optionalScopes:{},sessionProperties:{},isMultichainOrigin:!1},[t]);await this.permissionController.requestPermissionsIncremental({origin:e},{[te.Caip25EndowmentPermissionName]:{caveats:[{type:te.Caip25CaveatType,value:r}]}})}getNonEvmSupportedMethods(e){return this.controllerMessenger.call("MultichainRouter:getSupportedMethods",e)}notifySolanaAccountChangedForCurrentAccount(e){var t;let r;try{r=this.permissionController.getCaveat(e,te.Caip25EndowmentPermissionName,te.Caip25CaveatType)}catch{}if(!r)return;const n=null===(t=r.value.sessionProperties)||void 0===t?void 0:t[te.KnownSessionProperties.SolanaAccountChangedNotifications],o=(0,te.getSessionScopes)(r.value,{getNonEvmSupportedMethods:this.getNonEvmSupportedMethods.bind(this)}),s=o[_e.MultichainNetworks.SOLANA]||o[_e.MultichainNetworks.SOLANA_DEVNET]||o[_e.MultichainNetworks.SOLANA_TESTNET];if(n&&s){const{accounts:t}=s,r=t.map(e=>{const{address:t}=(0,Q.parseCaipAccountId)(e);return t}),[n]=this.sortMultichainAccountsByLastSelected(r);n&&this._notifySolanaAccountChange(e,[n])}}getAddTransactionRequest({transactionParams:e,transactionOptions:t,dappRequest:r,...n}){var o;const s=(null==r?void 0:r.networkClientId)??(null==t?void 0:t.networkClientId),{chainId:a}=this.networkController.getNetworkConfigurationByNetworkClientId(s);return{internalAccounts:this.accountsController.listAccounts(),dappRequest:r,networkClientId:s,selectedAccount:this.accountsController.getAccountByAddress(e.from),transactionController:this.txController,transactionOptions:t,transactionParams:e,userOperationController:this.userOperationController,chainId:a,ppomController:this.ppomController,securityAlertsEnabled:null===(o=this.preferencesController.state)||void 0===o?void 0:o.securityAlertsEnabled,updateSecurityAlertResponse:this.updateSecurityAlertResponse.bind(this),getSecurityAlertResponse:this.appStateController.getAddressSecurityAlertResponse.bind(this.appStateController),addSecurityAlertResponse:this.appStateController.addAddressSecurityAlertResponse.bind(this.appStateController),getSecurityAlertsConfig:this.getSecurityAlertsConfig(),...n}}async getCurrentAccountEIP1559Compatibility(){return!0}async createCancelTransaction(e,t,r){await this.txController.stopTransaction(e,t,r);return this.getState()}async createSpeedUpTransaction(e,t,r){await this.txController.speedUpTransaction(e,t,r);return this.getState()}async estimateGas(e){return new Promise((t,r)=>{this.provider.request({method:"eth_estimateGas",params:[e]}).then(e=>t(e.toString(16))).catch(e=>r(e))})}async updateSecurityAlertResponse(e,t,r){return await(0,_t.updateSecurityAlertResponse)({appStateController:this.appStateController,messenger:this.controllerMessenger,method:e,securityAlertId:t,securityAlertResponse:r,signatureController:this.signatureController,transactionController:this.txController})}getHDEntropyIndex(){const e=this.accountsController.getSelectedAccount(),t=this.keyringController.state.keyrings.filter(e=>e.type===h.KeyringTypes.hd).findIndex(t=>t.accounts.includes(e.address));return-1===t?undefined:t}markPasswordForgotten(){this.preferencesController.setPasswordForgotten(!0),this.sendUpdate()}unMarkPasswordForgotten(){this.preferencesController.setPasswordForgotten(!1),this.sendUpdate()}setupUntrustedCommunicationEip1193({connectionStream:e,sender:t,subjectType:r}){if(t.url&&this.onboardingController.state.completedOnboarding&&this.preferencesController.state.usePhishDetect){const{hostname:r}=new URL(t.url);this.phishingController.maybeUpdateState();const n=this.phishingController.test(t.url);if(null!=n&&n.result)return this.sendPhishingWarning(e,r),void this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.PhishingPageDisplayed,category:fe.MetaMetricsEventCategory.Phishing,properties:{url:r}})}let n;n=r||(t.id&&t.id!==this.extension.runtime.id?I.SubjectType.Extension:I.SubjectType.Website);const o=(0,ot.setupMultiplex)(e);o.ignoreStream(jt.METAMASK_CAIP_MULTICHAIN_PROVIDER),this.setupProviderConnectionEip1193(o.createStream(jt.METAMASK_EIP_1193_PROVIDER),t,n),t.url&&this.setupPublicConfig(o.createStream("publicConfig"))}setupUntrustedCommunicationCaip({connectionStream:e,sender:t,subjectType:r}){let n;n=r||(t.id&&t.id!==this.extension.runtime.id?I.SubjectType.Extension:I.SubjectType.Website),this.setupProviderConnectionCaip(e,t,n)}setupTrustedCommunication(e,t){const r=(0,ot.setupMultiplex)(e);this.setupControllerConnection(r.createStream("controller")),this.setupProviderConnectionEip1193(r.createStream("provider"),t,I.SubjectType.Internal)}setupPhishingCommunication({connectionStream:e}){const{usePhishDetect:t}=this.preferencesController.state;if(!t)return;const r=(0,ot.setupMultiplex)(e).createStream("metamask-phishing-safelist");r.on("data",(0,ht.default)({safelistPhishingDomain:this.safelistPhishingDomain.bind(this),backToSafetyPhishingWarning:this.backToSafetyPhishingWarning.bind(this)},r))}setUpCookieHandlerCommunication({connectionStream:e}){const{metaMetricsId:t,dataCollectionForMarketing:r,participateInMetaMetrics:n}=this.metaMetricsController.state;if(t&&r&&n){const t=(0,ot.setupMultiplex)(e).createStream(jt.METAMASK_COOKIE_HANDLER);t.on("data",(0,ht.default)({getCookieFromMarketingPage:this.getCookieFromMarketingPage.bind(this)},t))}}getCookieFromMarketingPage(e){const{ga_client_id:t}=e;this.metaMetricsController.setMarketingCampaignCookieId(t)}sendPhishingWarning(e,t){(0,ot.setupMultiplex)(e).createStream("phishing").write({hostname:t})}setupControllerConnection(e){const t=new xt.PatchStore(this.memStore);let r=!1;const n=()=>{if(!(0,ot.isStreamWritable)(e)||!r)return;const n=t.flushPendingPatches();e.write({jsonrpc:"2.0",method:"sendUpdate",params:[n]})},s={...this.getApi(),...this.controllerApi,startPatches:()=>{r=!0,n()},getStatePatches:()=>t.flushPendingPatches()};this.on("update",n),this.activeControllerConnections+=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),e.on("data",(0,ht.default)(s,e));const a=()=>{(0,ot.isStreamWritable)(e)&&e.write({jsonrpc:"2.0",method:"startUISync"})};this.startUISync?a():this.once("startUISync",a);const i=()=>{e.mmFinished||(this.activeControllerConnections-=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),e.mmFinished=!0,this.removeListener("update",n),t.destroy())};e.mmFinished=!1,(0,o.finished)(e,i),e.once("close",i),e.once("end",i)}setupProviderConnectionEip1193(e,t,r){let n,s;n=r===I.SubjectType.Internal?me.ORIGIN_METAMASK:r===I.SubjectType.Snap?t.snapId:new URL(t.url).origin,t.id&&t.id!==this.extension.runtime.id&&this.subjectMetadataController.addSubjectMetadata({origin:n,extensionId:t.id,subjectType:I.SubjectType.Extension}),t.tab&&t.tab.id&&(s=t.tab.id);let a=n;t.tab&&t.tab.url&&(a=new URL(t.tab.url).origin);const l=this.setupProviderEngineEip1193({origin:n,sender:t,subjectType:r,tabId:s,mainFrameOrigin:a}),c=(0,Qe.default)(),d=(0,i.createEngineStream)({engine:l}),u=this.addConnection(n,{tabId:s,apiType:kr,engine:l});(0,o.pipeline)(e,c,d,e,e=>{var t;l.destroy(),u&&this.removeConnection(n,u),!e||null!==(t=e.message)&&void 0!==t&&t.match("Premature close")||v.default.error(e)}),r!==I.SubjectType.Internal&&this._notifyChainChangeForConnection({engine:l},n)}setupProviderConnectionCaip(e,t,r){let n,s;n=r===I.SubjectType.Internal?me.ORIGIN_METAMASK:r===I.SubjectType.Snap?t.snapId:new URL(t.url).origin,t.id&&t.id!==this.extension.runtime.id&&this.subjectMetadataController.addSubjectMetadata({origin:n,extensionId:t.id,subjectType:I.SubjectType.Extension}),t.tab&&t.tab.id&&(s=t.tab.id);const a=this.setupProviderEngineCaip({origin:n,sender:t,subjectType:r,tabId:s}),l=(0,Qe.default)(),c=(0,i.createEngineStream)({engine:a}),d=this.addConnection(n,{tabId:s,apiType:Sr,engine:a});setTimeout(()=>this.notifySolanaAccountChangedForCurrentAccount(n),500),(0,o.pipeline)(e,l,c,e,e=>{var t;a.destroy(),d&&this.removeConnection(n,d),!e||null!==(t=e.message)&&void 0!==t&&t.match("Premature close")||v.default.error(e)})}setupCommonMiddlewareHooks(e){return{addSubjectMetadata:this.subjectMetadataController.addSubjectMetadata.bind(this.subjectMetadataController),getProviderState:this.getProviderState.bind(this),handleWatchAssetRequest:this.handleWatchAssetRequest.bind(this),requestUserApproval:this.approvalController.addAndShowApprovalRequest.bind(this.approvalController),getCaveat:({target:t,caveatType:r})=>{try{return this.permissionController.getCaveat(e,t,r)}catch(e){if(!(e instanceof I.PermissionDoesNotExistError))throw e}return undefined},requestPermittedChainsPermissionIncrementalForOrigin:t=>(0,te.requestPermittedChainsPermissionIncremental)({...t,origin:e,hooks:{requestPermissionsIncremental:this.permissionController.requestPermissionsIncremental.bind(this.permissionController),grantPermissionsIncremental:this.permissionController.grantPermissionsIncremental.bind(this.permissionController)}}),addNetwork:this.networkController.addNetwork.bind(this.networkController),updateNetwork:this.networkController.updateNetwork.bind(this.networkController),setActiveNetwork:async t=>{this.permissionController.hasPermission(e,te.Caip25EndowmentPermissionName)?this.selectedNetworkController.setNetworkClientIdForDomain(e,t):await this.networkController.setActiveNetwork(t)},getNetworkConfigurationByChainId:this.networkController.getNetworkConfigurationByChainId.bind(this.networkController),setTokenNetworkFilter:e=>{const{tokenNetworkFilter:t}=this.preferencesController.getPreferences();e&&1===Object.keys(t).length&&this.preferencesController.setPreference("tokenNetworkFilter",{[e]:!0})},setEnabledNetworks:(e,t)=>{this.networkOrderController.setEnabledNetworks(e,t)},setEnabledNetworksMultichain:(e,t)=>{this.networkOrderController.setEnabledNetworksMultichain(e,t)},getEnabledNetworks:e=>this.networkOrderController.state.enabledNetworkMap[e]||{},getCurrentChainIdForDomain:e=>{const t=this.selectedNetworkController.getNetworkClientIdForDomain(e),{chainId:r}=this.networkController.getNetworkConfigurationByNetworkClientId(t);return r},getWeb3ShimUsageState:this.alertController.getWeb3ShimUsageState.bind(this.alertController),setWeb3ShimUsageRecorded:this.alertController.setWeb3ShimUsageRecorded.bind(this.alertController),rejectApprovalRequestsForOrigin:()=>this.rejectOriginPendingApprovals(e)}}setupProviderEngineEip1193({origin:e,subjectType:t,sender:r,tabId:n,mainFrameOrigin:o}){const s=new a.JsonRpcEngine;s.push((0,Xe.default)({origin:e})),o&&s.push((0,et.default)({mainFrameOrigin:o})),s.push((0,N.createSelectedNetworkMiddleware)(this.controllerMessenger));const i=this.selectedNetworkController.getProviderAndBlockTracker(e),l=(0,p.default)(i),c=(0,m.default)(i);return c.events.on("notification",e=>s.emit("notification",e)),n&&s.push((0,tt.default)({tabId:n})),s.push((0,Je.default)({origin:e})),s.push(this.permissionLogController.createMiddleware()),s.push((0,Dt.default)()),s.push((0,Ft.default)({getThrottledOriginState:this.appStateController.getThrottledOriginState.bind(this.appStateController),updateThrottledOriginState:this.appStateController.updateThrottledOriginState.bind(this.appStateController)})),s.push((0,Ve.createPPOMMiddleware)(this.ppomController,this.preferencesController,this.networkController,this.appStateController,this.accountsController,this.updateSecurityAlertResponse.bind(this),this.getSecurityAlertsConfig.bind(this))),s.push((0,He.createTrustSignalsMiddleware)(this.networkController,this.appStateController,this.phishingController,this.preferencesController,this.getPermittedAccounts.bind(this))),s.push((0,wt.default)({getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),getHDEntropyIndex:this.getHDEntropyIndex.bind(this),getHardwareTypeForMetric:this.getHardwareTypeForMetric.bind(this),snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]}),appStateController:this.appStateController,metaMetricsController:this.metaMetricsController})),s.push((0,Ze.createUnsupportedMethodMiddleware)()),t===I.SubjectType.Snap&&(0,Le.isSnapPreinstalled)(e)&&s.push((0,x.createPreinstalledSnapsMiddleware)({getPermissions:this.permissionController.getPermissions.bind(this.permissionController,e),getAllEvmAccounts:()=>this.controllerMessenger.call("AccountsController:listAccounts").map(e=>e.address),grantPermissions:t=>this.controllerMessenger.call("PermissionController:grantPermissions",{approvedPermissions:t,subject:{origin:e}})})),s.push((0,Ze.createEthAccountsMethodMiddleware)({getAccounts:this.getPermittedAccounts.bind(this,e)})),t!==I.SubjectType.Internal&&s.push(this.permissionController.createPermissionMiddleware({origin:e})),t===I.SubjectType.Website&&s.push((0,nt.default)({location:r.url,registerOnboarding:this.onboardingController.registerOnboarding})),s.push((0,It.default)({messenger:this.controllerMessenger.getRestricted({name:"EvmMethodsToNonEvmAccountFilterMessenger",allowedActions:["AccountsController:getSelectedAccount"]})})),s.push((0,Ze.createEip1193MethodMiddleware)({subjectType:t,...this.setupCommonMiddlewareHooks(e),metamaskState:this.getState(),sendMetrics:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getAccounts:this.getPermittedAccounts.bind(this,e),getCaip25PermissionFromLegacyPermissionsForOrigin:e=>(0,te.getCaip25PermissionFromLegacyPermissions)(e),getPermissionsForOrigin:this.permissionController.getPermissions.bind(this.permissionController,e),requestPermissionsForOrigin:t=>this.permissionController.requestPermissions({origin:e},t,{metadata:{isEip1193Request:!0}}),revokePermissionsForOrigin:t=>{try{this.permissionController.revokePermissions({[e]:t})}catch(e){console.log(e)}},updateCaveat:this.permissionController.updateCaveat.bind(this.permissionController,e),hasApprovalRequestsForOrigin:()=>this.approvalController.has({origin:e})})),s.push((0,x.createSnapsMethodMiddleware)(t===I.SubjectType.Snap,{clearSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:clearSnapState",e),getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),getSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getPermitted",e),requestPermissions:async t=>await this.permissionController.requestPermissions({origin:e},t),getPermissions:this.permissionController.getPermissions.bind(this.permissionController,e),getSnapFile:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getFile",e),getSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getSnapState",e),updateSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:updateSnapState",e),installSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:install",e),invokeSnap:this.permissionController.executeRestrictedMethod.bind(this.permissionController,e,ue.RestrictedMethods.wallet_snap),getIsLocked:()=>!this.appStateController.isUnlocked(),getIsActive:()=>this._isClientOpen,getInterfaceState:(...t)=>this.controllerMessenger.call("SnapInterfaceController:getInterface",e,...t).state,getInterfaceContext:(...t)=>this.controllerMessenger.call("SnapInterfaceController:getInterface",e,...t).context,createInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:createInterface",e),updateInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:updateInterface",e),resolveInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:resolveInterface",e),getSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:get"),trackError:e=>{var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r?void 0:r.call(t,e)},trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getAllSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getAll"),openWebSocket:this.controllerMessenger.call.bind(this.controllerMessenger,"WebSocketService:open",e),closeWebSocket:this.controllerMessenger.call.bind(this.controllerMessenger,"WebSocketService:close",e),getWebSockets:this.controllerMessenger.call.bind(this.controllerMessenger,"WebSocketService:getAll",e),sendWebSocketMessage:this.controllerMessenger.call.bind(this.controllerMessenger,"WebSocketService:sendMessage",e),getCurrencyRate:e=>{const t=this.multichainRatesController.state.rates[e],{fiatCurrency:r}=this.multichainRatesController.state;return t?{...t,currency:r}:undefined},getEntropySources:()=>this.controllerMessenger.call("KeyringController:getState").keyrings.map((e,t)=>e.type===h.KeyringTypes.hd?{id:e.metadata.id,name:e.metadata.name,type:"mnemonic",primary:0===t}:null).filter(Boolean),hasPermission:this.permissionController.hasPermission.bind(this.permissionController,e),scheduleBackgroundEvent:t=>this.controllerMessenger.call("CronjobController:schedule",{...t,snapId:e}),cancelBackgroundEvent:this.controllerMessenger.call.bind(this.controllerMessenger,"CronjobController:cancel",e),getBackgroundEvents:this.controllerMessenger.call.bind(this.controllerMessenger,"CronjobController:get",e),getNetworkConfigurationByChainId:this.controllerMessenger.call.bind(this.controllerMessenger,"NetworkController:getNetworkConfigurationByChainId"),getNetworkClientById:this.controllerMessenger.call.bind(this.controllerMessenger,"NetworkController:getNetworkClientById"),startTrace:e=>{const{_isStandaloneSpan:t,...r}=(0,Ae.trace)(e);return r},endTrace:Ae.endTrace,handleSnapRpcRequest:t=>this.handleSnapRequest({...t,origin:e}),getAllowedKeyringMethods:(0,Ue.keyringSnapPermissionsBuilder)(this.subjectMetadataController,e)})),s.push(l),s.push(c.middleware),s.push(this.metamaskMiddleware),s.push((0,d.providerAsMiddleware)(i.provider)),s}setupProviderEngineCaip({origin:e,sender:t,subjectType:r,tabId:n}){const o=new a.JsonRpcEngine;o.push((0,Xe.default)({origin:e})),n&&o.push((0,tt.default)({tabId:n})),o.push((0,Je.default)({origin:e})),o.push((e,t,r,n)=>[me.MESSAGE_TYPE.WALLET_CREATE_SESSION,me.MESSAGE_TYPE.WALLET_INVOKE_METHOD,me.MESSAGE_TYPE.WALLET_GET_SESSION,me.MESSAGE_TYPE.WALLET_REVOKE_SESSION].includes(e.method)?r():n(f.rpcErrors.methodNotFound({data:{method:e.method}}))),o.push((0,wt.default)({getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),getHDEntropyIndex:this.getHDEntropyIndex.bind(this),getHardwareTypeForMetric:this.getHardwareTypeForMetric.bind(this),snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]}),appStateController:this.appStateController,metaMetricsController:this.metaMetricsController})),o.push(X.multichainMethodCallValidatorMiddleware);const s=(0,Ze.makeMethodMiddlewareMaker)([X.walletRevokeSession,X.walletGetSession,X.walletInvokeMethod,X.walletCreateSession]);o.push(s({findNetworkClientIdByChainId:this.networkController.findNetworkClientIdByChainId.bind(this.networkController),listAccounts:this.accountsController.listAccounts.bind(this.accountsController),requestPermissionsForOrigin:(t,r={})=>this.permissionController.requestPermissions({origin:e},t,r),getCaveatForOrigin:this.permissionController.getCaveat.bind(this.permissionController,e),getSelectedNetworkClientId:()=>this.networkController.state.selectedNetworkClientId,revokePermissionForOrigin:this.permissionController.revokePermission.bind(this.permissionController,e),getNonEvmSupportedMethods:this.getNonEvmSupportedMethods.bind(this),isNonEvmScopeSupported:this.controllerMessenger.call.bind(this.controllerMessenger,"MultichainRouter:isSupportedScope"),handleNonEvmRequestForOrigin:t=>this.controllerMessenger.call("MultichainRouter:handleRequest",{...t,origin:e}),getNonEvmAccountAddresses:this.controllerMessenger.call.bind(this.controllerMessenger,"MultichainRouter:getSupportedAccounts"),trackSessionCreatedEvent:e=>this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.PermissionsRequested,properties:{api_source:fe.MetaMetricsRequestedThrough.MultichainApi,method:me.MESSAGE_TYPE.WALLET_CREATE_SESSION,chain_id_list:(0,te.getAllScopesFromCaip25CaveatValue)(e)}})})),o.push((0,Ze.createUnsupportedMethodMiddleware)(new Set([...le.UNSUPPORTED_RPC_METHODS,"eth_requestAccounts","eth_accounts"]))),r===I.SubjectType.Website&&o.push((0,nt.default)({location:t.url,registerOnboarding:this.onboardingController.registerOnboarding})),o.push((0,Ze.createMultichainMethodMiddleware)({subjectType:r,...this.setupCommonMiddlewareHooks(e)})),o.push(this.metamaskMiddleware);try{const t=this.permissionController.getCaveat(e,te.Caip25EndowmentPermissionName,te.Caip25CaveatType),r=(0,te.getSessionScopes)(t.value,{getNonEvmSupportedMethods:this.getNonEvmSupportedMethods.bind(this)});Object.entries(r).forEach(([t,r])=>{r.notifications.includes("eth_subscription")&&r.methods.includes("eth_subscribe")&&this.addMultichainApiEthSubscriptionMiddleware({scope:t,origin:e,tabId:n})})}catch(e){}return this.multichainSubscriptionManager.on("notification",(t,r,s)=>{e===t&&n===r&&o.emit("notification",s)}),o.push(this.multichainMiddlewareManager.generateMultichainMiddlewareForOriginAndTabId(e,n)),o.push(async(e,t,r,n)=>{const{provider:o}=this.networkController.getNetworkClientById(e.networkClientId);return t.result=await o.request(e),n()}),o}setupPublicConfig(e){const t=(0,c.storeAsStream)(this.publicConfigStore);(0,o.pipeline)(t,e,e=>{var r;t.destroy(),!e||null!==(r=e.message)&&void 0!==r&&r.match("Premature close")||v.default.error(e)})}addConnection(e,{tabId:t,apiType:r,engine:n}){if(e===me.ORIGIN_METAMASK)return null;this.connections[e]||(this.connections[e]={});const o=(0,S.nanoid)();return this.connections[e][o]={tabId:t,apiType:r,engine:n},o}removeConnection(e,t){const r=this.connections[e];r&&(delete r[t],0===Object.keys(r).length&&delete this.connections[e])}removeAllConnections(e){const t=this.connections[e];t&&Object.keys(t).forEach(t=>{this.removeConnection(e,t)})}notifyConnections(e,t,r){const n=this.connections[e];n&&Object.values(n).forEach(e=>{r&&e.apiType!==r||e.engine&&e.engine.emit("notification",t)})}notifyAllConnections(e,t){const r="function"==typeof e?t=>e(t):()=>e;Object.keys(this.connections).forEach(e=>{Object.values(this.connections[e]).forEach(async n=>{if(!t||n.apiType===t)try{this.notifyConnection(n,await r(e))}catch(e){console.error(e)}})})}notifyConnection(e,t){try{e.engine&&e.engine.emit("notification",t)}catch(e){console.error(e)}}async _onKeyringControllerUpdate(e){const{keyrings:t}=e,r=t.reduce((e,{accounts:t})=>e.concat(t),[]).filter(Nt.isEthAddress);r.length&&this.accountTrackerController.syncWithAddresses(r)}_onUnlock(){this.unMarkPasswordForgotten(),this.emit("unlock")}_onLock(){this.emit("lock")}_onStateUpdate(e){this.isClientOpenAndUnlocked=e.isUnlocked&&this._isClientOpen,this._notifyChainChange()}_onAccountRemoved(e){this.removeAllAccountPermissions(e)}privateSendUpdate(){this.emit("update",this.getState())}isUnlocked(){return this.keyringController.state.isUnlocked}getExternalPendingTransactions(e){return this.smartTransactionsController.getTransactions({addressFrom:e,status:"pending"})}async initializeChainlist(){const e=`cachedFetch:${le.CHAIN_SPEC_URL}`,{cachedResponse:t}=await(0,ve.getStorageItem)(e)||{};t||await(0,ve.setStorageItem)(e,{cachedResponse:(0,w.rawChainData)(),cachedTime:0}),await(0,pt.initializeRpcProviderDomains)()}async getPendingNonce(e,t){const{nonceDetails:r,releaseLock:n}=await this.txController.getNonceLock(e,t),o=r.params.highestSuggested;return n(),o}async getNextNonce(e,t){const r=await this.txController.getNonceLock(e,t);return r.releaseLock(),r.nextNonce}throwTestError(e){setTimeout(()=>{const t=new Error(e);throw t.name="TestError",t})}captureTestError(e){setTimeout(()=>{const t=new Error(e);t.name="TestError",(0,se.captureException)(t)})}getTransactionMetricsRequest(){return{...{createEventFragment:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:createEventFragment"),finalizeEventFragment:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:finalizeEventFragment"),getEventFragmentById:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:getEventFragmentById"),getParticipateInMetrics:()=>this.controllerMessenger.call("MetaMetricsController:getState").participateInMetaMetrics,trackEvent:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:trackEvent"),updateEventFragment:this.controllerMessenger.call.bind(this.controllerMessenger,"MetaMetricsController:updateEventFragment"),getAccountBalance:(e,t)=>{var r;return null===(r=this.accountTrackerController.state.accountsByChainId)||void 0===r||null===(r=r[t])||void 0===r||null===(r=r[e])||void 0===r?void 0:r.balance},getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),getHardwareTypeForMetric:this.getHardwareTypeForMetric.bind(this),getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getSelectedAddress:()=>this.accountsController.getSelectedAccount().address,getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),getTransaction:e=>this.txController.state.transactions.find(t=>t.id===e),getIsSmartTransaction:e=>(0,Te.getIsSmartTransaction)(this._getMetaMaskState(),e),getSmartTransactionByMinedTxHash:e=>this.smartTransactionsController.getSmartTransactionByMinedTxHash(e),getMethodData:e=>{if(!e)return null;const{knownMethodData:t,use4ByteResolution:r}=this.preferencesController.state,n=(0,pt.addHexPrefix)(e);return(0,pt.getMethodDataName)(t,r,n,this.preferencesController.addKnownMethodData.bind(this.preferencesController),this.provider)},getIsConfirmationAdvancedDetailsOpen:()=>this.preferencesController.state.preferences.showConfirmationAdvancedDetails,getHDEntropyIndex:this.getHDEntropyIndex.bind(this),getNetworkRpcUrl:e=>{try{var t;const n=this.networkController.findNetworkClientIdByChainId(e),o=this.networkController.getNetworkConfigurationByNetworkClientId(n);if(o.rpcUrl)return o.rpcUrl;if((null===(t=o.rpcEndpoints)||void 0===t?void 0:t.length)>0){var r;const e=o.defaultRpcEndpointIndex||0;return(null===(r=o.rpcEndpoints[e])||void 0===r?void 0:r.url)||o.rpcEndpoints[0].url}return"unknown"}catch(e){return console.error("Error getting RPC URL:",e),"unknown"}}},snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]}),provider:this.provider}}updateAccountBalanceForTransactionNetwork(e){const{networkClientId:t,txParams:{from:r}}=e;this.accountTrackerController.updateAccountByAddress({address:r,networkClientId:t})}toggleExternalServices(e){this.preferencesController.toggleExternalServices(e),this.tokenListController.updatePreventPollingOnNetworkRestart(!e),e?(this.tokenDetectionController.enable(),this.gasFeeController.enableNonRPCGasFeeApis()):(this.tokenDetectionController.disable(),this.gasFeeController.disableNonRPCGasFeeApis())}async setLedgerTransportPreference(e){const t=window.navigator.hid?ce.LedgerTransportTypes.webhid:ce.LedgerTransportTypes.u2f;return null!=e&&e.updateTransportMethod?e.updateTransportMethod(t).catch(e=>{throw e}):undefined}recordFirstTimeInfo(e){if(!("firstTimeInfo"in e)){const t="13.4.0";e.firstTimeInfo={version:t,date:Date.now()}}}set isClientOpen(e){this._isClientOpen=e,this.controllerMessenger.call("SnapController:setClientActive",e)}onClientClosed(){try{this.gasFeeController.stopAllPolling(),this.currencyRateController.stopAllPolling(),this.tokenRatesController.stopAllPolling(),this.tokenDetectionController.stopAllPolling(),this.tokenListController.stopAllPolling(),this.tokenBalancesController.stopAllPolling(),this.appStateController.clearPollingTokens(),this.accountTrackerController.stopAllPolling(),this.deFiPositionsController.stopAllPolling()}catch(e){console.error(e)}}onEnvironmentTypeClosed(e){const t=me.POLLING_TOKEN_ENVIRONMENT_TYPES[e];this.appStateController.state[t].forEach(e=>{this.gasFeeController.stopPollingByPollingToken(e),this.currencyRateController.stopPollingByPollingToken(e),this.tokenRatesController.stopPollingByPollingToken(e),this.tokenDetectionController.stopPollingByPollingToken(e),this.tokenListController.stopPollingByPollingToken(e),this.tokenBalancesController.stopPollingByPollingToken(e),this.accountTrackerController.stopPollingByPollingToken(e),this.appStateController.removePollingToken(e,t)})}safelistPhishingDomain(e){return(0,pt.getPlatform)()===me.PLATFORM_FIREFOX||this.metaMetricsController.trackEvent({category:fe.MetaMetricsEventCategory.Phishing,event:fe.MetaMetricsEventName.ProceedAnywayClicked,properties:{url:e,referrer:{url:e}}},{excludeMetaMetricsId:!0}),this.phishingController.bypass(e)}async backToSafetyPhishingWarning(){this.metaMetricsController.trackEvent({category:fe.MetaMetricsEventCategory.Navigation,event:fe.MetaMetricsEventName.PortfolioLinkClicked,properties:{location:"phishing_page",text:"Back to safety"}}),await this.platform.switchToAnotherURL(undefined,"https://app.metamask.io/?metamaskEntry=phishing_page_portfolio_button")}async setLocked(e={skipSeedlessOperationLock:!1}){const{skipSeedlessOperationLock:t}=e,r=this.onboardingController.getIsSocialLoginFlow();let n;r&&!t&&(n=await this.seedlessOperationMutex.acquire());try{r&&await this.seedlessOnboardingController.setLocked(),await this.keyringController.setLocked()}catch(e){throw v.default.error("Error setting locked state",e),e}finally{n&&n()}}rejectAllPendingApprovals(){(0,$t.rejectAllApprovals)({approvalController:this.approvalController,deleteInterface:e=>this.controllerMessenger.call("SnapInterfaceController:deleteInterface",e)})}async getCode(e,t){const{provider:r}=this.networkController.getNetworkClientById(t);return await r.request({method:"eth_getCode",params:[e]})}async _onAccountChange(e){const t=(0,yt.getPermittedAccountsByOrigin)(this.permissionController.state);for(const[r,n]of t.entries())n.includes(e)&&this._notifyAccountsChange(r,n)}_notifyAccountsChange(e,t){this.notifyConnections(e,{method:yt.NOTIFICATION_NAMES.accountsChanged,params:t.length<2?t:this.getPermittedAccounts(e)},kr),this.permissionLogController.updateAccountsHistory(e,t)}async _notifyAuthorizationChange(e,t){this.notifyConnections(e,{method:X.MultichainApiNotifications.sessionChanged,params:{sessionScopes:(0,te.getSessionScopes)(t,{getNonEvmSupportedMethods:this.getNonEvmSupportedMethods.bind(this)})}},Sr)}async _notifySolanaAccountChange(e,t){this.notifyConnections(e,{method:X.MultichainApiNotifications.walletNotify,params:{scope:_e.MultichainNetworks.SOLANA,notification:{method:yt.NOTIFICATION_NAMES.accountsChanged,params:t}}},Sr)}async _notifyChainChange(){this.notifyAllConnections(async e=>({method:yt.NOTIFICATION_NAMES.chainChanged,params:await this.getProviderNetworkState({origin:e})}),kr)}async _notifyChainChangeForConnection(e,t){this.notifyConnection(e,{method:yt.NOTIFICATION_NAMES.chainChanged,params:await this.getProviderNetworkState({origin:t})})}async _onFinishedTransaction(e){if(![H.TransactionStatus.confirmed,H.TransactionStatus.failed].includes(e.status))return;const t=performance.now(),r=(0,Ae.trace)({name:Ae.TraceName.OnFinishedTransaction,startTime:performance.timeOrigin});(0,Ae.trace)({name:Ae.TraceName.OnFinishedTransaction,startTime:performance.timeOrigin,parentContext:r,data:{transactionMeta:e}}),await this._createTransactionNotifcation(e),await this._updateNFTOwnership(e),this._trackTransactionFailure(e),await this.tokenBalancesController.updateBalances({chainIds:[e.chainId]}),(0,Ae.endTrace)({name:Ae.TraceName.OnFinishedTransaction,timestamp:performance.timeOrigin+t})}async _createTransactionNotifcation(e){const{chainId:t}=e;let r={};if(t){var n,o;const e=null===(n=this.networkController.state.networkConfigurationsByChainId)||void 0===n?void 0:n[t];r={blockExplorerUrl:null==e||null===(o=e.blockExplorerUrls)||void 0===o?void 0:o[null==e?void 0:e.defaultBlockExplorerUrlIndex]}}try{await this.platform.showTransactionNotification(e,r)}catch(e){v.default.error("Failed to create transaction notification",e)}}async _updateNFTOwnership(e){var t,r;const{type:n,txParams:o,chainId:s,txReceipt:a}=e,i=this.accountsController.getSelectedAccount().address,{allNfts:l}=this.nftController.state,c=null==a?void 0:a.logs,d=n===H.TransactionType.contractInteraction&&c,u=(n===H.TransactionType.tokenMethodTransferFrom||n===H.TransactionType.tokenMethodSafeTransferFrom)&&o!==undefined;if(!d&&!u)return;const h=null===(t=this.networkController)||void 0===t||null===(t=t.state)||void 0===t||null===(t=t.networkConfigurationsByChainId)||void 0===t||null===(t=t[s])||void 0===t||null===(t=t.rpcEndpoints[null===(r=this.networkController)||void 0===r||null===(r=r.state)||void 0===r||null===(r=r.networkConfigurationsByChainId)||void 0===r||null===(r=r[s])||void 0===r?void 0:r.defaultRpcEndpointIndex])||void 0===t?void 0:t.networkClientId;if(u){var p;const{data:e,to:t,from:r}=o,n=(0,be.parseStandardTokenTransactionData)(e),a=(0,ye.getTokenIdParam)(n)??(0,ke.getTokenValueParam)(n),i=null==l||null===(p=l[r])||void 0===p||null===(p=p[s])||void 0===p?void 0:p.find(({address:e,tokenId:r})=>(0,Ce.isEqualCaseInsensitive)(e,t)&&r===a);i&&this.nftController.checkAndUpdateSingleNftOwnershipStatus(i,!1,h,{userAddress:r})}else{const e=c.map(e=>{const t=e.topics&&e.topics[0]===Me.TRANSFER_SINFLE_LOG_TOPIC_HASH,r=e.topics&&e.topics[0]===Me.TOKEN_TRANSFER_LOG_TOPIC_HASH;let n;return t&&(n=e.topics&&e.topics[3]&&e.topics[3].match(null==i?void 0:i.slice(2))),r&&(n=e.topics&&e.topics[2]&&e.topics[2].match(null==i?void 0:i.slice(2))),{isERC1155NftTransfer:t,isERC721NftTransfer:r,isTransferToSelectedAddress:n,...e}});if(0!==e.length){const t=[];e.forEach(e=>{if(e.isTransferToSelectedAddress&&(e.isERC1155NftTransfer||e.isERC721NftTransfer)){let r;r=e.isERC1155NftTransfer?new W.Interface(z.abiERC1155):new W.Interface(z.abiERC721);try{const n=r.parseLog({data:e.data,topics:e.topics});t.push({contract:e.address,...n})}catch(e){}}});const r=[],n=[];t.forEach(e=>{var t;const o=(0,ye.getTokenIdParam)(e),a=null==l||null===(t=l[i])||void 0===t||null===(t=t[s])||void 0===t?void 0:t.find(({address:t,tokenId:r})=>(0,Ce.isEqualCaseInsensitive)(t,e.contract)&&r===o);a?r.push(a):n.push({tokenId:o,...e})});const o=r.map(async e=>this.nftController.checkAndUpdateSingleNftOwnershipStatus(e,!1,h,{selectedAddress:i}));await Promise.allSettled(o);const a=n.map(async e=>this.nftController.addNft(e.contract,e.tokenId,h));await Promise.allSettled(a)}}}_trackTransactionFailure(e){var t,r;const{txReceipt:n}=e,o=this.getState(),{allTokens:s}=this.tokensController.state,a=this.accountsController.getSelectedAccount(),i=(null==s||null===(t=s[e.chainId])||void 0===t?void 0:t[a.address])||[];n&&"0x0"===n.status&&this.metaMetricsController.trackEvent({event:"Tx Status Update: On-Chain Failure",category:fe.MetaMetricsEventCategory.Background,properties:{action:"Transactions",errorMessage:null===(r=e.simulationFails)||void 0===r?void 0:r.reason,numberOfTokens:i.length,numberOfAccounts:Object.keys(o.accounts).length}},{matomoEvent:!0})}_onUserOperationAdded(e){const t=this.txController.state.transactions.find(t=>t.id===e.id);t&&(t.type===H.TransactionType.swap?this.controllerMessenger.publish("TransactionController:transactionNewSwap",{transactionMeta:t}):t.type===H.TransactionType.swapApproval&&this.controllerMessenger.publish("TransactionController:transactionNewSwapApproval",{transactionMeta:t}))}_onUserOperationTransactionUpdated(e){const t={...e,txParams:{...e.txParams,from:this.accountsController.getSelectedAccount().address}};this.txController.state.transactions.some(e=>e.id===t.id)||this.txController.update(e=>{e.transactions.push(t)}),this.txController.updateTransaction(t,"Generated from user operation"),this.controllerMessenger.publish("TransactionController:transactionStatusUpdated",{transactionMeta:t})}_getMetaMaskState(){return{metamask:this.getState()}}_getConfigForRemoteFeatureFlagRequest(){return{distribution:Tr.main||B.DistributionType.Main,environment:Pr.production||B.EnvironmentType.Development}}}async function Ar(e,t){var r,n,o,s,a;const i=null===(r=this.opts.overrides)||void 0===r?void 0:r.keyrings;let l=null;switch(e.name){case ce.HardwareDeviceNames.trezor:l=(null==i||null===(n=i.trezor)||void 0===n?void 0:n.type)||y.TrezorKeyring.type;break;case ce.HardwareDeviceNames.oneKey:l=(null==i||null===(o=i.oneKey)||void 0===o?void 0:o.type)||(null===y.OneKeyKeyring||void 0===y.OneKeyKeyring?void 0:y.OneKeyKeyring.type);break;case ce.HardwareDeviceNames.ledger:l=(null==i||null===(s=i.ledger)||void 0===s?void 0:s.type)||C.LedgerKeyring.type;break;case ce.HardwareDeviceNames.qr:l=k.QrKeyring.type;break;case ce.HardwareDeviceNames.lattice:l=(null==i||null===(a=i.lattice)||void 0===a?void 0:a.type)||b.default.type;break;default:throw new Error("MetamaskController:#withKeyringForDevice - Unknown device")}return this.keyringController.withKeyring({type:l},async({keyring:r})=>{if(e.hdPath&&r.setHdPath&&r.setHdPath(e.hdPath),e.name===ce.HardwareDeviceNames.lattice&&(r.appName="MetaMask"),e.name===ce.HardwareDeviceNames.ledger&&await this.setLedgerTransportPreference(r),e.name===ce.HardwareDeviceNames.trezor||e.name===ce.HardwareDeviceNames.oneKey){const e=r.getModel();this.appStateController.setTrezorModel(e)}return r.network=(0,Ee.getProviderConfig)({metamask:this.networkController.state}).type,await t(r)},{createIfMissing:!0})}function Or(){const e=wr(Mr,this,jr).call(this);return this.networkController.getNetworkClientById(e).configuration.chainId}function jr(){return this.networkController.state.selectedNetworkClientId}function _r({existingControllers:e,initFunctions:t,initState:r}){const n={extension:this.extension,getCronjobControllerStorageManager:()=>this.opts.cronjobControllerStorageManager,getFlatState:this.getState.bind(this),getGlobalChainId:wr(Mr,this,Or).bind(this),getGlobalNetworkClientId:wr(Mr,this,jr).bind(this),getPermittedAccounts:this.getPermittedAccounts.bind(this),getProvider:()=>this.provider,getStateUI:this._getMetaMaskState.bind(this),getTransactionMetricsRequest:this.getTransactionMetricsRequest.bind(this),updateAccountBalanceForTransactionNetwork:this.updateAccountBalanceForTransactionNetwork.bind(this),offscreenPromise:this.offscreenPromise,preinstalledSnaps:this.opts.preinstalledSnaps,persistedState:r,removeAllConnections:this.removeAllConnections.bind(this),setupUntrustedCommunicationEip1193:this.setupUntrustedCommunicationEip1193.bind(this),showNotification:this.platform._showNotification,getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),getHardwareTypeForMetric:this.getHardwareTypeForMetric.bind(this),trace:Ae.trace};return(0,Ht.initControllers)({baseControllerMessenger:this.controllerMessenger,existingControllers:e,initFunctions:t,initRequest:n})}r.default=Er}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/metamask-controller.js"}],[239,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:2,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=2;try{"etherscan"===t.data.config.provider.type&&(t.data.config.provider.type="rpc",t.data.config.provider.rpcTarget="https://rpc.metamask.io/")}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/002.js"}],[24,{"../../controllers/institutional-snap/InstitutionalSnapController":111},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.InstitutionalSnapControllerInit=void 0;var n=e("../../controllers/institutional-snap/InstitutionalSnapController");r.InstitutionalSnapControllerInit=e=>({controller:new n.InstitutionalSnapController({messenger:e.controllerMessenger})})}}},{package:"$root$",file:"app/scripts/controller-init/institutional-snap/institutional-snap-controller-init.ts"}],[240,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:3,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=3;try{"https://rawtestrpc.metamask.io/"===t.data.config.provider.rpcTarget&&(t.data.config.provider.rpcTarget="https://testrpc.metamask.io/")}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/003.js"}],[241,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:4,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=4;try{if("rpc"!==t.data.config.provider.type)return Promise.resolve(t);switch(t.data.config.provider.rpcTarget){case"https://testrpc.metamask.io/":t.data.config.provider={type:"testnet"};break;case"https://rpc.metamask.io/":t.data.config.provider={type:"mainnet"}}}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/004.js"}],[242,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:5,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=5;try{const e=function(e){const{config:t}=e,r={...e,KeyringController:{vault:e.vault,selectedAccount:t.selectedAccount,walletNicknames:e.walletNicknames}};return delete r.vault,delete r.walletNicknames,delete r.config.selectedAccount,r}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #5${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/005.js"}],[243,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:6,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=6;try{const e=function(e){const t=e.KeyringController,r={...e,PreferencesController:{selectedAddress:t.selectedAccount}};return delete r.KeyringController.selectedAccount,r}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #6${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/006.js"}],[244,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:7,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=7;try{const e=function(e){const t={...e,TransactionManager:{transactions:e.transactions||[],gasMultiplier:e.gasMultiplier||1}};return delete t.transactions,delete t.gasMultiplier,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #7${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/007.js"}],[245,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:8,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=8;try{const e=function(e){const t={...e,NoticeController:{noticesList:e.noticesList||[]}};return delete t.noticesList,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #8${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/008.js"}],[246,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:9,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=9;try{const e=function(e){const t=(0,n.merge)({},e,{CurrencyController:{currentCurrency:e.currentFiat||e.fiatCurrency||"USD",conversionRate:e.conversionRate,conversionDate:e.conversionDate}});return delete t.currentFiat,delete t.fiatCurrency,delete t.conversionRate,delete t.conversionDate,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #9${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/009.js"}],[247,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:10,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=10;try{const e=function(e){const t=(0,n.merge)({},e,{ShapeShiftController:{shapeShiftTxList:e.shapeShiftTxList||[]}});return delete t.shapeShiftTxList,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #10${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/010.js"}],[248,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:11,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=11;try{const e=function(e){const t=e;return delete t.TOSHash,delete t.isDisclaimerConfirmed,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #11${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/011.js"}],[249,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:12,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=12;try{const e=function(e){const t=e;return t.NoticeController.noticesList.forEach(e=>{e.read&&(e.body="")}),t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #12${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/012.js"}],[25,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){return e.getRestricted({name:"AccountTreeController",allowedEvents:["AccountsController:accountAdded","AccountsController:accountRemoved","AccountsController:selectedAccountChange"],allowedActions:["AccountsController:listMultichainAccounts","AccountsController:getAccount","AccountsController:getSelectedAccount","AccountsController:setSelectedAccount","SnapController:get","KeyringController:getState"]})}Object.defineProperty(r,"__esModule",{value:!0}),r.getAccountTreeControllerInitMessenger=function(e){return n(e)},r.getAccountTreeControllerMessenger=n}}},{package:"$root$",file:"app/scripts/controller-init/messengers/accounts/account-tree-controller-messenger.ts"}],[250,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:13,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=13;try{const e=function(e){const t=e,{config:r}=t;r&&r.provider&&"testnet"===r.provider.type&&(t.config.provider.type="ropsten");return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #13${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/013.js"}],[251,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:14,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=14;try{const e=function(e){const t=e;return t.NetworkController={},t.NetworkController.provider=t.config.provider,delete t.config.provider,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #14${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/014.js"}],[252,{"@metamask/transaction-controller":2587,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/transaction-controller"),o=e("lodash");r.default={version:15,migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=15;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=r;t.TransactionController.transactions=e.map(e=>e.err?("Gave up submitting tx."===e.err.message&&(e.status=n.TransactionStatus.failed),e):e)}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #15${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/015.js"}],[253,{"@metamask/transaction-controller":2587,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/transaction-controller"),o=e("lodash");r.default={version:16,migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=16;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map(e=>e.err?("transaction with the same hash was already imported."===e.err&&(e.status=n.TransactionStatus.submitted,delete e.err),e):e)}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #16${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/016.js"}],[254,{"@metamask/transaction-controller":2587,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/transaction-controller"),o=e("lodash");r.default={version:17,migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=17;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map(e=>(!e.status===n.TransactionStatus.failed||e.retryCount>0&&e.retryCount<2&&(e.status=n.TransactionStatus.submitted,delete e.err),e))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #17${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/017.js"}],[255,{"fast-json-patch":3937,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=(n=e("fast-json-patch"))&&n.__esModule?n:{default:n},s=e("lodash");r.default={version:18,migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=18;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map(e=>{if(!e.history||0===e.history.length){const t=function(e){const t={...e};return delete t.history,(0,s.cloneDeep)(t)}(e);return e.history=[t],e}const t=(r=e.history,r.map((e,t)=>0===t?e:function(e,t,r){const n=o.default.compare(e,t);return n[0]&&(r&&(n[0].note=r),n[0].timestamp=Date.now()),n}(r[t-1],e))).filter(e=>!Array.isArray(e)||e.length>0);var r;return e.history=t,e})}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #18${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/018.js"}],[256,{"@metamask/transaction-controller":2587,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/transaction-controller"),o=e("lodash");r.default={version:19,migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=19;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e,t,r)=>{if(e.status!==n.TransactionStatus.submitted)return e;const o=function(e){const t=e.map(e=>{const{nonce:t}=e.txParams;return parseInt(t||"0x0",16)});return Math.max.apply(null,t)}(r.filter(e=>e.status===n.TransactionStatus.confirmed).filter(t=>t.txParams.from===e.txParams.from).filter(t=>t.metamaskNetworkId.from===e.metamaskNetworkId.from)),s=function(e,t){const r=e.map(e=>{const{nonce:t}=e.txParams;return parseInt(t,16)});let n=t;for(;r.includes(n);)n+=1;return n}(r.filter(e=>e.status===n.TransactionStatus.submitted).filter(t=>t.txParams.from===e.txParams.from).filter(t=>t.metamaskNetworkId.from===e.metamaskNetworkId.from),o),a=Math.max(s,o);return parseInt(e.txParams.nonce,16)>a+1&&(e.status=n.TransactionStatus.failed,e.err={message:"nonce too high",note:"migration 019 custom error"}),e})}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #19${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/019.js"}],[257,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:20,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=20;try{const e=function(e){const t=e;"metamask"in t&&!("firstTimeInfo"in t.metamask)&&(t.metamask.firstTimeInfo={version:"3.12.0",date:Date.now()});return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #20${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/020.js"}],[258,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:21,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=21;try{const e=function(e){const t=e;return delete t.BlacklistController,delete t.RecentBlocks,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #21${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/021.js"}],[259,{"@metamask/transaction-controller":2587,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/transaction-controller"),o=e("lodash");r.default={version:22,migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=22;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map(e=>(e.status!==n.TransactionStatus.submitted||e.submittedTime||(e.submittedTime=(new Date).getTime()),e))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #22${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/022.js"}],[26,{"./account-tree-controller-messenger":25,"./institutional-snap-controller-messenger":27,"./multichain-account-service-messenger":28},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getAccountTreeControllerInitMessenger",{enumerable:!0,get:function(){return n.getAccountTreeControllerInitMessenger}}),Object.defineProperty(r,"getAccountTreeControllerMessenger",{enumerable:!0,get:function(){return n.getAccountTreeControllerMessenger}}),Object.defineProperty(r,"getInstitutionalSnapControllerMessenger",{enumerable:!0,get:function(){return s.getInstitutionalSnapControllerMessenger}}),Object.defineProperty(r,"getMultichainAccountServiceInitMessenger",{enumerable:!0,get:function(){return o.getMultichainAccountServiceInitMessenger}}),Object.defineProperty(r,"getMultichainAccountServiceMessenger",{enumerable:!0,get:function(){return o.getMultichainAccountServiceMessenger}});var n=e("./account-tree-controller-messenger"),o=e("./multichain-account-service-messenger"),s=e("./institutional-snap-controller-messenger")}}},{package:"$root$",file:"app/scripts/controller-init/messengers/accounts/index.ts"}],[260,{"@metamask/transaction-controller":2587,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("@metamask/transaction-controller");r.default={version:23,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=23;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;if(e.length<=40)return t;const r=e.reverse();let n=!0;for(;r.length>40&&n;){const e=r.findIndex(e=>e.status===o.TransactionStatus.failed||e.status===o.TransactionStatus.rejected||e.status===o.TransactionStatus.confirmed||e.status===o.TransactionStatus.dropped);e<0?n=!1:r.splice(e,1)}t.TransactionController.transactions=r.reverse()}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #23${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/023.js"}],[2609,{"./constants.cjs":2610,"./helpers/Bundler.cjs":2611,"./helpers/PendingUserOperationTracker.cjs":2612,"./helpers/SnapSmartContractAccount.cjs":2613,"./logger.cjs":2615,"./types.cjs":2616,"./utils/gas-fees.cjs":2618,"./utils/gas.cjs":2619,"./utils/transaction.cjs":2620,"./utils/validation.cjs":2621,"@metamask/base-controller":1140,"@metamask/controller-utils":1224,"@metamask/eth-query":1756,"@metamask/rpc-errors":2224,"@metamask/transaction-controller":2587,"@metamask/utils":2632,events:3902,lodash:4362,uuid:5195},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,o,s,a,i,l,c,d,u,h,p,m,f,g,v,y,C,b,w,k,S,P,T,M,E=this&&this.__classPrivateFieldSet||function(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r},A=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},O=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.UserOperationController=void 0;const j=e("@metamask/base-controller"),_=e("@metamask/controller-utils"),I=O(e("@metamask/eth-query")),N=e("@metamask/rpc-errors"),R=e("@metamask/transaction-controller"),D=e("@metamask/utils"),F=O(e("events")),x=e("lodash"),L=e("uuid"),$=e("./constants.cjs"),B=e("./helpers/Bundler.cjs"),U=e("./helpers/PendingUserOperationTracker.cjs"),K=e("./helpers/SnapSmartContractAccount.cjs"),G=e("./logger.cjs"),q=e("./types.cjs"),V=e("./utils/gas.cjs"),H=e("./utils/gas-fees.cjs"),W=e("./utils/transaction.cjs"),z=e("./utils/validation.cjs"),Y={userOperations:{persist:!0,anonymous:!1}};class Q extends j.BaseController{constructor({entrypoint:e,getGasFeeEstimates:t,messenger:r,state:i}){super({name:"UserOperationController",metadata:Y,messenger:r,state:{userOperations:{},...i}}),n.add(this),o.set(this,void 0),s.set(this,void 0),a.set(this,void 0),this.hub=new F.default,E(this,o,e,"f"),E(this,s,t,"f"),E(this,a,new U.PendingUserOperationTracker({getUserOperations:()=>(0,x.cloneDeep)(Object.values(this.state.userOperations)),messenger:r}),"f"),A(this,n,"m",w).call(this)}async addUserOperation(e,t){return(0,z.validateAddUserOperationRequest)(e),(0,z.validateAddUserOperationOptions)(t),await A(this,n,"m",i).call(this,e,t)}async addUserOperationFromTransaction(e,t){(0,z.validateAddUserOperationOptions)(t);const{data:r,from:o,maxFeePerGas:s,maxPriorityFeePerGas:a,to:l,value:c}=e,d={data:""===r?undefined:r,from:o,maxFeePerGas:s,maxPriorityFeePerGas:a,to:l,value:c};return(0,z.validateAddUserOperationRequest)(d),await A(this,n,"m",i).call(this,d,{...t,transaction:e})}startPollingByNetworkClientId(e){return A(this,a,"f").startPolling({networkClientId:e})}}r.UserOperationController=Q,o=new WeakMap,s=new WeakMap,a=new WeakMap,n=new WeakSet,i=async function(e,t){(0,G.projectLogger)("Adding user operation",{request:e,options:t});const{networkClientId:r,origin:o,smartContractAccount:s,swaps:a,transaction:i}=t,{chainId:u,provider:h}=await A(this,n,"m",P).call(this,r),p=await A(this,n,"m",d).call(this,u,o,i,a),m=s??new K.SnapSmartContractAccount(this.messagingSystem),f={chainId:u,metadata:p,options:{...t,smartContractAccount:m},provider:h,request:e,transaction:i},{id:v}=p;let y=!1;const C=(async()=>{try{return await A(this,n,"m",l).call(this,f)}catch(e){if(A(this,n,"m",g).call(this,p,e),y)throw e;return undefined}})(),b=async()=>(y=!0,await C);return{id:v,hash:b,transactionHash:async()=>{await b();const{transactionHash:e}=await A(this,n,"m",c).call(this,p);return e}}},l=async function(e){const{metadata:t,options:r}=e,{requireApproval:o,smartContractAccount:s}=r;let a;try{return await A(this,n,"m",u).call(this,e),await A(this,n,"m",h).call(this,t,s),this.hub.emit("user-operation-added",t),!1!==o&&(a=await A(this,n,"m",p).call(this,e)),await A(this,n,"m",m).call(this,t,s),await A(this,n,"m",f).call(this,t),a?.success(),t.hash}catch(e){throw a?.error(e),e}},c=async function(e){const{id:t,hash:r}=e;return(0,G.projectLogger)("Waiting for confirmation",t,r),new Promise((e,r)=>{this.hub.once(`${t}:confirmed`,t=>{e(t)}),this.hub.once(`${t}:failed`,(e,t)=>{r(t)})})},d=async function(e,t,r,o){const s={actualGasCost:null,actualGasUsed:null,baseFeePerGas:null,bundlerUrl:null,chainId:e,error:null,hash:null,id:(0,L.v1)(),origin:t,status:q.UserOperationStatus.Unapproved,swapsMetadata:o?{approvalTxId:o.approvalTxId??null,destinationTokenAddress:o.destinationTokenAddress??null,destinationTokenAmount:o.destinationTokenAmount??null,destinationTokenDecimals:o.destinationTokenDecimals??null,destinationTokenSymbol:o.destinationTokenSymbol??null,estimatedBaseFee:o.estimatedBaseFee??null,sourceTokenAddress:o.sourceTokenAddress??null,sourceTokenAmount:o.sourceTokenAmount??null,sourceTokenDecimals:o.sourceTokenDecimals??null,sourceTokenSymbol:o.sourceTokenSymbol??null,swapAndSendRecipient:o.swapAndSendRecipient??null,swapMetaData:o.swapMetaData??null,swapTokenValue:o.swapTokenValue??null}:null,time:Date.now(),transactionHash:null,transactionParams:r??null,transactionType:null,userFeeLevel:null,userOperation:A(this,n,"m",v).call(this,r)};return A(this,n,"m",y).call(this,s),(0,G.projectLogger)("Added user operation",s.id),s},u=async function(e){const{chainId:t,metadata:r,options:a,provider:i,request:l,transaction:c}=e,{data:d,from:u,to:h,value:p}=l,{id:m,transactionParams:f,userOperation:g}=r,{smartContractAccount:v}=a;(0,G.projectLogger)("Preparing user operation",{id:m});const C=await A(this,n,"m",S).call(this,c,i,a);r.transactionType=C??null,(0,G.projectLogger)("Determined transaction type",C),await(0,H.updateGasFees)({getGasFeeEstimates:A(this,s,"f"),metadata:r,originalRequest:l,provider:i,transaction:f??undefined});const b=await v.prepareUserOperation({chainId:t,data:d,from:u,to:h,value:p});(0,z.validatePrepareUserOperationResponse)(b);const{bundler:w,callData:k,dummyPaymasterAndData:P,dummySignature:T,initCode:M,nonce:E,sender:O}=b;g.callData=k,g.initCode=M??$.EMPTY_BYTES,g.nonce=E,g.paymasterAndData=P??$.EMPTY_BYTES,g.sender=O,g.signature=T??$.EMPTY_BYTES,r.bundlerUrl=w,await(0,V.updateGas)(r,b,A(this,o,"f")),A(this,n,"m",y).call(this,r)},h=async function(e,t){const{id:r,userOperation:o,chainId:s}=e;(0,G.projectLogger)("Requesting paymaster data",{id:r});const a=await t.updateUserOperation({userOperation:o,chainId:s});(0,z.validateUpdateUserOperationResponse)(a),o.paymasterAndData=a.paymasterAndData??$.EMPTY_BYTES,a.callGasLimit&&(o.callGasLimit=a.callGasLimit),a.preVerificationGas&&(o.preVerificationGas=a.preVerificationGas),a.verificationGasLimit&&(o.verificationGasLimit=a.verificationGasLimit),A(this,n,"m",y).call(this,e)},p=async function(e){(0,G.projectLogger)("Requesting approval");const{metadata:t}=e,{resultCallbacks:r,value:o}=await A(this,n,"m",k).call(this,t),s=o?.txMeta;return s&&await A(this,n,"m",T).call(this,e,s),t.status=q.UserOperationStatus.Approved,A(this,n,"m",y).call(this,t),r},m=async function(e,t){const{id:r,chainId:o,userOperation:s}=e;(0,G.projectLogger)("Signing user operation",r,s);const a=await t.signUserOperation({userOperation:s,chainId:o});(0,z.validateSignUserOperationResponse)(a);const{signature:i}=a;s.signature=i,(0,G.projectLogger)("Signed user operation",i),e.status=q.UserOperationStatus.Signed,A(this,n,"m",y).call(this,e)},f=async function(e){const{userOperation:t}=e;(0,G.projectLogger)("Submitting user operation",t);const r=new B.Bundler(e.bundlerUrl),s=await r.sendUserOperation(t,A(this,o,"f"));e.hash=s,e.status=q.UserOperationStatus.Submitted,A(this,n,"m",y).call(this,e)},g=function(e,t){const{id:r}=e,o=t;(0,G.projectLogger)("User operation failed",r,t),e.error={name:o.name,message:o.message,stack:o.stack,code:o.code,rpc:o.value},e.status=q.UserOperationStatus.Failed,A(this,n,"m",y).call(this,e),String(o.code)===String(N.errorCodes.provider.userRejectedRequest)&&A(this,n,"m",C).call(this,r)},v=function(e){return{callData:$.EMPTY_BYTES,callGasLimit:$.EMPTY_BYTES,initCode:$.EMPTY_BYTES,maxFeePerGas:e?.maxFeePerGas??$.EMPTY_BYTES,maxPriorityFeePerGas:e?.maxPriorityFeePerGas??$.EMPTY_BYTES,nonce:$.EMPTY_BYTES,paymasterAndData:$.EMPTY_BYTES,preVerificationGas:$.EMPTY_BYTES,sender:$.ADDRESS_ZERO,signature:$.EMPTY_BYTES,verificationGasLimit:$.EMPTY_BYTES}},y=function(e){const{id:t}=e;this.update(r=>{r.userOperations[t]=(0,x.cloneDeep)(e)}),A(this,n,"m",b).call(this,e)},C=function(e){this.update(t=>{delete t.userOperations[e]})},b=function(e){if(!e.transactionParams)return;const t=(0,W.getTransactionMetadata)(e);this.hub.emit("transaction-updated",t)},w=function(){A(this,a,"f").hub.on("user-operation-confirmed",e=>{(0,G.projectLogger)("In listener..."),this.hub.emit("user-operation-confirmed",e),this.hub.emit(`${e.id}:confirmed`,e)}),A(this,a,"f").hub.on("user-operation-failed",(e,t)=>{this.hub.emit("user-operation-failed",e,t),this.hub.emit(`${e.id}:failed`,e,t)}),A(this,a,"f").hub.on("user-operation-updated",e=>{A(this,n,"m",y).call(this,e)})},k=async function(e){const{id:t,origin:r}=e,n=_.ApprovalType.Transaction,o={txId:t};return await this.messagingSystem.call("ApprovalController:addRequest",{id:t,origin:r,type:n,requestData:o,expectsResult:!0},!0)},S=async function(e,t,r){if(!e)return undefined;if(r.type)return r.type;const n=new I.default(t),o=(0,R.determineTransactionType)(e,n);return(await o).type},P=async function(e){const{provider:t,configuration:r}=this.messagingSystem.call("NetworkController:getNetworkClientById",e),{chainId:n}=r;return{provider:t,chainId:n}},T=async function(e,t){(0,G.projectLogger)("Found updated transaction in approval",{updatedTransaction:t});const{metadata:r,request:o}=e,{userOperation:s}=r,a=s.paymasterAndData!==$.EMPTY_BYTES,i=(0,D.add0x)(t.txParams.maxFeePerGas),l=(0,D.add0x)(t.txParams.maxPriorityFeePerGas);let c=!1;const d=s.maxFeePerGas,u=s.maxPriorityFeePerGas,h=d!==i||u!==l,p=a&&i===$.VALUE_ZERO&&l===$.VALUE_ZERO;h&&!p&&((0,G.projectLogger)("Gas fees updated during approval",{previousMaxFeePerGas:d,previousMaxPriorityFeePerGas:u,updatedMaxFeePerGas:i,updatedMaxPriorityFeePerGas:l}),s.maxFeePerGas=i,s.maxPriorityFeePerGas=l,c=a);const m=o.data??$.EMPTY_BYTES,f=t.txParams.data??$.EMPTY_BYTES;m!==f&&((0,G.projectLogger)("Data updated during approval",{previousData:m,updatedData:f}),c=!0);const g=o.value??$.VALUE_ZERO,v=t.txParams.value??$.VALUE_ZERO;if(g!==v&&((0,G.projectLogger)("Value updated during approval",{previousValue:g,updatedValue:v}),c=!0),c){const t={...o,data:f,maxFeePerGas:i,maxPriorityFeePerGas:l,value:v};await A(this,n,"m",M).call(this,{...e,request:t})}},M=async function(e){(0,G.projectLogger)("Regenerating user operation as parameters were updated during approval");const{options:{smartContractAccount:t},metadata:r}=e;await A(this,n,"m",u).call(this,e),await A(this,n,"m",h).call(this,r,t),(0,G.projectLogger)("Regenerated user operation",r.userOperation)}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/UserOperationController.cjs"}],[261,{"@metamask/transaction-controller":2587,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("@metamask/transaction-controller");r.default={version:24,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=24;const r=function(e){const t=e;if(!t.TransactionController)return t;const{transactions:r}=t.TransactionController;return t.TransactionController.transactions=r.map((e,t)=>(e.status===o.TransactionStatus.unapproved&&e.txParams&&e.txParams.from&&(e.txParams.from=e.txParams.from.toLowerCase()),e)),t}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/024.js"}],[2610,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.VALUE_ZERO=r.ADDRESS_ZERO=r.EMPTY_BYTES=void 0,r.EMPTY_BYTES="0x",r.ADDRESS_ZERO="0x0000000000000000000000000000000000000000",r.VALUE_ZERO="0x0"}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/constants.cjs"}],[2611,{"../logger.cjs":2615},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,o,s,a=this&&this.__classPrivateFieldSet||function(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r},i=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.Bundler=void 0;const l=e("../logger.cjs"),c=(0,l.createModuleLogger)(l.projectLogger,"bundler");r.Bundler=class{constructor(e){n.add(this),o.set(this,void 0),a(this,o,e,"f")}async estimateUserOperationGas(e,t){c("Estimating gas",{url:i(this,o,"f"),userOperation:e,entrypoint:t});const r=await i(this,n,"m",s).call(this,"eth_estimateUserOperationGas",[e,t]);return c("Estimated gas",{response:r}),r}async getUserOperationReceipt(e){return c("Getting user operation receipt",{url:i(this,o,"f"),hash:e}),await i(this,n,"m",s).call(this,"eth_getUserOperationReceipt",[e])}async sendUserOperation(e,t){c("Sending user operation",{url:i(this,o,"f"),userOperation:e,entrypoint:t});const r=await i(this,n,"m",s).call(this,"eth_sendUserOperation",[e,t]);return c("Sent user operation",r),r}},o=new WeakMap,n=new WeakSet,s=async function(e,t){const r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:1,method:e,params:t})},n=await fetch(i(this,o,"f"),r),s=await n.json();if(s.error){const e=new Error(s.error.message||s.error);throw e.code=s.error.code,e}return s.result}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/helpers/Bundler.cjs"}],[2612,{"../logger.cjs":2615,"../types.cjs":2616,"./Bundler.cjs":2611,"@metamask/controller-utils":1224,"@metamask/eth-query":1756,"@metamask/polling-controller":2109,"@metamask/utils":2632,events:3902},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,o,s,a,i,l,c,d,u,h,p,m=this&&this.__classPrivateFieldSet||function(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r},f=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},g=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.PendingUserOperationTracker=void 0;const v=e("@metamask/controller-utils"),y=g(e("@metamask/eth-query")),C=e("@metamask/polling-controller"),b=e("@metamask/utils"),w=g(e("events")),k=e("../logger.cjs"),S=e("../types.cjs"),P=e("./Bundler.cjs"),T=(0,b.createModuleLogger)(k.projectLogger,"pending-user-operations");class M extends((0,C.BlockTrackerPollingControllerOnly)()){constructor({getUserOperations:e,messenger:t}){super(),n.add(this),o.set(this,void 0),s.set(this,void 0),this.hub=new w.default,m(this,o,e,"f"),m(this,s,t,"f")}async _executePoll({networkClientId:e}){try{const{blockTracker:t,configuration:r,provider:o}=this._getNetworkClientById(e);T("Polling",{blockNumber:t.getCurrentBlock(),chainId:r.chainId}),await f(this,n,"m",a).call(this,r.chainId,o)}catch(e){T("Failed to check user operations",e)}}_getNetworkClientById(e){return f(this,s,"f").call("NetworkController:getNetworkClientById",e)}}r.PendingUserOperationTracker=M,o=new WeakMap,s=new WeakMap,n=new WeakSet,a=async function(e,t){const r=f(this,n,"m",d).call(this).filter(t=>t.chainId===e);r.length?(T("Found pending user operations to check",{count:r.length,ids:r.map(e=>e.id)}),await Promise.all(r.map(e=>f(this,n,"m",i).call(this,e,t)))):T("No pending user operations to check")},i=async function(e,t){const{bundlerUrl:r,hash:o,id:s}=e;if(o&&r)try{const a=await f(this,n,"m",h).call(this,o,r),i=a?.success;if(a&&!i)return void f(this,n,"m",c).call(this,e,a);if(i)return void await f(this,n,"m",l).call(this,e,a,t);T("No receipt found for user operation",{id:s,hash:o})}catch(e){T("Failed to check user operation",s,e)}else T("Skipping user operation as missing hash or bundler",s)},l=async function(e,t,r){const{id:o}=e,{actualGasCost:s,actualGasUsed:a,receipt:{blockHash:i,transactionHash:l}}=t;T("User operation confirmed",o,l);const{baseFeePerGas:c}=await(0,v.query)(new y.default(r),"getBlockByHash",[i,!1]);e.actualGasCost=f(this,n,"m",p).call(this,s),e.actualGasUsed=f(this,n,"m",p).call(this,a),e.baseFeePerGas=c,e.status=S.UserOperationStatus.Confirmed,e.transactionHash=l,f(this,n,"m",u).call(this,e),this.hub.emit("user-operation-confirmed",e)},c=function(e,t){const{id:r}=e;T("User operation failed",r),e.status=S.UserOperationStatus.Failed,f(this,n,"m",u).call(this,e),this.hub.emit("user-operation-failed",e,new Error("User operation receipt has failed status"))},d=function(){return f(this,o,"f").call(this).filter(e=>e.status===S.UserOperationStatus.Submitted)},u=function(e){this.hub.emit("user-operation-updated",e)},h=async function(e,t){return new P.Bundler(t).getUserOperationReceipt(e)},p=function(e){return"number"==typeof e?(0,v.toHex)(e):e}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/helpers/PendingUserOperationTracker.cjs"}],[2613,{"../constants.cjs":2610,"../utils/chain-id.cjs":2617},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,o=this&&this.__classPrivateFieldSet||function(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r},s=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.SnapSmartContractAccount=void 0;const a=e("../constants.cjs"),i=e("../utils/chain-id.cjs");r.SnapSmartContractAccount=class{constructor(e){n.set(this,void 0),o(this,n,e,"f")}async prepareUserOperation(e){const{chainId:t,data:r,from:o,to:l,value:c}=e,d=r??a.EMPTY_BYTES,u=l??a.ADDRESS_ZERO,h=c??a.VALUE_ZERO,p=await s(this,n,"f").call("KeyringController:prepareUserOperation",o,[{data:d,to:u,value:h}],{chainId:(0,i.toEip155ChainId)(t)}),{bundlerUrl:m,callData:f,dummyPaymasterAndData:g,dummySignature:v,gasLimits:y,initCode:C,nonce:b}=p;return{bundler:m,callData:f,dummyPaymasterAndData:g,dummySignature:v,gas:y,initCode:C,nonce:b,sender:o}}async updateUserOperation(e){const{userOperation:t,chainId:r}=e,{sender:o}=t,{paymasterAndData:l,verificationGasLimit:c,preVerificationGas:d,callGasLimit:u}=await s(this,n,"f").call("KeyringController:patchUserOperation",o,t,{chainId:(0,i.toEip155ChainId)(r)});return{paymasterAndData:l===a.EMPTY_BYTES?undefined:l,verificationGasLimit:c,preVerificationGas:d,callGasLimit:u}}async signUserOperation(e){const{userOperation:t,chainId:r}=e,{sender:o}=t;return{signature:await s(this,n,"f").call("KeyringController:signUserOperation",o,t,{chainId:(0,i.toEip155ChainId)(r)})}}},n=new WeakMap}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/helpers/SnapSmartContractAccount.cjs"}],[2614,{"./UserOperationController.cjs":2609,"./types.cjs":2616},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),o(e("./UserOperationController.cjs"),r),o(e("./types.cjs"),r)}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/index.cjs"}],[2615,{"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createModuleLogger=r.projectLogger=void 0;const n=e("@metamask/utils");Object.defineProperty(r,"createModuleLogger",{enumerable:!0,get:function(){return n.createModuleLogger}}),r.projectLogger=(0,n.createProjectLogger)("user-operation-controller")}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/logger.cjs"}],[2616,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n;Object.defineProperty(r,"__esModule",{value:!0}),r.UserOperationStatus=void 0,function(e){e.Unapproved="unapproved",e.Approved="approved",e.Signed="signed",e.Submitted="submitted",e.Failed="failed",e.Confirmed="confirmed"}(n||(r.UserOperationStatus=n={}))}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/types.cjs"}],[2617,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.toEip155ChainId=void 0,r.toEip155ChainId=function(e){const t=Number(e);return Number.isInteger(t)?t.toString():e}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/chain-id.cjs"}],[2618,{"../constants.cjs":2610,"../logger.cjs":2615,"@metamask/controller-utils":1224,"@metamask/eth-query":1756,"@metamask/gas-fee-controller":1843,"@metamask/transaction-controller":2587,"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.updateGasFees=void 0;const o=e("@metamask/controller-utils"),s=n(e("@metamask/eth-query")),a=e("@metamask/gas-fee-controller"),i=e("@metamask/transaction-controller"),l=e("@metamask/utils"),c=e("../constants.cjs"),d=e("../logger.cjs"),u=(0,d.createModuleLogger)(d.projectLogger,"gas-fees");function h(e){return(0,o.toHex)((0,o.gweiDecToWEIBN)(e))}function p(e){return!e||e===c.EMPTY_BYTES}r.updateGasFees=async function(e){const{metadata:t,originalRequest:r,transaction:n}=e,{userOperation:c}=t;let d;const m=async()=>(d||(d=await async function(e){const{getGasFeeEstimates:t,provider:r}=e;try{const{gasFeeEstimates:e,gasEstimateType:r}=await t();if(r===a.GAS_ESTIMATE_TYPES.FEE_MARKET){const{medium:{suggestedMaxPriorityFeePerGas:t,suggestedMaxFeePerGas:r}={}}=e;if(t&&r){const e={maxFeePerGas:h(r),maxPriorityFeePerGas:h(t)};return u("Using medium values from fee market estimate",e),e}}if(r===a.GAS_ESTIMATE_TYPES.LEGACY){const t=h(e.medium);return u("Using medium value from legacy estimate",t),{maxFeePerGas:t}}if(r===a.GAS_ESTIMATE_TYPES.ETH_GASPRICE){const t=h(e.gasPrice);return u("Using gasPrice from estimate",t),{maxFeePerGas:t}}}catch(e){u("Failed to get estimate",e)}const n=await(0,o.query)(new s.default(r),"gasPrice");if(!n)return{};const i=(0,l.add0x)(n.toString(16));return u("Using gasPrice from network as fallback",i),{maxFeePerGas:i}}(e)),d);c.maxFeePerGas=await async function(e,t,r){const{maxFeePerGas:n,maxPriorityFeePerGas:o}=e,{gasPrice:s}=r??{};if(!p(n))return u("Using maxFeePerGas from request",n),n;if(p(o)&&s)return u("Setting maxFeePerGas to transaction gasPrice",s),s;const{maxFeePerGas:a}=await t();if(!a)throw new Error("Failed to get gas fee estimate for maxFeePerGas");return u("Using maxFeePerGas from estimate",a),a}(r,m,n),c.maxPriorityFeePerGas=await async function(e,t,r,n){const{maxFeePerGas:o,maxPriorityFeePerGas:s}=e,{gasPrice:a}=n??{},{maxFeePerGas:i}=r;if(!p(s))return u("Using maxPriorityFeePerGas from request",s),s;if(p(o)&&a)return u("Setting maxPriorityFeePerGas to transaction gasPrice",a),a;const{maxPriorityFeePerGas:l}=await t();if(l)return u("Using maxPriorityFeePerGas from estimate",l),l;return u("Setting maxPriorityFeePerGas to maxFeePerGas",i),i}(r,m,c,n),t.userFeeLevel=function(e,t,r,n){const{origin:s}=e,{maxFeePerGas:a,maxPriorityFeePerGas:l}=t,{maxFeePerGas:c,maxPriorityFeePerGas:d}=r||{};if(p(a)&&p(l)&&n?.gasPrice)return s===o.ORIGIN_METAMASK?i.UserFeeLevel.CUSTOM:i.UserFeeLevel.DAPP_SUGGESTED;if(p(a)&&p(l)&&c&&d)return i.UserFeeLevel.MEDIUM;if(s===o.ORIGIN_METAMASK)return i.UserFeeLevel.CUSTOM;return i.UserFeeLevel.DAPP_SUGGESTED}(t,r,d,n)}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/gas-fees.cjs"}],[2619,{"../constants.cjs":2610,"../helpers/Bundler.cjs":2611,"../logger.cjs":2615,"@metamask/controller-utils":1224,"@metamask/utils":2632,"bn.js":3529},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.updateGas=void 0;const o=e("@metamask/controller-utils"),s=e("@metamask/utils"),a=n(e("bn.js")),i=e("../constants.cjs"),l=e("../helpers/Bundler.cjs"),c=e("../logger.cjs"),d=(0,c.createModuleLogger)(c.projectLogger,"gas");function u(e){const t=("string"==typeof e?(0,o.hexToBN)(e):new a.default(e)).muln(1.5);return(0,s.add0x)(t.toString(16))}r.updateGas=async function(e,t,r){const{userOperation:n}=e;if(t.gas)return n.callGasLimit=t.gas.callGasLimit,n.preVerificationGas=t.gas.preVerificationGas,n.verificationGasLimit=t.gas.verificationGasLimit,void d("Using gas values from smart contract account",{callGasLimit:n.callGasLimit,preVerificationGas:n.preVerificationGas,verificationGasLimit:n.verificationGasLimit});const o={...n,maxFeePerGas:i.VALUE_ZERO,maxPriorityFeePerGas:i.VALUE_ZERO,callGasLimit:i.VALUE_ZERO,preVerificationGas:i.VALUE_ZERO,verificationGasLimit:"0xF4240"},s=new l.Bundler(e.bundlerUrl),a=await s.estimateUserOperationGas(o,r);n.callGasLimit=u(a.callGasLimit),n.preVerificationGas=u(a.preVerificationGas),n.verificationGasLimit=u(a.verificationGasLimit??a.verificationGas),d("Using buffered gas values from bundler estimate",{callGasLimit:n.callGasLimit,preVerificationGas:n.preVerificationGas,verificationGasLimit:n.verificationGasLimit,multiplier:1.5,estimate:a})}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/gas.cjs"}],[262,{"../lib/util":237,"@metamask/transaction-controller":2587,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("@metamask/transaction-controller"),s=e("../lib/util");r.default={version:25,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=25;const r=function(e){const t=e;if(t.TransactionController&&t.TransactionController.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map(e=>(e.status!==o.TransactionStatus.unapproved||(e.txParams=function(e){const t={from:e=>(0,s.addHexPrefix)(e).toLowerCase(),to:()=>(0,s.addHexPrefix)(e.to).toLowerCase(),nonce:e=>(0,s.addHexPrefix)(e),value:e=>(0,s.addHexPrefix)(e),data:e=>(0,s.addHexPrefix)(e),gas:e=>(0,s.addHexPrefix)(e),gasPrice:e=>(0,s.addHexPrefix)(e)},r={};return Object.keys(t).forEach(n=>{e[n]&&(r[n]=t[n](e[n]))}),r}(e.txParams)),e))}return t}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/025.js"}],[2620,{"../constants.cjs":2610,"../types.cjs":2616,"@metamask/transaction-controller":2587,"@metamask/utils":2632,"bn.js":3529},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.getTransactionMetadata=void 0;const o=e("@metamask/transaction-controller"),s=e("@metamask/utils"),a=n(e("bn.js")),i=e("../constants.cjs"),l=e("../types.cjs");r.getTransactionMetadata=function(e){const{actualGasCost:t,actualGasUsed:r,baseFeePerGas:n,chainId:c,error:d,origin:u,transactionHash:h,id:p,swapsMetadata:m,time:f,transactionParams:g,transactionType:v,userFeeLevel:y,userOperation:C}=e;if(!g)return undefined;const b=t&&r?(0,s.add0x)(new a.default((0,s.remove0x)(t),16).div(new a.default((0,s.remove0x)(r),16)).toString(16)):undefined,w=d?{name:d.name,message:d.message,stack:d.stack,code:d.code,rpc:d.rpc}:undefined,k={[l.UserOperationStatus.Unapproved]:o.TransactionStatus.unapproved,[l.UserOperationStatus.Approved]:o.TransactionStatus.approved,[l.UserOperationStatus.Signed]:o.TransactionStatus.signed,[l.UserOperationStatus.Submitted]:o.TransactionStatus.submitted,[l.UserOperationStatus.Confirmed]:o.TransactionStatus.confirmed,[l.UserOperationStatus.Failed]:o.TransactionStatus.failed}[e.status],S=function(...e){const t=new a.default(0);for(const r of e)r&&t.iadd(new a.default((0,s.remove0x)(r),16));return(0,s.add0x)(t.toString(16))}(C.preVerificationGas,C.verificationGasLimit,C.callGasLimit),P=C.paymasterAndData!==i.EMPTY_BYTES,T=P?i.VALUE_ZERO:C.maxFeePerGas,M=P?i.VALUE_ZERO:C.maxPriorityFeePerGas,E=C.nonce===i.EMPTY_BYTES?undefined:C.nonce,A={...g,from:C.sender,gas:S,nonce:E,maxFeePerGas:T,maxPriorityFeePerGas:M};delete A.gasPrice;const O={approvalTxId:m?.approvalTxId??undefined,destinationTokenAddress:m?.destinationTokenAddress??undefined,destinationTokenAmount:m?.destinationTokenAmount??undefined,destinationTokenDecimals:m?.destinationTokenDecimals??undefined,destinationTokenSymbol:m?.destinationTokenSymbol??undefined,estimatedBaseFee:m?.estimatedBaseFee??undefined,sourceTokenAddress:m?.sourceTokenAddress??undefined,sourceTokenAmount:m?.sourceTokenAmount??undefined,sourceTokenDecimals:m?.sourceTokenDecimals??undefined,sourceTokenSymbol:m?.sourceTokenSymbol??undefined,swapAndSendRecipient:m?.swapAndSendRecipient??undefined,swapMetaData:m?.swapMetaData??undefined,swapTokenValue:m?.swapTokenValue??undefined},j=P?o.UserFeeLevel.CUSTOM:y;return{baseFeePerGas:n??undefined,chainId:c,error:w,hash:h??undefined,id:p,isUserOperation:!0,networkClientId:"user-operation",origin:u,status:k,time:f,txParams:A,txReceipt:{effectiveGasPrice:b??undefined,gasUsed:r??undefined},type:v??undefined,userFeeLevel:j,...O}}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/transaction.cjs"}],[2621,{"../constants.cjs":2610,"@metamask/superstruct":2538,"@metamask/transaction-controller":2587,"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateSignUserOperationResponse=r.validateUpdateUserOperationResponse=r.validatePrepareUserOperationResponse=r.validateAddUserOperationOptions=r.validateAddUserOperationRequest=void 0;const n=e("@metamask/superstruct"),o=e("@metamask/transaction-controller"),s=e("@metamask/utils"),a=e("../constants.cjs");function i(e,t,r){try{(0,n.assert)(e,t,r)}catch(e){const t=e.failures().map(e=>e.path.length?`${e.path.join(".")} - ${e.message}`:e.message).join("\n");throw new Error(`${r}\n${t}`)}}function l(){return(0,n.define)("Hexadecimal String",e=>(0,s.isStrictHexString)(e))}function c(){return(0,n.define)("Hexadecimal String or 0x",e=>(0,s.isStrictHexString)(e)||e===a.EMPTY_BYTES)}r.validateAddUserOperationRequest=function(e){const t=l(),r=c();i(e,(0,n.object)({data:(0,n.optional)(r),from:t,maxFeePerGas:(0,n.optional)(t),maxPriorityFeePerGas:(0,n.optional)(t),to:(0,n.optional)(t),value:(0,n.optional)(t)}),"Invalid request to add user operation")},r.validateAddUserOperationOptions=function(e){i(e,(0,n.object)({networkClientId:(0,n.string)(),origin:(0,n.string)(),requireApproval:(0,n.optional)((0,n.boolean)()),smartContractAccount:(0,n.optional)((0,n.object)({prepareUserOperation:(0,n.func)(),updateUserOperation:(0,n.func)(),signUserOperation:(0,n.func)()})),swaps:(0,n.optional)((0,n.object)({approvalTxId:(0,n.optional)((0,n.string)()),destinationTokenAddress:(0,n.optional)((0,n.string)()),destinationTokenDecimals:(0,n.optional)((0,n.number)()),destinationTokenSymbol:(0,n.optional)((0,n.string)()),estimatedBaseFee:(0,n.optional)((0,n.string)()),sourceTokenSymbol:(0,n.optional)((0,n.string)()),swapMetaData:(0,n.optional)((0,n.object)()),swapTokenValue:(0,n.optional)((0,n.string)()),destinationTokenAmount:(0,n.optional)((0,n.string)()),sourceTokenAddress:(0,n.optional)((0,n.string)()),sourceTokenAmount:(0,n.optional)((0,n.string)()),sourceTokenDecimals:(0,n.optional)((0,n.number)()),swapAndSendRecipient:(0,n.optional)((0,n.string)())})),type:(0,n.optional)((0,n.enums)(Object.values(o.TransactionType)))}),"Invalid options to add user operation")},r.validatePrepareUserOperationResponse=function(e){const t=l(),r=c();i(e,(0,n.refine)((0,n.object)({bundler:(0,n.string)(),callData:t,dummyPaymasterAndData:(0,n.optional)(r),dummySignature:(0,n.optional)(r),gas:(0,n.optional)((0,n.object)({callGasLimit:t,preVerificationGas:t,verificationGasLimit:t})),initCode:(0,n.optional)(r),nonce:t,sender:t}),"ValidPrepareUserOperationResponse",({gas:e,dummySignature:t})=>!!(e||t&&t!==a.EMPTY_BYTES)||"Must specify dummySignature if not specifying gas"),"Invalid response when preparing user operation")},r.validateUpdateUserOperationResponse=function(e){i(e,(0,n.optional)((0,n.object)({paymasterAndData:(0,n.optional)(c()),callGasLimit:(0,n.optional)(c()),preVerificationGas:(0,n.optional)(c()),verificationGasLimit:(0,n.optional)(c())})),"Invalid response when updating user operation")},r.validateSignUserOperationResponse=function(e){const t=l();i(e,(0,n.object)({signature:t}),"Invalid response when signing user operation")}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/validation.cjs"}],[263,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:26,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=26;try{const e=t.data;t.data=function(e){if(!e.KeyringController||!e.PreferencesController)return e;if(!e.KeyringController.walletNicknames)return e;return e.PreferencesController.identities=Object.keys(e.KeyringController.walletNicknames).reduce((t,r)=>(t[r]={name:e.KeyringController.walletNicknames[r],address:r},t),{}),delete e.KeyringController.walletNicknames,e}(e)}catch(e){return console.warn(`MetaMask Migration #26${e.stack}`),Promise.reject(e)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/026.js"}],[264,{"@metamask/transaction-controller":2587,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("@metamask/transaction-controller");r.default={version:27,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=27;const r=function(e){const t=e;if(t.TransactionController&&t.TransactionController.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.filter(e=>e.status!==o.TransactionStatus.rejected)}return t}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/027.js"}],[2645,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var n=0;n<e.length;n++){var o=e.charAt(n),s=o.charCodeAt(0);if(255!==t[s])throw new TypeError(o+" is ambiguous");t[s]=n}var a=e.length,i=e.charAt(0),l=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function d(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var r=0;if(" "!==e[r]){for(var n=0,o=0;e[r]===i;)n++,r++;for(var s=(e.length-r)*l+1>>>0,c=new Uint8Array(s);e[r];){var d=t[e.charCodeAt(r)];if(255===d)return;for(var u=0,h=s-1;(0!==d||u<o)&&-1!==h;h--,u++)d+=a*c[h]>>>0,c[h]=d%256>>>0,d=d/256>>>0;if(0!==d)throw new Error("Non-zero carry");o=u,r++}if(" "!==e[r]){for(var p=s-o;p!==s&&0===c[p];)p++;for(var m=new Uint8Array(n+(s-p)),f=n;p!==s;)m[f++]=c[p++];return m}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,o=0,s=t.length;o!==s&&0===t[o];)o++,r++;for(var l=(s-o)*c+1>>>0,d=new Uint8Array(l);o!==s;){for(var u=t[o],h=0,p=l-1;(0!==u||h<n)&&-1!==p;p--,h++)u+=256*d[p]>>>0,d[p]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=h,o++}for(var m=l-n;m!==l&&0===d[m];)m++;for(var f=i.repeat(r);m<l;++m)f+=e.charAt(d[m]);return f},decodeUnsafe:d,decode:function(e){var t=d(e);if(t)return t;throw new Error("Non-base"+a+" character")}}}}}},{package:"@ensdomains/content-hash>cids>multibase>@multiformats/base-x",file:"node_modules/@multiformats/base-x/src/index.js"}],[265,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:28,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=28;const r=function(e){const t=e;if(t.PreferencesController&&t.PreferencesController.tokens&&t.PreferencesController.identities){const{identities:e,tokens:r}=t.PreferencesController;t.PreferencesController.accountTokens={},Object.keys(e).forEach(e=>{t.PreferencesController.accountTokens[e]={mainnet:r}}),t.PreferencesController.tokens=[]}return t}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/028.js"}],[266,{"./fail-tx":444,"@metamask/transaction-controller":2587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=e("@metamask/transaction-controller"),s=(n=e("./fail-tx"))&&n.__esModule?n:{default:n};r.default={version:29,migrate:(0,s.default)(29,"Stuck in approved state for too long.",e=>{const t=e.status===o.TransactionStatus.approved,r=e.submittedTime,n=Date.now();return t&&n-r>432e5})}}}},{package:"$root$",file:"app/scripts/migrations/029.js"}],[267,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:30,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=30;const r=function(e){const t=e;if(e.PreferencesController){const{frequentRpcListDetail:e}=t.PreferencesController;e&&(e.forEach((t,r)=>{Boolean(t.chainId)&&Number.isNaN(parseInt(t.chainId))&&delete e[r].chainId}),t.PreferencesController.frequentRpcListDetail=e)}e.NetworkController&&(t.NetworkController.network&&Number.isNaN(parseInt(t.NetworkController.network))&&delete t.NetworkController.network,t.NetworkController.provider&&t.NetworkController.provider.chainId&&Number.isNaN(parseInt(t.NetworkController.provider.chainId))&&delete t.NetworkController.provider.chainId);return t}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/030.js"}],[268,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:31,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=31;const r=function(e){const{KeyringController:t,PreferencesController:r}=e;if(t&&r){const{vault:e}=t;r.completedOnboarding=Boolean(e)}return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/031.js"}],[2689,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.openrpcDocument=void 0,r.openrpcDocument={$schema:"https://meta.json-schema.tools/",$id:"https://meta.open-rpc.org/",title:"openrpcDocument",type:"object",required:["info","methods","openrpc"],additionalProperties:!1,patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}},properties:{openrpc:{title:"openrpc",type:"string",enum:["1.3.2","1.3.1","1.3.0","1.2.6","1.2.5","1.2.4","1.2.3","1.2.2","1.2.1","1.2.0","1.1.12","1.1.11","1.1.10","1.1.9","1.1.8","1.1.7","1.1.6","1.1.5","1.1.4","1.1.3","1.1.2","1.1.1","1.1.0","1.0.0","1.0.0-rc1","1.0.0-rc0"]},info:{$ref:"#/definitions/infoObject"},externalDocs:{$ref:"#/definitions/externalDocumentationObject"},servers:{title:"servers",type:"array",additionalItems:!1,items:{$ref:"#/definitions/serverObject"}},methods:{title:"methods",type:"array",additionalItems:!1,items:{title:"methodOrReference",oneOf:[{$ref:"#/definitions/methodObject"},{$ref:"#/definitions/referenceObject"}]}},components:{title:"components",type:"object",properties:{schemas:{title:"schemaComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/JSONSchema"}}},links:{title:"linkComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/linkObject"}}},errors:{title:"errorComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/errorObject"}}},examples:{title:"exampleComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/exampleObject"}}},examplePairings:{title:"examplePairingComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/examplePairingObject"}}},contentDescriptors:{title:"contentDescriptorComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/contentDescriptorObject"}}},tags:{title:"tagComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/tagObject"}}}}},$schema:{title:"metaSchema",description:"JSON Schema URI (used by some editors)",type:"string",default:"https://meta.open-rpc.org/"}},definitions:{specificationExtension:{title:"specificationExtension"},JSONSchema:{$ref:"https://meta.json-schema.tools"},referenceObject:{title:"referenceObject",type:"object",additionalProperties:!1,required:["$ref"],properties:{$ref:{$ref:"https://meta.json-schema.tools/#/definitions/JSONSchemaObject/properties/$ref"}}},errorObject:{title:"errorObject",type:"object",description:"Defines an application level error.",additionalProperties:!1,required:["code","message"],properties:{code:{title:"errorObjectCode",description:"A Number that indicates the error type that occurred. This MUST be an integer. The error codes from and including -32768 to -32000 are reserved for pre-defined errors. These pre-defined errors SHOULD be assumed to be returned from any JSON-RPC api.",type:"integer"},message:{title:"errorObjectMessage",description:"A String providing a short description of the error. The message SHOULD be limited to a concise single sentence.",type:"string"},data:{title:"errorObjectData",description:"A Primitive or Structured value that contains additional information about the error. This may be omitted. The value of this member is defined by the Server (e.g. detailed error information, nested errors etc.)."}}},licenseObject:{title:"licenseObject",type:"object",additionalProperties:!1,properties:{name:{title:"licenseObjectName",type:"string"},url:{title:"licenseObjectUrl",type:"string"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},contactObject:{title:"contactObject",type:"object",additionalProperties:!1,properties:{name:{title:"contactObjectName",type:"string"},email:{title:"contactObjectEmail",type:"string"},url:{title:"contactObjectUrl",type:"string"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},infoObject:{title:"infoObject",type:"object",additionalProperties:!1,required:["title","version"],properties:{title:{title:"infoObjectProperties",type:"string"},description:{title:"infoObjectDescription",type:"string"},termsOfService:{title:"infoObjectTermsOfService",type:"string",format:"uri"},version:{title:"infoObjectVersion",type:"string"},contact:{$ref:"#/definitions/contactObject"},license:{$ref:"#/definitions/licenseObject"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},serverObject:{title:"serverObject",type:"object",required:["url"],additionalProperties:!1,properties:{url:{title:"serverObjectUrl",type:"string",format:"uri"},name:{title:"serverObjectName",type:"string"},description:{title:"serverObjectDescription",type:"string"},summary:{title:"serverObjectSummary",type:"string"},variables:{title:"serverObjectVariables",type:"object",patternProperties:{"[0-z]+":{title:"serverObjectVariable",type:"object",required:["default"],properties:{default:{title:"serverObjectVariableDefault",type:"string"},description:{title:"serverObjectVariableDescription",type:"string"},enum:{title:"serverObjectVariableEnum",type:"array",items:{title:"serverObjectVariableEnumItem",type:"string"}}}}}}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},linkObject:{title:"linkObject",type:"object",additionalProperties:!1,properties:{name:{title:"linkObjectName",type:"string",minLength:1},summary:{title:"linkObjectSummary",type:"string"},method:{title:"linkObjectMethod",type:"string"},description:{title:"linkObjectDescription",type:"string"},params:{title:"linkObjectParams"},server:{title:"linkObjectServer",$ref:"#/definitions/serverObject"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},externalDocumentationObject:{title:"externalDocumentationObject",type:"object",additionalProperties:!1,description:"information about external documentation",required:["url"],properties:{description:{title:"externalDocumentationObjectDescription",type:"string"},url:{title:"externalDocumentationObjectUrl",type:"string",format:"uri"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},methodObject:{title:"methodObject",type:"object",required:["name","params"],additionalProperties:!1,properties:{name:{title:"methodObjectName",description:"The cannonical name for the method. The name MUST be unique within the methods array.",type:"string",minLength:1},description:{title:"methodObjectDescription",description:"A verbose explanation of the method behavior. GitHub Flavored Markdown syntax MAY be used for rich text representation.",type:"string"},summary:{title:"methodObjectSummary",description:"A short summary of what the method does.",type:"string"},servers:{title:"servers",type:"array",additionalItems:!1,items:{$ref:"#/definitions/serverObject"}},tags:{title:"methodObjectTags",type:"array",items:{title:"tagOrReference",oneOf:[{$ref:"#/definitions/tagObject"},{$ref:"#/definitions/referenceObject"}]}},paramStructure:{title:"methodObjectParamStructure",type:"string",description:"Format the server expects the params. Defaults to 'either'.",enum:["by-position","by-name","either"],default:"either"},params:{title:"methodObjectParams",type:"array",items:{title:"contentDescriptorOrReference",oneOf:[{$ref:"#/definitions/contentDescriptorObject"},{$ref:"#/definitions/referenceObject"}]}},result:{title:"methodObjectResult",oneOf:[{$ref:"#/definitions/contentDescriptorObject"},{$ref:"#/definitions/referenceObject"}]},errors:{title:"methodObjectErrors",description:"Defines an application level error.",type:"array",items:{title:"errorOrReference",oneOf:[{$ref:"#/definitions/errorObject"},{$ref:"#/definitions/referenceObject"}]}},links:{title:"methodObjectLinks",type:"array",items:{title:"linkOrReference",oneOf:[{$ref:"#/definitions/linkObject"},{$ref:"#/definitions/referenceObject"}]}},examples:{title:"methodObjectExamples",type:"array",items:{title:"examplePairingOrReference",oneOf:[{$ref:"#/definitions/examplePairingObject"},{$ref:"#/definitions/referenceObject"}]}},deprecated:{title:"methodObjectDeprecated",type:"boolean",default:!1},externalDocs:{$ref:"#/definitions/externalDocumentationObject"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},tagObject:{title:"tagObject",type:"object",additionalProperties:!1,required:["name"],properties:{name:{title:"tagObjectName",type:"string",minLength:1},description:{title:"tagObjectDescription",type:"string"},externalDocs:{$ref:"#/definitions/externalDocumentationObject"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},exampleObject:{title:"exampleObject",type:"object",required:["name","value"],properties:{summary:{title:"exampleObjectSummary",type:"string"},value:{title:"exampleObjectValue"},description:{title:"exampleObjectDescription",type:"string"},name:{title:"exampleObjectName",type:"string",minLength:1}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},examplePairingObject:{title:"examplePairingObject",type:"object",required:["name","params"],properties:{name:{title:"examplePairingObjectName",type:"string",minLength:1},description:{title:"examplePairingObjectDescription",type:"string"},params:{title:"examplePairingObjectParams",type:"array",items:{title:"exampleOrReference",oneOf:[{$ref:"#/definitions/exampleObject"},{$ref:"#/definitions/referenceObject"}]}},result:{title:"examplePairingObjectResult",oneOf:[{$ref:"#/definitions/exampleObject"},{$ref:"#/definitions/referenceObject"}]}}},contentDescriptorObject:{title:"contentDescriptorObject",type:"object",additionalProperties:!1,required:["name","schema"],properties:{name:{title:"contentDescriptorObjectName",type:"string",minLength:1},description:{title:"contentDescriptorObjectDescription",type:"string"},summary:{title:"contentDescriptorObjectSummary",type:"string"},schema:{$ref:"#/definitions/JSONSchema"},required:{title:"contentDescriptorObjectRequired",type:"boolean",default:!1},deprecated:{title:"contentDescriptorObjectDeprecated",type:"boolean",default:!1}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}}}},r.default=r.openrpcDocument}}},{package:"@open-rpc/meta-schema",file:"node_modules/@open-rpc/meta-schema/index.js"}],[269,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:32,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=32;const r=t.data;return t.data=function(e){const{PreferencesController:t}=e;if(t){const{betaUI:e}=t.featureFlags||{};t.completedUiMigration=e}return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/032.js"}],[2690,{"@json-schema-tools/dereferencer":693,"@json-schema-tools/reference-resolver":697,"fast-safe-stringify":3939},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,s){function a(e){try{l(n.next(e))}catch(e){s(e)}}function i(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,i)}l((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var r,n,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(l){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.OpenRPCDocumentDereferencingError=void 0;var i=a(e("@json-schema-tools/dereferencer")),l=a(e("@json-schema-tools/reference-resolver")),c=a(e("fast-safe-stringify")),d=function(e){this.name="OpenRPCDocumentDereferencingError",this.message="The json schema provided cannot be dereferenced. Received Error: \n ".concat(e)};r.OpenRPCDocumentDereferencingError=d;var u=function(e,t,r){return o(void 0,void 0,void 0,function(){var n,o;return s(this,function(s){switch(s.label){case 0:if((n=e.$ref)===undefined)return[2,e];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.resolve(n,t)];case 2:return[2,s.sent()];case 3:throw o=s.sent(),new d(["unable to eval pointer against OpenRPC Document.","error type: ".concat(o.name),"instance: ".concat(o.instance),"token: ".concat(o.token),"pointer: ".concat(n),"reference object: ".concat((0,c.default)(e))].join("\n"));case 4:return[2]}})})},h=function(e,t,r){return o(void 0,void 0,void 0,function(){var n,o,a,i,l,c;return s(this,function(s){switch(s.label){case 0:n=[],o=0,a=e,s.label=1;case 1:return o<a.length?(i=a[o],c=(l=n).push,[4,u(i,t,r)]):[3,4];case 2:c.apply(l,[s.sent()]),s.label=3;case 3:return o++,[3,1];case 4:return[2,n]}})})},p=function(e,t){return o(void 0,void 0,void 0,function(){var r,n,o;return s(this,function(s){switch(s.label){case 0:if(!0===e||!1===e)return[2,Promise.resolve(e)];t!==undefined&&(e.components={schemas:t}),r=new i.default(e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.resolve()];case 2:return!0!==(n=s.sent())&&!1!==n&&(delete n.components,delete e.components),[2,n];case 3:throw o=s.sent(),new d(["Unable to parse reference inside of JSONSchema",e.title?"Schema Title: ".concat(e.title):"","error message: ".concat(o.message),"schema in question: ".concat((0,c.default)(e))].join("\n"));case 4:return[2]}})})},m=function(e){return o(void 0,void 0,void 0,function(){var t,r,n,o,a,i,l;return s(this,function(s){switch(s.label){case 0:if(e.components===undefined)return[2,Promise.resolve(e)];if(e.components.contentDescriptors===undefined)return[2,Promise.resolve(e)];t=e.components.contentDescriptors,r=Object.keys(t),n={},e.components.schemas&&(n=e.components.schemas),o=0,a=r,s.label=1;case 1:return o<a.length?(i=a[o],l=t[i],[4,p(t[i].schema,n)]):[3,4];case 2:l.schema=s.sent(),s.label=3;case 3:return o++,[3,1];case 4:return[2,e]}})})},f=function(e,t,r){return o(void 0,void 0,void 0,function(){var n,o,a,i,l,c,d,m,f,g,v,y,C,b,w,k,S,P,T,M;return s(this,function(s){switch(s.label){case 0:return n=e,e.$ref===undefined?[3,2]:[4,u({$ref:e.$ref},t,r)];case 1:n=s.sent(),s.label=2;case 2:return n.tags===undefined?[3,4]:(o=n,[4,h(n.tags,t,r)]);case 3:o.tags=s.sent(),s.label=4;case 4:return n.errors===undefined?[3,6]:(a=n,[4,h(n.errors,t,r)]);case 5:a.errors=s.sent(),s.label=6;case 6:return n.links===undefined?[3,8]:(i=n,[4,h(n.links,t,r)]);case 7:i.links=s.sent(),s.label=8;case 8:return n.examples===undefined?[3,14]:(l=n,[4,h(n.examples,t,r)]);case 9:l.examples=s.sent(),c=0,d=n.examples,s.label=10;case 10:return c<d.length?(m=d[c],f=m,[4,h(m.params,t,r)]):[3,14];case 11:return f.params=s.sent(),m.result===undefined?[3,13]:(g=m,[4,u(m.result,t,r)]);case 12:g.result=s.sent(),s.label=13;case 13:return c++,[3,10];case 14:return v=n,[4,h(n.params,t,r)];case 15:return v.params=s.sent(),n.result===undefined?[3,17]:(y=n,[4,u(n.result,t,r)]);case 16:y.result=s.sent(),s.label=17;case 17:C={},t.components&&t.components.schemas&&(C=t.components.schemas),b=n.params,w=0,k=b,s.label=18;case 18:return w<k.length?(S=k[w],P=S,[4,p(S.schema,C)]):[3,21];case 19:P.schema=s.sent(),s.label=20;case 20:return w++,[3,18];case 21:return n.result===undefined?[3,23]:(T=n.result,M=T,[4,p(T.schema,C)]);case 22:M.schema=s.sent(),s.label=23;case 23:return[2,n]}})})};r.default=function(e,t){return void 0===t&&(t=l.default),o(this,void 0,void 0,function(){var r,a,i,l,c,d,u;return s(this,function(h){switch(h.label){case 0:return r=n({},e),[4,(g=r,o(void 0,void 0,void 0,function(){var e,t,r,n,o,a,i;return s(this,function(s){switch(s.label){case 0:if(g.components===undefined)return[2,Promise.resolve(g)];if(g.components.schemas===undefined)return[2,Promise.resolve(g)];e=g.components.schemas,t=Object.keys(e),r=0,n=t,s.label=1;case 1:return r<n.length?(o=n[r],a=e,i=o,[4,p(e[o],e)]):[3,4];case 2:a[i]=s.sent(),s.label=3;case 3:return r++,[3,1];case 4:return[2,g]}})}))];case 1:return r=h.sent(),[4,m(r)];case 2:r=h.sent(),a=[],i=0,l=r.methods,h.label=3;case 3:return i<l.length?(c=l[i],u=(d=a).push,[4,f(c,r,t)]):[3,6];case 4:u.apply(d,[h.sent()]),h.label=5;case 5:return i++,[3,3];case 6:return r.methods=a,[2,r]}var g})})}}}},{package:"@open-rpc/schema-utils-js",file:"node_modules/@open-rpc/schema-utils-js/build/dereference-document.js"}],[2691,{"./dereference-document":2690,"./validate-open-rpc-document":2692,"@json-schema-tools/reference-resolver":697,"@json-schema-tools/reference-resolver/build/reference-resolver":698,"is-url":4181},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return s(t,e),t},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,s){function a(e){try{l(n.next(e))}catch(e){s(e)}}function i(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,i)}l((n=n.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,t){var r,n,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(l){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.makeCustomResolver=void 0;var d=c(e("./dereference-document")),u=a(e("./validate-open-rpc-document")),h=c(e("@json-schema-tools/reference-resolver")),p=e("is-url"),m=c(e("@json-schema-tools/reference-resolver/build/reference-resolver")),f={dereference:!0,validate:!0};r.makeCustomResolver=function(e){return new m.default(e)},r.default=function(e,t){return function(r,o){return void 0===r&&(r="./openrpc.json"),void 0===o&&(o=f),i(this,void 0,void 0,function(){var s,a,i,c;return l(this,function(l){switch(l.label){case 0:return a=n(n({},f),o),"string"==typeof r?[3,1]:(s=r,[3,6]);case 1:return function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(r)?(s=JSON.parse(r),[3,6]):[3,2];case 2:return p(r)?[4,e(r)]:[3,4];case 3:return s=l.sent(),[3,6];case 4:return[4,t(r)];case 5:s=l.sent(),l.label=6;case 6:if(a.validate&&(c=(0,u.default)(s))instanceof u.OpenRPCDocumentValidationError)throw c;return i=s,a.dereference?a.resolver===undefined?[3,8]:[4,(0,d.default)(s,a.resolver)]:[3,10];case 7:return i=l.sent(),[3,10];case 8:return[4,(0,d.default)(s,h.default)];case 9:i=l.sent(),l.label=10;case 10:if(a.validate&&(c=(0,u.default)(i))instanceof u.OpenRPCDocumentValidationError)throw c;return[2,i]}})})}}}}},{package:"@open-rpc/schema-utils-js",file:"node_modules/@open-rpc/schema-utils-js/build/parse-open-rpc-document.js"}],[2692,{"@json-schema-tools/meta-schema":694,"@open-rpc/meta-schema":2689,ajv:3329},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.OpenRPCDocumentValidationError=void 0;var s=o(e("@open-rpc/meta-schema")),a=o(e("ajv")),i=o(e("@json-schema-tools/meta-schema")),l=function(e){this.name="OpenRPCDocumentDereferencingError",this.message=["Error validating OpenRPC Document against @open-rpc/meta-schema.","The errors found are as follows:",JSON.stringify(e,undefined,"  ")].join("\n")};r.OpenRPCDocumentValidationError=l,r.default=function(e){var t=new a.default;t.addSchema(i.default,"https://meta.json-schema.tools");var r=n({},s.default);delete r.definitions.JSONSchema.$id,delete r.definitions.JSONSchema.$schema,delete r.$schema,delete r.$id;try{t.validate(r,e)}catch(e){throw new Error(["schema-utils-js: Internal Error","-----",e,"-----","If you see this report it: https://github.com/open-rpc/schema-utils-js/issues"].join("\n"))}return!t.errors||new l(t.errors)}}}},{package:"@open-rpc/schema-utils-js",file:"node_modules/@open-rpc/schema-utils-js/build/validate-open-rpc-document.js"}],[27,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getInstitutionalSnapControllerMessenger=function(e){return e.getRestricted({name:"InstitutionalSnapController",allowedActions:["AccountsController:getAccountByAddress","SnapController:handleRequest","TransactionController:updateCustodialTransaction"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/accounts/institutional-snap-controller-messenger.ts"}],[270,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:33,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=33;const r=function(e){const t=e;e.NoticeController&&delete t.NoticeController;return t}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/033.js"}],[271,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:34,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=34;const r=t.data;return t.data=function(e){const{PreferencesController:t}=e;if(t){const e=t.featureFlags||{};e.privacyMode||void 0!==t.migratedPrivacyMode||(t.migratedPrivacyMode=!0,e.privacyMode=!0)}return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/034.js"}],[2710,{assert:3586,buffer:3590,"component-type":3658,"join-component":4189},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("component-type"),o=e("join-component"),s=e("assert");t.exports=function(e,t){switch(i(e),t=t||e.type,s(t,"You must pass an event type."),t){case"track":return function(e){s(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".'),s(e.event,'You must pass an "event".')}(e);case"group":return function(e){s(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".'),s(e.groupId,'You must pass a "groupId".')}(e);case"identify":case"page":case"screen":return function(e){s(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".')}(e);case"alias":return function(e){s(e.userId,'You must pass a "userId".'),s(e.previousId,'You must pass a "previousId".')}(e);default:s(0,'Invalid event type: "'+t+'"')}};var a={anonymousId:["string","number"],category:"string",context:"object",event:"string",groupId:["string","number"],integrations:"object",name:"string",previousId:["string","number"],timestamp:"date",userId:["string","number"],type:"string"};function i(e){s("object"===n(e),"You must pass a message object.");var t=JSON.stringify(e);for(var i in s(r.byteLength(t,"utf8")<32768,"Your message must be < 32kb."),a){var l=e[i];if(l){var c=a[i];"array"!==n(c)&&(c=[c]);var d="object"===c[0]?"an":"a";s(c.some(function(e){return n(l)===e}),'"'+i+'" must be '+d+" "+o(c,"or")+".")}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@segment/loosely-validate-event",file:"node_modules/@segment/loosely-validate-event/index.js"}],[272,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:35,async migrate(e){const t=(0,n.cloneDeep)(e);return t.meta.version=35,t.data=function(e){e.PreferencesController&&e.PreferencesController.seedWords!==undefined&&delete e.PreferencesController.seedWords;return e}(t.data),t}}}}},{package:"$root$",file:"app/scripts/migrations/035.js"}],[273,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:36,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=36;const r=t.data;return t.data=function(e){const{PreferencesController:t}=e;if(t){const e=t.featureFlags||{};void 0!==e.privacyMode&&delete e.privacyMode}return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/036.js"}],[274,{"@metamask/controller-utils":1224,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("@metamask/controller-utils");r.default={version:37,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=37;const r=t.data;return t.data=function(e){if(e.AddressBookController){const t=e.AddressBookController.addressBook,r=new Set,n={};Object.values(t).forEach(e=>{r.add(e.chainId)});for(const e of r.values()){n[e]={};for(const r in t)t[r].chainId===e&&(t[r].isEns=!1,(0,o.normalizeEnsName)(t[r].name)&&(t[r].isEns=!0),n[e][r]=t[r])}e.AddressBookController.addressBook=n}return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/037.js"}],[2742,{"@metamask/eth-sig-util":1758,tslib:5149},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.transformTypedData=void 0;const n=e("tslib").__importStar(e("@metamask/eth-sig-util"));function o(e){switch(Object.prototype.toString.call(e)){case"[object Object]":{const t=Object.keys(e).map(t=>[t,o(e[t])]);return Object.fromEntries(t)}case"[object Array]":return e.map(e=>o(e));case"[object BigInt]":return e.toString();default:return e}}r.transformTypedData=(e,t)=>{if(!t)throw new Error("Trezor: Only version 4 of typed data signing is supported");const r=n.SignTypedDataVersion.V4,{types:s,primaryType:a,domain:i,message:l}=n.TypedDataUtils.sanitizeData(e),c=n.TypedDataUtils.hashStruct("EIP712Domain",o(i),s,r).toString("hex");let d=null;return"EIP712Domain"!==a&&(d=n.TypedDataUtils.hashStruct(a,o(l),s,r).toString("hex")),Object.assign({domain_separator_hash:c,message_hash:d},e)},r.default=r.transformTypedData}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-plugin-ethereum",file:"node_modules/@trezor/connect-plugin-ethereum/lib/index.js"}],[275,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:38,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=38;const r=t.data;return t.data=function(e){const{ABTestController:t={}}=e,{abTests:r={}}=t;if(r.fullScreenVsPopup)return e;return{...e,ABTestController:{...t,abTests:{...r,fullScreenVsPopup:"control"}}}}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/038.js"}],[276,{"../../../shared/modules/hexstring-utils":5360,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("../../../shared/modules/hexstring-utils");const s="SAI";function a(e={}){return e&&"object"==typeof e&&"DAI"===e.symbol&&"0x89d24A6b4CcB1B6fAA2625fE562bDD9a23260359"===(0,o.toChecksumHexAddress)(e.address)}r.default={version:39,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=39;const r=t.data;return t.data=function(e){const{PreferencesController:t}=e;if(t){const e=t.tokens||[];if(Array.isArray(e))for(const t of e)a(t)&&(t.symbol=s);const r=t.accountTokens||{};if(r&&"object"==typeof r)for(const e of Object.keys(r)){const t=r[e];if(t&&"object"==typeof t)for(const e of Object.keys(t)){const r=t[e];if(Array.isArray(r))for(const e of r)a(e)&&(e.symbol=s)}}}return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/039.js"}],[277,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:40,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=40;const r=t.data;return t.data=function(e){return delete e.ProviderApprovalController,e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/040.js"}],[278,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:41,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=41;const r=t.data;return t.data=function(e){e.PreferencesController&&e.PreferencesController.preferences&&(e.PreferencesController.preferences.autoLockTimeLimit=e.PreferencesController.preferences.autoLogoutTimeLimit,delete e.PreferencesController.preferences.autoLogoutTimeLimit);return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/041.js"}],[279,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:42,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=42;const r=t.data;return t.data=function(e){e.AppStateController?e.AppStateController.connectedStatusPopoverHasBeenShown=!1:e.AppStateController={connectedStatusPopoverHasBeenShown:!1};return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/042.js"}],[28,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){return e.getRestricted({name:"MultichainAccountService",allowedEvents:["KeyringController:stateChange","AccountsController:accountAdded","AccountsController:accountRemoved"],allowedActions:["AccountsController:listMultichainAccounts","AccountsController:getAccountByAddress","AccountsController:getAccount","SnapController:handleRequest","KeyringController:getState","KeyringController:withKeyring"]})}Object.defineProperty(r,"__esModule",{value:!0}),r.getMultichainAccountServiceInitMessenger=function(e){return n(e)},r.getMultichainAccountServiceMessenger=n}}},{package:"$root$",file:"app/scripts/controller-init/messengers/accounts/multichain-account-service-messenger.ts"}],[280,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:43,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=43;const r=t.data;return t.data=function(e){var t;null!=e&&null!==(t=e.PreferencesController)&&void 0!==t&&t.currentAccountTab&&delete e.PreferencesController.currentAccountTab;return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/043.js"}],[281,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:44,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=44;const r=t.data;return t.data=function(e){var t;void 0!==(null==e||null===(t=e.AppStateController)||void 0===t?void 0:t.mkrMigrationReminderTimestamp)&&delete e.AppStateController.mkrMigrationReminderTimestamp;return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/044.js"}],[282,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:45,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=45;const r=t.data;return t.data=function(e){var t;o.includes(null==e||null===(t=e.PreferencesController)||void 0===t?void 0:t.ipfsGateway)&&(e.PreferencesController.ipfsGateway="dweb.link");return e}(r),t}};const o=["ipfs.io","ipfs.dweb.link"]}}},{package:"$root$",file:"app/scripts/migrations/045.js"}],[283,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:46,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=46;const r=t.data;return t.data=function(e){void 0!==(null==e?void 0:e.ABTestController)&&delete e.ABTestController;return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/046.js"}],[284,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:47,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=47;const r=t.data;return t.data=function(e){var t;const r=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;Array.isArray(r)&&r.forEach(e=>{"number"==typeof e.metamaskNetworkId&&(e.metamaskNetworkId=e.metamaskNetworkId.toString())});return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/047.js"}],[285,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:48,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=48;const r=t.data;return t.data=function(e={}){var t,r,n,a,i,l,c,d;null===(t=e.NetworkController)||void 0===t||delete t.settings;const u=(null===(r=e.NetworkController)||void 0===r?void 0:r.provider)||{};if(("rpc"!==u.type||"string"==typeof u.chainId&&s.test(u.chainId))&&"localhost"!==u.type){if(null!==(n=e.NetworkController)&&void 0!==n&&n.provider){var h;if("rpcTarget"in e.NetworkController.provider){const t=e.NetworkController.provider.rpcTarget;e.NetworkController.provider.rpcUrl=t}null===(h=e.NetworkController)||void 0===h||null===(h=h.provider)||void 0===h||delete h.rpcTarget}}else e.NetworkController.provider={type:"rinkeby",rpcUrl:"",chainId:"0x4",nickname:"",rpcPrefs:{},ticker:"ETH"};e.PreferencesController||(e.PreferencesController={});e.PreferencesController.frequentRpcListDetail||(e.PreferencesController.frequentRpcListDetail=[]);e.PreferencesController.frequentRpcListDetail.unshift({rpcUrl:"http://localhost:8545",chainId:"0x539",ticker:"ETH",nickname:"Localhost 8545",rpcPrefs:{}}),null===(a=e.CachedBalancesController)||void 0===a||delete a.cachedBalances;const p=null===(i=e.TransactionController)||void 0===i?void 0:i.transactions;Array.isArray(p)&&p.forEach(e=>{const t=null==e?void 0:e.metamaskNetworkId;"string"==typeof t&&o.test(t)&&(e.metamaskNetworkId=parseInt(t,16).toString(10))});const m=(null===(l=e.AddressBookController)||void 0===l?void 0:l.addressBook)||{};Object.keys(m).forEach(e=>{if(/^\d+$/iu.test(e)){const t=`0x${parseInt(e,10).toString(16)}`;!function(e,t){Object.values(e).forEach(e=>{e&&"object"==typeof e&&(e.chainId=t)})}(m[e],t),m[t]?function(e,t,r){const n=e[t]||{},o={...e[r]};Object.keys(n).forEach(e=>{if(o[e]&&"object"==typeof o[e]){const t={};new Set([...Object.keys(o[e]),...Object.keys(n[e]||{})]).forEach(r=>{var s;t[r]=o[e][r]||(null===(s=n[e])||void 0===s?void 0:s[r])||""}),o[e]=t}else n[e]&&"object"==typeof n[e]&&(o[e]=n[e])}),e[r]=o}(m,e,t):m[t]=m[e],delete m[e]}}),null===(c=e.IncomingTransactionsController)||void 0===c||null===(c=c.incomingTxLastFetchedBlocksByNetwork)||void 0===c||delete c.localhost;const f=null===(d=e.PreferencesController)||void 0===d?void 0:d.accountTokens;f&&Object.keys(f).forEach(e=>{var t,r;const n=(null===(t=f[e])||void 0===t?void 0:t.localhost)||[];if(n.length>0){const t=f[e].rpc||[];t.length>0?f[e].rpc=function(e,t){const r=s(e),n=s(t),o=[];return new Set([...Object.keys(r),...Object.keys(n)]).forEach(e=>{o.push({...r[e],...n[e]})}),o;function s(e){return e.reduce((e,t)=>(null!=t&&t.address&&"string"==typeof(null==t?void 0:t.address)&&(e[t.address]=t),e),{})}}(n,t):f[e].rpc=n}null===(r=f[e])||void 0===r||delete r.localhost});return e}(r),t}};const o=/^0x[0-9a-f]+$/iu,s=/^0x[1-9a-f]+[0-9a-f]*$/iu}}},{package:"$root$",file:"app/scripts/migrations/048.js"}],[286,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:49,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=49;const r=t.data;return t.data=function(e={}){if(e.PreferencesController){const{metaMetricsId:t,participateInMetaMetrics:r,metaMetricsSendCount:n}=e.PreferencesController;e.MetaMetricsController=e.MetaMetricsController??{},t!==undefined&&(e.MetaMetricsController.metaMetricsId=t,delete e.PreferencesController.metaMetricsId),r!==undefined&&(e.MetaMetricsController.participateInMetaMetrics=r,delete e.PreferencesController.participateInMetaMetrics),n!==undefined&&(e.MetaMetricsController.metaMetricsSendCount=n,delete e.PreferencesController.metaMetricsSendCount)}return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/049.js"}],[287,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");const o=["METASWAP_GAS_PRICE_ESTIMATES_LAST_RETRIEVED","METASWAP_GAS_PRICE_ESTIMATES","cachedFetch","BASIC_PRICE_ESTIMATES_LAST_RETRIEVED","BASIC_PRICE_ESTIMATES","BASIC_GAS_AND_TIME_API_ESTIMATES","BASIC_GAS_AND_TIME_API_ESTIMATES_LAST_RETRIEVED","GAS_API_ESTIMATES_LAST_RETRIEVED","GAS_API_ESTIMATES"];r.default={version:50,async migrate(e){const t=(0,n.cloneDeep)(e);return t.meta.version=50,o.forEach(e=>{var t;return null===(t=window.localStorage)||void 0===t?void 0:t.removeItem(e)}),t}}}}},{package:"$root$",file:"app/scripts/migrations/050.js"}],[288,{"../../../shared/constants/network":5262,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("../../../shared/constants/network");r.default={version:51,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=51;const r=t.data;return t.data=function(e){var t,r;const{chainId:n,type:s}=(null==e||null===(t=e.NetworkController)||void 0===t?void 0:t.provider)||{},a=null===(r=o.BUILT_IN_NETWORKS[s])||void 0===r?void 0:r.chainId;a&&n!==a&&(e.NetworkController.provider.chainId=a);return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/051.js"}],[289,{"../../../shared/constants/network":5262,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("../../../shared/constants/network");r.default={version:52,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=52;const r=t.data;return t.data=function(e={}){if(e.PreferencesController){const{accountTokens:t,accountHiddenTokens:r,frequentRpcListDetail:n}=e.PreferencesController,s={},a={};if(t&&Object.keys(t).length>0){for(const e of Object.keys(t)){s[e]={},t[e][o.NETWORK_TYPES.RPC]&&n.forEach(r=>{s[e][r.chainId]=t[e][o.NETWORK_TYPES.RPC]});for(const r of Object.keys(t[e]))switch(r){case o.NETWORK_TYPES.MAINNET:s[e][o.CHAIN_IDS.MAINNET]=t[e][o.NETWORK_TYPES.MAINNET];break;case"ropsten":s[e]["0x3"]=t[e].ropsten;break;case"rinkeby":s[e]["0x4"]=t[e].rinkeby;break;case o.NETWORK_TYPES.GOERLI:s[e][o.CHAIN_IDS.GOERLI]=t[e][o.NETWORK_TYPES.GOERLI];break;case"kovan":s[e]["0x2a"]=t[e].kovan}}e.PreferencesController.accountTokens=s}if(r&&Object.keys(r).length>0){for(const e of Object.keys(r)){a[e]={},r[e][o.NETWORK_TYPES.RPC]&&n.forEach(t=>{a[e][t.chainId]=r[e][o.NETWORK_TYPES.RPC]});for(const t of Object.keys(r[e]))switch(t){case o.NETWORK_TYPES.MAINNET:a[e][o.CHAIN_IDS.MAINNET]=r[e][o.NETWORK_TYPES.MAINNET];break;case"ropsten":a[e]["0x3"]=r[e].ropsten;break;case"rinkeby":a[e]["0x4"]=r[e].rinkeby;break;case o.NETWORK_TYPES.GOERLI:a[e][o.CHAIN_IDS.GOERLI]=r[e][o.NETWORK_TYPES.GOERLI];break;case"kovan":a[e]["0x2a"]=r[e].kovan}}e.PreferencesController.accountHiddenTokens=a}}return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/052.js"}],[29,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getAssetsContractControllerMessenger=function(e){return e.getRestricted({name:"AssetsContractController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getNetworkConfigurationByNetworkClientId","NetworkController:getSelectedNetworkClient","NetworkController:getState"],allowedEvents:["PreferencesController:stateChange","NetworkController:networkDidChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/assets/assets-contract-controller-messenger.ts"}],[290,{"@metamask/transaction-controller":2587,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("@metamask/transaction-controller");r.default={version:53,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=53;const r=t.data;return t.data=function(e){var t,r;const n=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions,s=null==e||null===(r=e.IncomingTransactionsController)||void 0===r?void 0:r.incomingTransactions;Array.isArray(n)&&n.forEach(e=>{e&&(e.type!==o.TransactionType.retry&&e.type!==o.TransactionType.cancel&&(e.type=e.transactionCategory),delete e.transactionCategory)});if(s){Object.entries(s).forEach(([t,r])=>{r&&(delete r.transactionCategory,e.IncomingTransactionsController.incomingTransactions[t]={...r,type:o.TransactionType.incoming})})}return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/053.js"}],[291,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");function o(e){return"number"==typeof e||"string"==typeof e&&e.match(/^(0x)?\d+$/u)}r.default={version:54,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=54;const r=function(e){const t=e;if(!t.PreferencesController)return t;const r=t.PreferencesController.tokens||[],n=r.filter(({decimals:e})=>o(e));for(const e of n)"string"==typeof e.decimals&&(e.decimals=parseInt(e.decimals));t.PreferencesController.tokens=n;const{accountTokens:s}=t.PreferencesController;if(s&&"object"==typeof s)for(const e of Object.keys(s)){const t=s[e];if(t&&"object"==typeof t)for(const e of Object.keys(t)){const r=(t[e]||[]).filter(({decimals:e})=>o(e));for(const e of r)"string"==typeof e.decimals&&(e.decimals=parseInt(e.decimals));t[e]=r}}return t.PreferencesController.accountTokens=s,t}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/054.js"}],[292,{"../../../shared/constants/network":5262,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("../../../shared/constants/network");r.default={version:55,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=55;const r=t.data;return t.data=function(e){var t;null!=e&&null!==(t=e.IncomingTransactionsController)&&void 0!==t&&t.incomingTxLastFetchedBlocksByNetwork&&(e.IncomingTransactionsController.incomingTxLastFetchedBlockByChainId=(0,n.mapKeys)(e.IncomingTransactionsController.incomingTxLastFetchedBlocksByNetwork,(e,t)=>{var r;return(null===(r=o.BUILT_IN_NETWORKS[t])||void 0===r?void 0:r.chainId)??s}),delete e.IncomingTransactionsController.incomingTxLastFetchedBlockByChainId[s],delete e.IncomingTransactionsController.incomingTxLastFetchedBlocksByNetwork);return e}(r),t}};const s="UNKNOWN";o.BUILT_IN_NETWORKS.rinkeby={networkId:"4",chainId:"0x4",ticker:"ETH"},o.BUILT_IN_NETWORKS.ropsten={networkId:"3",chainId:"0x3",ticker:"ETH"},o.BUILT_IN_NETWORKS.kovan={networkId:"42",chainId:"0x2a",ticker:"ETH"}}}},{package:"$root$",file:"app/scripts/migrations/055.js"}],[293,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:56,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=56;const{PreferencesController:r}=t.data;return Array.isArray(null==r?void 0:r.tokens)&&(r.tokens=r.tokens.filter(({address:e})=>e)),null!=r&&r.accountTokens&&"object"==typeof r.accountTokens&&Object.keys(r.accountTokens).forEach(e=>{Object.keys(r.accountTokens[e]).forEach(t=>{r.accountTokens[e][t]=r.accountTokens[e][t].filter(({address:e})=>e)})}),null!=r&&r.assetImages&&"undefined"in r.assetImages&&delete r.assetImages.undefined,t}}}}},{package:"$root$",file:"app/scripts/migrations/056.js"}],[294,{"../../../shared/modules/random-id":5366,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=e("lodash"),s=(n=e("../../../shared/modules/random-id"))&&n.__esModule?n:{default:n};r.default={version:57,async migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=57;const r=t.data;return t.data=function(e){var t;null!=e&&null!==(t=e.TransactionController)&&void 0!==t&&t.transactions&&Array.isArray(e.TransactionController.transactions)&&!e.TransactionController.transactions.some(e=>"object"!=typeof e||void 0===e.txParams)&&(e.TransactionController.transactions=(0,o.keyBy)(e.TransactionController.transactions,e=>(void 0!==e.id&&null!==e.id||(e.id=(0,s.default)()),e.id)));return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/057.js"}],[295,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:58,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=58;const r=t.data;return t.data=function(e){var t;return null===(t=e.AppStateController)||void 0===t||delete t.swapsWelcomeMessageHasBeenShown,e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/058.js"}],[296,{"@metamask/transaction-controller":2587,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("@metamask/transaction-controller");r.default={version:59,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=59;const r=t.data;return t.data=function(e){var t;const r=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;if((0,n.isPlainObject)(r)){const t=(0,n.groupBy)(Object.values(r),e=>{var t;return`${null===(t=e.txParams)||void 0===t?void 0:t.nonce}-${e.chainId??e.metamaskNetworkId}`}),s=(0,n.pickBy)(t,e=>e.some(e=>e.type!==o.TransactionType.cancel&&e.type!==o.TransactionType.retry));e.TransactionController.transactions=(0,n.keyBy)((0,n.concat)(...Object.values(s)),e=>e.id)}return e}(r),t}}}}},{package:"$root$",file:"app/scripts/migrations/059.js"}],[297,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");const o="2020-08-31";r.default={version:60,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=60;const r=function(e){var t;const r=null==e||null===(t=e.NotificationController)||void 0===t?void 0:t.notifications;var s;(0,n.isPlainObject)(r)&&(null===(s=r[2])||void 0===s?void 0:s.date)===o&&delete e.NotificationController.notifications[2];return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/060.js"}],[298,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:61,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=61;const r=function(e){const t=(new Date).getTime();e.AppStateController?(e.AppStateController.recoveryPhraseReminderHasBeenShown=!1,e.AppStateController.recoveryPhraseReminderLastShown=t):e.AppStateController={recoveryPhraseReminderHasBeenShown:!1,recoveryPhraseReminderLastShown:t};return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/061.js"}],[299,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:62,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=62;const r=function(e){if(e.MetaMetricsController){const{metaMetricsSendCount:t}=e.MetaMetricsController;t!==undefined&&delete e.MetaMetricsController.metaMetricsSendCount}return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/062.js"}],[30,{"./assets-contract-controller-messenger":29,"./network-order-controller-messenger":31,"./nft-controller-messenger":32,"./nft-detection-controller-messenger":33,"./token-rates-controller-messenger":34},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getAssetsContractControllerMessenger",{enumerable:!0,get:function(){return a.getAssetsContractControllerMessenger}}),Object.defineProperty(r,"getNetworkOrderControllerMessenger",{enumerable:!0,get:function(){return i.getNetworkOrderControllerMessenger}}),Object.defineProperty(r,"getNftControllerInitMessenger",{enumerable:!0,get:function(){return o.getNftControllerInitMessenger}}),Object.defineProperty(r,"getNftControllerMessenger",{enumerable:!0,get:function(){return o.getNftControllerMessenger}}),Object.defineProperty(r,"getNftDetectionControllerMessenger",{enumerable:!0,get:function(){return s.getNftDetectionControllerMessenger}}),Object.defineProperty(r,"getTokenRatesControllerMessenger",{enumerable:!0,get:function(){return n.getTokenRatesControllerMessenger}});var n=e("./token-rates-controller-messenger"),o=e("./nft-controller-messenger"),s=e("./nft-detection-controller-messenger"),a=e("./assets-contract-controller-messenger"),i=e("./network-order-controller-messenger")}}},{package:"$root$",file:"app/scripts/controller-init/messengers/assets/index.ts"}],[300,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:63,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=63;const r=function(e){var t,r,n,o,s,a,i,l;const c=null==e||null===(t=e.PreferencesController)||void 0===t?void 0:t.accountTokens,d=null==e||null===(r=e.PreferencesController)||void 0===r?void 0:r.accountHiddenTokens,u={};c&&Object.keys(c).forEach(e=>{Object.keys(c[e]).forEach(t=>{const r=c[e][t];u[t]===undefined?u[t]={[e]:r}:u[t]={...u[t],[e]:r}})});const h={};d&&Object.keys(d).forEach(e=>{Object.keys(d[e]).forEach(t=>{const r=d[e][t];h[t]===undefined?h[t]={[e]:r}:h[t]={...h[t],[e]:r}})});e.TokensController?(e.TokensController.allTokens=u,e.TokensController.allIgnoredTokens=h):e.TokensController={allTokens:u,allIgnoredTokens:h};return null==e||null===(n=e.PreferencesController)||void 0===n||delete n.accountHiddenTokens,null==e||null===(o=e.PreferencesController)||void 0===o||delete o.accountTokens,null==e||null===(s=e.PreferencesController)||void 0===s||delete s.assetImages,null==e||null===(a=e.PreferencesController)||void 0===a||delete a.hiddenTokens,null==e||null===(i=e.PreferencesController)||void 0===i||delete i.tokens,null==e||null===(l=e.PreferencesController)||void 0===l||delete l.suggestedTokens,e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/063.js"}],[301,{"@metamask/transaction-controller":2587,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("@metamask/transaction-controller");const s="sentEther";r.default={version:64,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=64;const r=function(e){var t;const r=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;if((0,n.isPlainObject)(r))for(const e of Object.values(r))e.type===s&&(e.type=o.TransactionType.simpleSend),e.history&&e.history.map(e=>(e.type&&e.type===s&&(e.type=o.TransactionType.simpleSend),e));return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/064.js"}],[302,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:65,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=65;const r=function(e){if(e.PreferencesController){const{completedOnboarding:t,firstTimeFlowType:r}=e.PreferencesController;e.OnboardingController=e.OnboardingController??{},t!==undefined&&(e.OnboardingController.completedOnboarding=t,delete e.PreferencesController.completedOnboarding),r!==undefined&&(e.OnboardingController.firstTimeFlowType=r,delete e.PreferencesController.firstTimeFlowType)}return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/065.js"}],[303,{"../../../shared/constants/hardware-wallets":5253,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=e("../../../shared/constants/hardware-wallets");r.default={version:66,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=66;const r=function(e){var t;const r=window.navigator.hid?o.LedgerTransportTypes.webhid:o.LedgerTransportTypes.u2f,n=Boolean(null===(t=e.PreferencesController)||void 0===t?void 0:t.useLedgerLive),s={...e,PreferencesController:{...null==e?void 0:e.PreferencesController,ledgerTransportType:n?o.LedgerTransportTypes.live:r}};return delete s.PreferencesController.useLedgerLive,s}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/066.js"}],[304,{"../../../shared/constants/network":5262,"bignumber.js":3481,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=e("lodash"),s=(n=e("bignumber.js"))&&n.__esModule?n:{default:n},a=e("../../../shared/constants/network");const i=e=>new s.default(e||"0x0",16).gt(0);r.default={version:67,async migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=67;const r=function(e){var t,r,n;const o=(null==e?void 0:e.PreferencesController)||{},s=o.preferences||{};if(s.showTestNetworks)return e;const l=(null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions)||{},c=(null===(r=e.NetworkController)||void 0===r?void 0:r.provider)||{},d=(null===(n=e.CachedBalancesController)||void 0===n?void 0:n.cachedBalances)||{},u=a.TEST_CHAINS.includes(null==c?void 0:c.chainId),h=Object.values(l).some(({chainId:e})=>a.TEST_CHAINS.includes(e)),p=a.TEST_CHAINS.some(e=>Object.values(d[e]||{}).some(i)),m=u||h||p,f={...e,PreferencesController:{...o,preferences:{...s,showTestNetworks:m}}};return f}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/067.js"}],[305,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:68,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=68;const r=function(e){const{PermissionsController:t={},PermissionsMetadata:r={},...n}=e,{domainMetadata:a={},permissionsHistory:i={},permissionsLog:l=[]}=r;return{...n,PermissionController:o(t),PermissionLogController:{permissionActivityLog:l,permissionHistory:i},SubjectMetadataController:s(a)}}(t.data);return t.data=r,t}};function o(e){const{domains:t={}}=e,r="eth_accounts";return{subjects:Object.entries(t).reduce((e,[t,n])=>{const{permissions:[o]}=n,s=o.caveats.find(e=>"exposedAccounts"===e.name),a={...o,caveats:[{type:"restrictReturnedAccounts",value:s.value}]};return delete a["@context"],e[t]={origin:t,permissions:{[r]:a}},e},{})}}function s(e){return{subjectMetadata:Object.entries(e).reduce((e,[t,r])=>{const{name:n=null,icon:o=null,extensionId:s=null,...a}=r;return delete a.lastUpdated,delete a.host,t&&(e[t]={name:n,iconUrl:o,extensionId:s,...a,origin:t}),e},{})}}}}},{package:"$root$",file:"app/scripts/migrations/068.js"}],[306,{"@metamask/permission-controller":2090,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/permission-controller"),o=e("lodash");r.default={version:69,async migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=69;const r=function(e){var t;if("object"==typeof(null==e||null===(t=e.SubjectMetadataController)||void 0===t?void 0:t.subjectMetadata)){const{SubjectMetadataController:{subjectMetadata:t}}=e;Object.values(t).forEach(e=>{e&&"object"==typeof e&&!Array.isArray(e)&&(e.subjectType=e.extensionId?n.SubjectType.Extension:n.SubjectType.Website)})}return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/069.js"}],[307,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:70,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=70;const r=function(e){var t;if(Array.isArray(null==e||null===(t=e.PermissionLogController)||void 0===t?void 0:t.permissionActivityLog)){const{PermissionLogController:{permissionActivityLog:t}}=e;t.forEach(e=>{e&&"object"==typeof e&&!Array.isArray(e)&&(delete e.request,delete e.response)})}return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/070.js"}],[308,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:71,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=71;const r=function(e){e.NotificationController&&(e.AnnouncementController={announcements:e.NotificationController.notifications},delete e.NotificationController);return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/071.js"}],[309,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:72,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=72;const r=function(e){const t=(null==e?void 0:e.PreferencesController)||{};return{...e,PreferencesController:{...t,knownMethodData:{}}}}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/072.js"}],[31,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getNetworkOrderControllerMessenger=function(e){return e.getRestricted({name:"NetworkOrderController",allowedEvents:["NetworkController:stateChange","NetworkController:networkRemoved"],allowedActions:["NetworkController:getState","NetworkController:setActiveNetwork"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/assets/network-order-controller-messenger.ts"}],[310,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:73,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=73;const r=function(e){const t=(null==e?void 0:e.PreferencesController)||{};return{...e,PreferencesController:{...t,knownMethodData:{}}}}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/073.js"}],[3100,{"./types.js":3101},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./types.js");const o={type:"xstate.init"},s="xstate.assign";function a(e){return e===undefined?[]:[].concat(e)}function i(e,t){return"string"==typeof(e="string"==typeof e&&t&&t[e]?t[e]:e)?{type:e}:"function"==typeof e?{type:e.name,exec:e}:e}function l(e){return t=>e===t}function c(e){return"string"==typeof e?{type:e}:e}function d(e,t){return{value:e,context:t,actions:[],changed:!1,matches:l(e)}}function u(e,t,r){let n=t,o=!1;return[e.filter(e=>{if(e.type===s){o=!0;let t=Object.assign({},n);return"function"==typeof e.assignment?t=e.assignment(n,r):Object.keys(e.assignment).forEach(o=>{t[o]="function"==typeof e.assignment[o]?e.assignment[o](n,r):e.assignment[o]}),n=t,!1}return!0}),n,o]}const h=(e,t)=>e.actions.forEach(({exec:r})=>r&&r(e.context,t));Object.defineProperty(r,"InterpreterStatus",{enumerable:!0,get:function(){return n.InterpreterStatus}}),r.assign=function(e){return{type:s,assignment:e}},r.createMachine=function(e,t={}){const[r,n]=u(a(e.states[e.initial].entry).map(e=>i(e,t.actions)),e.context,o),s={config:e,_options:t,initialState:{value:e.initial,actions:r,context:n,matches:l(e.initial)},transition:(t,r)=>{const{value:n,context:o}="string"==typeof t?{value:t,context:e.context}:t,h=c(r),p=e.states[n];if(p.on){const t=a(p.on[h.type]);for(const r of t){if(r===undefined)return d(n,o);const{target:t,actions:c=[],cond:m=()=>!0}="string"==typeof r?{target:r}:r,f=t===undefined,g=null!=t?t:n,v=e.states[g];if(m(o,h)){const e=(f?a(c):[].concat(p.exit,c,v.entry).filter(e=>e)).map(e=>i(e,s._options.actions)),[r,d,m]=u(e,o,h),g=null!=t?t:n;return{value:g,context:d,actions:r,changed:t!==n||r.length>0||m,matches:l(g)}}}}return d(n,o)}};return s},r.interpret=function(e){let t=e.initialState,r=n.InterpreterStatus.NotStarted;const s=new Set,a={_machine:e,send:o=>{r===n.InterpreterStatus.Running&&(t=e.transition(t,o),h(t,c(o)),s.forEach(e=>e(t)))},subscribe:e=>(s.add(e),e(t),{unsubscribe:()=>s.delete(e)}),start:s=>{if(s){const r="object"==typeof s?s:{context:e.config.context,value:s};t={value:r.value,actions:[],context:r.context,matches:l(r.value)}}else t=e.initialState;return r=n.InterpreterStatus.Running,h(t,o),a},stop:()=>(r=n.InterpreterStatus.Stopped,s.clear(),a),get state(){return t},get status(){return r}};return a}}}},{package:"@metamask/snaps-controllers>@xstate/fsm",file:"node_modules/@xstate/fsm/lib/index.js"}],[3101,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n;Object.defineProperty(r,"__esModule",{value:!0}),r.InterpreterStatus=void 0,(n=r.InterpreterStatus||(r.InterpreterStatus={}))[n.NotStarted=0]="NotStarted",n[n.Running=1]="Running",n[n.Stopped=2]="Stopped"}}},{package:"@metamask/snaps-controllers>@xstate/fsm",file:"node_modules/@xstate/fsm/lib/types.js"}],[311,{"../../../shared/constants/network":5262,"bignumber.js":3481,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=e("lodash"),s=(n=e("bignumber.js"))&&n.__esModule?n:{default:n},a=e("../../../shared/constants/network");const i=e=>new s.default(e||"0x0",16).gt(0),l=["0x3","0x2a","0x4"],c={"0x3":{rpcUrl:(0,a.getRpcUrl)({network:"ropsten"}),nickname:"Ropsten",ticker:"RopstenETH"},"0x2a":{rpcUrl:(0,a.getRpcUrl)({network:"kovan"}),nickname:"Kovan",ticker:"KovanETH"},"0x4":{rpcUrl:(0,a.getRpcUrl)({network:"rinkeby"}),nickname:"Rinkeby",ticker:"RinkebyETH"}};r.default={version:74,async migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=74;const r=function(e){var t,r;const n=(null==e?void 0:e.PreferencesController)||{},s=n.preferences||{},a=(null==e?void 0:e.NetworkController)||{},d=(null==a?void 0:a.provider)||{},u=l.filter(e=>e===(null==d?void 0:d.chainId));if(!s.showTestNetworks&&0===u.length)return e;const h=(null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions)||{},p=(null===(r=e.CachedBalancesController)||void 0===r?void 0:r.cachedBalances)||{},m=Object.values(h).filter(({chainId:e})=>l.includes(e)).map(({chainId:e})=>e),f=l.filter(e=>Object.values(p[e]||{}).some(i)),g=(0,o.uniq)([...f,...m,...u]),v=n.frequentRpcListDetail??[];g.forEach(e=>{v.find(t=>t.chainId===e)||v.unshift({rpcUrl:c[e].rpcUrl,chainId:e,ticker:c[e].ticker,nickname:c[e].nickname,rpcPrefs:{}})}),v.length&&(n.frequentRpcListDetail=v);if(u.length){const e=u[0];a.provider={...a.provider,type:"rpc",rpcUrl:c[e].rpcUrl,chainId:e,nickname:c[e].nickname,ticker:c[e].ticker}}return{...e,PreferencesController:{...n},NetworkController:{...a}}}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/074.js"}],[312,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:75,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=75;const r=function(e){return delete e.ThreeBoxController,e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/075.js"}],[313,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:76,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=76;const r=function(e){var t;if(e.CollectiblesController){const{allCollectibleContracts:t,allCollectibles:r,ignoredCollectibles:n,...o}=e.CollectiblesController;e.NftController={...t?{allNftContracts:t}:{},...r?{allNfts:r}:{},...n?{ignoredNfts:n}:{},...o},delete e.CollectiblesController}null!==(t=e.PreferencesController)&&void 0!==t&&t.useCollectibleDetection&&(e.PreferencesController.useNftDetection=e.PreferencesController.useCollectibleDetection,delete e.PreferencesController.useCollectibleDetection);return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/076.js"}],[314,{"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){(0,n.hasProperty)(e,"PreferencesController")&&(0,n.isObject)(e.PreferencesController)&&(0,n.hasProperty)(e.PreferencesController,"frequentRpcListDetail")&&(0,n.isObject)(e.NetworkController)&&(0,n.hasProperty)(e.NetworkController,"networkConfigurations")&&delete e.PreferencesController.frequentRpcListDetail;return{...e}};var n=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-082.ts"}],[315,{"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){(0,n.hasProperty)(e,"NetworkController")&&(0,n.isObject)(e.NetworkController)&&(0,n.hasProperty)(e.NetworkController,"network")&&(0,n.hasProperty)(e.NetworkController,"networkId")&&delete e.NetworkController.network;return{...e}};var n=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-084.ts"}],[316,{"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){(0,n.hasProperty)(e,"NetworkController")&&(0,n.isObject)(e.NetworkController)&&(0,n.hasProperty)(e.NetworkController,"provider")&&(0,n.hasProperty)(e.NetworkController,"providerConfig")&&delete e.NetworkController.provider;return{...e}};var n=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-086.ts"}],[317,{"@metamask/utils":2632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){if((0,n.hasProperty)(e,"NftController")&&(0,n.isObject)(e.NftController)){const t=e.NftController;if((0,n.hasProperty)(t,"allNftContracts")&&(0,n.isObject)(t.allNftContracts)){const{allNftContracts:e}=t;Object.keys(e).every(t=>(0,n.isObject)(e[t]))&&Object.keys(e).forEach(t=>{const r=e[t];if((0,n.isObject)(r)&&o(r))for(const e of Object.keys(r))(0,n.isStrictHexString)(e)||delete r[e]})}if((0,n.hasProperty)(t,"allNfts")&&(0,n.isObject)(t.allNfts)){const{allNfts:e}=t;Object.keys(e).every(t=>(0,n.isObject)(e[t]))&&Object.keys(e).forEach(t=>{const r=e[t];if((0,n.isObject)(r)&&o(r))for(const e of Object.keys(r))(0,n.isStrictHexString)(e)||delete r[e]})}e.NftController=t}if((0,n.hasProperty)(e,"TokenListController")&&(0,n.isObject)(e.TokenListController)){const t=e.TokenListController;if((0,n.hasProperty)(t,"tokensChainsCache")&&(0,n.isObject)(t.tokensChainsCache)&&o(t.tokensChainsCache))for(const e of Object.keys(t.tokensChainsCache))(0,n.isStrictHexString)(e)||delete t.tokensChainsCache[e]}if((0,n.hasProperty)(e,"TokensController")&&(0,n.isObject)(e.TokensController)){const t=e.TokensController;if((0,n.hasProperty)(t,"allTokens")&&(0,n.isObject)(t.allTokens)&&o(t.allTokens)){const{allTokens:e}=t;for(const r of Object.keys(e))(0,n.isStrictHexString)(r)||delete t.allTokens[r]}if((0,n.hasProperty)(t,"allIgnoredTokens")&&(0,n.isObject)(t.allIgnoredTokens)&&o(t.allIgnoredTokens)){const{allIgnoredTokens:e}=t;for(const r of Object.keys(e))(0,n.isStrictHexString)(r)||delete t.allIgnoredTokens[r]}if((0,n.hasProperty)(t,"allDetectedTokens")&&(0,n.isObject)(t.allDetectedTokens)&&o(t.allDetectedTokens)){const{allDetectedTokens:e}=t;for(const r of Object.keys(e))(0,n.isStrictHexString)(r)||delete t.allDetectedTokens[r]}e.TokensController=t}return e};var n=e("@metamask/utils");function o(e){return Object.keys(e).some(e=>(0,n.isStrictHexString)(e))}}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-088.ts"}],[318,{"./077-supplements/077-supplement-for-082":314,"./077-supplements/077-supplement-for-084":315,"./077-supplements/077-supplement-for-086":316,"./077-supplements/077-supplement-for-088":317,"@metamask/utils":2632,lodash:4362,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),o=d(e("loglevel")),s=e("@metamask/utils"),a=d(e("./077-supplements/077-supplement-for-082")),i=d(e("./077-supplements/077-supplement-for-084")),l=d(e("./077-supplements/077-supplement-for-086")),c=d(e("./077-supplements/077-supplement-for-088"));function d(e){return e&&e.__esModule?e:{default:e}}r.default={version:77,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=77;let r=function(e){if(!(0,s.hasProperty)(e,"TokenListController"))return o.default.warn("Skipping migration, TokenListController state is missing"),e;var t,r;if(!(0,s.isObject)(e.TokenListController))return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.TokenListController is "+typeof e.TokenListController)),e;if(!(0,s.hasProperty)(e.TokenListController,"tokensChainsCache"))return o.default.warn("Skipping migration, TokenListController.tokensChainsCache state is missing"),e;const{TokenListController:n}=e,{tokensChainsCache:a}=n;let i,l;for(const e in a){var c,d;if(i=a[e].data||{},l={},Array.isArray(i))for(const e of i)l[e.address]=e;else if((null===(c=Object.keys(i)[0])||void 0===c?void 0:c.toLowerCase())!==(null===(d=i[Object.keys(i)[0]])||void 0===d||null===(d=d.address)||void 0===d?void 0:d.toLowerCase()))for(const e in i)l[i[e].address]=i[e];a[e].data=Object.keys(l).length>0?l:i}return n.tokensChainsCache=a,{...e,TokenListController:{...n}}}(t.data);return r=(0,a.default)(r),r=(0,i.default)(r),r=(0,l.default)(r),r=(0,c.default)(r),t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/077.js"}],[319,{"@metamask/utils":2632,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,o.hasProperty)(e,"PhishingController")||!(0,o.isObject)(e.PhishingController))return e;const{PhishingController:t}=e;return delete t.phishing,delete t.lastFetched,e}(t.data),t},r.version=void 0;var n=e("lodash"),o=e("@metamask/utils");const s=r.version=78}}},{package:"$root$",file:"app/scripts/migrations/078.ts"}],[32,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getNftControllerInitMessenger=function(e){return e.getRestricted({name:"NftControllerInit",allowedActions:["MetaMetricsController:trackEvent"],allowedEvents:[]})},r.getNftControllerMessenger=function(e){return e.getRestricted({name:"NftController",allowedEvents:["PreferencesController:stateChange","AccountsController:selectedEvmAccountChange"],allowedActions:["ApprovalController:addRequest","NetworkController:getNetworkClientById","AccountsController:getSelectedAccount","AccountsController:getAccount","AssetsContractController:getERC721AssetName","AssetsContractController:getERC721AssetSymbol","AssetsContractController:getERC721TokenURI","AssetsContractController:getERC721OwnerOf","AssetsContractController:getERC1155BalanceOf","AssetsContractController:getERC1155TokenURI","NetworkController:findNetworkClientIdByChainId","PhishingController:bulkScanUrls"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/assets/nft-controller-messenger.ts"}],[320,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:79,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=79;const r=function(e){var t,r;(null==e||null===(t=e.AppStateController)||void 0===t?void 0:t.collectiblesDetectionNoticeDismissed)!==undefined&&delete e.AppStateController.collectiblesDetectionNoticeDismissed;(null==e||null===(r=e.metamask)||void 0===r?void 0:r.collectiblesDropdownState)!==undefined&&delete e.metamask.collectiblesDropdownState;return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/079.js"}],[321,{lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:80,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=80;const r=function(e){var t;(null==e||null===(t=e.metamask)||void 0===t?void 0:t.showPortfolioTooltip)!==undefined&&delete e.metamask.showPortfolioTooltip;return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/080.js"}],[322,{"@metamask/utils":2632,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);t.meta.version=s;const r=function(e){if(!(0,o.hasProperty)(e,"SnapController")||!(0,o.hasProperty)(e,"PermissionController")||!(0,o.isObject)(e.PermissionController))return e;const{PermissionController:t}=e,{subjects:r}=t;if(!(0,o.isObject)(r))return e;const s="wallet_snap_";for(const[t,a]of Object.entries(r)){if(!(0,o.isObject)(a)||!(0,o.isObject)(a.permissions))return e;let r,i=1;const{permissions:l}=a,c={...l};for(const[a,d]of Object.entries(l))if(a.startsWith(s)){if(!(0,o.isObject)(d)||!(0,o.hasProperty)(d,"id")||!(0,o.hasProperty)(d,"date"))return e;if((0,o.hasProperty)(c,"wallet_snap")||(c.wallet_snap={caveats:[{type:"snapIds",value:{}}],invoker:t,parentCapability:"wallet_snap"}),!(0,o.isObject)(c.wallet_snap))return e;if(!(0,n.isArray)(c.wallet_snap.caveats))return e;const l=a.slice(s.length),u=c.wallet_snap.caveats[0];if(!(0,o.isObject)(u))return e;if(!(0,o.hasProperty)(u,"type")||"snapIds"!==u.type||!(0,o.hasProperty)(u,"value")||!(0,o.isObject)(u.value))return e;if(u.value[l]={},"number"!=typeof d.date||"string"!=typeof d.id)return e;d.date>i&&(i=d.date,r=d.id),delete c[a]}c.wallet_snap&&(c.wallet_snap.date=i,c.wallet_snap.id=r,a.permissions=c)}return e}(t.data);return t.data=r,t},r.version=void 0;var n=e("lodash"),o=e("@metamask/utils");const s=r.version=81}}},{package:"$root$",file:"app/scripts/migrations/081.ts"}],[323,{"@metamask/utils":2632,lodash:4362,loglevel:4370,uuid:5195},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,o.cloneDeep)(e);return t.meta.version=l,t.data=function(e){if(!(0,s.hasProperty)(e,"PreferencesController"))return i.default.warn("state.PreferencesController is undefined"),e;if(!(0,s.isObject)(e.PreferencesController)){var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.PreferencesController is "+typeof e.PreferencesController)),e}if(!(0,s.hasProperty)(e,"NetworkController")||!(0,s.isObject)(e.NetworkController)){var n,o;return null===(n=global.sentry)||void 0===n||null===(o=n.captureException)||void 0===o||o.call(n,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}if(!(0,s.hasProperty)(e.PreferencesController,"frequentRpcListDetail")||!Array.isArray(e.PreferencesController.frequentRpcListDetail)){var l,c;if(!(e.NetworkController.networkConfigurations&&e.PreferencesController.frequentRpcListDetail===undefined))null===(l=global.sentry)||void 0===l||null===(c=l.captureException)||void 0===c||c.call(l,new Error("typeof state.PreferencesController.frequentRpcListDetail is "+typeof e.PreferencesController.frequentRpcListDetail));return e}if(!e.PreferencesController.frequentRpcListDetail.every(s.isObject)){var d,u;const t=e.PreferencesController.frequentRpcListDetail.find(e=>!(0,s.isObject)(e));return null===(d=global.sentry)||void 0===d||null===(u=d.captureException)||void 0===u||u.call(d,new Error("state.PreferencesController.frequentRpcListDetail contains an element of type "+typeof t)),e}const{PreferencesController:h,NetworkController:p}=e,{frequentRpcListDetail:m}=h;if(!Array.isArray(m))return e;const f=m.reduce((e,{rpcUrl:t,chainId:r,ticker:n,nickname:o,rpcPrefs:s})=>{const i=(0,a.v4)();return{...e,[i]:{rpcUrl:t,chainId:r,ticker:n,rpcPrefs:s,nickname:o}}},{});return delete h.frequentRpcListDetail,{...e,NetworkController:{...p,networkConfigurations:f},PreferencesController:{...h}}}(t.data),t},r.version=void 0;var n,o=e("lodash"),s=e("@metamask/utils"),a=e("uuid"),i=(n=e("loglevel"))&&n.__esModule?n:{default:n};const l=r.version=82}}},{package:"$root$",file:"app/scripts/migrations/082.ts"}],[324,{"@metamask/utils":2632,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,o.isObject)(e.NetworkController)){var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}const{NetworkController:n}=e;if(!(0,o.isObject)(n.networkConfigurations)){var s,a;return null===(s=global.sentry)||void 0===s||null===(a=s.captureException)||void 0===a||a.call(s,new Error("typeof NetworkController.networkConfigurations is "+typeof n.networkConfigurations)),e}const{networkConfigurations:i}=n,l={};for(const t of Object.keys(i)){const r=i[t];if(!(0,o.isObject)(r))return e;l[t]={...r,id:t}}return{...e,NetworkController:{...n,networkConfigurations:l}}}(t.data),t},r.version=void 0;var n=e("lodash"),o=e("@metamask/utils");const s=r.version=83}}},{package:"$root$",file:"app/scripts/migrations/083.ts"}],[325,{"@metamask/utils":2632,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,o.hasProperty)(e,"NetworkController")||!(0,o.isObject)(e.NetworkController)){var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}if(!(0,o.hasProperty)(e.NetworkController,"network")){var n,s;if(e.NetworkController.networkId===undefined)null===(n=global.sentry)||void 0===n||null===(s=n.captureException)||void 0===s||s.call(n,new Error("typeof state.NetworkController.network is "+typeof e.NetworkController.network));return e}const a={...e.NetworkController};"loading"===a.network?(a.networkId=null,a.networkStatus="unknown"):(a.networkId=a.network,a.networkStatus="available");return delete a.network,{...e,NetworkController:a}}(t.data),t},r.version=void 0;var n=e("lodash"),o=e("@metamask/utils");const s=r.version=84}}},{package:"$root$",file:"app/scripts/migrations/084.ts"}],[326,{"@metamask/utils":2632,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,o.isObject)(e.NetworkController)){var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}return delete e.NetworkController.previousProviderStore,e}(t.data),t},r.version=void 0;var n=e("lodash"),o=e("@metamask/utils");const s=r.version=85}}},{package:"$root$",file:"app/scripts/migrations/085.ts"}],[327,{"@metamask/utils":2632,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,o.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if((0,n.hasProperty)(e,"NetworkController")&&(0,n.isObject)(e.NetworkController)&&(0,n.hasProperty)(e.NetworkController,"provider")){const t=e.NetworkController;return t.providerConfig=t.provider,delete t.provider,{...e,NetworkController:t}}var t,r;if((0,n.isObject)(e.NetworkController)){if(!(0,n.hasProperty)(e.NetworkController,"provider")){var o,s;if(e.NetworkController.providerConfig===undefined)null===(o=global.sentry)||void 0===o||null===(s=o.captureException)||void 0===s||s.call(o,new Error("typeof state.NetworkController.provider is "+typeof e.NetworkController.provider))}}else null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},r.version=void 0;var n=e("@metamask/utils"),o=e("lodash");const s=r.version=86}}},{package:"$root$",file:"app/scripts/migrations/086.ts"}],[328,{"@metamask/utils":2632,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,o.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,n.isObject)(e.TokensController)){var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.TokensController is "+typeof e.TokensController)),e}return delete e.TokensController.suggestedAssets,e}(t.data),t},r.version=void 0;var n=e("@metamask/utils"),o=e("lodash");const s=r.version=87}}},{package:"$root$",file:"app/scripts/migrations/087.ts"}],[329,{"@metamask/utils":2632,"bn.js":3529,lodash:4362,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,s.cloneDeep)(e);return t.meta.version=l,function(e){if((0,n.hasProperty)(e,"NftController")&&(0,n.isObject)(e.NftController)){const l=e.NftController;if((0,n.hasProperty)(l,"allNftContracts")&&(0,n.isObject)(l.allNftContracts)){const{allNftContracts:e}=l;Object.keys(e).every(t=>(0,n.isObject)(e[t]))&&Object.keys(e).forEach(t=>{const r=e[t];if((0,n.isObject)(r)){for(const e of Object.keys(r))"undefined"!==e&&e!==undefined&&"null"!==e||delete r[e];e[t]=(0,s.mapKeys)(r,(e,t)=>c(t))}})}else if((0,n.hasProperty)(l,"allNftContracts")){var t,r;null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NftController.allNftContracts is "+typeof l.allNftContracts))}else a.default.warn("typeof state.NftController.allNftContracts is "+typeof l.allNftContracts);if((0,n.hasProperty)(l,"allNfts")&&(0,n.isObject)(l.allNfts)){const{allNfts:e}=l;Object.keys(e).every(t=>(0,n.isObject)(e[t]))&&Object.keys(e).forEach(t=>{const r=e[t];if((0,n.isObject)(r)){for(const e of Object.keys(r))"undefined"!==e&&e!==undefined&&"null"!==e||delete r[e];e[t]=(0,s.mapKeys)(r,(e,t)=>c(t))}})}else if((0,n.hasProperty)(l,"allNfts")){var o,i;null===(o=global.sentry)||void 0===o||null===(i=o.captureException)||void 0===i||i.call(o,new Error("typeof state.NftController.allNfts is "+typeof l.allNfts))}else a.default.warn("typeof state.NftController.allNfts is "+typeof l.allNfts);e.NftController=l}else if((0,n.hasProperty)(e,"NftController")){var l,d;null===(l=global.sentry)||void 0===l||null===(d=l.captureException)||void 0===d||d.call(l,new Error("typeof state.NftController is "+typeof e.NftController))}else a.default.warn("typeof state.NftController is undefined");if((0,n.hasProperty)(e,"TokenListController")&&(0,n.isObject)(e.TokenListController)){const t=e.TokenListController;if((0,n.hasProperty)(t,"tokensChainsCache")&&(0,n.isObject)(t.tokensChainsCache)){for(const e of Object.keys(t.tokensChainsCache))"undefined"!==e&&e!==undefined&&"null"!==e||delete t.tokensChainsCache[e];t.tokensChainsCache=(0,s.mapKeys)(t.tokensChainsCache,(e,t)=>c(t))}else if((0,n.hasProperty)(t,"tokensChainsCache")){var u,h;null===(u=global.sentry)||void 0===u||null===(h=u.captureException)||void 0===h||h.call(u,new Error("typeof state.TokenListController.tokensChainsCache is "+typeof e.TokenListController.tokensChainsCache))}else a.default.warn("typeof state.TokenListController.tokensChainsCache is undefined")}else a.default.warn("typeof state.TokenListController is "+typeof e.TokenListController);if((0,n.hasProperty)(e,"TokensController")&&(0,n.isObject)(e.TokensController)){const t=e.TokensController;if((0,n.hasProperty)(t,"allTokens")&&(0,n.isObject)(t.allTokens)){const{allTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined&&"null"!==t||delete e[t];t.allTokens=(0,s.mapKeys)(e,(e,t)=>c(t))}else if((0,n.hasProperty)(t,"allTokens")){var p,m;null===(p=global.sentry)||void 0===p||null===(m=p.captureException)||void 0===m||m.call(p,new Error("typeof state.TokensController.allTokens is "+typeof t.allTokens))}else a.default.warn("typeof state.TokensController.allTokens is "+typeof t.allTokens);if((0,n.hasProperty)(t,"allIgnoredTokens")&&(0,n.isObject)(t.allIgnoredTokens)){const{allIgnoredTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined&&"null"!==t||delete e[t];t.allIgnoredTokens=(0,s.mapKeys)(e,(e,t)=>c(t))}else if((0,n.hasProperty)(t,"allIgnoredTokens")){var f,g;null===(f=global.sentry)||void 0===f||null===(g=f.captureException)||void 0===g||g.call(f,new Error("typeof state.TokensController.allIgnoredTokens is "+typeof t.allIgnoredTokens))}else a.default.warn("typeof state.TokensController.allIgnoredTokens is "+typeof t.allIgnoredTokens);if((0,n.hasProperty)(t,"allDetectedTokens")&&(0,n.isObject)(t.allDetectedTokens)){const{allDetectedTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined&&"null"!==t||delete e[t];t.allDetectedTokens=(0,s.mapKeys)(e,(e,t)=>c(t))}else if((0,n.hasProperty)(t,"allDetectedTokens")){var v,y;null===(v=global.sentry)||void 0===v||null===(y=v.captureException)||void 0===y||y.call(v,new Error("typeof state.TokensController.allDetectedTokens is "+typeof t.allDetectedTokens))}else a.default.warn("typeof state.TokensController.allDetectedTokens is "+typeof t.allDetectedTokens);e.TokensController=t}else{var C,b;null===(C=global.sentry)||void 0===C||null===(b=C.captureException)||void 0===b||b.call(C,new Error("typeof state.TokensController is "+typeof e.TokensController))}}(t.data),t},r.version=void 0;var n=e("@metamask/utils"),o=i(e("bn.js")),s=e("lodash"),a=i(e("loglevel"));function i(e){return e&&e.__esModule?e:{default:e}}const l=r.version=88;function c(e){if("string"==typeof e&&(0,n.isStrictHexString)(e))return e;return`0x${o.default.isBN(e)?e.toString(16):new o.default(e.toString(10),10).toString(16)}`}}}},{package:"$root$",file:"app/scripts/migrations/088.ts"}],[33,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getNftDetectionControllerMessenger=function(e){return e.getRestricted({name:"NftDetectionController",allowedEvents:["NetworkController:stateChange","PreferencesController:stateChange"],allowedActions:["ApprovalController:addRequest","NetworkController:getState","NetworkController:getNetworkClientById","AccountsController:getSelectedAccount","NetworkController:findNetworkClientIdByChainId","PhishingController:bulkScanUrls"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/assets/nft-detection-controller-messenger.ts"}],[330,{"@metamask/utils":2632,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,o.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if((0,n.hasProperty)(e,"NetworkController")&&(0,n.isObject)(e.NetworkController)&&(0,n.hasProperty)(e.NetworkController,"providerConfig")&&(0,n.isObject)(e.NetworkController.providerConfig)){const{networkConfigurations:t,providerConfig:r}=e.NetworkController;if(!(0,n.isObject)(t))return e;if(r.id)return e;let o;for(const s of Object.keys(t)){const a=t[s];if(!(0,n.isObject)(a))return e;if(a.rpcUrl===r.rpcUrl){o=a.id;break}}return o?(e.NetworkController.providerConfig={...r,id:o},{...e,NetworkController:e.NetworkController}):e}var t,r;if((0,n.isObject)(e.NetworkController)){if(!(0,n.isObject)(e.NetworkController.providerConfig)){var o,s;null===(o=global.sentry)||void 0===o||null===(s=o.captureException)||void 0===s||s.call(o,new Error("typeof state.NetworkController.providerConfig is "+typeof e.NetworkController.providerConfig))}}else null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},r.version=void 0;var n=e("@metamask/utils"),o=e("lodash");const s=r.version=89}}},{package:"$root$",file:"app/scripts/migrations/089.ts"}],[331,{"@metamask/utils":2632,lodash:4362,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,o.cloneDeep)(e);return t.meta.version=i,t.data=function(e){if(!(0,s.hasProperty)(e,"PhishingController"))return a.default.warn("typeof state.PhishingController is undefined"),e;if(!(0,s.isObject)(e.PhishingController)){var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.PhishingController is "+typeof e.PhishingController)),e}if(!(0,s.hasProperty)(e.PhishingController,"listState"))return a.default.warn("typeof state.PhishingController.listState is "+typeof e.PhishingController),e;return delete e.PhishingController.listState,e}(t.data),t},r.version=void 0;var n,o=e("lodash"),s=e("@metamask/utils"),a=(n=e("loglevel"))&&n.__esModule?n:{default:n};const i=r.version=90}}},{package:"$root$",file:"app/scripts/migrations/090.ts"}],[332,{"@metamask/utils":2632,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,o.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if((0,n.hasProperty)(e,"NetworkController")&&(0,n.isObject)(e.NetworkController)&&(0,n.hasProperty)(e.NetworkController,"networkConfigurations")&&(0,n.isObject)(e.NetworkController.networkConfigurations)){const{networkConfigurations:t}=e.NetworkController;for(const[e,r]of Object.entries(t))(0,n.isObject)(r)&&(r.chainId||delete t[e]);return e.NetworkController={...e.NetworkController,networkConfigurations:t},{...e,NetworkController:e.NetworkController}}var t,r;if((0,n.isObject)(e.NetworkController)){if(!(0,n.isObject)(e.NetworkController.networkConfigurations)){var o,s;null===(o=global.sentry)||void 0===o||null===(s=o.captureException)||void 0===s||s.call(o,new Error("typeof state.NetworkController.networkConfigurations is "+typeof e.NetworkController.networkConfigurations))}}else null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},r.version=void 0;var n=e("@metamask/utils"),o=e("lodash");const s=r.version=91}}},{package:"$root$",file:"app/scripts/migrations/091.ts"}],[3329,{"./cache":3330,"./compile":3334,"./compile/async":3331,"./compile/error_classes":3332,"./compile/formats":3333,"./compile/resolve":3335,"./compile/rules":3336,"./compile/schema_obj":3337,"./compile/util":3339,"./data":3340,"./keyword":3368,"./refs/data.json":3369,"./refs/json-schema-draft-07.json":3370,"fast-json-stable-stringify":3938},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./compile"),o=e("./compile/resolve"),s=e("./cache"),a=e("./compile/schema_obj"),i=e("fast-json-stable-stringify"),l=e("./compile/formats"),c=e("./compile/rules"),d=e("./data"),u=e("./compile/util");t.exports=v,v.prototype.validate=function(e,t){var r;if("string"==typeof e){if(!(r=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var n=this._addSchema(e);r=n.validate||this._compile(n)}var o=r(t);!0!==r.$async&&(this.errors=r.errors);return o},v.prototype.compile=function(e,t){var r=this._addSchema(e,undefined,t);return r.validate||this._compile(r)},v.prototype.addSchema=function(e,t,r,n){if(Array.isArray(e)){for(var s=0;s<e.length;s++)this.addSchema(e[s],undefined,r,n);return this}var a=this._getId(e);if(a!==undefined&&"string"!=typeof a)throw new Error("schema id must be string");return S(this,t=o.normalizeId(t||a)),this._schemas[t]=this._addSchema(e,r,n,!0),this},v.prototype.addMetaSchema=function(e,t,r){return this.addSchema(e,t,r,!0),this},v.prototype.validateSchema=function(e,t){var r=e.$schema;if(r!==undefined&&"string"!=typeof r)throw new Error("$schema must be a string");if(!(r=r||this._opts.defaultMeta||function(e){var t=e._opts.meta;return e._opts.defaultMeta="object"==typeof t?e._getId(t)||t:e.getSchema(m)?m:undefined,e._opts.defaultMeta}(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var n=this.validate(r,e);if(!n&&t){var o="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(o);this.logger.error(o)}return n},v.prototype.getSchema=function(e){var t=y(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return function(e,t){var r=o.schema.call(e,{schema:{}},t);if(r){var s=r.schema,i=r.root,l=r.baseId,c=n.call(e,s,i,undefined,l);return e._fragments[t]=new a({ref:t,fragment:!0,schema:s,root:i,baseId:l,validate:c}),c}}(this,e)}},v.prototype.removeSchema=function(e){if(e instanceof RegExp)return C(this,this._schemas,e),C(this,this._refs,e),this;switch(typeof e){case"undefined":return C(this,this._schemas),C(this,this._refs),this._cache.clear(),this;case"string":var t=y(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var r=this._opts.serialize,n=r?r(e):e;this._cache.del(n);var s=this._getId(e);s&&(s=o.normalizeId(s),delete this._schemas[s],delete this._refs[s])}return this},v.prototype.addFormat=function(e,t){"string"==typeof t&&(t=new RegExp(t));return this._formats[e]=t,this},v.prototype.errorsText=function(e,t){if(!(e=e||this.errors))return"No errors";for(var r=(t=t||{}).separator===undefined?", ":t.separator,n=t.dataVar===undefined?"data":t.dataVar,o="",s=0;s<e.length;s++){var a=e[s];a&&(o+=n+a.dataPath+" "+a.message+r)}return o.slice(0,-r.length)},v.prototype._addSchema=function(e,t,r,n){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var s=this._opts.serialize,i=s?s(e):e,l=this._cache.get(i);if(l)return l;n=n||!1!==this._opts.addUsedSchema;var c=o.normalizeId(this._getId(e));c&&n&&S(this,c);var d,u=!1!==this._opts.validateSchema&&!t;u&&!(d=c&&c==o.normalizeId(e.$schema))&&this.validateSchema(e,!0);var h=o.ids.call(this,e),p=new a({id:c,schema:e,localRefs:h,cacheKey:i,meta:r});"#"!=c[0]&&n&&(this._refs[c]=p);this._cache.put(i,p),u&&d&&this.validateSchema(e,!0);return p},v.prototype._compile=function(e,t){if(e.compiling)return e.validate=s,s.schema=e.schema,s.errors=null,s.root=t||s,!0===e.schema.$async&&(s.$async=!0),s;var r,o;e.compiling=!0,e.meta&&(r=this._opts,this._opts=this._metaOpts);try{o=n.call(this,e.schema,t,e.localRefs)}catch(t){throw delete e.validate,t}finally{e.compiling=!1,e.meta&&(this._opts=r)}return e.validate=o,e.refs=o.refs,e.refVal=o.refVal,e.root=o.root,o;function s(){var t=e.validate,r=t.apply(this,arguments);return s.errors=t.errors,r}},v.prototype.compileAsync=e("./compile/async");var h=e("./keyword");v.prototype.addKeyword=h.add,v.prototype.getKeyword=h.get,v.prototype.removeKeyword=h.remove,v.prototype.validateKeyword=h.validate;var p=e("./compile/error_classes");v.ValidationError=p.Validation,v.MissingRefError=p.MissingRef,v.$dataMetaSchema=d;var m="http://json-schema.org/draft-07/schema",f=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],g=["/properties"];function v(t){if(!(this instanceof v))return new v(t);t=this._opts=u.copy(t)||{},function(e){var t=e._opts.logger;if(!1===t)e.logger={log:P,warn:P,error:P};else{if(t===undefined&&(t=console),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=l(t.format),this._cache=t.cache||new s,this._loadingSchemas={},this._compilations=[],this.RULES=c(),this._getId=function(e){switch(e.schemaId){case"auto":return k;case"id":return b;default:return w}}(t),t.loopRequired=t.loopRequired||Infinity,"property"==t.errorDataPath&&(t._errorDataPathProperty=!0),t.serialize===undefined&&(t.serialize=i),this._metaOpts=function(e){for(var t=u.copy(e._opts),r=0;r<f.length;r++)delete t[f[r]];return t}(this),t.formats&&function(e){for(var t in e._opts.formats){var r=e._opts.formats[t];e.addFormat(t,r)}}(this),t.keywords&&function(e){for(var t in e._opts.keywords){var r=e._opts.keywords[t];e.addKeyword(t,r)}}(this),function(t){var r;t._opts.$data&&(r=e("./refs/data.json"),t.addMetaSchema(r,r.$id,!0));if(!1===t._opts.meta)return;var n=e("./refs/json-schema-draft-07.json");t._opts.$data&&(n=d(n,g));t.addMetaSchema(n,m,!0),t._refs["http://json-schema.org/schema"]=m}(this),"object"==typeof t.meta&&this.addMetaSchema(t.meta),t.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),function(e){var t=e._opts.schemas;if(!t)return;if(Array.isArray(t))e.addSchema(t);else for(var r in t)e.addSchema(t[r],r)}(this)}function y(e,t){return t=o.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function C(e,t,r){for(var n in t){var o=t[n];o.meta||r&&!r.test(n)||(e._cache.del(o.cacheKey),delete t[n])}}function b(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function w(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function k(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function S(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function P(){}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/ajv.js"}],[333,{"@metamask/utils":2632,lodash:4362,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,o.cloneDeep)(e);return t.meta.version=i,t.data=function(e){if(!(0,s.hasProperty)(e,"TokenListController"))return a.default.warn("Skipping migration, TokenListController state is missing"),e;var t,r;if(!(0,s.isObject)(e.TokenListController))return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.TokenListController is "+typeof e.TokenListController)),e;if(!(0,s.hasProperty)(e.TokenListController,"tokensChainsCache"))return a.default.warn("Skipping migration, TokenListController.tokensChainsCache state is missing"),e;e.TokenListController.tokensChainsCache===undefined&&delete e.TokenListController.tokensChainsCache;return e}(t.data),t},r.version=void 0;var n,o=e("lodash"),s=e("@metamask/utils"),a=(n=e("loglevel"))&&n.__esModule?n:{default:n};const i=r.version=92.1}}},{package:"$root$",file:"app/scripts/migrations/092.1.ts"}],[3330,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=t.exports=function(){this._cache={}};n.prototype.put=function(e,t){this._cache[e]=t},n.prototype.get=function(e){return this._cache[e]},n.prototype.del=function(e){delete this._cache[e]},n.prototype.clear=function(){this._cache={}}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/cache.js"}],[3331,{"./error_classes":3332},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./error_classes").MissingRef;t.exports=function e(t,r,o){var s=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof r&&(o=r,r=undefined);var a=i(t).then(function(){var e=s._addSchema(t,undefined,r);return e.validate||l(e)});o&&a.then(function(e){o(null,e)},o);return a;function i(t){var r=t.$schema;return r&&!s.getSchema(r)?e.call(s,{$ref:r},!0):Promise.resolve()}function l(e){try{return s._compile(e)}catch(t){if(t instanceof n)return function(t){var n=t.missingSchema;if(c(n))throw new Error("Schema "+n+" is loaded but "+t.missingRef+" cannot be resolved");var o=s._loadingSchemas[n];o||(o=s._loadingSchemas[n]=s._opts.loadSchema(n)).then(a,a);return o.then(function(e){if(!c(n))return i(e).then(function(){c(n)||s.addSchema(e,n,undefined,r)})}).then(function(){return l(e)});function a(){delete s._loadingSchemas[n]}function c(e){return s._refs[e]||s._schemas[e]}}(t);throw t}}}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/compile/async.js"}],[3332,{"./resolve":3335},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./resolve");function o(e,t,r){this.message=r||o.message(e,t),this.missingRef=n.url(e,t),this.missingSchema=n.normalizeId(n.fullPath(this.missingRef))}function s(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}t.exports={Validation:s(function(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0}),MissingRef:s(o)},o.message=function(e,t){return"can't resolve reference "+t+" from id "+e}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/compile/error_classes.js"}],[3333,{"./util":3339},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./util"),o=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,s=[0,31,28,31,30,31,30,31,31,30,31,30,31],a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,i=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,l=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,c=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,d=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,u=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,h=/^(?:\/(?:[^~/]|~0|~1)*)*$/,p=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,m=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;function f(e){return e="full"==e?"full":"fast",n.copy(f[e])}function g(e){var t=e.match(o);if(!t)return!1;var r=+t[1],n=+t[2],a=+t[3];return n>=1&&n<=12&&a>=1&&a<=(2==n&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(r)?29:s[n])}function v(e,t){var r=e.match(a);if(!r)return!1;var n=r[1],o=r[2],s=r[3],i=r[5];return(n<=23&&o<=59&&s<=59||23==n&&59==o&&60==s)&&(!t||i)}t.exports=f,f.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":c,url:d,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:w,uuid:u,"json-pointer":h,"json-pointer-uri-fragment":p,"relative-json-pointer":m},f.full={date:g,time:v,"date-time":function(e){var t=e.split(y);return 2==t.length&&g(t[0])&&v(t[1],!0)},uri:function(e){return C.test(e)&&l.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":c,url:d,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:w,uuid:u,"json-pointer":h,"json-pointer-uri-fragment":p,"relative-json-pointer":m};var y=/t|\s/i;var C=/\/|:/;var b=/[^\\]\\Z/;function w(e){if(b.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/compile/formats.js"}],[3334,{"../dotjs/validate":3367,"./error_classes":3332,"./resolve":3335,"./util":3339,"fast-deep-equal":3931,"fast-json-stable-stringify":3938},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./resolve"),o=e("./util"),s=e("./error_classes"),a=e("fast-json-stable-stringify"),i=e("../dotjs/validate"),l=o.ucs2length,c=e("fast-deep-equal"),d=s.Validation;function u(e,t,r){var n=p.call(this,e,t,r);return n>=0?{index:n,compiling:!0}:(n=this._compilations.length,this._compilations[n]={schema:e,root:t,baseId:r},{index:n,compiling:!1})}function h(e,t,r){var n=p.call(this,e,t,r);n>=0&&this._compilations.splice(n,1)}function p(e,t,r){for(var n=0;n<this._compilations.length;n++){var o=this._compilations[n];if(o.schema==e&&o.root==t&&o.baseId==r)return n}return-1}function m(e,t){return"var pattern"+e+" = new RegExp("+o.toQuotedString(t[e])+");"}function f(e){return"var default"+e+" = defaults["+e+"];"}function g(e,t){return t[e]===undefined?"":"var refVal"+e+" = refVal["+e+"];"}function v(e){return"var customRule"+e+" = customRules["+e+"];"}function y(e,t){if(!e.length)return"";for(var r="",n=0;n<e.length;n++)r+=t(n,e);return r}t.exports=function e(t,r,p,C){var b=this,w=this._opts,k=[undefined],S={},P=[],T={},M=[],E={},A=[];r=r||{schema:t,refVal:k,refs:S};var O=u.call(this,t,r,C),j=this._compilations[O.index];if(O.compiling)return j.callValidate=function e(){var t=j.validate,r=t.apply(this,arguments);return e.errors=t.errors,r};var _=this._formats,I=this.RULES;try{var N=D(t,r,p,C);j.validate=N;var R=j.callValidate;return R&&(R.schema=N.schema,R.errors=null,R.refs=N.refs,R.refVal=N.refVal,R.root=N.root,R.$async=N.$async,w.sourceCode&&(R.source=N.source)),N}finally{h.call(this,t,r,C)}function D(t,a,u,h){var p=!a||a&&a.schema==t;if(a.schema!=r.schema)return e.call(b,t,a,u,h);var C,T=!0===t.$async,E=i({isTop:!0,schema:t,isRoot:p,baseId:h,root:a,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:s.MissingRef,RULES:I,validate:i,util:o,resolve:n,resolveRef:F,usePattern:$,useDefault:B,useCustomRule:U,opts:w,formats:_,logger:b.logger,self:b});E=y(k,g)+y(P,m)+y(M,f)+y(A,v)+E,w.processCode&&(E=w.processCode(E,t));try{C=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",E)(b,I,_,r,k,M,A,c,l,d),k[0]=C}catch(e){throw b.logger.error("Error compiling schema, function code:",E),e}return C.schema=t,C.errors=null,C.refs=S,C.refVal=k,C.root=p?C:a,T&&(C.$async=!0),!0===w.sourceCode&&(C.source={code:E,patterns:P,defaults:M}),C}function F(t,o,s){o=n.url(t,o);var a,i,l=S[o];if(l!==undefined)return L(a=k[l],i="refVal["+l+"]");if(!s&&r.refs){var c=r.refs[o];if(c!==undefined)return L(a=r.refVal[c],i=x(o,a))}i=x(o);var d=n.call(b,D,r,o);if(d===undefined){var u=p&&p[o];u&&(d=n.inlineRef(u,w.inlineRefs)?u:e.call(b,u,r,p,t))}if(d!==undefined)return function(e,t){var r=S[e];k[r]=t}(o,d),L(d,i);!function(e){delete S[e]}(o)}function x(e,t){var r=k.length;return k[r]=t,S[e]=r,"refVal"+r}function L(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function $(e){var t=T[e];return t===undefined&&(t=T[e]=P.length,P[t]=e),"pattern"+t}function B(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return o.toQuotedString(e);case"object":if(null===e)return"null";var t=a(e),r=E[t];return r===undefined&&(r=E[t]=M.length,M[r]=e),"default"+r}}function U(e,t,r,n){if(!1!==b._opts.validateSchema){var o=e.definition.dependencies;if(o&&!o.every(function(e){return Object.prototype.hasOwnProperty.call(r,e)}))throw new Error("parent schema must have all required keywords: "+o.join(","));var s=e.definition.validateSchema;if(s)if(!s(t)){var a="keyword schema is invalid: "+b.errorsText(s.errors);if("log"!=b._opts.validateSchema)throw new Error(a);b.logger.error(a)}}var i,l=e.definition.compile,c=e.definition.inline,d=e.definition.macro;if(l)i=l.call(b,t,r,n);else if(d)i=d.call(b,t,r,n),!1!==w.validateSchema&&b.validateSchema(i,!0);else if(c)i=c.call(b,n,e.keyword,t,r);else if(!(i=e.definition.validate))return;if(i===undefined)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var u=A.length;return A[u]=i,{code:"customRule"+u,validate:i}}}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/compile/index.js"}],[3335,{"./schema_obj":3337,"./util":3339,"fast-deep-equal":3931,"json-schema-traverse":3371,"uri-js":5169},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("uri-js"),o=e("fast-deep-equal"),s=e("./util"),a=e("./schema_obj"),i=e("json-schema-traverse");function l(e,t,r){var n=this._refs[r];if("string"==typeof n){if(!this._refs[n])return l.call(this,e,t,n);n=this._refs[n]}if((n=n||this._schemas[r])instanceof a)return m(n.schema,this._opts.inlineRefs)?n.schema:n.validate||this._compile(n);var o,s,i,d=c.call(this,t,r);return d&&(o=d.schema,t=d.root,i=d.baseId),o instanceof a?s=o.validate||e.call(this,o.schema,t,undefined,i):o!==undefined&&(s=m(o,this._opts.inlineRefs)?o:e.call(this,o,t,undefined,i)),s}function c(e,t){var r=n.parse(t),o=y(r),s=v(this._getId(e.schema));if(0===Object.keys(e.schema).length||o!==s){var i=b(o),l=this._refs[i];if("string"==typeof l)return d.call(this,e,l,r);if(l instanceof a)l.validate||this._compile(l),e=l;else{if(!((l=this._schemas[i])instanceof a))return;if(l.validate||this._compile(l),i==b(t))return{schema:l,root:e,baseId:s};e=l}if(!e.schema)return;s=v(this._getId(e.schema))}return h.call(this,r,s,e.schema,e)}function d(e,t,r){var n=c.call(this,e,t);if(n){var o=n.schema,s=n.baseId;e=n.root;var a=this._getId(o);return a&&(s=w(s,a)),h.call(this,r,s,o,e)}}t.exports=l,l.normalizeId=b,l.fullPath=v,l.url=w,l.ids=function(e){var t=b(this._getId(e)),r={"":t},a={"":v(t,!1)},l={},c=this;return i(e,{allKeys:!0},function(e,t,i,d,u,h,p){if(""!==t){var m=c._getId(e),f=r[d],g=a[d]+"/"+u;if(p!==undefined&&(g+="/"+("number"==typeof p?p:s.escapeFragment(p))),"string"==typeof m){m=f=b(f?n.resolve(f,m):m);var v=c._refs[m];if("string"==typeof v&&(v=c._refs[v]),v&&v.schema){if(!o(e,v.schema))throw new Error('id "'+m+'" resolves to more than one schema')}else if(m!=b(g))if("#"==m[0]){if(l[m]&&!o(e,l[m]))throw new Error('id "'+m+'" resolves to more than one schema');l[m]=e}else c._refs[m]=g}r[t]=f,a[t]=g}}),l},l.inlineRef=m,l.schema=c;var u=s.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function h(e,t,r,n){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var o=e.fragment.split("/"),a=1;a<o.length;a++){var i=o[a];if(i){if((r=r[i=s.unescapeFragment(i)])===undefined)break;var l;if(!u[i]&&((l=this._getId(r))&&(t=w(t,l)),r.$ref)){var d=w(t,r.$ref),h=c.call(this,n,d);h&&(r=h.schema,n=h.root,t=h.baseId)}}}return r!==undefined&&r!==n.schema?{schema:r,root:n,baseId:t}:void 0}}var p=s.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function m(e,t){return!1!==t&&(t===undefined||!0===t?f(e):t?g(e)<=t:void 0)}function f(e){var t;if(Array.isArray(e)){for(var r=0;r<e.length;r++)if("object"==typeof(t=e[r])&&!f(t))return!1}else for(var n in e){if("$ref"==n)return!1;if("object"==typeof(t=e[n])&&!f(t))return!1}return!0}function g(e){var t,r=0;if(Array.isArray(e)){for(var n=0;n<e.length;n++)if("object"==typeof(t=e[n])&&(r+=g(t)),r==Infinity)return Infinity}else for(var o in e){if("$ref"==o)return Infinity;if(p[o])r++;else if("object"==typeof(t=e[o])&&(r+=g(t)+1),r==Infinity)return Infinity}return r}function v(e,t){return!1!==t&&(e=b(e)),y(n.parse(e))}function y(e){return n.serialize(e).split("#")[0]+"#"}var C=/#\/?$/;function b(e){return e?e.replace(C,""):""}function w(e,t){return t=b(t),n.resolve(e,t)}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/compile/resolve.js"}],[3336,{"../dotjs":3356,"./util":3339},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("../dotjs"),o=e("./util").toHash;t.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"];return e.all=o(t),e.types=o(["number","integer","string","array","object","boolean","null"]),e.forEach(function(r){r.rules=r.rules.map(function(r){var o;if("object"==typeof r){var s=Object.keys(r)[0];o=r[s],r=s,o.forEach(function(r){t.push(r),e.all[r]=!0})}return t.push(r),e.all[r]={keyword:r,code:n[r],implements:o}}),e.all.$comment={keyword:"$comment",code:n.$comment},r.type&&(e.types[r.type]=r)}),e.keywords=o(t.concat(["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),e.custom={},e}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/compile/rules.js"}],[3337,{"./util":3339},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./util");t.exports=function(e){n.copy(e,this)}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/compile/schema_obj.js"}],[3338,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e){for(var t,r=0,n=e.length,o=0;o<n;)r++,(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<n&&56320==(64512&(t=e.charCodeAt(o)))&&o++;return r}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/compile/ucs2length.js"}],[3339,{"./ucs2length":3338,"fast-deep-equal":3931},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e,t,r,n){var o=n?" !== ":" === ",s=n?" || ":" && ",a=n?"!":"",i=n?"":"!";switch(e){case"null":return t+o+"null";case"array":return a+"Array.isArray("+t+")";case"object":return"("+a+t+s+"typeof "+t+o+'"object"'+s+i+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+o+'"number"'+s+i+"("+t+" % 1)"+s+t+o+t+(r?s+a+"isFinite("+t+")":"")+")";case"number":return"(typeof "+t+o+'"'+e+'"'+(r?s+a+"isFinite("+t+")":"")+")";default:return"typeof "+t+o+'"'+e+'"'}}t.exports={copy:function(e,t){for(var r in t=t||{},e)t[r]=e[r];return t},checkDataType:n,checkDataTypes:function(e,t,r){if(1===e.length)return n(e[0],t,r,!0);var o="",a=s(e);for(var i in a.array&&a.object&&(o=a.null?"(":"(!"+t+" || ",o+="typeof "+t+' !== "object")',delete a.null,delete a.array,delete a.object),a.number&&delete a.integer,a)o+=(o?" && ":"")+n(i,t,r,!0);return o},coerceToTypes:function(e,t){if(Array.isArray(t)){for(var r=[],n=0;n<t.length;n++){var s=t[n];(o[s]||"array"===e&&"array"===s)&&(r[r.length]=s)}if(r.length)return r}else{if(o[t])return[t];if("array"===e&&"array"===t)return["array"]}},toHash:s,getProperty:l,escapeQuotes:c,equal:e("fast-deep-equal"),ucs2length:e("./ucs2length"),varOccurences:function(e,t){t+="[^0-9]";var r=e.match(new RegExp(t,"g"));return r?r.length:0},varReplace:function(e,t,r){return t+="([^0-9])",r=r.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),r+"$1")},schemaHasRules:function(e,t){if("boolean"==typeof e)return!e;for(var r in e)if(t[r])return!0},schemaHasRulesExcept:function(e,t,r){if("boolean"==typeof e)return!e&&"not"!=r;for(var n in e)if(n!=r&&t[n])return!0},schemaUnknownRules:function(e,t){if("boolean"==typeof e)return;for(var r in e)if(!t[r])return r},toQuotedString:d,getPathExpr:function(e,t,r,n){return p(e,r?"'/' + "+t+(n?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):n?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")},getPath:function(e,t,r){var n=d(r?"/"+m(t):l(t));return p(e,n)},getData:function(e,t,r){var n,o,s,a;if(""===e)return"rootData";if("/"==e[0]){if(!u.test(e))throw new Error("Invalid JSON-pointer: "+e);o=e,s="rootData"}else{if(!(a=e.match(h)))throw new Error("Invalid JSON-pointer: "+e);if(n=+a[1],"#"==(o=a[2])){if(n>=t)throw new Error("Cannot access property/index "+n+" levels up, current level is "+t);return r[t-n]}if(n>t)throw new Error("Cannot access data "+n+" levels up, current level is "+t);if(s="data"+(t-n||""),!o)return s}for(var i=s,c=o.split("/"),d=0;d<c.length;d++){var p=c[d];p&&(i+=" && "+(s+=l(f(p))))}return i},unescapeFragment:function(e){return f(decodeURIComponent(e))},unescapeJsonPointer:f,escapeFragment:function(e){return encodeURIComponent(m(e))},escapeJsonPointer:m};var o=s(["string","number","integer","boolean","null"]);function s(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}var a=/^[a-z$_][a-z$_0-9]*$/i,i=/'|\\/g;function l(e){return"number"==typeof e?"["+e+"]":a.test(e)?"."+e:"['"+c(e)+"']"}function c(e){return e.replace(i,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function d(e){return"'"+c(e)+"'"}var u=/^\/(?:[^~]|~0|~1)*$/,h=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function p(e,t){return'""'==e?t:(e+" + "+t).replace(/([^\\])' \+ '/g,"$1")}function m(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function f(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/compile/util.js"}],[334,{"../../../shared/lib/sentry":5336,"@metamask/utils":2632,lodash:4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,o.cloneDeep)(e);return t.meta.version=a,t.data=function(e){return function(e){const t=["networkId","networkStatus","providerConfig","networkDetails","networkConfigurations"];if(!(0,n.hasProperty)(e,"NetworkController")||!(0,o.isObject)(e.NetworkController))return(0,s.captureException)(`Migration ${a}: Invalid NetworkController state: ${typeof e.NetworkController}`),e;const r=e.NetworkController,i=(0,o.pick)(r,t);return{...e,NetworkController:i}}(e)}(t.data),t},r.version=void 0;var n=e("@metamask/utils"),o=e("lodash"),s=e("../../../shared/lib/sentry");const a=r.version=92.2}}},{package:"$root$",file:"app/scripts/migrations/092.2.ts"}],[3340,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];t.exports=function(e,t){for(var r=0;r<t.length;r++){e=JSON.parse(JSON.stringify(e));var o,s=t[r].split("/"),a=e;for(o=1;o<s.length;o++)a=a[s[o]];for(o=0;o<n.length;o++){var i=n[o],l=a[i];l&&(a[i]={anyOf:[l,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return e}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/data.js"}],[3341,{"./refs/json-schema-draft-07.json":3370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./refs/json-schema-draft-07.json");t.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:n.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:n.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/definition_schema.js"}],[3342,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n,o=" ",s=e.level,a=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(a||""),h=e.opts.$data&&i&&i.$data;h?(o+=" var schema"+s+" = "+e.util.getData(i.$data,a,e.dataPathArr)+"; ",n="schema"+s):n=i;var p="maximum"==t,m=p?"exclusiveMaximum":"exclusiveMinimum",f=e.schema[m],g=e.opts.$data&&f&&f.$data,v=p?"<":">",y=p?">":"<",C=undefined;if(!h&&"number"!=typeof i&&i!==undefined)throw new Error(t+" must be number");if(!g&&f!==undefined&&"number"!=typeof f&&"boolean"!=typeof f)throw new Error(m+" must be number or boolean");if(g){var b=e.util.getData(f.$data,a,e.dataPathArr),w="exclusive"+s,k="exclType"+s,S="exclIsNumber"+s,P="' + "+(E="op"+s)+" + '";o+=" var schemaExcl"+s+" = "+b+"; ",o+=" var "+w+"; var "+k+" = typeof "+(b="schemaExcl"+s)+"; if ("+k+" != 'boolean' && "+k+" != 'undefined' && "+k+" != 'number') { ";var T;C=m;(T=T||[]).push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(C||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(o+=" , message: '"+m+" should be boolean' "),e.opts.verbose&&(o+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),o+=" } "):o+=" {} ";var M=o;o=T.pop(),!e.compositeRule&&d?e.async?o+=" throw new ValidationError(["+M+"]); ":o+=" validate.errors = ["+M+"]; return false; ":o+=" var err = "+M+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+=" } else if ( ",h&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),o+=" "+k+" == 'number' ? ( ("+w+" = "+n+" === undefined || "+b+" "+v+"= "+n+") ? "+u+" "+y+"= "+b+" : "+u+" "+y+" "+n+" ) : ( ("+w+" = "+b+" === true) ? "+u+" "+y+"= "+n+" : "+u+" "+y+" "+n+" ) || "+u+" !== "+u+") { var op"+s+" = "+w+" ? '"+v+"' : '"+v+"='; ",i===undefined&&(C=m,c=e.errSchemaPath+"/"+m,n=b,h=g)}else{P=v;if((S="number"==typeof f)&&h){var E="'"+P+"'";o+=" if ( ",h&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),o+=" ( "+n+" === undefined || "+f+" "+v+"= "+n+" ? "+u+" "+y+"= "+f+" : "+u+" "+y+" "+n+" ) || "+u+" !== "+u+") { "}else{S&&i===undefined?(w=!0,C=m,c=e.errSchemaPath+"/"+m,n=f,y+="="):(S&&(n=Math[p?"min":"max"](f,i)),f===(!S||n)?(w=!0,C=m,c=e.errSchemaPath+"/"+m,y+="="):(w=!1,P+="="));E="'"+P+"'";o+=" if ( ",h&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),o+=" "+u+" "+y+" "+n+" || "+u+" !== "+u+") { "}}C=C||t,(T=T||[]).push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(C||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+E+", limit: "+n+", exclusive: "+w+" } ",!1!==e.opts.messages&&(o+=" , message: 'should be "+P+" ",o+=h?"' + "+n:n+"'"),e.opts.verbose&&(o+=" , schema:  ",o+=h?"validate.schema"+l:""+i,o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),o+=" } "):o+=" {} ";M=o;return o=T.pop(),!e.compositeRule&&d?e.async?o+=" throw new ValidationError(["+M+"]); ":o+=" validate.errors = ["+M+"]; return false; ":o+=" var err = "+M+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+=" } ",d&&(o+=" else { "),o}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/_limit.js"}],[3343,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n,o=" ",s=e.level,a=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(a||""),h=e.opts.$data&&i&&i.$data;if(h?(o+=" var schema"+s+" = "+e.util.getData(i.$data,a,e.dataPathArr)+"; ",n="schema"+s):n=i,!h&&"number"!=typeof i)throw new Error(t+" must be number");o+="if ( ",h&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),o+=" "+u+".length "+("maxItems"==t?">":"<")+" "+n+") { ";var p=t,m=m||[];m.push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(p||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(o+=" , message: 'should NOT have ",o+="maxItems"==t?"more":"fewer",o+=" than ",o+=h?"' + "+n+" + '":""+i,o+=" items' "),e.opts.verbose&&(o+=" , schema:  ",o+=h?"validate.schema"+l:""+i,o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),o+=" } "):o+=" {} ";var f=o;return o=m.pop(),!e.compositeRule&&d?e.async?o+=" throw new ValidationError(["+f+"]); ":o+=" validate.errors = ["+f+"]; return false; ":o+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+="} ",d&&(o+=" else { "),o}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/_limitItems.js"}],[3344,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n,o=" ",s=e.level,a=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(a||""),h=e.opts.$data&&i&&i.$data;if(h?(o+=" var schema"+s+" = "+e.util.getData(i.$data,a,e.dataPathArr)+"; ",n="schema"+s):n=i,!h&&"number"!=typeof i)throw new Error(t+" must be number");var p="maxLength"==t?">":"<";o+="if ( ",h&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),!1===e.opts.unicode?o+=" "+u+".length ":o+=" ucs2length("+u+") ",o+=" "+p+" "+n+") { ";var m=t,f=f||[];f.push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(m||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(o+=" , message: 'should NOT be ",o+="maxLength"==t?"longer":"shorter",o+=" than ",o+=h?"' + "+n+" + '":""+i,o+=" characters' "),e.opts.verbose&&(o+=" , schema:  ",o+=h?"validate.schema"+l:""+i,o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),o+=" } "):o+=" {} ";var g=o;return o=f.pop(),!e.compositeRule&&d?e.async?o+=" throw new ValidationError(["+g+"]); ":o+=" validate.errors = ["+g+"]; return false; ":o+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+="} ",d&&(o+=" else { "),o}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/_limitLength.js"}],[3345,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n,o=" ",s=e.level,a=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(a||""),h=e.opts.$data&&i&&i.$data;if(h?(o+=" var schema"+s+" = "+e.util.getData(i.$data,a,e.dataPathArr)+"; ",n="schema"+s):n=i,!h&&"number"!=typeof i)throw new Error(t+" must be number");o+="if ( ",h&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),o+=" Object.keys("+u+").length "+("maxProperties"==t?">":"<")+" "+n+") { ";var p=t,m=m||[];m.push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(p||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(o+=" , message: 'should NOT have ",o+="maxProperties"==t?"more":"fewer",o+=" than ",o+=h?"' + "+n+" + '":""+i,o+=" properties' "),e.opts.verbose&&(o+=" , schema:  ",o+=h?"validate.schema"+l:""+i,o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),o+=" } "):o+=" {} ";var f=o;return o=m.pop(),!e.compositeRule&&d?e.async?o+=" throw new ValidationError(["+f+"]); ":o+=" validate.errors = ["+f+"]; return false; ":o+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+="} ",d&&(o+=" else { "),o}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/_limitProperties.js"}],[3346,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.schema[t],s=e.schemaPath+e.util.getProperty(t),a=e.errSchemaPath+"/"+t,i=!e.opts.allErrors,l=e.util.copy(e),c="";l.level++;var d="valid"+l.level,u=l.baseId,h=!0,p=o;if(p)for(var m,f=-1,g=p.length-1;f<g;)m=p[f+=1],(e.opts.strictKeywords?"object"==typeof m&&Object.keys(m).length>0||!1===m:e.util.schemaHasRules(m,e.RULES.all))&&(h=!1,l.schema=m,l.schemaPath=s+"["+f+"]",l.errSchemaPath=a+"/"+f,n+="  "+e.validate(l)+" ",l.baseId=u,i&&(n+=" if ("+d+") { ",c+="}"));return i&&(n+=h?" if (true) { ":" "+c.slice(0,-1)+" "),n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/allOf.js"}],[3347,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.level,s=e.dataLevel,a=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+o,h="errs__"+o,p=e.util.copy(e),m="";p.level++;var f="valid"+p.level,g=a.every(function(t){return e.opts.strictKeywords?"object"==typeof t&&Object.keys(t).length>0||!1===t:e.util.schemaHasRules(t,e.RULES.all)});if(g){var v=p.baseId;n+=" var "+h+" = errors; var "+u+" = false;  ";var y=e.compositeRule;e.compositeRule=p.compositeRule=!0;var C=a;if(C)for(var b,w=-1,k=C.length-1;w<k;)b=C[w+=1],p.schema=b,p.schemaPath=i+"["+w+"]",p.errSchemaPath=l+"/"+w,n+="  "+e.validate(p)+" ",p.baseId=v,n+=" "+u+" = "+u+" || "+f+"; if (!"+u+") { ",m+="}";e.compositeRule=p.compositeRule=y,n+=" "+m+" if (!"+u+") {   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(n+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+=" } else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } ",e.opts.allErrors&&(n+=" } ")}else c&&(n+=" if (true) { ");return n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/anyOf.js"}],[3348,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.schema[t],s=e.errSchemaPath+"/"+t,a=(e.opts.allErrors,e.util.toQuotedString(o));return!0===e.opts.$comment?n+=" console.log("+a+");":"function"==typeof e.opts.$comment&&(n+=" self._opts.$comment("+a+", "+e.util.toQuotedString(s)+", validate.root.schema);"),n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/comment.js"}],[3349,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.level,s=e.dataLevel,a=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+o,h=e.opts.$data&&a&&a.$data;h&&(n+=" var schema"+o+" = "+e.util.getData(a.$data,s,e.dataPathArr)+"; "),h||(n+=" var schema"+o+" = validate.schema"+i+";"),n+="var "+u+" = equal("+d+", schema"+o+"); if (!"+u+") {   ";var p=p||[];p.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValue: schema"+o+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be equal to constant' "),e.opts.verbose&&(n+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var m=n;return n=p.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+m+"]); ":n+=" validate.errors = ["+m+"]; return false; ":n+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }",c&&(n+=" else { "),n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/const.js"}],[335,{"@metamask/utils":2632,lodash:4362,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,s.cloneDeep)(e);return t.meta.version=i,function(e){!function(e){if((0,o.isNullOrUndefined)(e.PreferencesController))return void a.default.warn(`Migration #${i}: preferences controller null or undefined, skipping migration`);if((0,o.hasProperty)(e,"AppStateController")&&(0,o.isObject)(e.AppStateController)&&(0,o.hasProperty)(e,"PreferencesController")&&(0,o.isObject)(e.PreferencesController)){var t;const r=null===(t=e.PreferencesController)||void 0===t?void 0:t.advancedGasFee,n=(0,o.isObject)(r)&&l(r);e.AppStateController.hadAdvancedGasFeesSetPriorToMigration92_3=n,(null===e.PreferencesController.advancedGasFee||(0,o.isObject)(e.PreferencesController.advancedGasFee)&&l(e.PreferencesController.advancedGasFee))&&(e.PreferencesController.advancedGasFee={})}else if(!1===(0,o.isObject)(e.AppStateController)){var r,n;null===(r=global.sentry)||void 0===r||null===(n=r.captureException)||void 0===n||n.call(r,new Error("typeof state.AppStateController is "+typeof e.AppStateController))}else if(!1===(0,o.isObject)(e.PreferencesController)){var s,c;null===(s=global.sentry)||void 0===s||null===(c=s.captureException)||void 0===c||c.call(s,new Error("typeof state.PreferencesController is "+typeof e.PreferencesController))}}(e)}(t.data),t},r.version=void 0;var n,o=e("@metamask/utils"),s=e("lodash"),a=(n=e("loglevel"))&&n.__esModule?n:{default:n};const i=r.version=92.3;function l(e){const t=Object.keys(e);return!(!t.includes("maxBaseFee")&&!t.includes("priorityFee"))}}}},{package:"$root$",file:"app/scripts/migrations/092.3.ts"}],[3350,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.level,s=e.dataLevel,a=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+o,h="errs__"+o,p=e.util.copy(e);p.level++;var m="valid"+p.level,f="i"+o,g=p.dataLevel=e.dataLevel+1,v="data"+g,y=e.baseId,C=e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all);if(n+="var "+h+" = errors;var "+u+";",C){var b=e.compositeRule;e.compositeRule=p.compositeRule=!0,p.schema=a,p.schemaPath=i,p.errSchemaPath=l,n+=" var "+m+" = false; for (var "+f+" = 0; "+f+" < "+d+".length; "+f+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers,!0);var w=d+"["+f+"]";p.dataPathArr[g]=f;var k=e.validate(p);p.baseId=y,e.util.varOccurences(k,v)<2?n+=" "+e.util.varReplace(k,v,w)+" ":n+=" var "+v+" = "+w+"; "+k+" ",n+=" if ("+m+") break; }  ",e.compositeRule=p.compositeRule=b,n+="  if (!"+m+") {"}else n+=" if ("+d+".length == 0) {";var S=S||[];S.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should contain a valid item' "),e.opts.verbose&&(n+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var P=n;return n=S.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+P+"]); ":n+=" validate.errors = ["+P+"]; return false; ":n+=" var err = "+P+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { ",C&&(n+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } "),e.opts.allErrors&&(n+=" } "),n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/contains.js"}],[3351,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n,o,s=" ",a=e.level,i=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,h="data"+(i||""),p="valid"+a,m="errs__"+a,f=e.opts.$data&&l&&l.$data;f?(s+=" var schema"+a+" = "+e.util.getData(l.$data,i,e.dataPathArr)+"; ",o="schema"+a):o=l;var g,v,y,C,b,w=this,k="definition"+a,S=w.definition,P="";if(f&&S.$data){b="keywordValidate"+a;var T=S.validateSchema;s+=" var "+k+" = RULES.custom['"+t+"'].definition; var "+b+" = "+k+".validate;"}else{if(!(C=e.useCustomRule(w,l,e.schema,e)))return;o="validate.schema"+c,b=C.code,g=S.compile,v=S.inline,y=S.macro}var M=b+".errors",E="i"+a,A="ruleErr"+a,O=S.async;if(O&&!e.async)throw new Error("async keyword in sync schema");if(v||y||(s+=M+" = null;"),s+="var "+m+" = errors;var "+p+";",f&&S.$data&&(P+="}",s+=" if ("+o+" === undefined) { "+p+" = true; } else { ",T&&(P+="}",s+=" "+p+" = "+k+".validateSchema("+o+"); if ("+p+") { ")),v)S.statements?s+=" "+C.validate+" ":s+=" "+p+" = "+C.validate+"; ";else if(y){var j=e.util.copy(e);P="";j.level++;var _="valid"+j.level;j.schema=C.validate,j.schemaPath="";var I=e.compositeRule;e.compositeRule=j.compositeRule=!0;var N=e.validate(j).replace(/validate\.schema/g,b);e.compositeRule=j.compositeRule=I,s+=" "+N}else{(x=x||[]).push(s),s="",s+="  "+b+".call( ",e.opts.passContext?s+="this":s+="self",g||!1===S.schema?s+=" , "+h+" ":s+=" , "+o+" , "+h+" , validate.schema"+e.schemaPath+" ",s+=" , (dataPath || '')",'""'!=e.errorPath&&(s+=" + "+e.errorPath);var R=i?"data"+(i-1||""):"parentData",D=i?e.dataPathArr[i]:"parentDataProperty",F=s+=" , "+R+" , "+D+" , rootData )  ";s=x.pop(),!1===S.errors?(s+=" "+p+" = ",O&&(s+="await "),s+=F+"; "):s+=O?" var "+(M="customErrors"+a)+" = null; try { "+p+" = await "+F+"; } catch (e) { "+p+" = false; if (e instanceof ValidationError) "+M+" = e.errors; else throw e; } ":" "+M+" = null; "+p+" = "+F+"; "}if(S.modifying&&(s+=" if ("+R+") "+h+" = "+R+"["+D+"];"),s+=""+P,S.valid)u&&(s+=" if (true) { ");else{var x;s+=" if ( ",S.valid===undefined?(s+=" !",s+=y?""+_:""+p):s+=" "+!S.valid+" ",s+=") { ",n=w.keyword,(x=x||[]).push(s),s="",(x=x||[]).push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(n||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { keyword: '"+w.keyword+"' } ",!1!==e.opts.messages&&(s+=" , message: 'should pass \""+w.keyword+"\" keyword validation' "),e.opts.verbose&&(s+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ";var L=s;s=x.pop(),!e.compositeRule&&u?e.async?s+=" throw new ValidationError(["+L+"]); ":s+=" validate.errors = ["+L+"]; return false; ":s+=" var err = "+L+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var $=s;s=x.pop(),v?S.errors?"full"!=S.errors&&(s+="  for (var "+E+"="+m+"; "+E+"<errors; "+E+"++) { var "+A+" = vErrors["+E+"]; if ("+A+".dataPath === undefined) "+A+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+A+".schemaPath === undefined) { "+A+'.schemaPath = "'+d+'"; } ',e.opts.verbose&&(s+=" "+A+".schema = "+o+"; "+A+".data = "+h+"; "),s+=" } "):!1===S.errors?s+=" "+$+" ":(s+=" if ("+m+" == errors) { "+$+" } else {  for (var "+E+"="+m+"; "+E+"<errors; "+E+"++) { var "+A+" = vErrors["+E+"]; if ("+A+".dataPath === undefined) "+A+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+A+".schemaPath === undefined) { "+A+'.schemaPath = "'+d+'"; } ',e.opts.verbose&&(s+=" "+A+".schema = "+o+"; "+A+".data = "+h+"; "),s+=" } } "):y?(s+="   var err =   ",!1!==e.createErrors?(s+=" { keyword: '"+(n||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { keyword: '"+w.keyword+"' } ",!1!==e.opts.messages&&(s+=" , message: 'should pass \""+w.keyword+"\" keyword validation' "),e.opts.verbose&&(s+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?s+=" throw new ValidationError(vErrors); ":s+=" validate.errors = vErrors; return false; ")):!1===S.errors?s+=" "+$+" ":(s+=" if (Array.isArray("+M+")) { if (vErrors === null) vErrors = "+M+"; else vErrors = vErrors.concat("+M+"); errors = vErrors.length;  for (var "+E+"="+m+"; "+E+"<errors; "+E+"++) { var "+A+" = vErrors["+E+"]; if ("+A+".dataPath === undefined) "+A+".dataPath = (dataPath || '') + "+e.errorPath+";  "+A+'.schemaPath = "'+d+'";  ',e.opts.verbose&&(s+=" "+A+".schema = "+o+"; "+A+".data = "+h+"; "),s+=" } } else { "+$+" } "),s+=" } ",u&&(s+=" else { ")}return s}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/custom.js"}],[3352,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.level,s=e.dataLevel,a=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="errs__"+o,h=e.util.copy(e),p="";h.level++;var m="valid"+h.level,f={},g={},v=e.opts.ownProperties;for(w in a)if("__proto__"!=w){var y=a[w],C=Array.isArray(y)?g:f;C[w]=y}n+="var "+u+" = errors;";var b=e.errorPath;for(var w in n+="var missing"+o+";",g)if((C=g[w]).length){if(n+=" if ( "+d+e.util.getProperty(w)+" !== undefined ",v&&(n+=" && Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(w)+"') "),c){n+=" && ( ";var k=C;if(k)for(var S=-1,P=k.length-1;S<P;){j=k[S+=1],S&&(n+=" || "),n+=" ( ( "+(R=d+(N=e.util.getProperty(j)))+" === undefined ",v&&(n+=" || ! Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(j)+"') "),n+=") && (missing"+o+" = "+e.util.toQuotedString(e.opts.jsonPointers?j:N)+") ) "}n+=")) {  ";var T="missing"+o,M="' + "+T+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(b,T,!0):b+" + "+T);var E=E||[];E.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(w)+"', missingProperty: '"+M+"', depsCount: "+C.length+", deps: '"+e.util.escapeQuotes(1==C.length?C[0]:C.join(", "))+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should have ",1==C.length?n+="property "+e.util.escapeQuotes(C[0]):n+="properties "+e.util.escapeQuotes(C.join(", ")),n+=" when property "+e.util.escapeQuotes(w)+" is present' "),e.opts.verbose&&(n+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var A=n;n=E.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+A+"]); ":n+=" validate.errors = ["+A+"]; return false; ":n+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{n+=" ) { ";var O=C;if(O)for(var j,_=-1,I=O.length-1;_<I;){j=O[_+=1];var N=e.util.getProperty(j),R=(M=e.util.escapeQuotes(j),d+N);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(b,j,e.opts.jsonPointers)),n+=" if ( "+R+" === undefined ",v&&(n+=" || ! Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(j)+"') "),n+=") {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(w)+"', missingProperty: '"+M+"', depsCount: "+C.length+", deps: '"+e.util.escapeQuotes(1==C.length?C[0]:C.join(", "))+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should have ",1==C.length?n+="property "+e.util.escapeQuotes(C[0]):n+="properties "+e.util.escapeQuotes(C.join(", ")),n+=" when property "+e.util.escapeQuotes(w)+" is present' "),e.opts.verbose&&(n+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}n+=" }   ",c&&(p+="}",n+=" else { ")}e.errorPath=b;var D=h.baseId;for(var w in f){y=f[w];(e.opts.strictKeywords?"object"==typeof y&&Object.keys(y).length>0||!1===y:e.util.schemaHasRules(y,e.RULES.all))&&(n+=" "+m+" = true; if ( "+d+e.util.getProperty(w)+" !== undefined ",v&&(n+=" && Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(w)+"') "),n+=") { ",h.schema=y,h.schemaPath=i+e.util.getProperty(w),h.errSchemaPath=l+"/"+e.util.escapeFragment(w),n+="  "+e.validate(h)+" ",h.baseId=D,n+=" }  ",c&&(n+=" if ("+m+") { ",p+="}"))}return c&&(n+="   "+p+" if ("+u+" == errors) {"),n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/dependencies.js"}],[3353,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.level,s=e.dataLevel,a=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+o,h=e.opts.$data&&a&&a.$data;h&&(n+=" var schema"+o+" = "+e.util.getData(a.$data,s,e.dataPathArr)+"; ");var p="i"+o,m="schema"+o;h||(n+=" var "+m+" = validate.schema"+i+";"),n+="var "+u+";",h&&(n+=" if (schema"+o+" === undefined) "+u+" = true; else if (!Array.isArray(schema"+o+")) "+u+" = false; else {"),n+=u+" = false;for (var "+p+"=0; "+p+"<"+m+".length; "+p+"++) if (equal("+d+", "+m+"["+p+"])) { "+u+" = true; break; }",h&&(n+="  }  "),n+=" if (!"+u+") {   ";var f=f||[];f.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValues: schema"+o+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(n+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var g=n;return n=f.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }",c&&(n+=" else { "),n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/enum.js"}],[3354,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.level,s=e.dataLevel,a=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||"");if(!1===e.opts.format)return c&&(n+=" if (true) { "),n;var u,h=e.opts.$data&&a&&a.$data;h?(n+=" var schema"+o+" = "+e.util.getData(a.$data,s,e.dataPathArr)+"; ",u="schema"+o):u=a;var p=e.opts.unknownFormats,m=Array.isArray(p);if(h){n+=" var "+(f="format"+o)+" = formats["+u+"]; var "+(g="isObject"+o)+" = typeof "+f+" == 'object' && !("+f+" instanceof RegExp) && "+f+".validate; var "+(v="formatType"+o)+" = "+g+" && "+f+".type || 'string'; if ("+g+") { ",e.async&&(n+=" var async"+o+" = "+f+".async; "),n+=" "+f+" = "+f+".validate; } if (  ",h&&(n+=" ("+u+" !== undefined && typeof "+u+" != 'string') || "),n+=" (","ignore"!=p&&(n+=" ("+u+" && !"+f+" ",m&&(n+=" && self._opts.unknownFormats.indexOf("+u+") == -1 "),n+=") || "),n+=" ("+f+" && "+v+" == '"+r+"' && !(typeof "+f+" == 'function' ? ",e.async?n+=" (async"+o+" ? await "+f+"("+d+") : "+f+"("+d+")) ":n+=" "+f+"("+d+") ",n+=" : "+f+".test("+d+"))))) {"}else{var f;if(!(f=e.formats[a])){if("ignore"==p)return e.logger.warn('unknown format "'+a+'" ignored in schema at path "'+e.errSchemaPath+'"'),c&&(n+=" if (true) { "),n;if(m&&p.indexOf(a)>=0)return c&&(n+=" if (true) { "),n;throw new Error('unknown format "'+a+'" is used in schema at path "'+e.errSchemaPath+'"')}var g,v=(g="object"==typeof f&&!(f instanceof RegExp)&&f.validate)&&f.type||"string";if(g){var y=!0===f.async;f=f.validate}if(v!=r)return c&&(n+=" if (true) { "),n;if(y){if(!e.async)throw new Error("async format in sync schema");n+=" if (!(await "+(C="formats"+e.util.getProperty(a)+".validate")+"("+d+"))) { "}else{n+=" if (! ";var C="formats"+e.util.getProperty(a);g&&(C+=".validate"),n+="function"==typeof f?" "+C+"("+d+") ":" "+C+".test("+d+") ",n+=") { "}}var b=b||[];b.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { format:  ",n+=h?""+u:""+e.util.toQuotedString(a),n+="  } ",!1!==e.opts.messages&&(n+=" , message: 'should match format \"",n+=h?"' + "+u+" + '":""+e.util.escapeQuotes(a),n+="\"' "),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+i:""+e.util.toQuotedString(a),n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var w=n;return n=b.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+w+"]); ":n+=" validate.errors = ["+w+"]; return false; ":n+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",c&&(n+=" else { "),n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/format.js"}],[3355,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.level,s=e.dataLevel,a=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+o,h="errs__"+o,p=e.util.copy(e);p.level++;var m="valid"+p.level,f=e.schema.then,g=e.schema.else,v=f!==undefined&&(e.opts.strictKeywords?"object"==typeof f&&Object.keys(f).length>0||!1===f:e.util.schemaHasRules(f,e.RULES.all)),y=g!==undefined&&(e.opts.strictKeywords?"object"==typeof g&&Object.keys(g).length>0||!1===g:e.util.schemaHasRules(g,e.RULES.all)),C=p.baseId;if(v||y){var b;p.createErrors=!1,p.schema=a,p.schemaPath=i,p.errSchemaPath=l,n+=" var "+h+" = errors; var "+u+" = true;  ";var w=e.compositeRule;e.compositeRule=p.compositeRule=!0,n+="  "+e.validate(p)+" ",p.baseId=C,p.createErrors=!0,n+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }  ",e.compositeRule=p.compositeRule=w,v?(n+=" if ("+m+") {  ",p.schema=e.schema.then,p.schemaPath=e.schemaPath+".then",p.errSchemaPath=e.errSchemaPath+"/then",n+="  "+e.validate(p)+" ",p.baseId=C,n+=" "+u+" = "+m+"; ",v&&y?n+=" var "+(b="ifClause"+o)+" = 'then'; ":b="'then'",n+=" } ",y&&(n+=" else { ")):n+=" if (!"+m+") { ",y&&(p.schema=e.schema.else,p.schemaPath=e.schemaPath+".else",p.errSchemaPath=e.errSchemaPath+"/else",n+="  "+e.validate(p)+" ",p.baseId=C,n+=" "+u+" = "+m+"; ",v&&y?n+=" var "+(b="ifClause"+o)+" = 'else'; ":b="'else'",n+=" } "),n+=" if (!"+u+") {   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { failingKeyword: "+b+" } ",!1!==e.opts.messages&&(n+=" , message: 'should match \"' + "+b+" + '\" schema' "),e.opts.verbose&&(n+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+=" }   ",c&&(n+=" else { ")}else c&&(n+=" if (true) { ");return n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/if.js"}],[3356,{"./_limit":3342,"./_limitItems":3343,"./_limitLength":3344,"./_limitProperties":3345,"./allOf":3346,"./anyOf":3347,"./comment":3348,"./const":3349,"./contains":3350,"./dependencies":3352,"./enum":3353,"./format":3354,"./if":3355,"./items":3357,"./multipleOf":3358,"./not":3359,"./oneOf":3360,"./pattern":3361,"./properties":3362,"./propertyNames":3363,"./ref":3364,"./required":3365,"./uniqueItems":3366,"./validate":3367},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports={$ref:e("./ref"),allOf:e("./allOf"),anyOf:e("./anyOf"),$comment:e("./comment"),const:e("./const"),contains:e("./contains"),dependencies:e("./dependencies"),enum:e("./enum"),format:e("./format"),if:e("./if"),items:e("./items"),maximum:e("./_limit"),minimum:e("./_limit"),maxItems:e("./_limitItems"),minItems:e("./_limitItems"),maxLength:e("./_limitLength"),minLength:e("./_limitLength"),maxProperties:e("./_limitProperties"),minProperties:e("./_limitProperties"),multipleOf:e("./multipleOf"),not:e("./not"),oneOf:e("./oneOf"),pattern:e("./pattern"),properties:e("./properties"),propertyNames:e("./propertyNames"),required:e("./required"),uniqueItems:e("./uniqueItems"),validate:e("./validate")}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/index.js"}],[3357,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.level,s=e.dataLevel,a=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+o,h="errs__"+o,p=e.util.copy(e),m="";p.level++;var f="valid"+p.level,g="i"+o,v=p.dataLevel=e.dataLevel+1,y="data"+v,C=e.baseId;if(n+="var "+h+" = errors;var "+u+";",Array.isArray(a)){var b=e.schema.additionalItems;if(!1===b){n+=" "+u+" = "+d+".length <= "+a.length+"; ";var w=l;l=e.errSchemaPath+"/additionalItems",n+="  if (!"+u+") {   ";var k=k||[];k.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+a.length+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have more than "+a.length+" items' "),e.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var S=n;n=k.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+S+"]); ":n+=" validate.errors = ["+S+"]; return false; ":n+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",l=w,c&&(m+="}",n+=" else { ")}var P=a;if(P)for(var T,M=-1,E=P.length-1;M<E;)if(T=P[M+=1],e.opts.strictKeywords?"object"==typeof T&&Object.keys(T).length>0||!1===T:e.util.schemaHasRules(T,e.RULES.all)){n+=" "+f+" = true; if ("+d+".length > "+M+") { ";var A=d+"["+M+"]";p.schema=T,p.schemaPath=i+"["+M+"]",p.errSchemaPath=l+"/"+M,p.errorPath=e.util.getPathExpr(e.errorPath,M,e.opts.jsonPointers,!0),p.dataPathArr[v]=M;var O=e.validate(p);p.baseId=C,e.util.varOccurences(O,y)<2?n+=" "+e.util.varReplace(O,y,A)+" ":n+=" var "+y+" = "+A+"; "+O+" ",n+=" }  ",c&&(n+=" if ("+f+") { ",m+="}")}if("object"==typeof b&&(e.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0||!1===b:e.util.schemaHasRules(b,e.RULES.all))){p.schema=b,p.schemaPath=e.schemaPath+".additionalItems",p.errSchemaPath=e.errSchemaPath+"/additionalItems",n+=" "+f+" = true; if ("+d+".length > "+a.length+") {  for (var "+g+" = "+a.length+"; "+g+" < "+d+".length; "+g+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers,!0);A=d+"["+g+"]";p.dataPathArr[v]=g;O=e.validate(p);p.baseId=C,e.util.varOccurences(O,y)<2?n+=" "+e.util.varReplace(O,y,A)+" ":n+=" var "+y+" = "+A+"; "+O+" ",c&&(n+=" if (!"+f+") break; "),n+=" } }  ",c&&(n+=" if ("+f+") { ",m+="}")}}else if(e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){p.schema=a,p.schemaPath=i,p.errSchemaPath=l,n+="  for (var "+g+" = 0; "+g+" < "+d+".length; "+g+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers,!0);A=d+"["+g+"]";p.dataPathArr[v]=g;O=e.validate(p);p.baseId=C,e.util.varOccurences(O,y)<2?n+=" "+e.util.varReplace(O,y,A)+" ":n+=" var "+y+" = "+A+"; "+O+" ",c&&(n+=" if (!"+f+") break; "),n+=" }"}return c&&(n+=" "+m+" if ("+h+" == errors) {"),n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/items.js"}],[3358,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n,o=" ",s=e.level,a=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(a||""),h=e.opts.$data&&i&&i.$data;if(h?(o+=" var schema"+s+" = "+e.util.getData(i.$data,a,e.dataPathArr)+"; ",n="schema"+s):n=i,!h&&"number"!=typeof i)throw new Error(t+" must be number");o+="var division"+s+";if (",h&&(o+=" "+n+" !== undefined && ( typeof "+n+" != 'number' || "),o+=" (division"+s+" = "+u+" / "+n+", ",e.opts.multipleOfPrecision?o+=" Math.abs(Math.round(division"+s+") - division"+s+") > 1e-"+e.opts.multipleOfPrecision+" ":o+=" division"+s+" !== parseInt(division"+s+") ",o+=" ) ",h&&(o+="  )  "),o+=" ) {   ";var p=p||[];p.push(o),o="",!1!==e.createErrors?(o+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+n+" } ",!1!==e.opts.messages&&(o+=" , message: 'should be multiple of ",o+=h?"' + "+n:n+"'"),e.opts.verbose&&(o+=" , schema:  ",o+=h?"validate.schema"+l:""+i,o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),o+=" } "):o+=" {} ";var m=o;return o=p.pop(),!e.compositeRule&&d?e.async?o+=" throw new ValidationError(["+m+"]); ":o+=" validate.errors = ["+m+"]; return false; ":o+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+="} ",d&&(o+=" else { "),o}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/multipleOf.js"}],[3359,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.level,s=e.dataLevel,a=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="errs__"+o,h=e.util.copy(e);h.level++;var p="valid"+h.level;if(e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){h.schema=a,h.schemaPath=i,h.errSchemaPath=l,n+=" var "+u+" = errors;  ";var m,f=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.createErrors=!1,h.opts.allErrors&&(m=h.opts.allErrors,h.opts.allErrors=!1),n+=" "+e.validate(h)+" ",h.createErrors=!0,m&&(h.opts.allErrors=m),e.compositeRule=h.compositeRule=f,n+=" if ("+p+") {   ";var g=g||[];g.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should NOT be valid' "),e.opts.verbose&&(n+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var v=n;n=g.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+v+"]); ":n+=" validate.errors = ["+v+"]; return false; ":n+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else {  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; } ",e.opts.allErrors&&(n+=" } ")}else n+="  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should NOT be valid' "),e.opts.verbose&&(n+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(n+=" if (false) { ");return n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/not.js"}],[336,{"@metamask/utils":2632,lodash:4362,loglevel:4370},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,o.cloneDeep)(e);return t.meta.version=i,t.data=function(e){if((0,s.hasProperty)(e,"PhishingController")&&(0,s.isObject)(e.PhishingController))delete e.PhishingController.stalelistLastFetched,delete e.PhishingController.hotlistLastFetched;else if((0,s.hasProperty)(e,"PhishingController")){var t,r;null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.PhishingController is "+typeof e.PhishingController))}else a.default.warn("typeof state.PhishingController is undefined");return e}(t.data),t},r.version=void 0;var n,o=e("lodash"),s=e("@metamask/utils"),a=(n=e("loglevel"))&&n.__esModule?n:{default:n};const i=r.version=92}}},{package:"$root$",file:"app/scripts/migrations/092.ts"}],[3360,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.level,s=e.dataLevel,a=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+o,h="errs__"+o,p=e.util.copy(e),m="";p.level++;var f="valid"+p.level,g=p.baseId,v="prevValid"+o,y="passingSchemas"+o;n+="var "+h+" = errors , "+v+" = false , "+u+" = false , "+y+" = null; ";var C=e.compositeRule;e.compositeRule=p.compositeRule=!0;var b=a;if(b)for(var w,k=-1,S=b.length-1;k<S;)w=b[k+=1],(e.opts.strictKeywords?"object"==typeof w&&Object.keys(w).length>0||!1===w:e.util.schemaHasRules(w,e.RULES.all))?(p.schema=w,p.schemaPath=i+"["+k+"]",p.errSchemaPath=l+"/"+k,n+="  "+e.validate(p)+" ",p.baseId=g):n+=" var "+f+" = true; ",k&&(n+=" if ("+f+" && "+v+") { "+u+" = false; "+y+" = ["+y+", "+k+"]; } else { ",m+="}"),n+=" if ("+f+") { "+u+" = "+v+" = true; "+y+" = "+k+"; }";return e.compositeRule=p.compositeRule=C,n+=m+"if (!"+u+") {   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { passingSchemas: "+y+" } ",!1!==e.opts.messages&&(n+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(n+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+="} else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }",e.opts.allErrors&&(n+=" } "),n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/oneOf.js"}],[3361,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n,o=" ",s=e.level,a=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(a||""),h=e.opts.$data&&i&&i.$data;h?(o+=" var schema"+s+" = "+e.util.getData(i.$data,a,e.dataPathArr)+"; ",n="schema"+s):n=i,o+="if ( ",h&&(o+=" ("+n+" !== undefined && typeof "+n+" != 'string') || "),o+=" !"+(h?"(new RegExp("+n+"))":e.usePattern(i))+".test("+u+") ) {   ";var p=p||[];p.push(o),o="",!1!==e.createErrors?(o+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",o+=h?""+n:""+e.util.toQuotedString(i),o+="  } ",!1!==e.opts.messages&&(o+=" , message: 'should match pattern \"",o+=h?"' + "+n+" + '":""+e.util.escapeQuotes(i),o+="\"' "),e.opts.verbose&&(o+=" , schema:  ",o+=h?"validate.schema"+l:""+e.util.toQuotedString(i),o+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),o+=" } "):o+=" {} ";var m=o;return o=p.pop(),!e.compositeRule&&d?e.async?o+=" throw new ValidationError(["+m+"]); ":o+=" validate.errors = ["+m+"]; return false; ":o+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o+="} ",d&&(o+=" else { "),o}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/pattern.js"}],[3362,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.level,s=e.dataLevel,a=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="errs__"+o,h=e.util.copy(e),p="";h.level++;var m="valid"+h.level,f="key"+o,g="idx"+o,v=h.dataLevel=e.dataLevel+1,y="data"+v,C="dataProperties"+o,b=Object.keys(a||{}).filter(N),w=e.schema.patternProperties||{},k=Object.keys(w).filter(N),S=e.schema.additionalProperties,P=b.length||k.length,T=!1===S,M="object"==typeof S&&Object.keys(S).length,E=e.opts.removeAdditional,A=T||M||E,O=e.opts.ownProperties,j=e.baseId,_=e.schema.required;if(_&&(!e.opts.$data||!_.$data)&&_.length<e.opts.loopRequired)var I=e.util.toHash(_);function N(e){return"__proto__"!==e}if(n+="var "+u+" = errors;var "+m+" = true;",O&&(n+=" var "+C+" = undefined;"),A){if(n+=O?" "+C+" = "+C+" || Object.keys("+d+"); for (var "+g+"=0; "+g+"<"+C+".length; "+g+"++) { var "+f+" = "+C+"["+g+"]; ":" for (var "+f+" in "+d+") { ",P){if(n+=" var isAdditional"+o+" = !(false ",b.length)if(b.length>8)n+=" || validate.schema"+i+".hasOwnProperty("+f+") ";else{var R=b;if(R)for(var D=-1,F=R.length-1;D<F;)Y=R[D+=1],n+=" || "+f+" == "+e.util.toQuotedString(Y)+" "}if(k.length){var x=k;if(x)for(var L=-1,$=x.length-1;L<$;)se=x[L+=1],n+=" || "+e.usePattern(se)+".test("+f+") "}n+=" ); if (isAdditional"+o+") { "}if("all"==E)n+=" delete "+d+"["+f+"]; ";else{var B=e.errorPath,U="' + "+f+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers)),T)if(E)n+=" delete "+d+"["+f+"]; ";else{n+=" "+m+" = false; ";var K=l;l=e.errSchemaPath+"/additionalProperties",(re=re||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { additionalProperty: '"+U+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is an invalid additional property":n+="should NOT have additional properties",n+="' "),e.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var G=n;n=re.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+G+"]); ":n+=" validate.errors = ["+G+"]; return false; ":n+=" var err = "+G+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=K,c&&(n+=" break; ")}else if(M)if("failing"==E){n+=" var "+u+" = errors;  ";var q=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.schema=S,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers);var V=d+"["+f+"]";h.dataPathArr[v]=f;var H=e.validate(h);h.baseId=j,e.util.varOccurences(H,y)<2?n+=" "+e.util.varReplace(H,y,V)+" ":n+=" var "+y+" = "+V+"; "+H+" ",n+=" if (!"+m+") { errors = "+u+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+d+"["+f+"]; }  ",e.compositeRule=h.compositeRule=q}else{h.schema=S,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers);V=d+"["+f+"]";h.dataPathArr[v]=f;H=e.validate(h);h.baseId=j,e.util.varOccurences(H,y)<2?n+=" "+e.util.varReplace(H,y,V)+" ":n+=" var "+y+" = "+V+"; "+H+" ",c&&(n+=" if (!"+m+") break; ")}e.errorPath=B}P&&(n+=" } "),n+=" }  ",c&&(n+=" if ("+m+") { ",p+="}")}var W=e.opts.useDefaults&&!e.compositeRule;if(b.length){var z=b;if(z)for(var Y,Q=-1,J=z.length-1;Q<J;){var Z=a[Y=z[Q+=1]];if(e.opts.strictKeywords?"object"==typeof Z&&Object.keys(Z).length>0||!1===Z:e.util.schemaHasRules(Z,e.RULES.all)){var X=e.util.getProperty(Y),ee=(V=d+X,W&&Z.default!==undefined);h.schema=Z,h.schemaPath=i+X,h.errSchemaPath=l+"/"+e.util.escapeFragment(Y),h.errorPath=e.util.getPath(e.errorPath,Y,e.opts.jsonPointers),h.dataPathArr[v]=e.util.toQuotedString(Y);H=e.validate(h);if(h.baseId=j,e.util.varOccurences(H,y)<2){H=e.util.varReplace(H,y,V);var te=V}else{te=y;n+=" var "+y+" = "+V+"; "}if(ee)n+=" "+H+" ";else{if(I&&I[Y]){n+=" if ( "+te+" === undefined ",O&&(n+=" || ! Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(Y)+"') "),n+=") { "+m+" = false; ";B=e.errorPath,K=l;var re,ne=e.util.escapeQuotes(Y);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(B,Y,e.opts.jsonPointers)),l=e.errSchemaPath+"/required",(re=re||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+ne+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+ne+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";G=n;n=re.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+G+"]); ":n+=" validate.errors = ["+G+"]; return false; ":n+=" var err = "+G+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=K,e.errorPath=B,n+=" } else { "}else c?(n+=" if ( "+te+" === undefined ",O&&(n+=" || ! Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(Y)+"') "),n+=") { "+m+" = true; } else { "):(n+=" if ("+te+" !== undefined ",O&&(n+=" &&   Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(Y)+"') "),n+=" ) { ");n+=" "+H+" } "}}c&&(n+=" if ("+m+") { ",p+="}")}}if(k.length){var oe=k;if(oe)for(var se,ae=-1,ie=oe.length-1;ae<ie;){Z=w[se=oe[ae+=1]];if(e.opts.strictKeywords?"object"==typeof Z&&Object.keys(Z).length>0||!1===Z:e.util.schemaHasRules(Z,e.RULES.all)){h.schema=Z,h.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(se),h.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(se),n+=O?" "+C+" = "+C+" || Object.keys("+d+"); for (var "+g+"=0; "+g+"<"+C+".length; "+g+"++) { var "+f+" = "+C+"["+g+"]; ":" for (var "+f+" in "+d+") { ",n+=" if ("+e.usePattern(se)+".test("+f+")) { ",h.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers);V=d+"["+f+"]";h.dataPathArr[v]=f;H=e.validate(h);h.baseId=j,e.util.varOccurences(H,y)<2?n+=" "+e.util.varReplace(H,y,V)+" ":n+=" var "+y+" = "+V+"; "+H+" ",c&&(n+=" if (!"+m+") break; "),n+=" } ",c&&(n+=" else "+m+" = true; "),n+=" }  ",c&&(n+=" if ("+m+") { ",p+="}")}}}return c&&(n+=" "+p+" if ("+u+" == errors) {"),n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/properties.js"}],[3363,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=" ",o=e.level,s=e.dataLevel,a=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="errs__"+o,h=e.util.copy(e);h.level++;var p="valid"+h.level;if(n+="var "+u+" = errors;",e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){h.schema=a,h.schemaPath=i,h.errSchemaPath=l;var m="key"+o,f="idx"+o,g="i"+o,v="' + "+m+" + '",y="data"+(h.dataLevel=e.dataLevel+1),C="dataProperties"+o,b=e.opts.ownProperties,w=e.baseId;b&&(n+=" var "+C+" = undefined; "),n+=b?" "+C+" = "+C+" || Object.keys("+d+"); for (var "+f+"=0; "+f+"<"+C+".length; "+f+"++) { var "+m+" = "+C+"["+f+"]; ":" for (var "+m+" in "+d+") { ",n+=" var startErrs"+o+" = errors; ";var k=m,S=e.compositeRule;e.compositeRule=h.compositeRule=!0;var P=e.validate(h);h.baseId=w,e.util.varOccurences(P,y)<2?n+=" "+e.util.varReplace(P,y,k)+" ":n+=" var "+y+" = "+k+"; "+P+" ",e.compositeRule=h.compositeRule=S,n+=" if (!"+p+") { for (var "+g+"=startErrs"+o+"; "+g+"<errors; "+g+"++) { vErrors["+g+"].propertyName = "+m+"; }   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { propertyName: '"+v+"' } ",!1!==e.opts.messages&&(n+=" , message: 'property name \\'"+v+"\\' is invalid' "),e.opts.verbose&&(n+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),c&&(n+=" break; "),n+=" } }"}return c&&(n+="  if ("+u+" == errors) {"),n}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/propertyNames.js"}],[3364,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n,o,s=" ",a=e.level,i=e.dataLevel,l=e.schema[t],c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(i||""),h="valid"+a;if("#"==l||"#/"==l)e.isRoot?(n=e.async,o="validate"):(n=!0===e.root.schema.$async,o="root.refVal[0]");else{var p=e.resolveRef(e.baseId,l,e.isRoot);if(p===undefined){var m=e.MissingRefError.message(e.baseId,l);if("fail"==e.opts.missingRefs){e.logger.error(m),(y=y||[]).push(s),s="",!1!==e.createErrors?(s+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { ref: '"+e.util.escapeQuotes(l)+"' } ",!1!==e.opts.messages&&(s+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(l)+"' "),e.opts.verbose&&(s+=" , schema: "+e.util.toQuotedString(l)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),s+=" } "):s+=" {} ";var f=s;s=y.pop(),!e.compositeRule&&d?e.async?s+=" throw new ValidationError(["+f+"]); ":s+=" validate.errors = ["+f+"]; return false; ":s+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",d&&(s+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,l,m);e.logger.warn(m),d&&(s+=" if (true) { ")}}else if(p.inline){var g=e.util.copy(e);g.level++;var v="valid"+g.level;g.schema=p.schema,g.schemaPath="",g.errSchemaPath=l,s+=" "+e.validate(g).replace(/validate\.schema/g,p.code)+" ",d&&(s+=" if ("+v+") { ")}else n=!0===p.$async||e.async&&!1!==p.$async,o=p.code}if(o){var y;(y=y||[]).push(s),s="",e.opts.passContext?s+=" "+o+".call(this, ":s+=" "+o+"( ",s+=" "+u+", (dataPath || '')",'""'!=e.errorPath&&(s+=" + "+e.errorPath);var C=s+=" , "+(i?"data"+(i-1||""):"parentData")+" , "+(i?e.dataPathArr[i]:"parentDataProperty")+", rootData)  ";if(s=y.pop(),n){if(!e.async)throw new Error("async schema referenced by sync schema");d&&(s+=" var "+h+"; "),s+=" try { await "+C+"; ",d&&(s+=" "+h+" = true; "),s+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",d&&(s+=" "+h+" = false; "),s+=" } ",d&&(s+=" if ("+h+") { ")}else s+=" if (!"+C+") { if (vErrors === null) vErrors = "+o+".errors; else vErrors = vErrors.concat("+o+".errors); errors = vErrors.length; } ",d&&(s+=" else { ")}return s}}}},{package:"eslint>ajv",file:"node_modules/ajv/lib/dotjs/ref.js"}]],[],{});